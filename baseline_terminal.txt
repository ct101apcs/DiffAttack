
******Attack based on Diffusion, Attacked Dataset: imagenet_compatible*********

Loading pipeline components...: 100%|██████████| 6/6 [00:02<00:00,  2.48it/s]

Accuracy on benign examples: 100.0%
gt_label: 809 pred_label: 809 pred_clean_logit 0.9425603747367859
prompt generate:  soup bowl  	labels:  [[809]]
decoder:  [49406, 7077, 3814, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.38it/s]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:32<00:00,  6.51s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:02<?, ?it/s, attack_loss: -1.91065 variance_cross_attn_loss: 0.05474 self_attn_loss: 0.00000 loss: -1.85591]
Iterations:   3%|▎         | 1/30 [00:03<01:42,  3.55s/it, attack_loss: -1.91065 variance_cross_attn_loss: 0.05474 self_attn_loss: 0.00000 loss: -1.85591]
Iterations:   3%|▎         | 1/30 [00:04<01:42,  3.55s/it, attack_loss: -4.59649 variance_cross_attn_loss: 0.05300 self_attn_loss: 1.03004 loss: -3.51345]
Iterations:   7%|▋         | 2/30 [00:05<01:20,  2.88s/it, attack_loss: -4.59649 variance_cross_attn_loss: 0.05300 self_attn_loss: 1.03004 loss: -3.51345]
Iterations:   7%|▋         | 2/30 [00:07<01:20,  2.88s/it, attack_loss: -6.53676 variance_cross_attn_loss: 0.04954 self_attn_loss: 0.84112 loss: -5.64610]
Iterations:  10%|█         | 3/30 [00:08<01:14,  2.76s/it, attack_loss: -6.53676 variance_cross_attn_loss: 0.04954 self_attn_loss: 0.84112 loss: -5.64610]
Iterations:  10%|█         | 3/30 [00:10<01:14,  2.76s/it, attack_loss: -15.74443 variance_cross_attn_loss: 0.05116 self_attn_loss: 0.98470 loss: -14.70858]
Iterations:  13%|█▎        | 4/30 [00:11<01:11,  2.75s/it, attack_loss: -15.74443 variance_cross_attn_loss: 0.05116 self_attn_loss: 0.98470 loss: -14.70858]
Iterations:  13%|█▎        | 4/30 [00:13<01:11,  2.75s/it, attack_loss: -15.54316 variance_cross_attn_loss: 0.05320 self_attn_loss: 1.34093 loss: -14.14903]
Iterations:  17%|█▋        | 5/30 [00:14<01:12,  2.91s/it, attack_loss: -15.54316 variance_cross_attn_loss: 0.05320 self_attn_loss: 1.34093 loss: -14.14903]
Iterations:  17%|█▋        | 5/30 [00:16<01:12,  2.91s/it, attack_loss: -20.33558 variance_cross_attn_loss: 0.05212 self_attn_loss: 1.41589 loss: -18.86757]
Iterations:  20%|██        | 6/30 [00:17<01:12,  3.02s/it, attack_loss: -20.33558 variance_cross_attn_loss: 0.05212 self_attn_loss: 1.41589 loss: -18.86757]
Iterations:  20%|██        | 6/30 [00:19<01:12,  3.02s/it, attack_loss: -34.58123 variance_cross_attn_loss: 0.04733 self_attn_loss: 1.28203 loss: -33.25188]
Iterations:  23%|██▎       | 7/30 [00:21<01:11,  3.12s/it, attack_loss: -34.58123 variance_cross_attn_loss: 0.04733 self_attn_loss: 1.28203 loss: -33.25188]
Iterations:  23%|██▎       | 7/30 [00:22<01:11,  3.12s/it, attack_loss: -41.28695 variance_cross_attn_loss: 0.04785 self_attn_loss: 1.24737 loss: -39.99172]
Iterations:  27%|██▋       | 8/30 [00:24<01:09,  3.17s/it, attack_loss: -41.28695 variance_cross_attn_loss: 0.04785 self_attn_loss: 1.24737 loss: -39.99172]
Iterations:  27%|██▋       | 8/30 [00:26<01:09,  3.17s/it, attack_loss: -50.77021 variance_cross_attn_loss: 0.04733 self_attn_loss: 1.29752 loss: -49.42536]
Iterations:  30%|███       | 9/30 [00:27<01:06,  3.16s/it, attack_loss: -50.77021 variance_cross_attn_loss: 0.04733 self_attn_loss: 1.29752 loss: -49.42536]
Iterations:  30%|███       | 9/30 [00:28<01:06,  3.16s/it, attack_loss: -62.06383 variance_cross_attn_loss: 0.04758 self_attn_loss: 1.35342 loss: -60.66283]
Iterations:  33%|███▎      | 10/30 [00:30<01:00,  3.00s/it, attack_loss: -62.06383 variance_cross_attn_loss: 0.04758 self_attn_loss: 1.35342 loss: -60.66283]
Iterations:  33%|███▎      | 10/30 [00:31<01:00,  3.00s/it, attack_loss: -74.82990 variance_cross_attn_loss: 0.04788 self_attn_loss: 1.35369 loss: -73.42833]
Iterations:  37%|███▋      | 11/30 [00:32<00:55,  2.91s/it, attack_loss: -74.82990 variance_cross_attn_loss: 0.04788 self_attn_loss: 1.35369 loss: -73.42833]
Iterations:  37%|███▋      | 11/30 [00:34<00:55,  2.91s/it, attack_loss: -82.26177 variance_cross_attn_loss: 0.04766 self_attn_loss: 1.41883 loss: -80.79528]
Iterations:  40%|████      | 12/30 [00:35<00:51,  2.87s/it, attack_loss: -82.26177 variance_cross_attn_loss: 0.04766 self_attn_loss: 1.41883 loss: -80.79528]
Iterations:  40%|████      | 12/30 [00:37<00:51,  2.87s/it, attack_loss: -91.13448 variance_cross_attn_loss: 0.04753 self_attn_loss: 1.49885 loss: -89.58811]
Iterations:  43%|████▎     | 13/30 [00:38<00:50,  2.99s/it, attack_loss: -91.13448 variance_cross_attn_loss: 0.04753 self_attn_loss: 1.49885 loss: -89.58811]
Iterations:  43%|████▎     | 13/30 [00:40<00:50,  2.99s/it, attack_loss: -101.69430 variance_cross_attn_loss: 0.04694 self_attn_loss: 1.61687 loss: -100.03049]
Iterations:  47%|████▋     | 14/30 [00:42<00:48,  3.05s/it, attack_loss: -101.69430 variance_cross_attn_loss: 0.04694 self_attn_loss: 1.61687 loss: -100.03049]
Iterations:  47%|████▋     | 14/30 [00:43<00:48,  3.05s/it, attack_loss: -111.74884 variance_cross_attn_loss: 0.04663 self_attn_loss: 1.78655 loss: -109.91566]
Iterations:  50%|█████     | 15/30 [00:45<00:46,  3.08s/it, attack_loss: -111.74884 variance_cross_attn_loss: 0.04663 self_attn_loss: 1.78655 loss: -109.91566]
Iterations:  50%|█████     | 15/30 [00:46<00:46,  3.08s/it, attack_loss: -120.10683 variance_cross_attn_loss: 0.04753 self_attn_loss: 1.76384 loss: -118.29546]
Iterations:  53%|█████▎    | 16/30 [00:48<00:43,  3.12s/it, attack_loss: -120.10683 variance_cross_attn_loss: 0.04753 self_attn_loss: 1.76384 loss: -118.29546]
Iterations:  53%|█████▎    | 16/30 [00:50<00:43,  3.12s/it, attack_loss: -128.64511 variance_cross_attn_loss: 0.04762 self_attn_loss: 1.76195 loss: -126.83555]
Iterations:  57%|█████▋    | 17/30 [00:51<00:40,  3.15s/it, attack_loss: -128.64511 variance_cross_attn_loss: 0.04762 self_attn_loss: 1.76195 loss: -126.83555]
Iterations:  57%|█████▋    | 17/30 [00:53<00:40,  3.15s/it, attack_loss: -137.10703 variance_cross_attn_loss: 0.04637 self_attn_loss: 1.74991 loss: -135.31075]
Iterations:  60%|██████    | 18/30 [00:54<00:36,  3.01s/it, attack_loss: -137.10703 variance_cross_attn_loss: 0.04637 self_attn_loss: 1.74991 loss: -135.31075]
Iterations:  60%|██████    | 18/30 [00:55<00:36,  3.01s/it, attack_loss: -145.86397 variance_cross_attn_loss: 0.04572 self_attn_loss: 1.74197 loss: -144.07626]
Iterations:  63%|██████▎   | 19/30 [00:57<00:33,  3.00s/it, attack_loss: -145.86397 variance_cross_attn_loss: 0.04572 self_attn_loss: 1.74197 loss: -144.07626]
Iterations:  63%|██████▎   | 19/30 [00:58<00:33,  3.00s/it, attack_loss: -155.48625 variance_cross_attn_loss: 0.04556 self_attn_loss: 1.76818 loss: -153.67250]
Iterations:  67%|██████▋   | 20/30 [01:00<00:29,  2.93s/it, attack_loss: -155.48625 variance_cross_attn_loss: 0.04556 self_attn_loss: 1.76818 loss: -153.67250]
Iterations:  67%|██████▋   | 20/30 [01:01<00:29,  2.93s/it, attack_loss: -163.51169 variance_cross_attn_loss: 0.04564 self_attn_loss: 1.85629 loss: -161.60976]
Iterations:  70%|███████   | 21/30 [01:03<00:27,  3.01s/it, attack_loss: -163.51169 variance_cross_attn_loss: 0.04564 self_attn_loss: 1.85629 loss: -161.60976]
Iterations:  70%|███████   | 21/30 [01:05<00:27,  3.01s/it, attack_loss: -171.06261 variance_cross_attn_loss: 0.04519 self_attn_loss: 1.97179 loss: -169.04562]
Iterations:  73%|███████▎  | 22/30 [01:06<00:24,  3.08s/it, attack_loss: -171.06261 variance_cross_attn_loss: 0.04519 self_attn_loss: 1.97179 loss: -169.04562]
Iterations:  73%|███████▎  | 22/30 [01:08<00:24,  3.08s/it, attack_loss: -179.96732 variance_cross_attn_loss: 0.04436 self_attn_loss: 1.96157 loss: -177.96140]
Iterations:  77%|███████▋  | 23/30 [01:09<00:21,  3.11s/it, attack_loss: -179.96732 variance_cross_attn_loss: 0.04436 self_attn_loss: 1.96157 loss: -177.96140]
Iterations:  77%|███████▋  | 23/30 [01:11<00:21,  3.11s/it, attack_loss: -186.92401 variance_cross_attn_loss: 0.04368 self_attn_loss: 1.89959 loss: -184.98074]
Iterations:  80%|████████  | 24/30 [01:12<00:18,  3.15s/it, attack_loss: -186.92401 variance_cross_attn_loss: 0.04368 self_attn_loss: 1.89959 loss: -184.98074]
Iterations:  80%|████████  | 24/30 [01:14<00:18,  3.15s/it, attack_loss: -196.28564 variance_cross_attn_loss: 0.04359 self_attn_loss: 1.92492 loss: -194.31714]
Iterations:  83%|████████▎ | 25/30 [01:16<00:16,  3.20s/it, attack_loss: -196.28564 variance_cross_attn_loss: 0.04359 self_attn_loss: 1.92492 loss: -194.31714]
Iterations:  83%|████████▎ | 25/30 [01:17<00:16,  3.20s/it, attack_loss: -203.17046 variance_cross_attn_loss: 0.04361 self_attn_loss: 1.96376 loss: -201.16309]
Iterations:  87%|████████▋ | 26/30 [01:19<00:12,  3.09s/it, attack_loss: -203.17046 variance_cross_attn_loss: 0.04361 self_attn_loss: 1.96376 loss: -201.16309]
Iterations:  87%|████████▋ | 26/30 [01:20<00:12,  3.09s/it, attack_loss: -210.34091 variance_cross_attn_loss: 0.04341 self_attn_loss: 2.00315 loss: -208.29436]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.95s/it, attack_loss: -210.34091 variance_cross_attn_loss: 0.04341 self_attn_loss: 2.00315 loss: -208.29436]
Iterations:  90%|█████████ | 27/30 [01:23<00:08,  2.95s/it, attack_loss: -218.28632 variance_cross_attn_loss: 0.04271 self_attn_loss: 2.02943 loss: -216.21419]
Iterations:  93%|█████████▎| 28/30 [01:24<00:05,  2.90s/it, attack_loss: -218.28632 variance_cross_attn_loss: 0.04271 self_attn_loss: 2.02943 loss: -216.21419]
Iterations:  93%|█████████▎| 28/30 [01:26<00:05,  2.90s/it, attack_loss: -226.17007 variance_cross_attn_loss: 0.04191 self_attn_loss: 2.05311 loss: -224.07504]
Iterations:  97%|█████████▋| 29/30 [01:27<00:02,  2.99s/it, attack_loss: -226.17007 variance_cross_attn_loss: 0.04191 self_attn_loss: 2.05311 loss: -224.07504]
Iterations:  97%|█████████▋| 29/30 [01:29<00:02,  2.99s/it, attack_loss: -232.80414 variance_cross_attn_loss: 0.04153 self_attn_loss: 2.08656 loss: -230.67604]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.12s/it, attack_loss: -232.80414 variance_cross_attn_loss: 0.04153 self_attn_loss: 2.08656 loss: -230.67604]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.04s/it, attack_loss: -232.80414 variance_cross_attn_loss: 0.04153 self_attn_loss: 2.08656 loss: -230.67604]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([666], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([809], device='cuda:0') tensor(4.6283e-11, device='cuda:0')
L1: [3079.]	L2: [10.986886]	Linf: [0.26666665]

Accuracy on benign examples: 100.0%
gt_label: 605 pred_label: 605 pred_clean_logit 0.882628321647644
prompt generate:  iPod  	labels:  [[605]]
decoder:  [49406, 17889, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:03<00:00,  5.37it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:31<00:00,  6.28s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -0.88299 variance_cross_attn_loss: 0.16439 self_attn_loss: 0.00000 loss: -0.71860]
Iterations:   3%|▎         | 1/30 [00:03<01:30,  3.13s/it, attack_loss: -0.88299 variance_cross_attn_loss: 0.16439 self_attn_loss: 0.00000 loss: -0.71860]
Iterations:   3%|▎         | 1/30 [00:04<01:30,  3.13s/it, attack_loss: -6.42925 variance_cross_attn_loss: 0.16221 self_attn_loss: 0.36662 loss: -5.90042]
Iterations:   7%|▋         | 2/30 [00:06<01:31,  3.27s/it, attack_loss: -6.42925 variance_cross_attn_loss: 0.16221 self_attn_loss: 0.36662 loss: -5.90042]
Iterations:   7%|▋         | 2/30 [00:08<01:31,  3.27s/it, attack_loss: -18.55716 variance_cross_attn_loss: 0.14708 self_attn_loss: 1.19567 loss: -17.21441]
Iterations:  10%|█         | 3/30 [00:09<01:30,  3.34s/it, attack_loss: -18.55716 variance_cross_attn_loss: 0.14708 self_attn_loss: 1.19567 loss: -17.21441]
Iterations:  10%|█         | 3/30 [00:11<01:30,  3.34s/it, attack_loss: -33.38728 variance_cross_attn_loss: 0.12585 self_attn_loss: 1.78844 loss: -31.47298]
Iterations:  13%|█▎        | 4/30 [00:13<01:25,  3.29s/it, attack_loss: -33.38728 variance_cross_attn_loss: 0.12585 self_attn_loss: 1.78844 loss: -31.47298]
Iterations:  13%|█▎        | 4/30 [00:14<01:25,  3.29s/it, attack_loss: -48.69171 variance_cross_attn_loss: 0.12020 self_attn_loss: 2.08527 loss: -46.48624]
Iterations:  17%|█▋        | 5/30 [00:15<01:17,  3.09s/it, attack_loss: -48.69171 variance_cross_attn_loss: 0.12020 self_attn_loss: 2.08527 loss: -46.48624]
Iterations:  17%|█▋        | 5/30 [00:17<01:17,  3.09s/it, attack_loss: -65.15808 variance_cross_attn_loss: 0.11765 self_attn_loss: 2.15354 loss: -62.88689]
Iterations:  20%|██        | 6/30 [00:18<01:10,  2.96s/it, attack_loss: -65.15808 variance_cross_attn_loss: 0.11765 self_attn_loss: 2.15354 loss: -62.88689]
Iterations:  20%|██        | 6/30 [00:20<01:10,  2.96s/it, attack_loss: -80.68366 variance_cross_attn_loss: 0.11289 self_attn_loss: 2.23938 loss: -78.33139]
Iterations:  23%|██▎       | 7/30 [00:21<01:05,  2.87s/it, attack_loss: -80.68366 variance_cross_attn_loss: 0.11289 self_attn_loss: 2.23938 loss: -78.33139]
Iterations:  23%|██▎       | 7/30 [00:23<01:05,  2.87s/it, attack_loss: -96.40789 variance_cross_attn_loss: 0.10846 self_attn_loss: 2.34189 loss: -93.95753]
Iterations:  27%|██▋       | 8/30 [00:24<01:07,  3.07s/it, attack_loss: -96.40789 variance_cross_attn_loss: 0.10846 self_attn_loss: 2.34189 loss: -93.95753]
Iterations:  27%|██▋       | 8/30 [00:26<01:07,  3.07s/it, attack_loss: -108.31683 variance_cross_attn_loss: 0.10457 self_attn_loss: 2.34312 loss: -105.86913]
Iterations:  30%|███       | 9/30 [00:27<01:05,  3.10s/it, attack_loss: -108.31683 variance_cross_attn_loss: 0.10457 self_attn_loss: 2.34312 loss: -105.86913]
Iterations:  30%|███       | 9/30 [00:29<01:05,  3.10s/it, attack_loss: -122.95352 variance_cross_attn_loss: 0.10182 self_attn_loss: 2.38451 loss: -120.46719]
Iterations:  33%|███▎      | 10/30 [00:31<01:03,  3.16s/it, attack_loss: -122.95352 variance_cross_attn_loss: 0.10182 self_attn_loss: 2.38451 loss: -120.46719]
Iterations:  33%|███▎      | 10/30 [00:32<01:03,  3.16s/it, attack_loss: -131.86372 variance_cross_attn_loss: 0.09941 self_attn_loss: 2.36497 loss: -129.39934]
Iterations:  37%|███▋      | 11/30 [00:34<01:00,  3.19s/it, attack_loss: -131.86372 variance_cross_attn_loss: 0.09941 self_attn_loss: 2.36497 loss: -129.39934]
Iterations:  37%|███▋      | 11/30 [00:36<01:00,  3.19s/it, attack_loss: -143.67099 variance_cross_attn_loss: 0.09762 self_attn_loss: 2.41763 loss: -141.15573]
Iterations:  40%|████      | 12/30 [00:37<00:57,  3.19s/it, attack_loss: -143.67099 variance_cross_attn_loss: 0.09762 self_attn_loss: 2.41763 loss: -141.15573]
Iterations:  40%|████      | 12/30 [00:39<00:57,  3.19s/it, attack_loss: -156.96738 variance_cross_attn_loss: 0.09528 self_attn_loss: 2.50871 loss: -154.36339]
Iterations:  43%|████▎     | 13/30 [00:40<00:51,  3.05s/it, attack_loss: -156.96738 variance_cross_attn_loss: 0.09528 self_attn_loss: 2.50871 loss: -154.36339]
Iterations:  43%|████▎     | 13/30 [00:41<00:51,  3.05s/it, attack_loss: -165.91275 variance_cross_attn_loss: 0.09267 self_attn_loss: 2.52946 loss: -163.29062]
Iterations:  47%|████▋     | 14/30 [00:43<00:46,  2.92s/it, attack_loss: -165.91275 variance_cross_attn_loss: 0.09267 self_attn_loss: 2.52946 loss: -163.29062]
Iterations:  47%|████▋     | 14/30 [00:44<00:46,  2.92s/it, attack_loss: -174.97034 variance_cross_attn_loss: 0.09062 self_attn_loss: 2.60322 loss: -172.27649]
Iterations:  50%|█████     | 15/30 [00:45<00:43,  2.87s/it, attack_loss: -174.97034 variance_cross_attn_loss: 0.09062 self_attn_loss: 2.60322 loss: -172.27649]
Iterations:  50%|█████     | 15/30 [00:47<00:43,  2.87s/it, attack_loss: -190.11476 variance_cross_attn_loss: 0.09043 self_attn_loss: 2.57946 loss: -187.44487]
Iterations:  53%|█████▎    | 16/30 [00:49<00:42,  3.01s/it, attack_loss: -190.11476 variance_cross_attn_loss: 0.09043 self_attn_loss: 2.57946 loss: -187.44487]
Iterations:  53%|█████▎    | 16/30 [00:50<00:42,  3.01s/it, attack_loss: -197.25427 variance_cross_attn_loss: 0.09010 self_attn_loss: 2.57953 loss: -194.58464]
Iterations:  57%|█████▋    | 17/30 [00:52<00:40,  3.11s/it, attack_loss: -197.25427 variance_cross_attn_loss: 0.09010 self_attn_loss: 2.57953 loss: -194.58464]
Iterations:  57%|█████▋    | 17/30 [00:54<00:40,  3.11s/it, attack_loss: -211.91534 variance_cross_attn_loss: 0.08914 self_attn_loss: 2.62800 loss: -209.19820]
Iterations:  60%|██████    | 18/30 [00:55<00:37,  3.13s/it, attack_loss: -211.91534 variance_cross_attn_loss: 0.08914 self_attn_loss: 2.62800 loss: -209.19820]
Iterations:  60%|██████    | 18/30 [00:57<00:37,  3.13s/it, attack_loss: -222.99899 variance_cross_attn_loss: 0.08911 self_attn_loss: 2.65132 loss: -220.25856]
Iterations:  63%|██████▎   | 19/30 [00:59<00:35,  3.21s/it, attack_loss: -222.99899 variance_cross_attn_loss: 0.08911 self_attn_loss: 2.65132 loss: -220.25856]
Iterations:  63%|██████▎   | 19/30 [01:00<00:35,  3.21s/it, attack_loss: -232.93410 variance_cross_attn_loss: 0.08888 self_attn_loss: 2.66794 loss: -230.17728]
Iterations:  67%|██████▋   | 20/30 [01:02<00:32,  3.27s/it, attack_loss: -232.93410 variance_cross_attn_loss: 0.08888 self_attn_loss: 2.66794 loss: -230.17728]
Iterations:  67%|██████▋   | 20/30 [01:03<00:32,  3.27s/it, attack_loss: -248.87842 variance_cross_attn_loss: 0.08802 self_attn_loss: 2.70358 loss: -246.08682]
Iterations:  70%|███████   | 21/30 [01:05<00:27,  3.09s/it, attack_loss: -248.87842 variance_cross_attn_loss: 0.08802 self_attn_loss: 2.70358 loss: -246.08682]
Iterations:  70%|███████   | 21/30 [01:06<00:27,  3.09s/it, attack_loss: -253.63374 variance_cross_attn_loss: 0.08712 self_attn_loss: 2.75742 loss: -250.78918]
Iterations:  73%|███████▎  | 22/30 [01:07<00:23,  2.99s/it, attack_loss: -253.63374 variance_cross_attn_loss: 0.08712 self_attn_loss: 2.75742 loss: -250.78918]
Iterations:  73%|███████▎  | 22/30 [01:09<00:23,  2.99s/it, attack_loss: -269.50827 variance_cross_attn_loss: 0.08644 self_attn_loss: 2.78915 loss: -266.63269]
Iterations:  77%|███████▋  | 23/30 [01:10<00:20,  2.92s/it, attack_loss: -269.50827 variance_cross_attn_loss: 0.08644 self_attn_loss: 2.78915 loss: -266.63269]
Iterations:  77%|███████▋  | 23/30 [01:12<00:20,  2.92s/it, attack_loss: -278.82587 variance_cross_attn_loss: 0.08608 self_attn_loss: 2.77390 loss: -275.96588]
Iterations:  80%|████████  | 24/30 [01:13<00:18,  3.04s/it, attack_loss: -278.82587 variance_cross_attn_loss: 0.08608 self_attn_loss: 2.77390 loss: -275.96588]
Iterations:  80%|████████  | 24/30 [01:15<00:18,  3.04s/it, attack_loss: -289.50571 variance_cross_attn_loss: 0.08554 self_attn_loss: 2.77563 loss: -286.64453]
Iterations:  83%|████████▎ | 25/30 [01:17<00:15,  3.17s/it, attack_loss: -289.50571 variance_cross_attn_loss: 0.08554 self_attn_loss: 2.77563 loss: -286.64453]
Iterations:  83%|████████▎ | 25/30 [01:19<00:15,  3.17s/it, attack_loss: -303.48767 variance_cross_attn_loss: 0.08492 self_attn_loss: 2.79622 loss: -300.60651]
Iterations:  87%|████████▋ | 26/30 [01:20<00:12,  3.18s/it, attack_loss: -303.48767 variance_cross_attn_loss: 0.08492 self_attn_loss: 2.79622 loss: -300.60651]
Iterations:  87%|████████▋ | 26/30 [01:22<00:12,  3.18s/it, attack_loss: -316.28613 variance_cross_attn_loss: 0.08402 self_attn_loss: 2.79943 loss: -313.40268]
Iterations:  90%|█████████ | 27/30 [01:23<00:09,  3.20s/it, attack_loss: -316.28613 variance_cross_attn_loss: 0.08402 self_attn_loss: 2.79943 loss: -313.40268]
Iterations:  90%|█████████ | 27/30 [01:25<00:09,  3.20s/it, attack_loss: -330.77856 variance_cross_attn_loss: 0.08375 self_attn_loss: 2.76642 loss: -327.92841]
Iterations:  93%|█████████▎| 28/30 [01:27<00:06,  3.19s/it, attack_loss: -330.77856 variance_cross_attn_loss: 0.08375 self_attn_loss: 2.76642 loss: -327.92841]
Iterations:  93%|█████████▎| 28/30 [01:28<00:06,  3.19s/it, attack_loss: -343.31805 variance_cross_attn_loss: 0.08327 self_attn_loss: 2.75083 loss: -340.48395]
Iterations:  97%|█████████▋| 29/30 [01:29<00:03,  3.03s/it, attack_loss: -343.31805 variance_cross_attn_loss: 0.08327 self_attn_loss: 2.75083 loss: -340.48395]
Iterations:  97%|█████████▋| 29/30 [01:31<00:03,  3.03s/it, attack_loss: -355.89297 variance_cross_attn_loss: 0.08285 self_attn_loss: 2.77140 loss: -353.03873]
Iterations: 100%|██████████| 30/30 [01:32<00:00,  3.01s/it, attack_loss: -355.89297 variance_cross_attn_loss: 0.08285 self_attn_loss: 2.77140 loss: -353.03873]
Iterations: 100%|██████████| 30/30 [01:32<00:00,  3.09s/it, attack_loss: -355.89297 variance_cross_attn_loss: 0.08285 self_attn_loss: 2.77140 loss: -353.03873]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([419], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([605], device='cuda:0') tensor(1.2839e-16, device='cuda:0')
L1: [3670.5962]	L2: [16.44668]	Linf: [0.79607844]

Accuracy on benign examples: 100.0%
gt_label: 94 pred_label: 94 pred_clean_logit 0.9314026236534119
prompt generate:  hummingbird  	labels:  [[94]]
decoder:  [49406, 33072, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.11it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:31<00:00,  6.35s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -0.30066 variance_cross_attn_loss: 1.92502 self_attn_loss: 0.00000 loss: 1.62436]
Iterations:   3%|▎         | 1/30 [00:02<01:12,  2.50s/it, attack_loss: -0.30066 variance_cross_attn_loss: 1.92502 self_attn_loss: 0.00000 loss: 1.62436]
Iterations:   3%|▎         | 1/30 [00:03<01:12,  2.50s/it, attack_loss: -2.07799 variance_cross_attn_loss: 1.88192 self_attn_loss: 1.06125 loss: 0.86518]
Iterations:   7%|▋         | 2/30 [00:05<01:13,  2.61s/it, attack_loss: -2.07799 variance_cross_attn_loss: 1.88192 self_attn_loss: 1.06125 loss: 0.86518]
Iterations:   7%|▋         | 2/30 [00:06<01:13,  2.61s/it, attack_loss: -5.18843 variance_cross_attn_loss: 1.89452 self_attn_loss: 1.12499 loss: -2.16892]
Iterations:  10%|█         | 3/30 [00:08<01:17,  2.87s/it, attack_loss: -5.18843 variance_cross_attn_loss: 1.89452 self_attn_loss: 1.12499 loss: -2.16892]
Iterations:  10%|█         | 3/30 [00:10<01:17,  2.87s/it, attack_loss: -10.30559 variance_cross_attn_loss: 1.89472 self_attn_loss: 1.29169 loss: -7.11918]
Iterations:  13%|█▎        | 4/30 [00:11<01:19,  3.07s/it, attack_loss: -10.30559 variance_cross_attn_loss: 1.89472 self_attn_loss: 1.29169 loss: -7.11918]
Iterations:  13%|█▎        | 4/30 [00:13<01:19,  3.07s/it, attack_loss: -19.04698 variance_cross_attn_loss: 1.88522 self_attn_loss: 1.31832 loss: -15.84344]
Iterations:  17%|█▋        | 5/30 [00:14<01:18,  3.13s/it, attack_loss: -19.04698 variance_cross_attn_loss: 1.88522 self_attn_loss: 1.31832 loss: -15.84344]
Iterations:  17%|█▋        | 5/30 [00:16<01:18,  3.13s/it, attack_loss: -25.59447 variance_cross_attn_loss: 1.86111 self_attn_loss: 1.35682 loss: -22.37653]
Iterations:  20%|██        | 6/30 [00:18<01:16,  3.20s/it, attack_loss: -25.59447 variance_cross_attn_loss: 1.86111 self_attn_loss: 1.35682 loss: -22.37653]
Iterations:  20%|██        | 6/30 [00:20<01:16,  3.20s/it, attack_loss: -36.21732 variance_cross_attn_loss: 1.86088 self_attn_loss: 1.40387 loss: -32.95256]
Iterations:  23%|██▎       | 7/30 [00:21<01:16,  3.31s/it, attack_loss: -36.21732 variance_cross_attn_loss: 1.86088 self_attn_loss: 1.40387 loss: -32.95256]
Iterations:  23%|██▎       | 7/30 [00:23<01:16,  3.31s/it, attack_loss: -47.94162 variance_cross_attn_loss: 1.86961 self_attn_loss: 1.46725 loss: -44.60476]
Iterations:  27%|██▋       | 8/30 [00:24<01:09,  3.18s/it, attack_loss: -47.94162 variance_cross_attn_loss: 1.86961 self_attn_loss: 1.46725 loss: -44.60476]
Iterations:  27%|██▋       | 8/30 [00:26<01:09,  3.18s/it, attack_loss: -58.57790 variance_cross_attn_loss: 1.84359 self_attn_loss: 1.50936 loss: -55.22496]
Iterations:  30%|███       | 9/30 [00:27<01:04,  3.05s/it, attack_loss: -58.57790 variance_cross_attn_loss: 1.84359 self_attn_loss: 1.50936 loss: -55.22496]
Iterations:  30%|███       | 9/30 [00:28<01:04,  3.05s/it, attack_loss: -72.51414 variance_cross_attn_loss: 1.82961 self_attn_loss: 1.49122 loss: -69.19331]
Iterations:  33%|███▎      | 10/30 [00:30<00:58,  2.94s/it, attack_loss: -72.51414 variance_cross_attn_loss: 1.82961 self_attn_loss: 1.49122 loss: -69.19331]
Iterations:  33%|███▎      | 10/30 [00:31<00:58,  2.94s/it, attack_loss: -83.82751 variance_cross_attn_loss: 1.81653 self_attn_loss: 1.50424 loss: -80.50674]
Iterations:  37%|███▋      | 11/30 [00:33<00:55,  2.92s/it, attack_loss: -83.82751 variance_cross_attn_loss: 1.81653 self_attn_loss: 1.50424 loss: -80.50674]
Iterations:  37%|███▋      | 11/30 [00:34<00:55,  2.92s/it, attack_loss: -96.39801 variance_cross_attn_loss: 1.81405 self_attn_loss: 1.57906 loss: -93.00490]
Iterations:  40%|████      | 12/30 [00:36<00:52,  2.94s/it, attack_loss: -96.39801 variance_cross_attn_loss: 1.81405 self_attn_loss: 1.57906 loss: -93.00490]
Iterations:  40%|████      | 12/30 [00:37<00:52,  2.94s/it, attack_loss: -105.67152 variance_cross_attn_loss: 1.79899 self_attn_loss: 1.68120 loss: -102.19134]
Iterations:  43%|████▎     | 13/30 [00:39<00:51,  3.05s/it, attack_loss: -105.67152 variance_cross_attn_loss: 1.79899 self_attn_loss: 1.68120 loss: -102.19134]
Iterations:  43%|████▎     | 13/30 [00:41<00:51,  3.05s/it, attack_loss: -115.83945 variance_cross_attn_loss: 1.78701 self_attn_loss: 1.74604 loss: -112.30640]
Iterations:  47%|████▋     | 14/30 [00:42<00:50,  3.13s/it, attack_loss: -115.83945 variance_cross_attn_loss: 1.78701 self_attn_loss: 1.74604 loss: -112.30640]
Iterations:  47%|████▋     | 14/30 [00:44<00:50,  3.13s/it, attack_loss: -124.33219 variance_cross_attn_loss: 1.78376 self_attn_loss: 1.77559 loss: -120.77283]
Iterations:  50%|█████     | 15/30 [00:45<00:47,  3.17s/it, attack_loss: -124.33219 variance_cross_attn_loss: 1.78376 self_attn_loss: 1.77559 loss: -120.77283]
Iterations:  50%|█████     | 15/30 [00:47<00:47,  3.17s/it, attack_loss: -132.57628 variance_cross_attn_loss: 1.78349 self_attn_loss: 1.80141 loss: -128.99138]
Iterations:  53%|█████▎    | 16/30 [00:48<00:43,  3.09s/it, attack_loss: -132.57628 variance_cross_attn_loss: 1.78349 self_attn_loss: 1.80141 loss: -128.99138]
Iterations:  53%|█████▎    | 16/30 [00:50<00:43,  3.09s/it, attack_loss: -139.42682 variance_cross_attn_loss: 1.77999 self_attn_loss: 1.81123 loss: -135.83560]
Iterations:  57%|█████▋    | 17/30 [00:51<00:38,  2.92s/it, attack_loss: -139.42682 variance_cross_attn_loss: 1.77999 self_attn_loss: 1.81123 loss: -135.83560]
Iterations:  57%|█████▋    | 17/30 [00:52<00:38,  2.92s/it, attack_loss: -147.48163 variance_cross_attn_loss: 1.77156 self_attn_loss: 1.83606 loss: -143.87401]
Iterations:  60%|██████    | 18/30 [00:54<00:34,  2.84s/it, attack_loss: -147.48163 variance_cross_attn_loss: 1.77156 self_attn_loss: 1.83606 loss: -143.87401]
Iterations:  60%|██████    | 18/30 [00:55<00:34,  2.84s/it, attack_loss: -156.87697 variance_cross_attn_loss: 1.76438 self_attn_loss: 1.88016 loss: -153.23242]
Iterations:  63%|██████▎   | 19/30 [00:57<00:31,  2.89s/it, attack_loss: -156.87697 variance_cross_attn_loss: 1.76438 self_attn_loss: 1.88016 loss: -153.23242]
Iterations:  63%|██████▎   | 19/30 [00:58<00:31,  2.89s/it, attack_loss: -165.94791 variance_cross_attn_loss: 1.76186 self_attn_loss: 1.89771 loss: -162.28835]
Iterations:  67%|██████▋   | 20/30 [01:00<00:30,  3.05s/it, attack_loss: -165.94791 variance_cross_attn_loss: 1.76186 self_attn_loss: 1.89771 loss: -162.28835]
Iterations:  67%|██████▋   | 20/30 [01:02<00:30,  3.05s/it, attack_loss: -174.02640 variance_cross_attn_loss: 1.76453 self_attn_loss: 1.89317 loss: -170.36870]
Iterations:  70%|███████   | 21/30 [01:03<00:27,  3.08s/it, attack_loss: -174.02640 variance_cross_attn_loss: 1.76453 self_attn_loss: 1.89317 loss: -170.36870]
Iterations:  70%|███████   | 21/30 [01:05<00:27,  3.08s/it, attack_loss: -180.54028 variance_cross_attn_loss: 1.77004 self_attn_loss: 1.89592 loss: -176.87433]
Iterations:  73%|███████▎  | 22/30 [01:06<00:24,  3.04s/it, attack_loss: -180.54028 variance_cross_attn_loss: 1.77004 self_attn_loss: 1.89592 loss: -176.87433]
Iterations:  73%|███████▎  | 22/30 [01:08<00:24,  3.04s/it, attack_loss: -187.55002 variance_cross_attn_loss: 1.76874 self_attn_loss: 1.91420 loss: -183.86708]
Iterations:  77%|███████▋  | 23/30 [01:09<00:20,  2.89s/it, attack_loss: -187.55002 variance_cross_attn_loss: 1.76874 self_attn_loss: 1.91420 loss: -183.86708]
Iterations:  77%|███████▋  | 23/30 [01:10<00:20,  2.89s/it, attack_loss: -193.80998 variance_cross_attn_loss: 1.76399 self_attn_loss: 1.93273 loss: -190.11327]
Iterations:  80%|████████  | 24/30 [01:11<00:17,  2.86s/it, attack_loss: -193.80998 variance_cross_attn_loss: 1.76399 self_attn_loss: 1.93273 loss: -190.11327]
Iterations:  80%|████████  | 24/30 [01:13<00:17,  2.86s/it, attack_loss: -200.68225 variance_cross_attn_loss: 1.75812 self_attn_loss: 1.93571 loss: -196.98842]
Iterations:  83%|████████▎ | 25/30 [01:14<00:14,  2.80s/it, attack_loss: -200.68225 variance_cross_attn_loss: 1.75812 self_attn_loss: 1.93571 loss: -196.98842]
Iterations:  83%|████████▎ | 25/30 [01:16<00:14,  2.80s/it, attack_loss: -206.85866 variance_cross_attn_loss: 1.74669 self_attn_loss: 1.94852 loss: -203.16345]
Iterations:  87%|████████▋ | 26/30 [01:17<00:10,  2.73s/it, attack_loss: -206.85866 variance_cross_attn_loss: 1.74669 self_attn_loss: 1.94852 loss: -203.16345]
Iterations:  87%|████████▋ | 26/30 [01:18<00:10,  2.73s/it, attack_loss: -212.46834 variance_cross_attn_loss: 1.74861 self_attn_loss: 1.97915 loss: -208.74057]
Iterations:  90%|█████████ | 27/30 [01:20<00:08,  2.91s/it, attack_loss: -212.46834 variance_cross_attn_loss: 1.74861 self_attn_loss: 1.97915 loss: -208.74057]
Iterations:  90%|█████████ | 27/30 [01:22<00:08,  2.91s/it, attack_loss: -218.74748 variance_cross_attn_loss: 1.74515 self_attn_loss: 1.97227 loss: -215.03008]
Iterations:  93%|█████████▎| 28/30 [01:23<00:05,  2.99s/it, attack_loss: -218.74748 variance_cross_attn_loss: 1.74515 self_attn_loss: 1.97227 loss: -215.03008]
Iterations:  93%|█████████▎| 28/30 [01:25<00:05,  2.99s/it, attack_loss: -224.69206 variance_cross_attn_loss: 1.74686 self_attn_loss: 1.98851 loss: -220.95670]
Iterations:  97%|█████████▋| 29/30 [01:26<00:03,  3.06s/it, attack_loss: -224.69206 variance_cross_attn_loss: 1.74686 self_attn_loss: 1.98851 loss: -220.95670]
Iterations:  97%|█████████▋| 29/30 [01:28<00:03,  3.06s/it, attack_loss: -229.84900 variance_cross_attn_loss: 1.74967 self_attn_loss: 2.01224 loss: -226.08710]
Iterations: 100%|██████████| 30/30 [01:30<00:00,  3.15s/it, attack_loss: -229.84900 variance_cross_attn_loss: 1.74967 self_attn_loss: 2.01224 loss: -226.08710]
Iterations: 100%|██████████| 30/30 [01:30<00:00,  3.01s/it, attack_loss: -229.84900 variance_cross_attn_loss: 1.74967 self_attn_loss: 2.01224 loss: -226.08710]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([14], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([94], device='cuda:0') tensor(8.6555e-11, device='cuda:0')
L1: [4357.2324]	L2: [17.041325]	Linf: [0.6627451]

Accuracy on benign examples: 100.0%
gt_label: 777 pred_label: 777 pred_clean_logit 0.8415653109550476
prompt generate:  scabbard  	labels:  [[777]]
decoder:  [49406, 31716, 17514, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:03<00:00,  4.95it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:32<00:00,  6.52s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -2.47691 variance_cross_attn_loss: 0.04344 self_attn_loss: 0.00000 loss: -2.43348]
Iterations:   3%|▎         | 1/30 [00:03<01:30,  3.11s/it, attack_loss: -2.47691 variance_cross_attn_loss: 0.04344 self_attn_loss: 0.00000 loss: -2.43348]
Iterations:   3%|▎         | 1/30 [00:04<01:30,  3.11s/it, attack_loss: -11.59061 variance_cross_attn_loss: 0.04451 self_attn_loss: 0.22399 loss: -11.32210]
Iterations:   7%|▋         | 2/30 [00:06<01:31,  3.27s/it, attack_loss: -11.59061 variance_cross_attn_loss: 0.04451 self_attn_loss: 0.22399 loss: -11.32210]
Iterations:   7%|▋         | 2/30 [00:08<01:31,  3.27s/it, attack_loss: -26.10371 variance_cross_attn_loss: 0.04509 self_attn_loss: 0.30844 loss: -25.75018]
Iterations:  10%|█         | 3/30 [00:09<01:29,  3.33s/it, attack_loss: -26.10371 variance_cross_attn_loss: 0.04509 self_attn_loss: 0.30844 loss: -25.75018]
Iterations:  10%|█         | 3/30 [00:11<01:29,  3.33s/it, attack_loss: -41.50280 variance_cross_attn_loss: 0.04482 self_attn_loss: 0.30163 loss: -41.15635]
Iterations:  13%|█▎        | 4/30 [00:12<01:23,  3.20s/it, attack_loss: -41.50280 variance_cross_attn_loss: 0.04482 self_attn_loss: 0.30163 loss: -41.15635]
Iterations:  13%|█▎        | 4/30 [00:14<01:23,  3.20s/it, attack_loss: -57.24791 variance_cross_attn_loss: 0.04359 self_attn_loss: 0.44520 loss: -56.75912]
Iterations:  17%|█▋        | 5/30 [00:15<01:18,  3.13s/it, attack_loss: -57.24791 variance_cross_attn_loss: 0.04359 self_attn_loss: 0.44520 loss: -56.75912]
Iterations:  17%|█▋        | 5/30 [00:17<01:18,  3.13s/it, attack_loss: -74.01887 variance_cross_attn_loss: 0.04287 self_attn_loss: 0.40646 loss: -73.56954]
Iterations:  20%|██        | 6/30 [00:18<01:12,  3.00s/it, attack_loss: -74.01887 variance_cross_attn_loss: 0.04287 self_attn_loss: 0.40646 loss: -73.56954]
Iterations:  20%|██        | 6/30 [00:20<01:12,  3.00s/it, attack_loss: -91.31165 variance_cross_attn_loss: 0.04229 self_attn_loss: 0.52124 loss: -90.74812]
Iterations:  23%|██▎       | 7/30 [00:21<01:10,  3.07s/it, attack_loss: -91.31165 variance_cross_attn_loss: 0.04229 self_attn_loss: 0.52124 loss: -90.74812]
Iterations:  23%|██▎       | 7/30 [00:23<01:10,  3.07s/it, attack_loss: -107.00658 variance_cross_attn_loss: 0.04181 self_attn_loss: 0.62881 loss: -106.33595]
Iterations:  27%|██▋       | 8/30 [00:25<01:09,  3.14s/it, attack_loss: -107.00658 variance_cross_attn_loss: 0.04181 self_attn_loss: 0.62881 loss: -106.33595]
Iterations:  27%|██▋       | 8/30 [00:26<01:09,  3.14s/it, attack_loss: -119.94190 variance_cross_attn_loss: 0.04133 self_attn_loss: 0.69372 loss: -119.20685]
Iterations:  30%|███       | 9/30 [00:28<01:06,  3.16s/it, attack_loss: -119.94190 variance_cross_attn_loss: 0.04133 self_attn_loss: 0.69372 loss: -119.20685]
Iterations:  30%|███       | 9/30 [00:30<01:06,  3.16s/it, attack_loss: -131.96008 variance_cross_attn_loss: 0.04078 self_attn_loss: 0.71288 loss: -131.20641]
Iterations:  33%|███▎      | 10/30 [00:31<01:04,  3.22s/it, attack_loss: -131.96008 variance_cross_attn_loss: 0.04078 self_attn_loss: 0.71288 loss: -131.20641]
Iterations:  33%|███▎      | 10/30 [00:33<01:04,  3.22s/it, attack_loss: -142.54195 variance_cross_attn_loss: 0.04044 self_attn_loss: 0.72108 loss: -141.78043]
Iterations:  37%|███▋      | 11/30 [00:34<01:01,  3.21s/it, attack_loss: -142.54195 variance_cross_attn_loss: 0.04044 self_attn_loss: 0.72108 loss: -141.78043]
Iterations:  37%|███▋      | 11/30 [00:36<01:01,  3.21s/it, attack_loss: -156.68312 variance_cross_attn_loss: 0.04030 self_attn_loss: 0.75012 loss: -155.89270]
Iterations:  40%|████      | 12/30 [00:38<00:57,  3.20s/it, attack_loss: -156.68312 variance_cross_attn_loss: 0.04030 self_attn_loss: 0.75012 loss: -155.89270]
Iterations:  40%|████      | 12/30 [00:39<00:57,  3.20s/it, attack_loss: -169.62189 variance_cross_attn_loss: 0.04016 self_attn_loss: 0.78424 loss: -168.79749]
Iterations:  43%|████▎     | 13/30 [00:40<00:51,  3.02s/it, attack_loss: -169.62189 variance_cross_attn_loss: 0.04016 self_attn_loss: 0.78424 loss: -168.79749]
Iterations:  43%|████▎     | 13/30 [00:42<00:51,  3.02s/it, attack_loss: -180.31161 variance_cross_attn_loss: 0.04012 self_attn_loss: 0.83301 loss: -179.43849]
Iterations:  47%|████▋     | 14/30 [00:43<00:46,  2.89s/it, attack_loss: -180.31161 variance_cross_attn_loss: 0.04012 self_attn_loss: 0.83301 loss: -179.43849]
Iterations:  47%|████▋     | 14/30 [00:44<00:46,  2.89s/it, attack_loss: -191.64456 variance_cross_attn_loss: 0.03976 self_attn_loss: 0.85496 loss: -190.74985]
Iterations:  50%|█████     | 15/30 [00:46<00:44,  2.94s/it, attack_loss: -191.64456 variance_cross_attn_loss: 0.03976 self_attn_loss: 0.85496 loss: -190.74985]
Iterations:  50%|█████     | 15/30 [00:48<00:44,  2.94s/it, attack_loss: -203.97830 variance_cross_attn_loss: 0.03903 self_attn_loss: 0.88235 loss: -203.05693]
Iterations:  53%|█████▎    | 16/30 [00:49<00:42,  3.01s/it, attack_loss: -203.97830 variance_cross_attn_loss: 0.03903 self_attn_loss: 0.88235 loss: -203.05693]
Iterations:  53%|█████▎    | 16/30 [00:51<00:42,  3.01s/it, attack_loss: -212.30629 variance_cross_attn_loss: 0.03819 self_attn_loss: 0.93469 loss: -211.33340]
Iterations:  57%|█████▋    | 17/30 [00:52<00:40,  3.09s/it, attack_loss: -212.30629 variance_cross_attn_loss: 0.03819 self_attn_loss: 0.93469 loss: -211.33340]
Iterations:  57%|█████▋    | 17/30 [00:54<00:40,  3.09s/it, attack_loss: -220.71930 variance_cross_attn_loss: 0.03776 self_attn_loss: 0.94505 loss: -219.73648]
Iterations:  60%|██████    | 18/30 [00:55<00:37,  3.11s/it, attack_loss: -220.71930 variance_cross_attn_loss: 0.03776 self_attn_loss: 0.94505 loss: -219.73648]
Iterations:  60%|██████    | 18/30 [00:57<00:37,  3.11s/it, attack_loss: -228.22562 variance_cross_attn_loss: 0.03735 self_attn_loss: 0.94862 loss: -227.23964]
Iterations:  63%|██████▎   | 19/30 [00:59<00:34,  3.16s/it, attack_loss: -228.22562 variance_cross_attn_loss: 0.03735 self_attn_loss: 0.94862 loss: -227.23964]
Iterations:  63%|██████▎   | 19/30 [01:00<00:34,  3.16s/it, attack_loss: -238.68716 variance_cross_attn_loss: 0.03708 self_attn_loss: 1.00149 loss: -237.64859]
Iterations:  67%|██████▋   | 20/30 [01:01<00:30,  3.05s/it, attack_loss: -238.68716 variance_cross_attn_loss: 0.03708 self_attn_loss: 1.00149 loss: -237.64859]
Iterations:  67%|██████▋   | 20/30 [01:03<00:30,  3.05s/it, attack_loss: -246.59254 variance_cross_attn_loss: 0.03691 self_attn_loss: 1.04216 loss: -245.51347]
Iterations:  70%|███████   | 21/30 [01:04<00:26,  2.92s/it, attack_loss: -246.59254 variance_cross_attn_loss: 0.03691 self_attn_loss: 1.04216 loss: -245.51347]
Iterations:  70%|███████   | 21/30 [01:06<00:26,  2.92s/it, attack_loss: -254.77661 variance_cross_attn_loss: 0.03660 self_attn_loss: 1.07511 loss: -253.66490]
Iterations:  73%|███████▎  | 22/30 [01:07<00:22,  2.84s/it, attack_loss: -254.77661 variance_cross_attn_loss: 0.03660 self_attn_loss: 1.07511 loss: -253.66490]
Iterations:  73%|███████▎  | 22/30 [01:09<00:22,  2.84s/it, attack_loss: -263.22635 variance_cross_attn_loss: 0.03619 self_attn_loss: 1.07910 loss: -262.11105]
Iterations:  77%|███████▋  | 23/30 [01:10<00:20,  2.98s/it, attack_loss: -263.22635 variance_cross_attn_loss: 0.03619 self_attn_loss: 1.07910 loss: -262.11105]
Iterations:  77%|███████▋  | 23/30 [01:12<00:20,  2.98s/it, attack_loss: -271.68341 variance_cross_attn_loss: 0.03599 self_attn_loss: 1.10015 loss: -270.54727]
Iterations:  80%|████████  | 24/30 [01:13<00:18,  3.06s/it, attack_loss: -271.68341 variance_cross_attn_loss: 0.03599 self_attn_loss: 1.10015 loss: -270.54727]
Iterations:  80%|████████  | 24/30 [01:15<00:18,  3.06s/it, attack_loss: -277.10562 variance_cross_attn_loss: 0.03583 self_attn_loss: 1.12022 loss: -275.94958]
Iterations:  83%|████████▎ | 25/30 [01:17<00:15,  3.14s/it, attack_loss: -277.10562 variance_cross_attn_loss: 0.03583 self_attn_loss: 1.12022 loss: -275.94958]
Iterations:  83%|████████▎ | 25/30 [01:18<00:15,  3.14s/it, attack_loss: -287.57309 variance_cross_attn_loss: 0.03587 self_attn_loss: 1.14729 loss: -286.38992]
Iterations:  87%|████████▋ | 26/30 [01:20<00:12,  3.16s/it, attack_loss: -287.57309 variance_cross_attn_loss: 0.03587 self_attn_loss: 1.14729 loss: -286.38992]
Iterations:  87%|████████▋ | 26/30 [01:22<00:12,  3.16s/it, attack_loss: -296.07202 variance_cross_attn_loss: 0.03599 self_attn_loss: 1.16585 loss: -294.87018]
Iterations:  90%|█████████ | 27/30 [01:23<00:09,  3.17s/it, attack_loss: -296.07202 variance_cross_attn_loss: 0.03599 self_attn_loss: 1.16585 loss: -294.87018]
Iterations:  90%|█████████ | 27/30 [01:25<00:09,  3.17s/it, attack_loss: -303.60205 variance_cross_attn_loss: 0.03602 self_attn_loss: 1.17343 loss: -302.39261]
Iterations:  93%|█████████▎| 28/30 [01:26<00:06,  3.06s/it, attack_loss: -303.60205 variance_cross_attn_loss: 0.03602 self_attn_loss: 1.17343 loss: -302.39261]
Iterations:  93%|█████████▎| 28/30 [01:28<00:06,  3.06s/it, attack_loss: -310.25055 variance_cross_attn_loss: 0.03602 self_attn_loss: 1.18040 loss: -309.03415]
Iterations:  97%|█████████▋| 29/30 [01:29<00:02,  2.99s/it, attack_loss: -310.25055 variance_cross_attn_loss: 0.03602 self_attn_loss: 1.18040 loss: -309.03415]
Iterations:  97%|█████████▋| 29/30 [01:30<00:02,  2.99s/it, attack_loss: -316.24026 variance_cross_attn_loss: 0.03598 self_attn_loss: 1.18128 loss: -315.02301]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  2.88s/it, attack_loss: -316.24026 variance_cross_attn_loss: 0.03598 self_attn_loss: 1.18128 loss: -315.02301]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.06s/it, attack_loss: -316.24026 variance_cross_attn_loss: 0.03598 self_attn_loss: 1.18128 loss: -315.02301]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([893], device='cuda:0') tensor(0.9872, device='cuda:0')
after_true: tensor([777], device='cuda:0') tensor(8.9251e-15, device='cuda:0')
L1: [5080.5527]	L2: [19.111351]	Linf: [0.6862745]

Accuracy on benign examples: 100.0%
gt_label: 768 pred_label: 768 pred_clean_logit 0.3755243420600891
prompt generate:  rugby ball  	labels:  [[768]]
decoder:  [49406, 4964, 1069, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.14it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:31<00:00,  6.30s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -11.71479 variance_cross_attn_loss: 0.07892 self_attn_loss: 0.00000 loss: -11.63587]
Iterations:   3%|▎         | 1/30 [00:02<01:12,  2.51s/it, attack_loss: -11.71479 variance_cross_attn_loss: 0.07892 self_attn_loss: 0.00000 loss: -11.63587]
Iterations:   3%|▎         | 1/30 [00:03<01:12,  2.51s/it, attack_loss: -35.22984 variance_cross_attn_loss: 0.07428 self_attn_loss: 2.20675 loss: -32.94880]
Iterations:   7%|▋         | 2/30 [00:05<01:14,  2.66s/it, attack_loss: -35.22984 variance_cross_attn_loss: 0.07428 self_attn_loss: 2.20675 loss: -32.94880]
Iterations:   7%|▋         | 2/30 [00:07<01:14,  2.66s/it, attack_loss: -45.01444 variance_cross_attn_loss: 0.07426 self_attn_loss: 2.13087 loss: -42.80930]
Iterations:  10%|█         | 3/30 [00:08<01:18,  2.90s/it, attack_loss: -45.01444 variance_cross_attn_loss: 0.07426 self_attn_loss: 2.13087 loss: -42.80930]
Iterations:  10%|█         | 3/30 [00:10<01:18,  2.90s/it, attack_loss: -53.70856 variance_cross_attn_loss: 0.07153 self_attn_loss: 2.54303 loss: -51.09400]
Iterations:  13%|█▎        | 4/30 [00:11<01:18,  3.02s/it, attack_loss: -53.70856 variance_cross_attn_loss: 0.07153 self_attn_loss: 2.54303 loss: -51.09400]
Iterations:  13%|█▎        | 4/30 [00:13<01:18,  3.02s/it, attack_loss: -61.58626 variance_cross_attn_loss: 0.07177 self_attn_loss: 2.61153 loss: -58.90296]
Iterations:  17%|█▋        | 5/30 [00:14<01:16,  3.07s/it, attack_loss: -61.58626 variance_cross_attn_loss: 0.07177 self_attn_loss: 2.61153 loss: -58.90296]
Iterations:  17%|█▋        | 5/30 [00:16<01:16,  3.07s/it, attack_loss: -61.51642 variance_cross_attn_loss: 0.07147 self_attn_loss: 2.64170 loss: -58.80325]
Iterations:  20%|██        | 6/30 [00:18<01:14,  3.11s/it, attack_loss: -61.51642 variance_cross_attn_loss: 0.07147 self_attn_loss: 2.64170 loss: -58.80325]
Iterations:  20%|██        | 6/30 [00:19<01:14,  3.11s/it, attack_loss: -70.82363 variance_cross_attn_loss: 0.06558 self_attn_loss: 2.79068 loss: -67.96737]
Iterations:  23%|██▎       | 7/30 [00:20<01:10,  3.06s/it, attack_loss: -70.82363 variance_cross_attn_loss: 0.06558 self_attn_loss: 2.79068 loss: -67.96737]
Iterations:  23%|██▎       | 7/30 [00:22<01:10,  3.06s/it, attack_loss: -76.55598 variance_cross_attn_loss: 0.06684 self_attn_loss: 2.74071 loss: -73.74843]
Iterations:  27%|██▋       | 8/30 [00:23<01:06,  3.03s/it, attack_loss: -76.55598 variance_cross_attn_loss: 0.06684 self_attn_loss: 2.74071 loss: -73.74843]
Iterations:  27%|██▋       | 8/30 [00:25<01:06,  3.03s/it, attack_loss: -79.93697 variance_cross_attn_loss: 0.06709 self_attn_loss: 2.78597 loss: -77.08391]
Iterations:  30%|███       | 9/30 [00:26<01:01,  2.91s/it, attack_loss: -79.93697 variance_cross_attn_loss: 0.06709 self_attn_loss: 2.78597 loss: -77.08391]
Iterations:  30%|███       | 9/30 [00:27<01:01,  2.91s/it, attack_loss: -88.44807 variance_cross_attn_loss: 0.06741 self_attn_loss: 2.83585 loss: -85.54482]
Iterations:  33%|███▎      | 10/30 [00:29<00:56,  2.83s/it, attack_loss: -88.44807 variance_cross_attn_loss: 0.06741 self_attn_loss: 2.83585 loss: -85.54482]
Iterations:  33%|███▎      | 10/30 [00:30<00:56,  2.83s/it, attack_loss: -94.48170 variance_cross_attn_loss: 0.06743 self_attn_loss: 2.88341 loss: -91.53085]
Iterations:  37%|███▋      | 11/30 [00:32<00:53,  2.83s/it, attack_loss: -94.48170 variance_cross_attn_loss: 0.06743 self_attn_loss: 2.88341 loss: -91.53085]
Iterations:  37%|███▋      | 11/30 [00:33<00:53,  2.83s/it, attack_loss: -100.18860 variance_cross_attn_loss: 0.06777 self_attn_loss: 2.91946 loss: -97.20138]
Iterations:  40%|████      | 12/30 [00:35<00:52,  2.92s/it, attack_loss: -100.18860 variance_cross_attn_loss: 0.06777 self_attn_loss: 2.91946 loss: -97.20138]
Iterations:  40%|████      | 12/30 [00:36<00:52,  2.92s/it, attack_loss: -105.31529 variance_cross_attn_loss: 0.06829 self_attn_loss: 2.94212 loss: -102.30488]
Iterations:  43%|████▎     | 13/30 [00:38<00:50,  2.99s/it, attack_loss: -105.31529 variance_cross_attn_loss: 0.06829 self_attn_loss: 2.94212 loss: -102.30488]
Iterations:  43%|████▎     | 13/30 [00:40<00:50,  2.99s/it, attack_loss: -109.14874 variance_cross_attn_loss: 0.06902 self_attn_loss: 2.91717 loss: -106.16256]
Iterations:  47%|████▋     | 14/30 [00:41<00:48,  3.04s/it, attack_loss: -109.14874 variance_cross_attn_loss: 0.06902 self_attn_loss: 2.91717 loss: -106.16256]
Iterations:  47%|████▋     | 14/30 [00:43<00:48,  3.04s/it, attack_loss: -113.28391 variance_cross_attn_loss: 0.06961 self_attn_loss: 2.93486 loss: -110.27943]
Iterations:  50%|█████     | 15/30 [00:44<00:44,  3.00s/it, attack_loss: -113.28391 variance_cross_attn_loss: 0.06961 self_attn_loss: 2.93486 loss: -110.27943]
Iterations:  50%|█████     | 15/30 [00:45<00:44,  3.00s/it, attack_loss: -117.83199 variance_cross_attn_loss: 0.06979 self_attn_loss: 2.95950 loss: -114.80270]
Iterations:  53%|█████▎    | 16/30 [00:47<00:40,  2.90s/it, attack_loss: -117.83199 variance_cross_attn_loss: 0.06979 self_attn_loss: 2.95950 loss: -114.80270]
Iterations:  53%|█████▎    | 16/30 [00:48<00:40,  2.90s/it, attack_loss: -122.29324 variance_cross_attn_loss: 0.06978 self_attn_loss: 2.96324 loss: -119.26022]
Iterations:  57%|█████▋    | 17/30 [00:49<00:36,  2.83s/it, attack_loss: -122.29324 variance_cross_attn_loss: 0.06978 self_attn_loss: 2.96324 loss: -119.26022]
Iterations:  57%|█████▋    | 17/30 [00:51<00:36,  2.83s/it, attack_loss: -127.43509 variance_cross_attn_loss: 0.07018 self_attn_loss: 2.94662 loss: -124.41828]
Iterations:  60%|██████    | 18/30 [00:52<00:34,  2.85s/it, attack_loss: -127.43509 variance_cross_attn_loss: 0.07018 self_attn_loss: 2.94662 loss: -124.41828]
Iterations:  60%|██████    | 18/30 [00:54<00:34,  2.85s/it, attack_loss: -131.45509 variance_cross_attn_loss: 0.06989 self_attn_loss: 2.95343 loss: -128.43178]
Iterations:  63%|██████▎   | 19/30 [00:55<00:32,  2.94s/it, attack_loss: -131.45509 variance_cross_attn_loss: 0.06989 self_attn_loss: 2.95343 loss: -128.43178]
Iterations:  63%|██████▎   | 19/30 [00:57<00:32,  2.94s/it, attack_loss: -135.68750 variance_cross_attn_loss: 0.06989 self_attn_loss: 2.96102 loss: -132.65659]
Iterations:  67%|██████▋   | 20/30 [00:59<00:30,  3.07s/it, attack_loss: -135.68750 variance_cross_attn_loss: 0.06989 self_attn_loss: 2.96102 loss: -132.65659]
Iterations:  67%|██████▋   | 20/30 [01:00<00:30,  3.07s/it, attack_loss: -139.32672 variance_cross_attn_loss: 0.06857 self_attn_loss: 3.01371 loss: -136.24443]
Iterations:  70%|███████   | 21/30 [01:02<00:28,  3.11s/it, attack_loss: -139.32672 variance_cross_attn_loss: 0.06857 self_attn_loss: 3.01371 loss: -136.24443]
Iterations:  70%|███████   | 21/30 [01:04<00:28,  3.11s/it, attack_loss: -141.80582 variance_cross_attn_loss: 0.06879 self_attn_loss: 3.00327 loss: -138.73376]
Iterations:  73%|███████▎  | 22/30 [01:05<00:24,  3.06s/it, attack_loss: -141.80582 variance_cross_attn_loss: 0.06879 self_attn_loss: 3.00327 loss: -138.73376]
Iterations:  73%|███████▎  | 22/30 [01:06<00:24,  3.06s/it, attack_loss: -146.88885 variance_cross_attn_loss: 0.06772 self_attn_loss: 3.02416 loss: -143.79698]
Iterations:  77%|███████▋  | 23/30 [01:07<00:20,  2.89s/it, attack_loss: -146.88885 variance_cross_attn_loss: 0.06772 self_attn_loss: 3.02416 loss: -143.79698]
Iterations:  77%|███████▋  | 23/30 [01:09<00:20,  2.89s/it, attack_loss: -150.56929 variance_cross_attn_loss: 0.06732 self_attn_loss: 3.08602 loss: -147.41594]
Iterations:  80%|████████  | 24/30 [01:10<00:16,  2.78s/it, attack_loss: -150.56929 variance_cross_attn_loss: 0.06732 self_attn_loss: 3.08602 loss: -147.41594]
Iterations:  80%|████████  | 24/30 [01:11<00:16,  2.78s/it, attack_loss: -153.73537 variance_cross_attn_loss: 0.06770 self_attn_loss: 3.12517 loss: -150.54250]
Iterations:  83%|████████▎ | 25/30 [01:12<00:13,  2.72s/it, attack_loss: -153.73537 variance_cross_attn_loss: 0.06770 self_attn_loss: 3.12517 loss: -150.54250]
Iterations:  83%|████████▎ | 25/30 [01:14<00:13,  2.72s/it, attack_loss: -157.22427 variance_cross_attn_loss: 0.06753 self_attn_loss: 3.10644 loss: -154.05032]
Iterations:  87%|████████▋ | 26/30 [01:16<00:11,  2.84s/it, attack_loss: -157.22427 variance_cross_attn_loss: 0.06753 self_attn_loss: 3.10644 loss: -154.05032]
Iterations:  87%|████████▋ | 26/30 [01:17<00:11,  2.84s/it, attack_loss: -160.92688 variance_cross_attn_loss: 0.06801 self_attn_loss: 3.11361 loss: -157.74525]
Iterations:  90%|█████████ | 27/30 [01:19<00:08,  2.94s/it, attack_loss: -160.92688 variance_cross_attn_loss: 0.06801 self_attn_loss: 3.11361 loss: -157.74525]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.94s/it, attack_loss: -164.20862 variance_cross_attn_loss: 0.06838 self_attn_loss: 3.13339 loss: -161.00685]
Iterations:  93%|█████████▎| 28/30 [01:22<00:06,  3.06s/it, attack_loss: -164.20862 variance_cross_attn_loss: 0.06838 self_attn_loss: 3.13339 loss: -161.00685]
Iterations:  93%|█████████▎| 28/30 [01:24<00:06,  3.06s/it, attack_loss: -168.38409 variance_cross_attn_loss: 0.06860 self_attn_loss: 3.16139 loss: -165.15410]
Iterations:  97%|█████████▋| 29/30 [01:25<00:03,  3.09s/it, attack_loss: -168.38409 variance_cross_attn_loss: 0.06860 self_attn_loss: 3.16139 loss: -165.15410]
Iterations:  97%|█████████▋| 29/30 [01:27<00:03,  3.09s/it, attack_loss: -171.58998 variance_cross_attn_loss: 0.06904 self_attn_loss: 3.17814 loss: -168.34279]
Iterations: 100%|██████████| 30/30 [01:28<00:00,  3.10s/it, attack_loss: -171.58998 variance_cross_attn_loss: 0.06904 self_attn_loss: 3.17814 loss: -168.34279]
Iterations: 100%|██████████| 30/30 [01:28<00:00,  2.96s/it, attack_loss: -171.58998 variance_cross_attn_loss: 0.06904 self_attn_loss: 3.17814 loss: -168.34279]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([981], device='cuda:0') tensor(0.9791, device='cuda:0')
after_true: tensor([768], device='cuda:0') tensor(2.5281e-08, device='cuda:0')
L1: [8065.945]	L2: [30.932642]	Linf: [0.8666667]

Accuracy on benign examples: 100.0%
gt_label: 663 pred_label: 663 pred_clean_logit 0.8165990710258484
prompt generate:  monastery  	labels:  [[663]]
decoder:  [49406, 21850, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.72it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:33<00:00,  6.70s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -1.12910 variance_cross_attn_loss: 0.01047 self_attn_loss: 0.00000 loss: -1.11863]
Iterations:   3%|▎         | 1/30 [00:02<01:26,  2.97s/it, attack_loss: -1.12910 variance_cross_attn_loss: 0.01047 self_attn_loss: 0.00000 loss: -1.11863]
Iterations:   3%|▎         | 1/30 [00:04<01:26,  2.97s/it, attack_loss: -4.04150 variance_cross_attn_loss: 0.00974 self_attn_loss: 0.92397 loss: -3.10779]
Iterations:   7%|▋         | 2/30 [00:06<01:28,  3.15s/it, attack_loss: -4.04150 variance_cross_attn_loss: 0.00974 self_attn_loss: 0.92397 loss: -3.10779]
Iterations:   7%|▋         | 2/30 [00:07<01:28,  3.15s/it, attack_loss: -13.84039 variance_cross_attn_loss: 0.00931 self_attn_loss: 1.28010 loss: -12.55098]
Iterations:  10%|█         | 3/30 [00:09<01:21,  3.01s/it, attack_loss: -13.84039 variance_cross_attn_loss: 0.00931 self_attn_loss: 1.28010 loss: -12.55098]
Iterations:  10%|█         | 3/30 [00:10<01:21,  3.01s/it, attack_loss: -25.95852 variance_cross_attn_loss: 0.00907 self_attn_loss: 1.42672 loss: -24.52273]
Iterations:  13%|█▎        | 4/30 [00:11<01:14,  2.87s/it, attack_loss: -25.95852 variance_cross_attn_loss: 0.00907 self_attn_loss: 1.42672 loss: -24.52273]
Iterations:  13%|█▎        | 4/30 [00:13<01:14,  2.87s/it, attack_loss: -38.74557 variance_cross_attn_loss: 0.00867 self_attn_loss: 1.49977 loss: -37.23713]
Iterations:  17%|█▋        | 5/30 [00:14<01:11,  2.86s/it, attack_loss: -38.74557 variance_cross_attn_loss: 0.00867 self_attn_loss: 1.49977 loss: -37.23713]
Iterations:  17%|█▋        | 5/30 [00:16<01:11,  2.86s/it, attack_loss: -47.78202 variance_cross_attn_loss: 0.00835 self_attn_loss: 1.60179 loss: -46.17188]
Iterations:  20%|██        | 6/30 [00:17<01:11,  2.96s/it, attack_loss: -47.78202 variance_cross_attn_loss: 0.00835 self_attn_loss: 1.60179 loss: -46.17188]
Iterations:  20%|██        | 6/30 [00:19<01:11,  2.96s/it, attack_loss: -57.77281 variance_cross_attn_loss: 0.00819 self_attn_loss: 1.66195 loss: -56.10266]
Iterations:  23%|██▎       | 7/30 [00:21<01:10,  3.06s/it, attack_loss: -57.77281 variance_cross_attn_loss: 0.00819 self_attn_loss: 1.66195 loss: -56.10266]
Iterations:  23%|██▎       | 7/30 [00:22<01:10,  3.06s/it, attack_loss: -67.58770 variance_cross_attn_loss: 0.00808 self_attn_loss: 1.69137 loss: -65.88825]
Iterations:  27%|██▋       | 8/30 [00:24<01:08,  3.13s/it, attack_loss: -67.58770 variance_cross_attn_loss: 0.00808 self_attn_loss: 1.69137 loss: -65.88825]
Iterations:  27%|██▋       | 8/30 [00:26<01:08,  3.13s/it, attack_loss: -76.23781 variance_cross_attn_loss: 0.00794 self_attn_loss: 1.77974 loss: -74.45013]
Iterations:  30%|███       | 9/30 [00:27<01:06,  3.15s/it, attack_loss: -76.23781 variance_cross_attn_loss: 0.00794 self_attn_loss: 1.77974 loss: -74.45013]
Iterations:  30%|███       | 9/30 [00:29<01:06,  3.15s/it, attack_loss: -82.35872 variance_cross_attn_loss: 0.00775 self_attn_loss: 1.91132 loss: -80.43964]
Iterations:  33%|███▎      | 10/30 [00:30<01:02,  3.12s/it, attack_loss: -82.35872 variance_cross_attn_loss: 0.00775 self_attn_loss: 1.91132 loss: -80.43964]
Iterations:  33%|███▎      | 10/30 [00:32<01:02,  3.12s/it, attack_loss: -88.00415 variance_cross_attn_loss: 0.00765 self_attn_loss: 1.97584 loss: -86.02067]
Iterations:  37%|███▋      | 11/30 [00:33<00:58,  3.06s/it, attack_loss: -88.00415 variance_cross_attn_loss: 0.00765 self_attn_loss: 1.97584 loss: -86.02067]
Iterations:  37%|███▋      | 11/30 [00:34<00:58,  3.06s/it, attack_loss: -96.09633 variance_cross_attn_loss: 0.00763 self_attn_loss: 2.02448 loss: -94.06422]
Iterations:  40%|████      | 12/30 [00:36<00:54,  3.01s/it, attack_loss: -96.09633 variance_cross_attn_loss: 0.00763 self_attn_loss: 2.02448 loss: -94.06422]
Iterations:  40%|████      | 12/30 [00:37<00:54,  3.01s/it, attack_loss: -102.71111 variance_cross_attn_loss: 0.00763 self_attn_loss: 2.04544 loss: -100.65804]
Iterations:  43%|████▎     | 13/30 [00:39<00:49,  2.94s/it, attack_loss: -102.71111 variance_cross_attn_loss: 0.00763 self_attn_loss: 2.04544 loss: -100.65804]
Iterations:  43%|████▎     | 13/30 [00:40<00:49,  2.94s/it, attack_loss: -107.83195 variance_cross_attn_loss: 0.00760 self_attn_loss: 2.06045 loss: -105.76391]
Iterations:  47%|████▋     | 14/30 [00:42<00:49,  3.09s/it, attack_loss: -107.83195 variance_cross_attn_loss: 0.00760 self_attn_loss: 2.06045 loss: -105.76391]
Iterations:  47%|████▋     | 14/30 [00:44<00:49,  3.09s/it, attack_loss: -114.91634 variance_cross_attn_loss: 0.00754 self_attn_loss: 2.09533 loss: -112.81348]
Iterations:  50%|█████     | 15/30 [00:45<00:47,  3.14s/it, attack_loss: -114.91634 variance_cross_attn_loss: 0.00754 self_attn_loss: 2.09533 loss: -112.81348]
Iterations:  50%|█████     | 15/30 [00:47<00:47,  3.14s/it, attack_loss: -120.52142 variance_cross_attn_loss: 0.00748 self_attn_loss: 2.12865 loss: -118.38530]
Iterations:  53%|█████▎    | 16/30 [00:48<00:44,  3.15s/it, attack_loss: -120.52142 variance_cross_attn_loss: 0.00748 self_attn_loss: 2.12865 loss: -118.38530]
Iterations:  53%|█████▎    | 16/30 [00:50<00:44,  3.15s/it, attack_loss: -125.02282 variance_cross_attn_loss: 0.00746 self_attn_loss: 2.14941 loss: -122.86594]
Iterations:  57%|█████▋    | 17/30 [00:52<00:41,  3.16s/it, attack_loss: -125.02282 variance_cross_attn_loss: 0.00746 self_attn_loss: 2.14941 loss: -122.86594]
Iterations:  57%|█████▋    | 17/30 [00:53<00:41,  3.16s/it, attack_loss: -131.41435 variance_cross_attn_loss: 0.00741 self_attn_loss: 2.18101 loss: -129.22592]
Iterations:  60%|██████    | 18/30 [00:55<00:37,  3.11s/it, attack_loss: -131.41435 variance_cross_attn_loss: 0.00741 self_attn_loss: 2.18101 loss: -129.22592]
Iterations:  60%|██████    | 18/30 [00:56<00:37,  3.11s/it, attack_loss: -137.91696 variance_cross_attn_loss: 0.00734 self_attn_loss: 2.22039 loss: -135.68924]
Iterations:  63%|██████▎   | 19/30 [00:57<00:32,  2.98s/it, attack_loss: -137.91696 variance_cross_attn_loss: 0.00734 self_attn_loss: 2.22039 loss: -135.68924]
Iterations:  63%|██████▎   | 19/30 [00:59<00:32,  2.98s/it, attack_loss: -137.77713 variance_cross_attn_loss: 0.00727 self_attn_loss: 2.24338 loss: -135.52647]
Iterations:  67%|██████▋   | 20/30 [01:00<00:29,  2.91s/it, attack_loss: -137.77713 variance_cross_attn_loss: 0.00727 self_attn_loss: 2.24338 loss: -135.52647]
Iterations:  67%|██████▋   | 20/30 [01:02<00:29,  2.91s/it, attack_loss: -148.46973 variance_cross_attn_loss: 0.00731 self_attn_loss: 2.24215 loss: -146.22028]
Iterations:  70%|███████   | 21/30 [01:03<00:26,  3.00s/it, attack_loss: -148.46973 variance_cross_attn_loss: 0.00731 self_attn_loss: 2.24215 loss: -146.22028]
Iterations:  70%|███████   | 21/30 [01:05<00:26,  3.00s/it, attack_loss: -153.12428 variance_cross_attn_loss: 0.00731 self_attn_loss: 2.25130 loss: -150.86568]
Iterations:  73%|███████▎  | 22/30 [01:06<00:24,  3.04s/it, attack_loss: -153.12428 variance_cross_attn_loss: 0.00731 self_attn_loss: 2.25130 loss: -150.86568]
Iterations:  73%|███████▎  | 22/30 [01:08<00:24,  3.04s/it, attack_loss: -157.03430 variance_cross_attn_loss: 0.00730 self_attn_loss: 2.26636 loss: -154.76065]
Iterations:  77%|███████▋  | 23/30 [01:10<00:21,  3.08s/it, attack_loss: -157.03430 variance_cross_attn_loss: 0.00730 self_attn_loss: 2.26636 loss: -154.76065]
Iterations:  77%|███████▋  | 23/30 [01:11<00:21,  3.08s/it, attack_loss: -162.91803 variance_cross_attn_loss: 0.00728 self_attn_loss: 2.28636 loss: -160.62439]
Iterations:  80%|████████  | 24/30 [01:13<00:18,  3.10s/it, attack_loss: -162.91803 variance_cross_attn_loss: 0.00728 self_attn_loss: 2.28636 loss: -160.62439]
Iterations:  80%|████████  | 24/30 [01:14<00:18,  3.10s/it, attack_loss: -168.90776 variance_cross_attn_loss: 0.00730 self_attn_loss: 2.30307 loss: -166.59740]
Iterations:  83%|████████▎ | 25/30 [01:16<00:15,  3.09s/it, attack_loss: -168.90776 variance_cross_attn_loss: 0.00730 self_attn_loss: 2.30307 loss: -166.59740]
Iterations:  83%|████████▎ | 25/30 [01:18<00:15,  3.09s/it, attack_loss: -172.95457 variance_cross_attn_loss: 0.00717 self_attn_loss: 2.32642 loss: -170.62099]
Iterations:  87%|████████▋ | 26/30 [01:19<00:12,  3.05s/it, attack_loss: -172.95457 variance_cross_attn_loss: 0.00717 self_attn_loss: 2.32642 loss: -170.62099]
Iterations:  87%|████████▋ | 26/30 [01:20<00:12,  3.05s/it, attack_loss: -178.12529 variance_cross_attn_loss: 0.00709 self_attn_loss: 2.34405 loss: -175.77415]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.93s/it, attack_loss: -178.12529 variance_cross_attn_loss: 0.00709 self_attn_loss: 2.34405 loss: -175.77415]
Iterations:  90%|█████████ | 27/30 [01:23<00:08,  2.93s/it, attack_loss: -183.01659 variance_cross_attn_loss: 0.00701 self_attn_loss: 2.36461 loss: -180.64496]
Iterations:  93%|█████████▎| 28/30 [01:24<00:05,  2.84s/it, attack_loss: -183.01659 variance_cross_attn_loss: 0.00701 self_attn_loss: 2.36461 loss: -180.64496]
Iterations:  93%|█████████▎| 28/30 [01:26<00:05,  2.84s/it, attack_loss: -187.09302 variance_cross_attn_loss: 0.00697 self_attn_loss: 2.39529 loss: -184.69075]
Iterations:  97%|█████████▋| 29/30 [01:27<00:02,  2.85s/it, attack_loss: -187.09302 variance_cross_attn_loss: 0.00697 self_attn_loss: 2.39529 loss: -184.69075]
Iterations:  97%|█████████▋| 29/30 [01:29<00:02,  2.85s/it, attack_loss: -190.65384 variance_cross_attn_loss: 0.00695 self_attn_loss: 2.41470 loss: -188.23219]
Iterations: 100%|██████████| 30/30 [01:30<00:00,  2.95s/it, attack_loss: -190.65384 variance_cross_attn_loss: 0.00695 self_attn_loss: 2.41470 loss: -188.23219]
Iterations: 100%|██████████| 30/30 [01:30<00:00,  3.02s/it, attack_loss: -190.65384 variance_cross_attn_loss: 0.00695 self_attn_loss: 2.41470 loss: -188.23219]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([497], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([663], device='cuda:0') tensor(3.5756e-09, device='cuda:0')
L1: [10414.848]	L2: [40.737457]	Linf: [0.79607844]

Accuracy on benign examples: 100.0%
gt_label: 717 pred_label: 717 pred_clean_logit 0.9892811179161072
prompt generate:  pickup  	labels:  [[717]]
decoder:  [49406, 15382, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.39it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:30<00:00,  6.08s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -0.88946 variance_cross_attn_loss: 0.01823 self_attn_loss: 0.00000 loss: -0.87123]
Iterations:   3%|▎         | 1/30 [00:02<01:25,  2.94s/it, attack_loss: -0.88946 variance_cross_attn_loss: 0.01823 self_attn_loss: 0.00000 loss: -0.87123]
Iterations:   3%|▎         | 1/30 [00:04<01:25,  2.94s/it, attack_loss: -5.06031 variance_cross_attn_loss: 0.01723 self_attn_loss: 0.47626 loss: -4.56681]
Iterations:   7%|▋         | 2/30 [00:06<01:25,  3.07s/it, attack_loss: -5.06031 variance_cross_attn_loss: 0.01723 self_attn_loss: 0.47626 loss: -4.56681]
Iterations:   7%|▋         | 2/30 [00:07<01:25,  3.07s/it, attack_loss: -20.85033 variance_cross_attn_loss: 0.01750 self_attn_loss: 0.53253 loss: -20.30030]
Iterations:  10%|█         | 3/30 [00:09<01:24,  3.13s/it, attack_loss: -20.85033 variance_cross_attn_loss: 0.01750 self_attn_loss: 0.53253 loss: -20.30030]
Iterations:  10%|█         | 3/30 [00:11<01:24,  3.13s/it, attack_loss: -36.68945 variance_cross_attn_loss: 0.01759 self_attn_loss: 0.57557 loss: -36.09629]
Iterations:  13%|█▎        | 4/30 [00:12<01:21,  3.15s/it, attack_loss: -36.68945 variance_cross_attn_loss: 0.01759 self_attn_loss: 0.57557 loss: -36.09629]
Iterations:  13%|█▎        | 4/30 [00:14<01:21,  3.15s/it, attack_loss: -56.56769 variance_cross_attn_loss: 0.01759 self_attn_loss: 0.57846 loss: -55.97165]
Iterations:  17%|█▋        | 5/30 [00:15<01:18,  3.13s/it, attack_loss: -56.56769 variance_cross_attn_loss: 0.01759 self_attn_loss: 0.57846 loss: -55.97165]
Iterations:  17%|█▋        | 5/30 [00:17<01:18,  3.13s/it, attack_loss: -72.86279 variance_cross_attn_loss: 0.01750 self_attn_loss: 0.56901 loss: -72.27627]
Iterations:  20%|██        | 6/30 [00:18<01:11,  2.99s/it, attack_loss: -72.86279 variance_cross_attn_loss: 0.01750 self_attn_loss: 0.56901 loss: -72.27627]
Iterations:  20%|██        | 6/30 [00:19<01:11,  2.99s/it, attack_loss: -87.01231 variance_cross_attn_loss: 0.01739 self_attn_loss: 0.64377 loss: -86.35115]
Iterations:  23%|██▎       | 7/30 [00:20<01:06,  2.88s/it, attack_loss: -87.01231 variance_cross_attn_loss: 0.01739 self_attn_loss: 0.64377 loss: -86.35115]
Iterations:  23%|██▎       | 7/30 [00:22<01:06,  2.88s/it, attack_loss: -98.52032 variance_cross_attn_loss: 0.01730 self_attn_loss: 0.71696 loss: -97.78607]
Iterations:  27%|██▋       | 8/30 [00:23<01:03,  2.86s/it, attack_loss: -98.52032 variance_cross_attn_loss: 0.01730 self_attn_loss: 0.71696 loss: -97.78607]
Iterations:  27%|██▋       | 8/30 [00:25<01:03,  2.86s/it, attack_loss: -109.76170 variance_cross_attn_loss: 0.01720 self_attn_loss: 0.73621 loss: -109.00830]
Iterations:  30%|███       | 9/30 [00:26<01:02,  2.96s/it, attack_loss: -109.76170 variance_cross_attn_loss: 0.01720 self_attn_loss: 0.73621 loss: -109.00830]
Iterations:  30%|███       | 9/30 [00:28<01:02,  2.96s/it, attack_loss: -119.12350 variance_cross_attn_loss: 0.01740 self_attn_loss: 0.69292 loss: -118.41319]
Iterations:  33%|███▎      | 10/30 [00:30<01:00,  3.03s/it, attack_loss: -119.12350 variance_cross_attn_loss: 0.01740 self_attn_loss: 0.69292 loss: -118.41319]
Iterations:  33%|███▎      | 10/30 [00:32<01:00,  3.03s/it, attack_loss: -128.52887 variance_cross_attn_loss: 0.01743 self_attn_loss: 0.70151 loss: -127.80993]
Iterations:  37%|███▋      | 11/30 [00:33<01:00,  3.21s/it, attack_loss: -128.52887 variance_cross_attn_loss: 0.01743 self_attn_loss: 0.70151 loss: -127.80993]
Iterations:  37%|███▋      | 11/30 [00:35<01:00,  3.21s/it, attack_loss: -136.54063 variance_cross_attn_loss: 0.01727 self_attn_loss: 0.75273 loss: -135.77063]
Iterations:  40%|████      | 12/30 [00:36<00:57,  3.20s/it, attack_loss: -136.54063 variance_cross_attn_loss: 0.01727 self_attn_loss: 0.75273 loss: -135.77063]
Iterations:  40%|████      | 12/30 [00:38<00:57,  3.20s/it, attack_loss: -143.41237 variance_cross_attn_loss: 0.01701 self_attn_loss: 0.82424 loss: -142.57112]
Iterations:  43%|████▎     | 13/30 [00:40<00:54,  3.22s/it, attack_loss: -143.41237 variance_cross_attn_loss: 0.01701 self_attn_loss: 0.82424 loss: -142.57112]
Iterations:  43%|████▎     | 13/30 [00:41<00:54,  3.22s/it, attack_loss: -150.96284 variance_cross_attn_loss: 0.01692 self_attn_loss: 0.84940 loss: -150.09653]
Iterations:  47%|████▋     | 14/30 [00:43<00:49,  3.11s/it, attack_loss: -150.96284 variance_cross_attn_loss: 0.01692 self_attn_loss: 0.84940 loss: -150.09653]
Iterations:  47%|████▋     | 14/30 [00:44<00:49,  3.11s/it, attack_loss: -158.01266 variance_cross_attn_loss: 0.01680 self_attn_loss: 0.87392 loss: -157.12195]
Iterations:  50%|█████     | 15/30 [00:45<00:44,  2.97s/it, attack_loss: -158.01266 variance_cross_attn_loss: 0.01680 self_attn_loss: 0.87392 loss: -157.12195]
Iterations:  50%|█████     | 15/30 [00:47<00:44,  2.97s/it, attack_loss: -164.84712 variance_cross_attn_loss: 0.01679 self_attn_loss: 0.88228 loss: -163.94804]
Iterations:  53%|█████▎    | 16/30 [00:48<00:40,  2.92s/it, attack_loss: -164.84712 variance_cross_attn_loss: 0.01679 self_attn_loss: 0.88228 loss: -163.94804]
Iterations:  53%|█████▎    | 16/30 [00:50<00:40,  2.92s/it, attack_loss: -172.23782 variance_cross_attn_loss: 0.01684 self_attn_loss: 0.89959 loss: -171.32140]
Iterations:  57%|█████▋    | 17/30 [00:51<00:39,  3.07s/it, attack_loss: -172.23782 variance_cross_attn_loss: 0.01684 self_attn_loss: 0.89959 loss: -171.32140]
Iterations:  57%|█████▋    | 17/30 [00:53<00:39,  3.07s/it, attack_loss: -178.27620 variance_cross_attn_loss: 0.01700 self_attn_loss: 0.91158 loss: -177.34763]
Iterations:  60%|██████    | 18/30 [00:55<00:37,  3.10s/it, attack_loss: -178.27620 variance_cross_attn_loss: 0.01700 self_attn_loss: 0.91158 loss: -177.34763]
Iterations:  60%|██████    | 18/30 [00:56<00:37,  3.10s/it, attack_loss: -184.20714 variance_cross_attn_loss: 0.01717 self_attn_loss: 0.91030 loss: -183.27966]
Iterations:  63%|██████▎   | 19/30 [00:58<00:34,  3.12s/it, attack_loss: -184.20714 variance_cross_attn_loss: 0.01717 self_attn_loss: 0.91030 loss: -183.27966]
Iterations:  63%|██████▎   | 19/30 [01:00<00:34,  3.12s/it, attack_loss: -189.71681 variance_cross_attn_loss: 0.01726 self_attn_loss: 0.92992 loss: -188.76964]
Iterations:  67%|██████▋   | 20/30 [01:01<00:31,  3.13s/it, attack_loss: -189.71681 variance_cross_attn_loss: 0.01726 self_attn_loss: 0.92992 loss: -188.76964]
Iterations:  67%|██████▋   | 20/30 [01:03<00:31,  3.13s/it, attack_loss: -194.80368 variance_cross_attn_loss: 0.01730 self_attn_loss: 0.95042 loss: -193.83595]
Iterations:  70%|███████   | 21/30 [01:04<00:27,  3.06s/it, attack_loss: -194.80368 variance_cross_attn_loss: 0.01730 self_attn_loss: 0.95042 loss: -193.83595]
Iterations:  70%|███████   | 21/30 [01:05<00:27,  3.06s/it, attack_loss: -200.58221 variance_cross_attn_loss: 0.01735 self_attn_loss: 0.95597 loss: -199.60890]
Iterations:  73%|███████▎  | 22/30 [01:07<00:24,  3.06s/it, attack_loss: -200.58221 variance_cross_attn_loss: 0.01735 self_attn_loss: 0.95597 loss: -199.60890]
Iterations:  73%|███████▎  | 22/30 [01:08<00:24,  3.06s/it, attack_loss: -206.30006 variance_cross_attn_loss: 0.01744 self_attn_loss: 0.94962 loss: -205.33301]
Iterations:  77%|███████▋  | 23/30 [01:10<00:20,  2.96s/it, attack_loss: -206.30006 variance_cross_attn_loss: 0.01744 self_attn_loss: 0.94962 loss: -205.33301]
Iterations:  77%|███████▋  | 23/30 [01:11<00:20,  2.96s/it, attack_loss: -211.31950 variance_cross_attn_loss: 0.01745 self_attn_loss: 0.96087 loss: -210.34119]
Iterations:  80%|████████  | 24/30 [01:12<00:17,  2.93s/it, attack_loss: -211.31950 variance_cross_attn_loss: 0.01745 self_attn_loss: 0.96087 loss: -210.34119]
Iterations:  80%|████████  | 24/30 [01:14<00:17,  2.93s/it, attack_loss: -216.24088 variance_cross_attn_loss: 0.01737 self_attn_loss: 0.98892 loss: -215.23457]
Iterations:  83%|████████▎ | 25/30 [01:16<00:15,  3.08s/it, attack_loss: -216.24088 variance_cross_attn_loss: 0.01737 self_attn_loss: 0.98892 loss: -215.23457]
Iterations:  83%|████████▎ | 25/30 [01:18<00:15,  3.08s/it, attack_loss: -221.91824 variance_cross_attn_loss: 0.01749 self_attn_loss: 0.99093 loss: -220.90982]
Iterations:  87%|████████▋ | 26/30 [01:19<00:12,  3.17s/it, attack_loss: -221.91824 variance_cross_attn_loss: 0.01749 self_attn_loss: 0.99093 loss: -220.90982]
Iterations:  87%|████████▋ | 26/30 [01:21<00:12,  3.17s/it, attack_loss: -227.15765 variance_cross_attn_loss: 0.01760 self_attn_loss: 0.99586 loss: -226.14420]
Iterations:  90%|█████████ | 27/30 [01:23<00:09,  3.29s/it, attack_loss: -227.15765 variance_cross_attn_loss: 0.01760 self_attn_loss: 0.99586 loss: -226.14420]
Iterations:  90%|█████████ | 27/30 [01:25<00:09,  3.29s/it, attack_loss: -232.75714 variance_cross_attn_loss: 0.01757 self_attn_loss: 1.03058 loss: -231.70898]
Iterations:  93%|█████████▎| 28/30 [01:26<00:06,  3.27s/it, attack_loss: -232.75714 variance_cross_attn_loss: 0.01757 self_attn_loss: 1.03058 loss: -231.70898]
Iterations:  93%|█████████▎| 28/30 [01:28<00:06,  3.27s/it, attack_loss: -237.60124 variance_cross_attn_loss: 0.01755 self_attn_loss: 1.05524 loss: -236.52846]
Iterations:  97%|█████████▋| 29/30 [01:29<00:03,  3.19s/it, attack_loss: -237.60124 variance_cross_attn_loss: 0.01755 self_attn_loss: 1.05524 loss: -236.52846]
Iterations:  97%|█████████▋| 29/30 [01:31<00:03,  3.19s/it, attack_loss: -243.21466 variance_cross_attn_loss: 0.01759 self_attn_loss: 1.07102 loss: -242.12605]
Iterations: 100%|██████████| 30/30 [01:32<00:00,  3.03s/it, attack_loss: -243.21466 variance_cross_attn_loss: 0.01759 self_attn_loss: 1.07102 loss: -242.12605]
Iterations: 100%|██████████| 30/30 [01:32<00:00,  3.07s/it, attack_loss: -243.21466 variance_cross_attn_loss: 0.01759 self_attn_loss: 1.07102 loss: -242.12605]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([468], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([717], device='cuda:0') tensor(1.4704e-11, device='cuda:0')
L1: [8254.741]	L2: [35.50124]	Linf: [0.83137256]

Accuracy on benign examples: 100.0%
gt_label: 671 pred_label: 671 pred_clean_logit 0.6306856274604797
prompt generate:  mountain bike  	labels:  [[671]]
decoder:  [49406, 3965, 3701, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.17it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:31<00:00,  6.34s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -11.61487 variance_cross_attn_loss: 0.13533 self_attn_loss: 0.00000 loss: -11.47954]
Iterations:   3%|▎         | 1/30 [00:02<01:13,  2.53s/it, attack_loss: -11.61487 variance_cross_attn_loss: 0.13533 self_attn_loss: 0.00000 loss: -11.47954]
Iterations:   3%|▎         | 1/30 [00:03<01:13,  2.53s/it, attack_loss: -39.57614 variance_cross_attn_loss: 0.13360 self_attn_loss: 0.50911 loss: -38.93343]
Iterations:   7%|▋         | 2/30 [00:05<01:12,  2.61s/it, attack_loss: -39.57614 variance_cross_attn_loss: 0.13360 self_attn_loss: 0.50911 loss: -38.93343]
Iterations:   7%|▋         | 2/30 [00:06<01:12,  2.61s/it, attack_loss: -63.04490 variance_cross_attn_loss: 0.13523 self_attn_loss: 1.10050 loss: -61.80917]
Iterations:  10%|█         | 3/30 [00:08<01:16,  2.82s/it, attack_loss: -63.04490 variance_cross_attn_loss: 0.13523 self_attn_loss: 1.10050 loss: -61.80917]
Iterations:  10%|█         | 3/30 [00:09<01:16,  2.82s/it, attack_loss: -87.17744 variance_cross_attn_loss: 0.13213 self_attn_loss: 1.24630 loss: -85.79901]
Iterations:  13%|█▎        | 4/30 [00:11<01:16,  2.96s/it, attack_loss: -87.17744 variance_cross_attn_loss: 0.13213 self_attn_loss: 1.24630 loss: -85.79901]
Iterations:  13%|█▎        | 4/30 [00:13<01:16,  2.96s/it, attack_loss: -102.21274 variance_cross_attn_loss: 0.13040 self_attn_loss: 1.45557 loss: -100.62677]
Iterations:  17%|█▋        | 5/30 [00:14<01:18,  3.12s/it, attack_loss: -102.21274 variance_cross_attn_loss: 0.13040 self_attn_loss: 1.45557 loss: -100.62677]
Iterations:  17%|█▋        | 5/30 [00:16<01:18,  3.12s/it, attack_loss: -109.85915 variance_cross_attn_loss: 0.13236 self_attn_loss: 1.76700 loss: -107.95980]
Iterations:  20%|██        | 6/30 [00:18<01:16,  3.20s/it, attack_loss: -109.85915 variance_cross_attn_loss: 0.13236 self_attn_loss: 1.76700 loss: -107.95980]
Iterations:  20%|██        | 6/30 [00:19<01:16,  3.20s/it, attack_loss: -124.85070 variance_cross_attn_loss: 0.13049 self_attn_loss: 1.83032 loss: -122.88989]
Iterations:  23%|██▎       | 7/30 [00:21<01:13,  3.19s/it, attack_loss: -124.85070 variance_cross_attn_loss: 0.13049 self_attn_loss: 1.83032 loss: -122.88989]
Iterations:  23%|██▎       | 7/30 [00:22<01:13,  3.19s/it, attack_loss: -131.63618 variance_cross_attn_loss: 0.12798 self_attn_loss: 1.87061 loss: -129.63760]
Iterations:  27%|██▋       | 8/30 [00:24<01:07,  3.07s/it, attack_loss: -131.63618 variance_cross_attn_loss: 0.12798 self_attn_loss: 1.87061 loss: -129.63760]
Iterations:  27%|██▋       | 8/30 [00:25<01:07,  3.07s/it, attack_loss: -144.89430 variance_cross_attn_loss: 0.12728 self_attn_loss: 1.89059 loss: -142.87645]
Iterations:  30%|███       | 9/30 [00:26<01:01,  2.93s/it, attack_loss: -144.89430 variance_cross_attn_loss: 0.12728 self_attn_loss: 1.89059 loss: -142.87645]
Iterations:  30%|███       | 9/30 [00:28<01:01,  2.93s/it, attack_loss: -156.97997 variance_cross_attn_loss: 0.12673 self_attn_loss: 1.90604 loss: -154.94719]
Iterations:  33%|███▎      | 10/30 [00:29<00:56,  2.84s/it, attack_loss: -156.97997 variance_cross_attn_loss: 0.12673 self_attn_loss: 1.90604 loss: -154.94719]
Iterations:  33%|███▎      | 10/30 [00:31<00:56,  2.84s/it, attack_loss: -167.00024 variance_cross_attn_loss: 0.12654 self_attn_loss: 1.92486 loss: -164.94884]
Iterations:  37%|███▋      | 11/30 [00:32<00:55,  2.92s/it, attack_loss: -167.00024 variance_cross_attn_loss: 0.12654 self_attn_loss: 1.92486 loss: -164.94884]
Iterations:  37%|███▋      | 11/30 [00:34<00:55,  2.92s/it, attack_loss: -177.69308 variance_cross_attn_loss: 0.12670 self_attn_loss: 1.94583 loss: -175.62056]
Iterations:  40%|████      | 12/30 [00:35<00:53,  2.99s/it, attack_loss: -177.69308 variance_cross_attn_loss: 0.12670 self_attn_loss: 1.94583 loss: -175.62056]
Iterations:  40%|████      | 12/30 [00:37<00:53,  2.99s/it, attack_loss: -188.30777 variance_cross_attn_loss: 0.12659 self_attn_loss: 1.99061 loss: -186.19057]
Iterations:  43%|████▎     | 13/30 [00:38<00:51,  3.05s/it, attack_loss: -188.30777 variance_cross_attn_loss: 0.12659 self_attn_loss: 1.99061 loss: -186.19057]
Iterations:  43%|████▎     | 13/30 [00:40<00:51,  3.05s/it, attack_loss: -197.71799 variance_cross_attn_loss: 0.12649 self_attn_loss: 2.00145 loss: -195.59004]
Iterations:  47%|████▋     | 14/30 [00:42<00:51,  3.21s/it, attack_loss: -197.71799 variance_cross_attn_loss: 0.12649 self_attn_loss: 2.00145 loss: -195.59004]
Iterations:  47%|████▋     | 14/30 [00:44<00:51,  3.21s/it, attack_loss: -206.42337 variance_cross_attn_loss: 0.12636 self_attn_loss: 1.98725 loss: -204.30977]
Iterations:  50%|█████     | 15/30 [00:45<00:48,  3.23s/it, attack_loss: -206.42337 variance_cross_attn_loss: 0.12636 self_attn_loss: 1.98725 loss: -204.30977]
Iterations:  50%|█████     | 15/30 [00:47<00:48,  3.23s/it, attack_loss: -213.61249 variance_cross_attn_loss: 0.12564 self_attn_loss: 2.03052 loss: -211.45633]
Iterations:  53%|█████▎    | 16/30 [00:48<00:43,  3.07s/it, attack_loss: -213.61249 variance_cross_attn_loss: 0.12564 self_attn_loss: 2.03052 loss: -211.45633]
Iterations:  53%|█████▎    | 16/30 [00:49<00:43,  3.07s/it, attack_loss: -221.08948 variance_cross_attn_loss: 0.12512 self_attn_loss: 2.06658 loss: -218.89777]
Iterations:  57%|█████▋    | 17/30 [00:51<00:38,  2.96s/it, attack_loss: -221.08948 variance_cross_attn_loss: 0.12512 self_attn_loss: 2.06658 loss: -218.89777]
Iterations:  57%|█████▋    | 17/30 [00:52<00:38,  2.96s/it, attack_loss: -227.48772 variance_cross_attn_loss: 0.12488 self_attn_loss: 2.08881 loss: -225.27403]
Iterations:  60%|██████    | 18/30 [00:53<00:34,  2.87s/it, attack_loss: -227.48772 variance_cross_attn_loss: 0.12488 self_attn_loss: 2.08881 loss: -225.27403]
Iterations:  60%|██████    | 18/30 [00:55<00:34,  2.87s/it, attack_loss: -234.64584 variance_cross_attn_loss: 0.12379 self_attn_loss: 2.16013 loss: -232.36192]
Iterations:  63%|██████▎   | 19/30 [00:56<00:32,  2.96s/it, attack_loss: -234.64584 variance_cross_attn_loss: 0.12379 self_attn_loss: 2.16013 loss: -232.36192]
Iterations:  63%|██████▎   | 19/30 [00:58<00:32,  2.96s/it, attack_loss: -242.20151 variance_cross_attn_loss: 0.12290 self_attn_loss: 2.21245 loss: -239.86617]
Iterations:  67%|██████▋   | 20/30 [01:00<00:30,  3.03s/it, attack_loss: -242.20151 variance_cross_attn_loss: 0.12290 self_attn_loss: 2.21245 loss: -239.86617]
Iterations:  67%|██████▋   | 20/30 [01:01<00:30,  3.03s/it, attack_loss: -248.27637 variance_cross_attn_loss: 0.12221 self_attn_loss: 2.26166 loss: -245.89250]
Iterations:  70%|███████   | 21/30 [01:03<00:27,  3.07s/it, attack_loss: -248.27637 variance_cross_attn_loss: 0.12221 self_attn_loss: 2.26166 loss: -245.89250]
Iterations:  70%|███████   | 21/30 [01:05<00:27,  3.07s/it, attack_loss: -255.17505 variance_cross_attn_loss: 0.12183 self_attn_loss: 2.29341 loss: -252.75981]
Iterations:  73%|███████▎  | 22/30 [01:06<00:24,  3.09s/it, attack_loss: -255.17505 variance_cross_attn_loss: 0.12183 self_attn_loss: 2.29341 loss: -252.75981]
Iterations:  73%|███████▎  | 22/30 [01:08<00:24,  3.09s/it, attack_loss: -261.78201 variance_cross_attn_loss: 0.12172 self_attn_loss: 2.31371 loss: -259.34659]
Iterations:  77%|███████▋  | 23/30 [01:09<00:22,  3.19s/it, attack_loss: -261.78201 variance_cross_attn_loss: 0.12172 self_attn_loss: 2.31371 loss: -259.34659]
Iterations:  77%|███████▋  | 23/30 [01:11<00:22,  3.19s/it, attack_loss: -268.04541 variance_cross_attn_loss: 0.12182 self_attn_loss: 2.32903 loss: -265.59454]
Iterations:  80%|████████  | 24/30 [01:12<00:18,  3.12s/it, attack_loss: -268.04541 variance_cross_attn_loss: 0.12182 self_attn_loss: 2.32903 loss: -265.59454]
Iterations:  80%|████████  | 24/30 [01:14<00:18,  3.12s/it, attack_loss: -274.61707 variance_cross_attn_loss: 0.12179 self_attn_loss: 2.34189 loss: -272.15338]
Iterations:  83%|████████▎ | 25/30 [01:15<00:14,  3.00s/it, attack_loss: -274.61707 variance_cross_attn_loss: 0.12179 self_attn_loss: 2.34189 loss: -272.15338]
Iterations:  83%|████████▎ | 25/30 [01:16<00:14,  3.00s/it, attack_loss: -280.55698 variance_cross_attn_loss: 0.12160 self_attn_loss: 2.34740 loss: -278.08795]
Iterations:  87%|████████▋ | 26/30 [01:18<00:11,  2.89s/it, attack_loss: -280.55698 variance_cross_attn_loss: 0.12160 self_attn_loss: 2.34740 loss: -278.08795]
Iterations:  87%|████████▋ | 26/30 [01:19<00:11,  2.89s/it, attack_loss: -286.07193 variance_cross_attn_loss: 0.12125 self_attn_loss: 2.34908 loss: -283.60159]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.94s/it, attack_loss: -286.07193 variance_cross_attn_loss: 0.12125 self_attn_loss: 2.34908 loss: -283.60159]
Iterations:  90%|█████████ | 27/30 [01:22<00:08,  2.94s/it, attack_loss: -290.74875 variance_cross_attn_loss: 0.12087 self_attn_loss: 2.34868 loss: -288.27917]
Iterations:  93%|█████████▎| 28/30 [01:24<00:05,  3.00s/it, attack_loss: -290.74875 variance_cross_attn_loss: 0.12087 self_attn_loss: 2.34868 loss: -288.27917]
Iterations:  93%|█████████▎| 28/30 [01:26<00:05,  3.00s/it, attack_loss: -296.10498 variance_cross_attn_loss: 0.12066 self_attn_loss: 2.34451 loss: -293.63980]
Iterations:  97%|█████████▋| 29/30 [01:27<00:03,  3.04s/it, attack_loss: -296.10498 variance_cross_attn_loss: 0.12066 self_attn_loss: 2.34451 loss: -293.63980]
Iterations:  97%|█████████▋| 29/30 [01:29<00:03,  3.04s/it, attack_loss: -301.05801 variance_cross_attn_loss: 0.12057 self_attn_loss: 2.33987 loss: -298.59756]
Iterations: 100%|██████████| 30/30 [01:30<00:00,  3.08s/it, attack_loss: -301.05801 variance_cross_attn_loss: 0.12057 self_attn_loss: 2.33987 loss: -298.59756]
Iterations: 100%|██████████| 30/30 [01:30<00:00,  3.02s/it, attack_loss: -301.05801 variance_cross_attn_loss: 0.12057 self_attn_loss: 2.33987 loss: -298.59756]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([880], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([671], device='cuda:0') tensor(5.1871e-14, device='cuda:0')
L1: [7204.623]	L2: [28.063627]	Linf: [0.9019608]

Accuracy on benign examples: 100.0%
gt_label: 324 pred_label: 324 pred_clean_logit 0.9429625272750854
prompt generate:  cabbage butterfly  	labels:  [[324]]
decoder:  [49406, 18407, 9738, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:03<00:00,  4.76it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:33<00:00,  6.64s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -8.53176 variance_cross_attn_loss: 0.07018 self_attn_loss: 0.00000 loss: -8.46158]
Iterations:   3%|▎         | 1/30 [00:03<01:32,  3.18s/it, attack_loss: -8.53176 variance_cross_attn_loss: 0.07018 self_attn_loss: 0.00000 loss: -8.46158]
Iterations:   3%|▎         | 1/30 [00:04<01:32,  3.18s/it, attack_loss: -18.88255 variance_cross_attn_loss: 0.06916 self_attn_loss: 0.97374 loss: -17.83965]
Iterations:   7%|▋         | 2/30 [00:06<01:28,  3.17s/it, attack_loss: -18.88255 variance_cross_attn_loss: 0.06916 self_attn_loss: 0.97374 loss: -17.83965]
Iterations:   7%|▋         | 2/30 [00:07<01:28,  3.17s/it, attack_loss: -37.58075 variance_cross_attn_loss: 0.06321 self_attn_loss: 1.12190 loss: -36.39564]
Iterations:  10%|█         | 3/30 [00:09<01:23,  3.09s/it, attack_loss: -37.58075 variance_cross_attn_loss: 0.06321 self_attn_loss: 1.12190 loss: -36.39564]
Iterations:  10%|█         | 3/30 [00:10<01:23,  3.09s/it, attack_loss: -48.62551 variance_cross_attn_loss: 0.05771 self_attn_loss: 1.13617 loss: -47.43163]
Iterations:  13%|█▎        | 4/30 [00:12<01:17,  2.98s/it, attack_loss: -48.62551 variance_cross_attn_loss: 0.05771 self_attn_loss: 1.13617 loss: -47.43163]
Iterations:  13%|█▎        | 4/30 [00:13<01:17,  2.98s/it, attack_loss: -56.66725 variance_cross_attn_loss: 0.05360 self_attn_loss: 1.19478 loss: -55.41887]
Iterations:  17%|█▋        | 5/30 [00:14<01:11,  2.88s/it, attack_loss: -56.66725 variance_cross_attn_loss: 0.05360 self_attn_loss: 1.19478 loss: -55.41887]
Iterations:  17%|█▋        | 5/30 [00:16<01:11,  2.88s/it, attack_loss: -66.72945 variance_cross_attn_loss: 0.05032 self_attn_loss: 1.30640 loss: -65.37273]
Iterations:  20%|██        | 6/30 [00:18<01:12,  3.00s/it, attack_loss: -66.72945 variance_cross_attn_loss: 0.05032 self_attn_loss: 1.30640 loss: -65.37273]
Iterations:  20%|██        | 6/30 [00:19<01:12,  3.00s/it, attack_loss: -78.38637 variance_cross_attn_loss: 0.04916 self_attn_loss: 1.40476 loss: -76.93244]
Iterations:  23%|██▎       | 7/30 [00:21<01:10,  3.08s/it, attack_loss: -78.38637 variance_cross_attn_loss: 0.04916 self_attn_loss: 1.40476 loss: -76.93244]
Iterations:  23%|██▎       | 7/30 [00:23<01:10,  3.08s/it, attack_loss: -91.60834 variance_cross_attn_loss: 0.04909 self_attn_loss: 1.50336 loss: -90.05589]
Iterations:  27%|██▋       | 8/30 [00:24<01:08,  3.10s/it, attack_loss: -91.60834 variance_cross_attn_loss: 0.04909 self_attn_loss: 1.50336 loss: -90.05589]
Iterations:  27%|██▋       | 8/30 [00:26<01:08,  3.10s/it, attack_loss: -105.83931 variance_cross_attn_loss: 0.04824 self_attn_loss: 1.60255 loss: -104.18852]
Iterations:  30%|███       | 9/30 [00:27<01:05,  3.11s/it, attack_loss: -105.83931 variance_cross_attn_loss: 0.04824 self_attn_loss: 1.60255 loss: -104.18852]
Iterations:  30%|███       | 9/30 [00:29<01:05,  3.11s/it, attack_loss: -123.15820 variance_cross_attn_loss: 0.04702 self_attn_loss: 1.68731 loss: -121.42388]
Iterations:  33%|███▎      | 10/30 [00:30<01:03,  3.16s/it, attack_loss: -123.15820 variance_cross_attn_loss: 0.04702 self_attn_loss: 1.68731 loss: -121.42388]
Iterations:  33%|███▎      | 10/30 [00:32<01:03,  3.16s/it, attack_loss: -143.55124 variance_cross_attn_loss: 0.04561 self_attn_loss: 1.85106 loss: -141.65457]
Iterations:  37%|███▋      | 11/30 [00:33<00:59,  3.11s/it, attack_loss: -143.55124 variance_cross_attn_loss: 0.04561 self_attn_loss: 1.85106 loss: -141.65457]
Iterations:  37%|███▋      | 11/30 [00:35<00:59,  3.11s/it, attack_loss: -161.66296 variance_cross_attn_loss: 0.04643 self_attn_loss: 1.94026 loss: -159.67627]
Iterations:  40%|████      | 12/30 [00:36<00:53,  2.96s/it, attack_loss: -161.66296 variance_cross_attn_loss: 0.04643 self_attn_loss: 1.94026 loss: -159.67627]
Iterations:  40%|████      | 12/30 [00:37<00:53,  2.96s/it, attack_loss: -180.51210 variance_cross_attn_loss: 0.04651 self_attn_loss: 1.96112 loss: -178.50447]
Iterations:  43%|████▎     | 13/30 [00:39<00:48,  2.88s/it, attack_loss: -180.51210 variance_cross_attn_loss: 0.04651 self_attn_loss: 1.96112 loss: -178.50447]
Iterations:  43%|████▎     | 13/30 [00:40<00:48,  2.88s/it, attack_loss: -198.33931 variance_cross_attn_loss: 0.04703 self_attn_loss: 2.00380 loss: -196.28848]
Iterations:  47%|████▋     | 14/30 [00:42<00:48,  3.05s/it, attack_loss: -198.33931 variance_cross_attn_loss: 0.04703 self_attn_loss: 2.00380 loss: -196.28848]
Iterations:  47%|████▋     | 14/30 [00:44<00:48,  3.05s/it, attack_loss: -213.52899 variance_cross_attn_loss: 0.04854 self_attn_loss: 1.98334 loss: -211.49712]
Iterations:  50%|█████     | 15/30 [00:45<00:47,  3.14s/it, attack_loss: -213.52899 variance_cross_attn_loss: 0.04854 self_attn_loss: 1.98334 loss: -211.49712]
Iterations:  50%|█████     | 15/30 [00:47<00:47,  3.14s/it, attack_loss: -226.74258 variance_cross_attn_loss: 0.05021 self_attn_loss: 2.02557 loss: -224.66679]
Iterations:  53%|█████▎    | 16/30 [00:49<00:45,  3.22s/it, attack_loss: -226.74258 variance_cross_attn_loss: 0.05021 self_attn_loss: 2.02557 loss: -224.66679]
Iterations:  53%|█████▎    | 16/30 [00:51<00:45,  3.22s/it, attack_loss: -236.65933 variance_cross_attn_loss: 0.05059 self_attn_loss: 1.95864 loss: -234.65010]
Iterations:  57%|█████▋    | 17/30 [00:52<00:41,  3.19s/it, attack_loss: -236.65933 variance_cross_attn_loss: 0.05059 self_attn_loss: 1.95864 loss: -234.65010]
Iterations:  57%|█████▋    | 17/30 [00:54<00:41,  3.19s/it, attack_loss: -246.81116 variance_cross_attn_loss: 0.05065 self_attn_loss: 2.18179 loss: -244.57872]
Iterations:  60%|██████    | 18/30 [00:55<00:37,  3.16s/it, attack_loss: -246.81116 variance_cross_attn_loss: 0.05065 self_attn_loss: 2.18179 loss: -244.57872]
Iterations:  60%|██████    | 18/30 [00:57<00:37,  3.16s/it, attack_loss: -252.11266 variance_cross_attn_loss: 0.05026 self_attn_loss: 2.35044 loss: -249.71196]
Iterations:  63%|██████▎   | 19/30 [00:58<00:33,  3.00s/it, attack_loss: -252.11266 variance_cross_attn_loss: 0.05026 self_attn_loss: 2.35044 loss: -249.71196]
Iterations:  63%|██████▎   | 19/30 [00:59<00:33,  3.00s/it, attack_loss: -266.47943 variance_cross_attn_loss: 0.05103 self_attn_loss: 2.26790 loss: -264.16049]
Iterations:  67%|██████▋   | 20/30 [01:00<00:29,  2.90s/it, attack_loss: -266.47943 variance_cross_attn_loss: 0.05103 self_attn_loss: 2.26790 loss: -264.16049]
Iterations:  67%|██████▋   | 20/30 [01:02<00:29,  2.90s/it, attack_loss: -277.47092 variance_cross_attn_loss: 0.05331 self_attn_loss: 2.22380 loss: -275.19379]
Iterations:  70%|███████   | 21/30 [01:04<00:26,  2.98s/it, attack_loss: -277.47092 variance_cross_attn_loss: 0.05331 self_attn_loss: 2.22380 loss: -275.19379]
Iterations:  70%|███████   | 21/30 [01:05<00:26,  2.98s/it, attack_loss: -287.35144 variance_cross_attn_loss: 0.05505 self_attn_loss: 2.23368 loss: -285.06271]
Iterations:  73%|███████▎  | 22/30 [01:07<00:24,  3.05s/it, attack_loss: -287.35144 variance_cross_attn_loss: 0.05505 self_attn_loss: 2.23368 loss: -285.06271]
Iterations:  73%|███████▎  | 22/30 [01:08<00:24,  3.05s/it, attack_loss: -297.71732 variance_cross_attn_loss: 0.05569 self_attn_loss: 2.29191 loss: -295.36972]
Iterations:  77%|███████▋  | 23/30 [01:10<00:21,  3.08s/it, attack_loss: -297.71732 variance_cross_attn_loss: 0.05569 self_attn_loss: 2.29191 loss: -295.36972]
Iterations:  77%|███████▋  | 23/30 [01:12<00:21,  3.08s/it, attack_loss: -309.78928 variance_cross_attn_loss: 0.05454 self_attn_loss: 2.32785 loss: -307.40689]
Iterations:  80%|████████  | 24/30 [01:13<00:19,  3.18s/it, attack_loss: -309.78928 variance_cross_attn_loss: 0.05454 self_attn_loss: 2.32785 loss: -307.40689]
Iterations:  80%|████████  | 24/30 [01:15<00:19,  3.18s/it, attack_loss: -319.43652 variance_cross_attn_loss: 0.05307 self_attn_loss: 2.33005 loss: -317.05341]
Iterations:  83%|████████▎ | 25/30 [01:16<00:15,  3.16s/it, attack_loss: -319.43652 variance_cross_attn_loss: 0.05307 self_attn_loss: 2.33005 loss: -317.05341]
Iterations:  83%|████████▎ | 25/30 [01:18<00:15,  3.16s/it, attack_loss: -329.71347 variance_cross_attn_loss: 0.05237 self_attn_loss: 2.34561 loss: -327.31549]
Iterations:  87%|████████▋ | 26/30 [01:20<00:12,  3.16s/it, attack_loss: -329.71347 variance_cross_attn_loss: 0.05237 self_attn_loss: 2.34561 loss: -327.31549]
Iterations:  87%|████████▋ | 26/30 [01:21<00:12,  3.16s/it, attack_loss: -340.70197 variance_cross_attn_loss: 0.05255 self_attn_loss: 2.33928 loss: -338.31015]
Iterations:  90%|█████████ | 27/30 [01:22<00:09,  3.01s/it, attack_loss: -340.70197 variance_cross_attn_loss: 0.05255 self_attn_loss: 2.33928 loss: -338.31015]
Iterations:  90%|█████████ | 27/30 [01:24<00:09,  3.01s/it, attack_loss: -352.11975 variance_cross_attn_loss: 0.05290 self_attn_loss: 2.37101 loss: -349.69586]
Iterations:  93%|█████████▎| 28/30 [01:25<00:05,  2.90s/it, attack_loss: -352.11975 variance_cross_attn_loss: 0.05290 self_attn_loss: 2.37101 loss: -349.69586]
Iterations:  93%|█████████▎| 28/30 [01:26<00:05,  2.90s/it, attack_loss: -363.36456 variance_cross_attn_loss: 0.05361 self_attn_loss: 2.40853 loss: -360.90240]
Iterations:  97%|█████████▋| 29/30 [01:28<00:02,  2.85s/it, attack_loss: -363.36456 variance_cross_attn_loss: 0.05361 self_attn_loss: 2.40853 loss: -360.90240]
Iterations:  97%|█████████▋| 29/30 [01:30<00:02,  2.85s/it, attack_loss: -375.21375 variance_cross_attn_loss: 0.05421 self_attn_loss: 2.42611 loss: -372.73343]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.05s/it, attack_loss: -375.21375 variance_cross_attn_loss: 0.05421 self_attn_loss: 2.42611 loss: -372.73343]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.06s/it, attack_loss: -375.21375 variance_cross_attn_loss: 0.05421 self_attn_loss: 2.42611 loss: -372.73343]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([55], device='cuda:0') tensor(0.5682, device='cuda:0')
after_true: tensor([324], device='cuda:0') tensor(1.5394e-17, device='cuda:0')
L1: [6475.7095]	L2: [23.839241]	Linf: [0.6431373]

Accuracy on benign examples: 100.0%
gt_label: 759 pred_label: 759 pred_clean_logit 0.9951533079147339
prompt generate:  reflex camera  	labels:  [[759]]
decoder:  [49406, 36050, 3934, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  3.89it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:30<00:00,  6.20s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -0.10091 variance_cross_attn_loss: 0.04729 self_attn_loss: 0.00000 loss: -0.05363]
Iterations:   3%|▎         | 1/30 [00:02<01:23,  2.87s/it, attack_loss: -0.10091 variance_cross_attn_loss: 0.04729 self_attn_loss: 0.00000 loss: -0.05363]
Iterations:   3%|▎         | 1/30 [00:04<01:23,  2.87s/it, attack_loss: -6.20976 variance_cross_attn_loss: 0.04914 self_attn_loss: 2.01514 loss: -4.14548]
Iterations:   7%|▋         | 2/30 [00:06<01:27,  3.11s/it, attack_loss: -6.20976 variance_cross_attn_loss: 0.04914 self_attn_loss: 2.01514 loss: -4.14548]
Iterations:   7%|▋         | 2/30 [00:07<01:27,  3.11s/it, attack_loss: -12.93653 variance_cross_attn_loss: 0.04515 self_attn_loss: 1.82888 loss: -11.06250]
Iterations:  10%|█         | 3/30 [00:09<01:24,  3.11s/it, attack_loss: -12.93653 variance_cross_attn_loss: 0.04515 self_attn_loss: 1.82888 loss: -11.06250]
Iterations:  10%|█         | 3/30 [00:10<01:24,  3.11s/it, attack_loss: -27.82208 variance_cross_attn_loss: 0.04477 self_attn_loss: 2.25407 loss: -25.52325]
Iterations:  13%|█▎        | 4/30 [00:12<01:22,  3.16s/it, attack_loss: -27.82208 variance_cross_attn_loss: 0.04477 self_attn_loss: 2.25407 loss: -25.52325]
Iterations:  13%|█▎        | 4/30 [00:14<01:22,  3.16s/it, attack_loss: -37.52922 variance_cross_attn_loss: 0.04560 self_attn_loss: 2.39945 loss: -35.08417]
Iterations:  17%|█▋        | 5/30 [00:16<01:22,  3.30s/it, attack_loss: -37.52922 variance_cross_attn_loss: 0.04560 self_attn_loss: 2.39945 loss: -35.08417]
Iterations:  17%|█▋        | 5/30 [00:17<01:22,  3.30s/it, attack_loss: -60.88770 variance_cross_attn_loss: 0.04525 self_attn_loss: 2.40932 loss: -58.43312]
Iterations:  20%|██        | 6/30 [00:18<01:15,  3.13s/it, attack_loss: -60.88770 variance_cross_attn_loss: 0.04525 self_attn_loss: 2.40932 loss: -58.43312]
Iterations:  20%|██        | 6/30 [00:20<01:15,  3.13s/it, attack_loss: -64.48641 variance_cross_attn_loss: 0.04334 self_attn_loss: 2.00257 loss: -62.44051]
Iterations:  23%|██▎       | 7/30 [00:21<01:08,  2.98s/it, attack_loss: -64.48641 variance_cross_attn_loss: 0.04334 self_attn_loss: 2.00257 loss: -62.44051]
Iterations:  23%|██▎       | 7/30 [00:23<01:08,  2.98s/it, attack_loss: -81.37615 variance_cross_attn_loss: 0.04501 self_attn_loss: 2.46843 loss: -78.86271]
Iterations:  27%|██▋       | 8/30 [00:24<01:03,  2.90s/it, attack_loss: -81.37615 variance_cross_attn_loss: 0.04501 self_attn_loss: 2.46843 loss: -78.86271]
Iterations:  27%|██▋       | 8/30 [00:25<01:03,  2.90s/it, attack_loss: -85.75558 variance_cross_attn_loss: 0.04388 self_attn_loss: 2.77368 loss: -82.93802]
Iterations:  30%|███       | 9/30 [00:27<01:02,  2.96s/it, attack_loss: -85.75558 variance_cross_attn_loss: 0.04388 self_attn_loss: 2.77368 loss: -82.93802]
Iterations:  30%|███       | 9/30 [00:29<01:02,  2.96s/it, attack_loss: -91.27843 variance_cross_attn_loss: 0.04375 self_attn_loss: 2.90962 loss: -88.32506]
Iterations:  33%|███▎      | 10/30 [00:30<01:00,  3.04s/it, attack_loss: -91.27843 variance_cross_attn_loss: 0.04375 self_attn_loss: 2.90962 loss: -88.32506]
Iterations:  33%|███▎      | 10/30 [00:32<01:00,  3.04s/it, attack_loss: -101.02174 variance_cross_attn_loss: 0.04343 self_attn_loss: 3.02509 loss: -97.95322]
Iterations:  37%|███▋      | 11/30 [00:33<00:58,  3.08s/it, attack_loss: -101.02174 variance_cross_attn_loss: 0.04343 self_attn_loss: 3.02509 loss: -97.95322]
Iterations:  37%|███▋      | 11/30 [00:35<00:58,  3.08s/it, attack_loss: -107.93909 variance_cross_attn_loss: 0.04394 self_attn_loss: 3.12112 loss: -104.77402]
Iterations:  40%|████      | 12/30 [00:37<00:56,  3.15s/it, attack_loss: -107.93909 variance_cross_attn_loss: 0.04394 self_attn_loss: 3.12112 loss: -104.77402]
Iterations:  40%|████      | 12/30 [00:38<00:56,  3.15s/it, attack_loss: -114.56132 variance_cross_attn_loss: 0.04435 self_attn_loss: 3.20859 loss: -111.30839]
Iterations:  43%|████▎     | 13/30 [00:40<00:54,  3.21s/it, attack_loss: -114.56132 variance_cross_attn_loss: 0.04435 self_attn_loss: 3.20859 loss: -111.30839]
Iterations:  43%|████▎     | 13/30 [00:42<00:54,  3.21s/it, attack_loss: -120.15370 variance_cross_attn_loss: 0.04499 self_attn_loss: 3.16690 loss: -116.94181]
Iterations:  47%|████▋     | 14/30 [00:43<00:50,  3.16s/it, attack_loss: -120.15370 variance_cross_attn_loss: 0.04499 self_attn_loss: 3.16690 loss: -116.94181]
Iterations:  47%|████▋     | 14/30 [00:44<00:50,  3.16s/it, attack_loss: -126.10817 variance_cross_attn_loss: 0.04547 self_attn_loss: 3.17771 loss: -122.88499]
Iterations:  50%|█████     | 15/30 [00:46<00:45,  3.02s/it, attack_loss: -126.10817 variance_cross_attn_loss: 0.04547 self_attn_loss: 3.17771 loss: -122.88499]
Iterations:  50%|█████     | 15/30 [00:47<00:45,  3.02s/it, attack_loss: -137.40160 variance_cross_attn_loss: 0.04526 self_attn_loss: 3.21311 loss: -134.14323]
Iterations:  53%|█████▎    | 16/30 [00:48<00:41,  2.93s/it, attack_loss: -137.40160 variance_cross_attn_loss: 0.04526 self_attn_loss: 3.21311 loss: -134.14323]
Iterations:  53%|█████▎    | 16/30 [00:50<00:41,  2.93s/it, attack_loss: -153.30887 variance_cross_attn_loss: 0.04523 self_attn_loss: 3.28220 loss: -149.98145]
Iterations:  57%|█████▋    | 17/30 [00:52<00:39,  3.00s/it, attack_loss: -153.30887 variance_cross_attn_loss: 0.04523 self_attn_loss: 3.28220 loss: -149.98145]
Iterations:  57%|█████▋    | 17/30 [00:53<00:39,  3.00s/it, attack_loss: -161.58235 variance_cross_attn_loss: 0.04515 self_attn_loss: 3.27096 loss: -158.26624]
Iterations:  60%|██████    | 18/30 [00:55<00:36,  3.06s/it, attack_loss: -161.58235 variance_cross_attn_loss: 0.04515 self_attn_loss: 3.27096 loss: -158.26624]
Iterations:  60%|██████    | 18/30 [00:56<00:36,  3.06s/it, attack_loss: -173.28912 variance_cross_attn_loss: 0.04499 self_attn_loss: 3.35371 loss: -169.89043]
Iterations:  63%|██████▎   | 19/30 [00:58<00:34,  3.11s/it, attack_loss: -173.28912 variance_cross_attn_loss: 0.04499 self_attn_loss: 3.35371 loss: -169.89043]
Iterations:  63%|██████▎   | 19/30 [01:00<00:34,  3.11s/it, attack_loss: -183.38724 variance_cross_attn_loss: 0.04500 self_attn_loss: 3.27750 loss: -180.06474]
Iterations:  67%|██████▋   | 20/30 [01:01<00:31,  3.13s/it, attack_loss: -183.38724 variance_cross_attn_loss: 0.04500 self_attn_loss: 3.27750 loss: -180.06474]
Iterations:  67%|██████▋   | 20/30 [01:03<00:31,  3.13s/it, attack_loss: -188.75505 variance_cross_attn_loss: 0.04518 self_attn_loss: 3.24227 loss: -185.46761]
Iterations:  70%|███████   | 21/30 [01:04<00:27,  3.03s/it, attack_loss: -188.75505 variance_cross_attn_loss: 0.04518 self_attn_loss: 3.24227 loss: -185.46761]
Iterations:  70%|███████   | 21/30 [01:05<00:27,  3.03s/it, attack_loss: -200.20459 variance_cross_attn_loss: 0.04512 self_attn_loss: 3.21930 loss: -196.94017]
Iterations:  73%|███████▎  | 22/30 [01:06<00:22,  2.79s/it, attack_loss: -200.20459 variance_cross_attn_loss: 0.04512 self_attn_loss: 3.21930 loss: -196.94017]
Iterations:  73%|███████▎  | 22/30 [01:08<00:22,  2.79s/it, attack_loss: -209.07413 variance_cross_attn_loss: 0.04493 self_attn_loss: 3.18698 loss: -205.84222]
Iterations:  77%|███████▋  | 23/30 [01:09<00:19,  2.81s/it, attack_loss: -209.07413 variance_cross_attn_loss: 0.04493 self_attn_loss: 3.18698 loss: -205.84222]
Iterations:  77%|███████▋  | 23/30 [01:11<00:19,  2.81s/it, attack_loss: -202.00504 variance_cross_attn_loss: 0.04442 self_attn_loss: 3.04354 loss: -198.91708]
Iterations:  80%|████████  | 24/30 [01:12<00:17,  2.86s/it, attack_loss: -202.00504 variance_cross_attn_loss: 0.04442 self_attn_loss: 3.04354 loss: -198.91708]
Iterations:  80%|████████  | 24/30 [01:14<00:17,  2.86s/it, attack_loss: -213.72984 variance_cross_attn_loss: 0.04460 self_attn_loss: 3.02222 loss: -210.66302]
Iterations:  83%|████████▎ | 25/30 [01:15<00:14,  2.94s/it, attack_loss: -213.72984 variance_cross_attn_loss: 0.04460 self_attn_loss: 3.02222 loss: -210.66302]
Iterations:  83%|████████▎ | 25/30 [01:17<00:14,  2.94s/it, attack_loss: -223.24739 variance_cross_attn_loss: 0.04457 self_attn_loss: 3.02208 loss: -220.18074]
Iterations:  87%|████████▋ | 26/30 [01:19<00:12,  3.14s/it, attack_loss: -223.24739 variance_cross_attn_loss: 0.04457 self_attn_loss: 3.02208 loss: -220.18074]
Iterations:  87%|████████▋ | 26/30 [01:21<00:12,  3.14s/it, attack_loss: -230.56364 variance_cross_attn_loss: 0.04449 self_attn_loss: 3.02292 loss: -227.49623]
Iterations:  90%|█████████ | 27/30 [01:22<00:09,  3.18s/it, attack_loss: -230.56364 variance_cross_attn_loss: 0.04449 self_attn_loss: 3.02292 loss: -227.49623]
Iterations:  90%|█████████ | 27/30 [01:24<00:09,  3.18s/it, attack_loss: -239.73737 variance_cross_attn_loss: 0.04465 self_attn_loss: 3.10216 loss: -236.59056]
Iterations:  93%|█████████▎| 28/30 [01:25<00:06,  3.24s/it, attack_loss: -239.73737 variance_cross_attn_loss: 0.04465 self_attn_loss: 3.10216 loss: -236.59056]
Iterations:  93%|█████████▎| 28/30 [01:27<00:06,  3.24s/it, attack_loss: -246.17844 variance_cross_attn_loss: 0.04467 self_attn_loss: 3.19646 loss: -242.93730]
Iterations:  97%|█████████▋| 29/30 [01:29<00:03,  3.22s/it, attack_loss: -246.17844 variance_cross_attn_loss: 0.04467 self_attn_loss: 3.19646 loss: -242.93730]
Iterations:  97%|█████████▋| 29/30 [01:30<00:03,  3.22s/it, attack_loss: -251.66422 variance_cross_attn_loss: 0.04522 self_attn_loss: 3.25709 loss: -248.36189]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.06s/it, attack_loss: -251.66422 variance_cross_attn_loss: 0.04522 self_attn_loss: 3.25709 loss: -248.36189]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.06s/it, attack_loss: -251.66422 variance_cross_attn_loss: 0.04522 self_attn_loss: 3.25709 loss: -248.36189]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([704], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([759], device='cuda:0') tensor(5.0605e-12, device='cuda:0')
L1: [5597.3687]	L2: [23.767752]	Linf: [0.6666667]

Accuracy on benign examples: 0.0%
gt_label: 634 pred_label: 388 pred_clean_logit 0.00823988951742649
prompt generate:  lumbermill  	labels:  [[388]]
decoder:  [49406, 27421, 6637, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.01it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:32<00:00,  6.46s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -44.48468 variance_cross_attn_loss: 0.01586 self_attn_loss: 0.00000 loss: -44.46882]
Iterations:   3%|▎         | 1/30 [00:02<01:25,  2.96s/it, attack_loss: -44.48468 variance_cross_attn_loss: 0.01586 self_attn_loss: 0.00000 loss: -44.46882]
Iterations:   3%|▎         | 1/30 [00:04<01:25,  2.96s/it, attack_loss: -66.73033 variance_cross_attn_loss: 0.01429 self_attn_loss: 0.97855 loss: -65.73749]
Iterations:   7%|▋         | 2/30 [00:05<01:19,  2.83s/it, attack_loss: -66.73033 variance_cross_attn_loss: 0.01429 self_attn_loss: 0.97855 loss: -65.73749]
Iterations:   7%|▋         | 2/30 [00:07<01:19,  2.83s/it, attack_loss: -92.56673 variance_cross_attn_loss: 0.01416 self_attn_loss: 1.39402 loss: -91.15854]
Iterations:  10%|█         | 3/30 [00:08<01:14,  2.74s/it, attack_loss: -92.56673 variance_cross_attn_loss: 0.01416 self_attn_loss: 1.39402 loss: -91.15854]
Iterations:  10%|█         | 3/30 [00:09<01:14,  2.74s/it, attack_loss: -125.46440 variance_cross_attn_loss: 0.01369 self_attn_loss: 1.43913 loss: -124.01158]
Iterations:  13%|█▎        | 4/30 [00:11<01:14,  2.87s/it, attack_loss: -125.46440 variance_cross_attn_loss: 0.01369 self_attn_loss: 1.43913 loss: -124.01158]
Iterations:  13%|█▎        | 4/30 [00:13<01:14,  2.87s/it, attack_loss: -167.11365 variance_cross_attn_loss: 0.01356 self_attn_loss: 1.52276 loss: -165.57733]
Iterations:  17%|█▋        | 5/30 [00:14<01:14,  2.97s/it, attack_loss: -167.11365 variance_cross_attn_loss: 0.01356 self_attn_loss: 1.52276 loss: -165.57733]
Iterations:  17%|█▋        | 5/30 [00:16<01:14,  2.97s/it, attack_loss: -196.69455 variance_cross_attn_loss: 0.01353 self_attn_loss: 1.60455 loss: -195.07646]
Iterations:  20%|██        | 6/30 [00:17<01:12,  3.02s/it, attack_loss: -196.69455 variance_cross_attn_loss: 0.01353 self_attn_loss: 1.60455 loss: -195.07646]
Iterations:  20%|██        | 6/30 [00:19<01:12,  3.02s/it, attack_loss: -211.48660 variance_cross_attn_loss: 0.01372 self_attn_loss: 1.71820 loss: -209.75468]
Iterations:  23%|██▎       | 7/30 [00:20<01:10,  3.07s/it, attack_loss: -211.48660 variance_cross_attn_loss: 0.01372 self_attn_loss: 1.71820 loss: -209.75468]
Iterations:  23%|██▎       | 7/30 [00:22<01:10,  3.07s/it, attack_loss: -224.73579 variance_cross_attn_loss: 0.01373 self_attn_loss: 1.83412 loss: -222.88794]
Iterations:  27%|██▋       | 8/30 [00:24<01:08,  3.11s/it, attack_loss: -224.73579 variance_cross_attn_loss: 0.01373 self_attn_loss: 1.83412 loss: -222.88794]
Iterations:  27%|██▋       | 8/30 [00:25<01:08,  3.11s/it, attack_loss: -243.05739 variance_cross_attn_loss: 0.01368 self_attn_loss: 1.86772 loss: -241.17598]
Iterations:  30%|███       | 9/30 [00:26<01:02,  3.00s/it, attack_loss: -243.05739 variance_cross_attn_loss: 0.01368 self_attn_loss: 1.86772 loss: -241.17598]
Iterations:  30%|███       | 9/30 [00:28<01:02,  3.00s/it, attack_loss: -260.57858 variance_cross_attn_loss: 0.01460 self_attn_loss: 1.82128 loss: -258.74271]
Iterations:  33%|███▎      | 10/30 [00:29<00:57,  2.90s/it, attack_loss: -260.57858 variance_cross_attn_loss: 0.01460 self_attn_loss: 1.82128 loss: -258.74271]
Iterations:  33%|███▎      | 10/30 [00:30<00:57,  2.90s/it, attack_loss: -271.55362 variance_cross_attn_loss: 0.01480 self_attn_loss: 1.84930 loss: -269.68951]
Iterations:  37%|███▋      | 11/30 [00:32<00:53,  2.83s/it, attack_loss: -271.55362 variance_cross_attn_loss: 0.01480 self_attn_loss: 1.84930 loss: -269.68951]
Iterations:  37%|███▋      | 11/30 [00:33<00:53,  2.83s/it, attack_loss: -287.16080 variance_cross_attn_loss: 0.01485 self_attn_loss: 1.88162 loss: -285.26431]
Iterations:  40%|████      | 12/30 [00:35<00:52,  2.90s/it, attack_loss: -287.16080 variance_cross_attn_loss: 0.01485 self_attn_loss: 1.88162 loss: -285.26431]
Iterations:  40%|████      | 12/30 [00:36<00:52,  2.90s/it, attack_loss: -305.59320 variance_cross_attn_loss: 0.01479 self_attn_loss: 1.91636 loss: -303.66205]
Iterations:  43%|████▎     | 13/30 [00:38<00:50,  2.98s/it, attack_loss: -305.59320 variance_cross_attn_loss: 0.01479 self_attn_loss: 1.91636 loss: -303.66205]
Iterations:  43%|████▎     | 13/30 [00:40<00:50,  2.98s/it, attack_loss: -319.22009 variance_cross_attn_loss: 0.01469 self_attn_loss: 1.96756 loss: -317.23785]
Iterations:  47%|████▋     | 14/30 [00:41<00:48,  3.04s/it, attack_loss: -319.22009 variance_cross_attn_loss: 0.01469 self_attn_loss: 1.96756 loss: -317.23785]
Iterations:  47%|████▋     | 14/30 [00:43<00:48,  3.04s/it, attack_loss: -335.59201 variance_cross_attn_loss: 0.01464 self_attn_loss: 1.99034 loss: -333.58704]
Iterations:  50%|█████     | 15/30 [00:44<00:46,  3.09s/it, attack_loss: -335.59201 variance_cross_attn_loss: 0.01464 self_attn_loss: 1.99034 loss: -333.58704]
Iterations:  50%|█████     | 15/30 [00:46<00:46,  3.09s/it, attack_loss: -349.92093 variance_cross_attn_loss: 0.01456 self_attn_loss: 2.00022 loss: -347.90616]
Iterations:  53%|█████▎    | 16/30 [00:48<00:45,  3.22s/it, attack_loss: -349.92093 variance_cross_attn_loss: 0.01456 self_attn_loss: 2.00022 loss: -347.90616]
Iterations:  53%|█████▎    | 16/30 [00:49<00:45,  3.22s/it, attack_loss: -361.01407 variance_cross_attn_loss: 0.01441 self_attn_loss: 2.02119 loss: -358.97849]
Iterations:  57%|█████▋    | 17/30 [00:51<00:40,  3.11s/it, attack_loss: -361.01407 variance_cross_attn_loss: 0.01441 self_attn_loss: 2.02119 loss: -358.97849]
Iterations:  57%|█████▋    | 17/30 [00:52<00:40,  3.11s/it, attack_loss: -375.21786 variance_cross_attn_loss: 0.01431 self_attn_loss: 2.03364 loss: -373.16992]
Iterations:  60%|██████    | 18/30 [00:54<00:37,  3.11s/it, attack_loss: -375.21786 variance_cross_attn_loss: 0.01431 self_attn_loss: 2.03364 loss: -373.16992]
Iterations:  60%|██████    | 18/30 [00:55<00:37,  3.11s/it, attack_loss: -381.44354 variance_cross_attn_loss: 0.01421 self_attn_loss: 2.05091 loss: -379.37842]
Iterations:  63%|██████▎   | 19/30 [00:56<00:32,  2.97s/it, attack_loss: -381.44354 variance_cross_attn_loss: 0.01421 self_attn_loss: 2.05091 loss: -379.37842]
Iterations:  63%|██████▎   | 19/30 [00:58<00:32,  2.97s/it, attack_loss: -389.40579 variance_cross_attn_loss: 0.01423 self_attn_loss: 2.06554 loss: -387.32602]
Iterations:  67%|██████▋   | 20/30 [01:00<00:31,  3.15s/it, attack_loss: -389.40579 variance_cross_attn_loss: 0.01423 self_attn_loss: 2.06554 loss: -387.32602]
Iterations:  67%|██████▋   | 20/30 [01:02<00:31,  3.15s/it, attack_loss: -401.84412 variance_cross_attn_loss: 0.01404 self_attn_loss: 2.12764 loss: -399.70242]
Iterations:  70%|███████   | 21/30 [01:03<00:28,  3.16s/it, attack_loss: -401.84412 variance_cross_attn_loss: 0.01404 self_attn_loss: 2.12764 loss: -399.70242]
Iterations:  70%|███████   | 21/30 [01:05<00:28,  3.16s/it, attack_loss: -411.85870 variance_cross_attn_loss: 0.01397 self_attn_loss: 2.14848 loss: -409.69626]
Iterations:  73%|███████▎  | 22/30 [01:07<00:25,  3.23s/it, attack_loss: -411.85870 variance_cross_attn_loss: 0.01397 self_attn_loss: 2.14848 loss: -409.69626]
Iterations:  73%|███████▎  | 22/30 [01:08<00:25,  3.23s/it, attack_loss: -424.84827 variance_cross_attn_loss: 0.01403 self_attn_loss: 2.14295 loss: -422.69128]
Iterations:  77%|███████▋  | 23/30 [01:10<00:23,  3.29s/it, attack_loss: -424.84827 variance_cross_attn_loss: 0.01403 self_attn_loss: 2.14295 loss: -422.69128]
Iterations:  77%|███████▋  | 23/30 [01:12<00:23,  3.29s/it, attack_loss: -435.39871 variance_cross_attn_loss: 0.01411 self_attn_loss: 2.13726 loss: -433.24734]
Iterations:  80%|████████  | 24/30 [01:13<00:19,  3.25s/it, attack_loss: -435.39871 variance_cross_attn_loss: 0.01411 self_attn_loss: 2.13726 loss: -433.24734]
Iterations:  80%|████████  | 24/30 [01:15<00:19,  3.25s/it, attack_loss: -446.08252 variance_cross_attn_loss: 0.01418 self_attn_loss: 2.13701 loss: -443.93130]
Iterations:  83%|████████▎ | 25/30 [01:16<00:15,  3.09s/it, attack_loss: -446.08252 variance_cross_attn_loss: 0.01418 self_attn_loss: 2.13701 loss: -443.93130]
Iterations:  83%|████████▎ | 25/30 [01:17<00:15,  3.09s/it, attack_loss: -450.30768 variance_cross_attn_loss: 0.01413 self_attn_loss: 2.14457 loss: -448.14899]
Iterations:  87%|████████▋ | 26/30 [01:19<00:12,  3.06s/it, attack_loss: -450.30768 variance_cross_attn_loss: 0.01413 self_attn_loss: 2.14457 loss: -448.14899]
Iterations:  87%|████████▋ | 26/30 [01:20<00:12,  3.06s/it, attack_loss: -460.19577 variance_cross_attn_loss: 0.01401 self_attn_loss: 2.19816 loss: -457.98361]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.92s/it, attack_loss: -460.19577 variance_cross_attn_loss: 0.01401 self_attn_loss: 2.19816 loss: -457.98361]
Iterations:  90%|█████████ | 27/30 [01:23<00:08,  2.92s/it, attack_loss: -468.37219 variance_cross_attn_loss: 0.01400 self_attn_loss: 2.22702 loss: -466.13116]
Iterations:  93%|█████████▎| 28/30 [01:25<00:05,  3.00s/it, attack_loss: -468.37219 variance_cross_attn_loss: 0.01400 self_attn_loss: 2.22702 loss: -466.13116]
Iterations:  93%|█████████▎| 28/30 [01:26<00:05,  3.00s/it, attack_loss: -478.83002 variance_cross_attn_loss: 0.01403 self_attn_loss: 2.23870 loss: -476.57727]
Iterations:  97%|█████████▋| 29/30 [01:28<00:03,  3.05s/it, attack_loss: -478.83002 variance_cross_attn_loss: 0.01403 self_attn_loss: 2.23870 loss: -476.57727]
Iterations:  97%|█████████▋| 29/30 [01:29<00:03,  3.05s/it, attack_loss: -487.55600 variance_cross_attn_loss: 0.01406 self_attn_loss: 2.25551 loss: -485.28641]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.07s/it, attack_loss: -487.55600 variance_cross_attn_loss: 0.01406 self_attn_loss: 2.25551 loss: -485.28641]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.05s/it, attack_loss: -487.55600 variance_cross_attn_loss: 0.01406 self_attn_loss: 2.25551 loss: -485.28641]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([388], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([634], device='cuda:0') tensor(2.6173e-22, device='cuda:0')
L1: [7070.3926]	L2: [27.585947]	Linf: [0.6901961]
Clean acc: 0.0%
Adv acc: 0.0%

*********Transfer to resnet********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 0.0%

*********Transfer to vgg********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to mobile********
Accuracy on benign examples: 72.72727272727273%
Accuracy on adversarial examples: 0.0%

*********Transfer to inception********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to convnext********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to vit********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to swin********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to deit-b********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to deit-s********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 27.27272727272727%

*********Transfer to mixer-b********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to mixer-l********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 18.181818181818183%
Warning: batch size is bigger than the data size. Setting batch size to data size

FID:  317.9945726384158

*********fid: 317.9945726384158********
