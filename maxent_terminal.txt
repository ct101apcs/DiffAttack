
******Attack based on Diffusion, Attacked Dataset: imagenet_compatible*********

Loading pipeline components...: 100%|██████████| 6/6 [00:01<00:00,  5.26it/s]

Accuracy on benign examples: 100.0%
gt_label: 809 pred_label: 809 pred_clean_logit 0.9425603747367859
prompt generate:  soup bowl  	labels:  [[809]]
decoder:  [49406, 7077, 3814, 49407] [49406, 49407]

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:30<00:00,  6.01s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:02<?, ?it/s, attack_loss: -1.91065 entropy_loss: -18656.98242 self_attn_loss: 0.00000 loss: -18658.89258]
Iterations:   3%|▎         | 1/30 [00:03<01:50,  3.81s/it, attack_loss: -1.91065 entropy_loss: -18656.98242 self_attn_loss: 0.00000 loss: -18658.89258]
Iterations:   3%|▎         | 1/30 [00:05<01:50,  3.81s/it, attack_loss: -4.59649 entropy_loss: -18655.21289 self_attn_loss: 1.03004 loss: -18658.77930]
Iterations:   7%|▋         | 2/30 [00:06<01:34,  3.37s/it, attack_loss: -4.59649 entropy_loss: -18655.21289 self_attn_loss: 1.03004 loss: -18658.77930]
Iterations:   7%|▋         | 2/30 [00:08<01:34,  3.37s/it, attack_loss: -6.53676 entropy_loss: -18676.57227 self_attn_loss: 0.84112 loss: -18682.26758]
Iterations:  10%|█         | 3/30 [00:09<01:26,  3.22s/it, attack_loss: -6.53676 entropy_loss: -18676.57227 self_attn_loss: 0.84112 loss: -18682.26758]
Iterations:  10%|█         | 3/30 [00:11<01:26,  3.22s/it, attack_loss: -15.74443 entropy_loss: -18683.46484 self_attn_loss: 0.98470 loss: -18698.22461]
Iterations:  13%|█▎        | 4/30 [00:13<01:22,  3.17s/it, attack_loss: -15.74443 entropy_loss: -18683.46484 self_attn_loss: 0.98470 loss: -18698.22461]
Iterations:  13%|█▎        | 4/30 [00:14<01:22,  3.17s/it, attack_loss: -15.54316 entropy_loss: -18668.57617 self_attn_loss: 1.34093 loss: -18682.77930]
Iterations:  17%|█▋        | 5/30 [00:15<01:16,  3.06s/it, attack_loss: -15.54316 entropy_loss: -18668.57617 self_attn_loss: 1.34093 loss: -18682.77930]
Iterations:  17%|█▋        | 5/30 [00:17<01:16,  3.06s/it, attack_loss: -20.33558 entropy_loss: -18684.10156 self_attn_loss: 1.41589 loss: -18703.02148]
Iterations:  20%|██        | 6/30 [00:18<01:09,  2.88s/it, attack_loss: -20.33558 entropy_loss: -18684.10156 self_attn_loss: 1.41589 loss: -18703.02148]
Iterations:  20%|██        | 6/30 [00:19<01:09,  2.88s/it, attack_loss: -34.58123 entropy_loss: -18748.43555 self_attn_loss: 1.28203 loss: -18781.73438]
Iterations:  23%|██▎       | 7/30 [00:20<01:03,  2.76s/it, attack_loss: -34.58123 entropy_loss: -18748.43555 self_attn_loss: 1.28203 loss: -18781.73438]
Iterations:  23%|██▎       | 7/30 [00:22<01:03,  2.76s/it, attack_loss: -41.28695 entropy_loss: -18746.26367 self_attn_loss: 1.24737 loss: -18786.30273]
Iterations:  27%|██▋       | 8/30 [00:23<01:00,  2.77s/it, attack_loss: -41.28695 entropy_loss: -18746.26367 self_attn_loss: 1.24737 loss: -18786.30273]
Iterations:  27%|██▋       | 8/30 [00:25<01:00,  2.77s/it, attack_loss: -50.77021 entropy_loss: -18748.56250 self_attn_loss: 1.29752 loss: -18798.03516]
Iterations:  30%|███       | 9/30 [00:26<01:00,  2.86s/it, attack_loss: -50.77021 entropy_loss: -18748.56250 self_attn_loss: 1.29752 loss: -18798.03516]
Iterations:  30%|███       | 9/30 [00:28<01:00,  2.86s/it, attack_loss: -62.06383 entropy_loss: -18741.82617 self_attn_loss: 1.35342 loss: -18802.53711]
Iterations:  33%|███▎      | 10/30 [00:29<00:58,  2.93s/it, attack_loss: -62.06383 entropy_loss: -18741.82617 self_attn_loss: 1.35342 loss: -18802.53711]
Iterations:  33%|███▎      | 10/30 [00:31<00:58,  2.93s/it, attack_loss: -74.82990 entropy_loss: -18741.16016 self_attn_loss: 1.35369 loss: -18814.63672]
Iterations:  37%|███▋      | 11/30 [00:32<00:54,  2.86s/it, attack_loss: -74.82990 entropy_loss: -18741.16016 self_attn_loss: 1.35369 loss: -18814.63672]
Iterations:  37%|███▋      | 11/30 [00:34<00:54,  2.86s/it, attack_loss: -82.26177 entropy_loss: -18742.41797 self_attn_loss: 1.41883 loss: -18823.26172]
Iterations:  40%|████      | 12/30 [00:35<00:52,  2.93s/it, attack_loss: -82.26177 entropy_loss: -18742.41797 self_attn_loss: 1.41883 loss: -18823.26172]
Iterations:  40%|████      | 12/30 [00:37<00:52,  2.93s/it, attack_loss: -91.13448 entropy_loss: -18750.59570 self_attn_loss: 1.49885 loss: -18840.23047]
Iterations:  43%|████▎     | 13/30 [00:38<00:49,  2.92s/it, attack_loss: -91.13448 entropy_loss: -18750.59570 self_attn_loss: 1.49885 loss: -18840.23047]
Iterations:  43%|████▎     | 13/30 [00:39<00:49,  2.92s/it, attack_loss: -101.69430 entropy_loss: -18761.99023 self_attn_loss: 1.61687 loss: -18862.06836]
Iterations:  47%|████▋     | 14/30 [00:41<00:44,  2.81s/it, attack_loss: -101.69430 entropy_loss: -18761.99023 self_attn_loss: 1.61687 loss: -18862.06836]
Iterations:  47%|████▋     | 14/30 [00:42<00:44,  2.81s/it, attack_loss: -111.74884 entropy_loss: -18764.39062 self_attn_loss: 1.78655 loss: -18874.35352]
Iterations:  50%|█████     | 15/30 [00:43<00:40,  2.71s/it, attack_loss: -111.74884 entropy_loss: -18764.39062 self_attn_loss: 1.78655 loss: -18874.35352]
Iterations:  50%|█████     | 15/30 [00:44<00:40,  2.71s/it, attack_loss: -120.10683 entropy_loss: -18758.66992 self_attn_loss: 1.76384 loss: -18877.01367]
Iterations:  53%|█████▎    | 16/30 [00:46<00:37,  2.71s/it, attack_loss: -120.10683 entropy_loss: -18758.66992 self_attn_loss: 1.76384 loss: -18877.01367]
Iterations:  53%|█████▎    | 16/30 [00:47<00:37,  2.71s/it, attack_loss: -128.64511 entropy_loss: -18758.17578 self_attn_loss: 1.76195 loss: -18885.05859]
Iterations:  57%|█████▋    | 17/30 [00:49<00:36,  2.81s/it, attack_loss: -128.64511 entropy_loss: -18758.17578 self_attn_loss: 1.76195 loss: -18885.05859]
Iterations:  57%|█████▋    | 17/30 [00:51<00:36,  2.81s/it, attack_loss: -137.10703 entropy_loss: -18774.43359 self_attn_loss: 1.74991 loss: -18909.79102]
Iterations:  60%|██████    | 18/30 [00:52<00:34,  2.90s/it, attack_loss: -137.10703 entropy_loss: -18774.43359 self_attn_loss: 1.74991 loss: -18909.79102]
Iterations:  60%|██████    | 18/30 [00:54<00:34,  2.90s/it, attack_loss: -145.86397 entropy_loss: -18780.74414 self_attn_loss: 1.74197 loss: -18924.86523]
Iterations:  63%|██████▎   | 19/30 [00:55<00:33,  3.06s/it, attack_loss: -145.86397 entropy_loss: -18780.74414 self_attn_loss: 1.74197 loss: -18924.86523]
Iterations:  63%|██████▎   | 19/30 [00:57<00:33,  3.06s/it, attack_loss: -155.48625 entropy_loss: -18781.65625 self_attn_loss: 1.76818 loss: -18935.37500]
Iterations:  67%|██████▋   | 20/30 [00:58<00:30,  3.07s/it, attack_loss: -155.48625 entropy_loss: -18781.65625 self_attn_loss: 1.76818 loss: -18935.37500]
Iterations:  67%|██████▋   | 20/30 [01:00<00:30,  3.07s/it, attack_loss: -163.51169 entropy_loss: -18781.62891 self_attn_loss: 1.85629 loss: -18943.28516]
Iterations:  70%|███████   | 21/30 [01:01<00:27,  3.04s/it, attack_loss: -163.51169 entropy_loss: -18781.62891 self_attn_loss: 1.85629 loss: -18943.28516]
Iterations:  70%|███████   | 21/30 [01:03<00:27,  3.04s/it, attack_loss: -171.06261 entropy_loss: -18794.11328 self_attn_loss: 1.97179 loss: -18963.20312]
Iterations:  73%|███████▎  | 22/30 [01:04<00:23,  2.91s/it, attack_loss: -171.06261 entropy_loss: -18794.11328 self_attn_loss: 1.97179 loss: -18963.20312]
Iterations:  73%|███████▎  | 22/30 [01:05<00:23,  2.91s/it, attack_loss: -179.96732 entropy_loss: -18802.01367 self_attn_loss: 1.96157 loss: -18980.01953]
Iterations:  77%|███████▋  | 23/30 [01:07<00:19,  2.78s/it, attack_loss: -179.96732 entropy_loss: -18802.01367 self_attn_loss: 1.96157 loss: -18980.01953]
Iterations:  77%|███████▋  | 23/30 [01:08<00:19,  2.78s/it, attack_loss: -186.92401 entropy_loss: -18803.31641 self_attn_loss: 1.89959 loss: -18988.33984]
Iterations:  80%|████████  | 24/30 [01:09<00:16,  2.79s/it, attack_loss: -186.92401 entropy_loss: -18803.31641 self_attn_loss: 1.89959 loss: -18988.33984]
Iterations:  80%|████████  | 24/30 [01:11<00:16,  2.79s/it, attack_loss: -196.28564 entropy_loss: -18806.47852 self_attn_loss: 1.92492 loss: -19000.83984]
Iterations:  83%|████████▎ | 25/30 [01:13<00:14,  2.94s/it, attack_loss: -196.28564 entropy_loss: -18806.47852 self_attn_loss: 1.92492 loss: -19000.83984]
Iterations:  83%|████████▎ | 25/30 [01:14<00:14,  2.94s/it, attack_loss: -203.17046 entropy_loss: -18808.20703 self_attn_loss: 1.96376 loss: -19009.41406]
Iterations:  87%|████████▋ | 26/30 [01:16<00:12,  3.01s/it, attack_loss: -203.17046 entropy_loss: -18808.20703 self_attn_loss: 1.96376 loss: -19009.41406]
Iterations:  87%|████████▋ | 26/30 [01:18<00:12,  3.01s/it, attack_loss: -210.34091 entropy_loss: -18810.60156 self_attn_loss: 2.00315 loss: -19018.93945]
Iterations:  90%|█████████ | 27/30 [01:19<00:09,  3.08s/it, attack_loss: -210.34091 entropy_loss: -18810.60156 self_attn_loss: 2.00315 loss: -19018.93945]
Iterations:  90%|█████████ | 27/30 [01:21<00:09,  3.08s/it, attack_loss: -218.28632 entropy_loss: -18816.29492 self_attn_loss: 2.02943 loss: -19032.55273]
Iterations:  93%|█████████▎| 28/30 [01:22<00:06,  3.09s/it, attack_loss: -218.28632 entropy_loss: -18816.29492 self_attn_loss: 2.02943 loss: -19032.55273]
Iterations:  93%|█████████▎| 28/30 [01:24<00:06,  3.09s/it, attack_loss: -226.17007 entropy_loss: -18822.22852 self_attn_loss: 2.05311 loss: -19046.34570]
Iterations:  97%|█████████▋| 29/30 [01:25<00:03,  3.02s/it, attack_loss: -226.17007 entropy_loss: -18822.22852 self_attn_loss: 2.05311 loss: -19046.34570]
Iterations:  97%|█████████▋| 29/30 [01:26<00:03,  3.02s/it, attack_loss: -232.80414 entropy_loss: -18824.61719 self_attn_loss: 2.08656 loss: -19055.33398]
Iterations: 100%|██████████| 30/30 [01:28<00:00,  2.87s/it, attack_loss: -232.80414 entropy_loss: -18824.61719 self_attn_loss: 2.08656 loss: -19055.33398]
Iterations: 100%|██████████| 30/30 [01:28<00:00,  2.93s/it, attack_loss: -232.80414 entropy_loss: -18824.61719 self_attn_loss: 2.08656 loss: -19055.33398]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([666], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([809], device='cuda:0') tensor(4.6283e-11, device='cuda:0')
L1: [3079.]	L2: [10.986886]	Linf: [0.26666665]

Accuracy on benign examples: 100.0%
gt_label: 605 pred_label: 605 pred_clean_logit 0.882628321647644
prompt generate:  iPod  	labels:  [[605]]
decoder:  [49406, 17889, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.32it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:30<00:00,  6.12s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -0.88299 entropy_loss: -18495.03516 self_attn_loss: 0.00000 loss: -18495.91797]
Iterations:   3%|▎         | 1/30 [00:02<01:12,  2.51s/it, attack_loss: -0.88299 entropy_loss: -18495.03516 self_attn_loss: 0.00000 loss: -18495.91797]
Iterations:   3%|▎         | 1/30 [00:03<01:12,  2.51s/it, attack_loss: -6.42925 entropy_loss: -18509.93945 self_attn_loss: 0.36662 loss: -18516.00195]
Iterations:   7%|▋         | 2/30 [00:05<01:15,  2.70s/it, attack_loss: -6.42925 entropy_loss: -18509.93945 self_attn_loss: 0.36662 loss: -18516.00195]
Iterations:   7%|▋         | 2/30 [00:07<01:15,  2.70s/it, attack_loss: -18.55716 entropy_loss: -18568.28125 self_attn_loss: 1.19567 loss: -18585.64258]
Iterations:  10%|█         | 3/30 [00:08<01:17,  2.89s/it, attack_loss: -18.55716 entropy_loss: -18568.28125 self_attn_loss: 1.19567 loss: -18585.64258]
Iterations:  10%|█         | 3/30 [00:10<01:17,  2.89s/it, attack_loss: -33.38728 entropy_loss: -18673.99414 self_attn_loss: 1.78844 loss: -18705.59375]
Iterations:  13%|█▎        | 4/30 [00:11<01:17,  3.00s/it, attack_loss: -33.38728 entropy_loss: -18673.99414 self_attn_loss: 1.78844 loss: -18705.59375]
Iterations:  13%|█▎        | 4/30 [00:13<01:17,  3.00s/it, attack_loss: -48.69171 entropy_loss: -18703.07227 self_attn_loss: 2.08527 loss: -18749.67773]
Iterations:  17%|█▋        | 5/30 [00:14<01:16,  3.07s/it, attack_loss: -48.69171 entropy_loss: -18703.07227 self_attn_loss: 2.08527 loss: -18749.67773]
Iterations:  17%|█▋        | 5/30 [00:16<01:16,  3.07s/it, attack_loss: -65.15808 entropy_loss: -18718.23633 self_attn_loss: 2.15354 loss: -18781.24023]
Iterations:  20%|██        | 6/30 [00:17<01:13,  3.08s/it, attack_loss: -65.15808 entropy_loss: -18718.23633 self_attn_loss: 2.15354 loss: -18781.24023]
Iterations:  20%|██        | 6/30 [00:19<01:13,  3.08s/it, attack_loss: -80.68366 entropy_loss: -18739.98242 self_attn_loss: 2.23938 loss: -18818.42578]
Iterations:  23%|██▎       | 7/30 [00:20<01:08,  2.99s/it, attack_loss: -80.68366 entropy_loss: -18739.98242 self_attn_loss: 2.23938 loss: -18818.42578]
Iterations:  23%|██▎       | 7/30 [00:22<01:08,  2.99s/it, attack_loss: -96.40789 entropy_loss: -18768.46875 self_attn_loss: 2.34189 loss: -18862.53516]
Iterations:  27%|██▋       | 8/30 [00:23<01:03,  2.88s/it, attack_loss: -96.40789 entropy_loss: -18768.46875 self_attn_loss: 2.34189 loss: -18862.53516]
Iterations:  27%|██▋       | 8/30 [00:24<01:03,  2.88s/it, attack_loss: -108.31683 entropy_loss: -18787.72852 self_attn_loss: 2.34312 loss: -18893.70312]
Iterations:  30%|███       | 9/30 [00:25<00:57,  2.74s/it, attack_loss: -108.31683 entropy_loss: -18787.72852 self_attn_loss: 2.34312 loss: -18893.70312]
Iterations:  30%|███       | 9/30 [00:27<00:57,  2.74s/it, attack_loss: -122.95352 entropy_loss: -18805.32422 self_attn_loss: 2.38451 loss: -18925.89258]
Iterations:  33%|███▎      | 10/30 [00:28<00:55,  2.79s/it, attack_loss: -122.95352 entropy_loss: -18805.32422 self_attn_loss: 2.38451 loss: -18925.89258]
Iterations:  33%|███▎      | 10/30 [00:30<00:55,  2.79s/it, attack_loss: -131.86372 entropy_loss: -18817.18750 self_attn_loss: 2.36497 loss: -18946.68555]
Iterations:  37%|███▋      | 11/30 [00:31<00:54,  2.89s/it, attack_loss: -131.86372 entropy_loss: -18817.18750 self_attn_loss: 2.36497 loss: -18946.68555]
Iterations:  37%|███▋      | 11/30 [00:33<00:54,  2.89s/it, attack_loss: -143.67099 entropy_loss: -18822.27148 self_attn_loss: 2.41763 loss: -18963.52539]
Iterations:  40%|████      | 12/30 [00:35<00:54,  3.05s/it, attack_loss: -143.67099 entropy_loss: -18822.27148 self_attn_loss: 2.41763 loss: -18963.52539]
Iterations:  40%|████      | 12/30 [00:36<00:54,  3.05s/it, attack_loss: -156.96738 entropy_loss: -18834.91992 self_attn_loss: 2.50871 loss: -18989.37891]
Iterations:  43%|████▎     | 13/30 [00:38<00:52,  3.07s/it, attack_loss: -156.96738 entropy_loss: -18834.91992 self_attn_loss: 2.50871 loss: -18989.37891]
Iterations:  43%|████▎     | 13/30 [00:40<00:52,  3.07s/it, attack_loss: -165.91275 entropy_loss: -18854.27930 self_attn_loss: 2.52946 loss: -19017.66211]
Iterations:  47%|████▋     | 14/30 [00:41<00:49,  3.09s/it, attack_loss: -165.91275 entropy_loss: -18854.27930 self_attn_loss: 2.52946 loss: -19017.66211]
Iterations:  47%|████▋     | 14/30 [00:43<00:49,  3.09s/it, attack_loss: -174.97034 entropy_loss: -18868.88086 self_attn_loss: 2.60322 loss: -19041.24805]
Iterations:  50%|█████     | 15/30 [00:44<00:45,  3.01s/it, attack_loss: -174.97034 entropy_loss: -18868.88086 self_attn_loss: 2.60322 loss: -19041.24805]
Iterations:  50%|█████     | 15/30 [00:45<00:45,  3.01s/it, attack_loss: -190.11476 entropy_loss: -18871.77734 self_attn_loss: 2.57946 loss: -19059.31250]
Iterations:  53%|█████▎    | 16/30 [00:46<00:40,  2.91s/it, attack_loss: -190.11476 entropy_loss: -18871.77734 self_attn_loss: 2.57946 loss: -19059.31250]
Iterations:  53%|█████▎    | 16/30 [00:48<00:40,  2.91s/it, attack_loss: -197.25427 entropy_loss: -18864.78516 self_attn_loss: 2.57953 loss: -19059.45898]
Iterations:  57%|█████▋    | 17/30 [00:49<00:37,  2.90s/it, attack_loss: -197.25427 entropy_loss: -18864.78516 self_attn_loss: 2.57953 loss: -19059.45898]
Iterations:  57%|█████▋    | 17/30 [00:51<00:37,  2.90s/it, attack_loss: -211.91534 entropy_loss: -18865.83594 self_attn_loss: 2.62800 loss: -19075.12305]
Iterations:  60%|██████    | 18/30 [00:52<00:34,  2.91s/it, attack_loss: -211.91534 entropy_loss: -18865.83594 self_attn_loss: 2.62800 loss: -19075.12305]
Iterations:  60%|██████    | 18/30 [00:54<00:34,  2.91s/it, attack_loss: -222.99899 entropy_loss: -18864.51953 self_attn_loss: 2.65132 loss: -19084.86719]
Iterations:  63%|██████▎   | 19/30 [00:55<00:32,  2.98s/it, attack_loss: -222.99899 entropy_loss: -18864.51953 self_attn_loss: 2.65132 loss: -19084.86719]
Iterations:  63%|██████▎   | 19/30 [00:57<00:32,  2.98s/it, attack_loss: -232.93410 entropy_loss: -18868.13281 self_attn_loss: 2.66794 loss: -19098.39844]
Iterations:  67%|██████▋   | 20/30 [00:59<00:30,  3.01s/it, attack_loss: -232.93410 entropy_loss: -18868.13281 self_attn_loss: 2.66794 loss: -19098.39844]
Iterations:  67%|██████▋   | 20/30 [01:00<00:30,  3.01s/it, attack_loss: -248.87842 entropy_loss: -18871.78125 self_attn_loss: 2.70358 loss: -19117.95703]
Iterations:  70%|███████   | 21/30 [01:02<00:27,  3.06s/it, attack_loss: -248.87842 entropy_loss: -18871.78125 self_attn_loss: 2.70358 loss: -19117.95703]
Iterations:  70%|███████   | 21/30 [01:03<00:27,  3.06s/it, attack_loss: -253.63374 entropy_loss: -18875.96484 self_attn_loss: 2.75742 loss: -19126.84180]
Iterations:  73%|███████▎  | 22/30 [01:05<00:24,  3.04s/it, attack_loss: -253.63374 entropy_loss: -18875.96484 self_attn_loss: 2.75742 loss: -19126.84180]
Iterations:  73%|███████▎  | 22/30 [01:06<00:24,  3.04s/it, attack_loss: -269.50827 entropy_loss: -18883.64062 self_attn_loss: 2.78915 loss: -19150.35938]
Iterations:  77%|███████▋  | 23/30 [01:08<00:21,  3.06s/it, attack_loss: -269.50827 entropy_loss: -18883.64062 self_attn_loss: 2.78915 loss: -19150.35938]
Iterations:  77%|███████▋  | 23/30 [01:09<00:21,  3.06s/it, attack_loss: -278.82587 entropy_loss: -18887.92188 self_attn_loss: 2.77390 loss: -19163.97461]
Iterations:  80%|████████  | 24/30 [01:10<00:17,  2.93s/it, attack_loss: -278.82587 entropy_loss: -18887.92188 self_attn_loss: 2.77390 loss: -19163.97461]
Iterations:  80%|████████  | 24/30 [01:12<00:17,  2.93s/it, attack_loss: -289.50571 entropy_loss: -18888.41992 self_attn_loss: 2.77563 loss: -19175.15039]
Iterations:  83%|████████▎ | 25/30 [01:13<00:14,  2.83s/it, attack_loss: -289.50571 entropy_loss: -18888.41992 self_attn_loss: 2.77563 loss: -19175.15039]
Iterations:  83%|████████▎ | 25/30 [01:15<00:14,  2.83s/it, attack_loss: -303.48767 entropy_loss: -18891.72461 self_attn_loss: 2.79622 loss: -19192.41602]
Iterations:  87%|████████▋ | 26/30 [01:16<00:11,  2.89s/it, attack_loss: -303.48767 entropy_loss: -18891.72461 self_attn_loss: 2.79622 loss: -19192.41602]
Iterations:  87%|████████▋ | 26/30 [01:18<00:11,  2.89s/it, attack_loss: -316.28613 entropy_loss: -18898.91211 self_attn_loss: 2.79943 loss: -19212.39844]
Iterations:  90%|█████████ | 27/30 [01:19<00:08,  2.95s/it, attack_loss: -316.28613 entropy_loss: -18898.91211 self_attn_loss: 2.79943 loss: -19212.39844]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.95s/it, attack_loss: -330.77856 entropy_loss: -18899.18555 self_attn_loss: 2.76642 loss: -19227.19727]
Iterations:  93%|█████████▎| 28/30 [01:22<00:06,  3.01s/it, attack_loss: -330.77856 entropy_loss: -18899.18555 self_attn_loss: 2.76642 loss: -19227.19727]
Iterations:  93%|█████████▎| 28/30 [01:24<00:06,  3.01s/it, attack_loss: -343.31805 entropy_loss: -18903.00781 self_attn_loss: 2.75083 loss: -19243.57422]
Iterations:  97%|█████████▋| 29/30 [01:25<00:03,  3.06s/it, attack_loss: -343.31805 entropy_loss: -18903.00781 self_attn_loss: 2.75083 loss: -19243.57422]
Iterations:  97%|█████████▋| 29/30 [01:27<00:03,  3.06s/it, attack_loss: -355.89297 entropy_loss: -18903.33203 self_attn_loss: 2.77140 loss: -19256.45312]
Iterations: 100%|██████████| 30/30 [01:29<00:00,  3.10s/it, attack_loss: -355.89297 entropy_loss: -18903.33203 self_attn_loss: 2.77140 loss: -19256.45312]
Iterations: 100%|██████████| 30/30 [01:29<00:00,  2.97s/it, attack_loss: -355.89297 entropy_loss: -18903.33203 self_attn_loss: 2.77140 loss: -19256.45312]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([419], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([605], device='cuda:0') tensor(1.2839e-16, device='cuda:0')
L1: [3670.5962]	L2: [16.44668]	Linf: [0.79607844]

Accuracy on benign examples: 100.0%
gt_label: 94 pred_label: 94 pred_clean_logit 0.9314026236534119
prompt generate:  hummingbird  	labels:  [[94]]
decoder:  [49406, 33072, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.22it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:31<00:00,  6.20s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -0.30066 entropy_loss: -17777.53906 self_attn_loss: 0.00000 loss: -17777.83984]
Iterations:   3%|▎         | 1/30 [00:02<01:17,  2.68s/it, attack_loss: -0.30066 entropy_loss: -17777.53906 self_attn_loss: 0.00000 loss: -17777.83984]
Iterations:   3%|▎         | 1/30 [00:04<01:17,  2.68s/it, attack_loss: -2.07799 entropy_loss: -17801.66211 self_attn_loss: 1.06125 loss: -17802.67969]
Iterations:   7%|▋         | 2/30 [00:05<01:15,  2.69s/it, attack_loss: -2.07799 entropy_loss: -17801.66211 self_attn_loss: 1.06125 loss: -17802.67969]
Iterations:   7%|▋         | 2/30 [00:06<01:15,  2.69s/it, attack_loss: -5.18843 entropy_loss: -17783.63867 self_attn_loss: 1.12499 loss: -17787.70117]
Iterations:  10%|█         | 3/30 [00:08<01:14,  2.76s/it, attack_loss: -5.18843 entropy_loss: -17783.63867 self_attn_loss: 1.12499 loss: -17787.70117]
Iterations:  10%|█         | 3/30 [00:09<01:14,  2.76s/it, attack_loss: -10.30559 entropy_loss: -17767.44922 self_attn_loss: 1.29169 loss: -17776.46289]
Iterations:  13%|█▎        | 4/30 [00:11<01:12,  2.79s/it, attack_loss: -10.30559 entropy_loss: -17767.44922 self_attn_loss: 1.29169 loss: -17776.46289]
Iterations:  13%|█▎        | 4/30 [00:12<01:12,  2.79s/it, attack_loss: -19.04698 entropy_loss: -17773.21484 self_attn_loss: 1.31832 loss: -17790.94336]
Iterations:  17%|█▋        | 5/30 [00:14<01:12,  2.90s/it, attack_loss: -19.04698 entropy_loss: -17773.21484 self_attn_loss: 1.31832 loss: -17790.94336]
Iterations:  17%|█▋        | 5/30 [00:15<01:12,  2.90s/it, attack_loss: -25.59447 entropy_loss: -17809.05664 self_attn_loss: 1.35682 loss: -17833.29492]
Iterations:  20%|██        | 6/30 [00:17<01:11,  2.98s/it, attack_loss: -25.59447 entropy_loss: -17809.05664 self_attn_loss: 1.35682 loss: -17833.29492]
Iterations:  20%|██        | 6/30 [00:19<01:11,  2.98s/it, attack_loss: -36.21732 entropy_loss: -17808.87305 self_attn_loss: 1.40387 loss: -17843.68555]
Iterations:  23%|██▎       | 7/30 [00:20<01:09,  3.04s/it, attack_loss: -36.21732 entropy_loss: -17808.87305 self_attn_loss: 1.40387 loss: -17843.68555]
Iterations:  23%|██▎       | 7/30 [00:22<01:09,  3.04s/it, attack_loss: -47.94162 entropy_loss: -17793.42188 self_attn_loss: 1.46725 loss: -17839.89648]
Iterations:  27%|██▋       | 8/30 [00:23<01:09,  3.14s/it, attack_loss: -47.94162 entropy_loss: -17793.42188 self_attn_loss: 1.46725 loss: -17839.89648]
Iterations:  27%|██▋       | 8/30 [00:25<01:09,  3.14s/it, attack_loss: -58.57790 entropy_loss: -17792.25391 self_attn_loss: 1.50936 loss: -17849.32227]
Iterations:  30%|███       | 9/30 [00:26<01:04,  3.06s/it, attack_loss: -58.57790 entropy_loss: -17792.25391 self_attn_loss: 1.50936 loss: -17849.32227]
Iterations:  30%|███       | 9/30 [00:28<01:04,  3.06s/it, attack_loss: -72.51414 entropy_loss: -17807.81836 self_attn_loss: 1.49122 loss: -17878.84180]
Iterations:  33%|███▎      | 10/30 [00:29<00:58,  2.93s/it, attack_loss: -72.51414 entropy_loss: -17807.81836 self_attn_loss: 1.49122 loss: -17878.84180]
Iterations:  33%|███▎      | 10/30 [00:30<00:58,  2.93s/it, attack_loss: -83.82751 entropy_loss: -17815.59180 self_attn_loss: 1.50424 loss: -17897.91602]
Iterations:  37%|███▋      | 11/30 [00:31<00:53,  2.83s/it, attack_loss: -83.82751 entropy_loss: -17815.59180 self_attn_loss: 1.50424 loss: -17897.91602]
Iterations:  37%|███▋      | 11/30 [00:33<00:53,  2.83s/it, attack_loss: -96.39801 entropy_loss: -17814.07422 self_attn_loss: 1.57906 loss: -17908.89258]
Iterations:  40%|████      | 12/30 [00:34<00:51,  2.84s/it, attack_loss: -96.39801 entropy_loss: -17814.07422 self_attn_loss: 1.57906 loss: -17908.89258]
Iterations:  40%|████      | 12/30 [00:36<00:51,  2.84s/it, attack_loss: -105.67152 entropy_loss: -17817.62695 self_attn_loss: 1.68120 loss: -17921.61719]
Iterations:  43%|████▎     | 13/30 [00:37<00:50,  2.94s/it, attack_loss: -105.67152 entropy_loss: -17817.62695 self_attn_loss: 1.68120 loss: -17921.61719]
Iterations:  43%|████▎     | 13/30 [00:39<00:50,  2.94s/it, attack_loss: -115.83945 entropy_loss: -17823.36523 self_attn_loss: 1.74604 loss: -17937.45898]
Iterations:  47%|████▋     | 14/30 [00:41<00:48,  3.05s/it, attack_loss: -115.83945 entropy_loss: -17823.36523 self_attn_loss: 1.74604 loss: -17937.45898]
Iterations:  47%|████▋     | 14/30 [00:43<00:48,  3.05s/it, attack_loss: -124.33219 entropy_loss: -17818.19727 self_attn_loss: 1.77559 loss: -17940.75391]
Iterations:  50%|█████     | 15/30 [00:44<00:46,  3.11s/it, attack_loss: -124.33219 entropy_loss: -17818.19727 self_attn_loss: 1.77559 loss: -17940.75391]
Iterations:  50%|█████     | 15/30 [00:46<00:46,  3.11s/it, attack_loss: -132.57628 entropy_loss: -17807.44727 self_attn_loss: 1.80141 loss: -17938.22266]
Iterations:  53%|█████▎    | 16/30 [00:47<00:44,  3.14s/it, attack_loss: -132.57628 entropy_loss: -17807.44727 self_attn_loss: 1.80141 loss: -17938.22266]
Iterations:  53%|█████▎    | 16/30 [00:49<00:44,  3.14s/it, attack_loss: -139.42682 entropy_loss: -17807.95312 self_attn_loss: 1.81123 loss: -17945.56836]
Iterations:  57%|█████▋    | 17/30 [00:50<00:39,  3.05s/it, attack_loss: -139.42682 entropy_loss: -17807.95312 self_attn_loss: 1.81123 loss: -17945.56836]
Iterations:  57%|█████▋    | 17/30 [00:52<00:39,  3.05s/it, attack_loss: -147.48163 entropy_loss: -17815.85352 self_attn_loss: 1.83606 loss: -17961.50000]
Iterations:  60%|██████    | 18/30 [00:53<00:35,  2.96s/it, attack_loss: -147.48163 entropy_loss: -17815.85352 self_attn_loss: 1.83606 loss: -17961.50000]
Iterations:  60%|██████    | 18/30 [00:54<00:35,  2.96s/it, attack_loss: -156.87697 entropy_loss: -17821.63477 self_attn_loss: 1.88016 loss: -17976.63086]
Iterations:  63%|██████▎   | 19/30 [00:56<00:31,  2.88s/it, attack_loss: -156.87697 entropy_loss: -17821.63477 self_attn_loss: 1.88016 loss: -17976.63086]
Iterations:  63%|██████▎   | 19/30 [00:57<00:31,  2.88s/it, attack_loss: -165.94791 entropy_loss: -17830.36914 self_attn_loss: 1.89771 loss: -17994.41992]
Iterations:  67%|██████▋   | 20/30 [00:58<00:28,  2.90s/it, attack_loss: -165.94791 entropy_loss: -17830.36914 self_attn_loss: 1.89771 loss: -17994.41992]
Iterations:  67%|██████▋   | 20/30 [01:00<00:28,  2.90s/it, attack_loss: -174.02640 entropy_loss: -17832.21680 self_attn_loss: 1.89317 loss: -18004.34961]
Iterations:  70%|███████   | 21/30 [01:02<00:26,  2.97s/it, attack_loss: -174.02640 entropy_loss: -17832.21680 self_attn_loss: 1.89317 loss: -18004.34961]
Iterations:  70%|███████   | 21/30 [01:03<00:26,  2.97s/it, attack_loss: -180.54028 entropy_loss: -17826.39648 self_attn_loss: 1.89592 loss: -18005.04102]
Iterations:  73%|███████▎  | 22/30 [01:05<00:24,  3.02s/it, attack_loss: -180.54028 entropy_loss: -17826.39648 self_attn_loss: 1.89592 loss: -18005.04102]
Iterations:  73%|███████▎  | 22/30 [01:07<00:24,  3.02s/it, attack_loss: -187.55002 entropy_loss: -17824.75195 self_attn_loss: 1.91420 loss: -18010.38867]
Iterations:  77%|███████▋  | 23/30 [01:08<00:21,  3.09s/it, attack_loss: -187.55002 entropy_loss: -17824.75195 self_attn_loss: 1.91420 loss: -18010.38867]
Iterations:  77%|███████▋  | 23/30 [01:10<00:21,  3.09s/it, attack_loss: -193.80998 entropy_loss: -17824.99805 self_attn_loss: 1.93273 loss: -18016.87500]
Iterations:  80%|████████  | 24/30 [01:11<00:18,  3.12s/it, attack_loss: -193.80998 entropy_loss: -17824.99805 self_attn_loss: 1.93273 loss: -18016.87500]
Iterations:  80%|████████  | 24/30 [01:13<00:18,  3.12s/it, attack_loss: -200.68225 entropy_loss: -17829.11133 self_attn_loss: 1.93571 loss: -18027.85742]
Iterations:  83%|████████▎ | 25/30 [01:14<00:15,  3.00s/it, attack_loss: -200.68225 entropy_loss: -17829.11133 self_attn_loss: 1.93571 loss: -18027.85742]
Iterations:  83%|████████▎ | 25/30 [01:15<00:15,  3.00s/it, attack_loss: -206.85866 entropy_loss: -17838.43750 self_attn_loss: 1.94852 loss: -18043.34766]
Iterations:  87%|████████▋ | 26/30 [01:17<00:11,  2.90s/it, attack_loss: -206.85866 entropy_loss: -17838.43750 self_attn_loss: 1.94852 loss: -18043.34766]
Iterations:  87%|████████▋ | 26/30 [01:18<00:11,  2.90s/it, attack_loss: -212.46834 entropy_loss: -17834.36328 self_attn_loss: 1.97915 loss: -18044.85156]
Iterations:  90%|█████████ | 27/30 [01:19<00:08,  2.80s/it, attack_loss: -212.46834 entropy_loss: -17834.36328 self_attn_loss: 1.97915 loss: -18044.85156]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.80s/it, attack_loss: -218.74748 entropy_loss: -17843.50000 self_attn_loss: 1.97227 loss: -18060.27539]
Iterations:  93%|█████████▎| 28/30 [01:22<00:05,  2.89s/it, attack_loss: -218.74748 entropy_loss: -17843.50000 self_attn_loss: 1.97227 loss: -18060.27539]
Iterations:  93%|█████████▎| 28/30 [01:24<00:05,  2.89s/it, attack_loss: -224.69206 entropy_loss: -17841.92383 self_attn_loss: 1.98851 loss: -18064.62695]
Iterations:  97%|█████████▋| 29/30 [01:25<00:02,  2.97s/it, attack_loss: -224.69206 entropy_loss: -17841.92383 self_attn_loss: 1.98851 loss: -18064.62695]
Iterations:  97%|█████████▋| 29/30 [01:27<00:02,  2.97s/it, attack_loss: -229.84900 entropy_loss: -17838.36133 self_attn_loss: 2.01224 loss: -18066.19727]
Iterations: 100%|██████████| 30/30 [01:29<00:00,  3.04s/it, attack_loss: -229.84900 entropy_loss: -17838.36133 self_attn_loss: 2.01224 loss: -18066.19727]
Iterations: 100%|██████████| 30/30 [01:29<00:00,  2.97s/it, attack_loss: -229.84900 entropy_loss: -17838.36133 self_attn_loss: 2.01224 loss: -18066.19727]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([14], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([94], device='cuda:0') tensor(8.6555e-11, device='cuda:0')
L1: [4357.2324]	L2: [17.041325]	Linf: [0.6627451]

Accuracy on benign examples: 100.0%
gt_label: 777 pred_label: 777 pred_clean_logit 0.8415653109550476
prompt generate:  scabbard  	labels:  [[777]]
decoder:  [49406, 31716, 17514, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:03<00:00,  5.09it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:32<00:00,  6.43s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -2.47691 entropy_loss: -18740.76953 self_attn_loss: 0.00000 loss: -18743.24609]
Iterations:   3%|▎         | 1/30 [00:02<01:26,  2.99s/it, attack_loss: -2.47691 entropy_loss: -18740.76953 self_attn_loss: 0.00000 loss: -18743.24609]
Iterations:   3%|▎         | 1/30 [00:04<01:26,  2.99s/it, attack_loss: -11.59061 entropy_loss: -18746.26562 self_attn_loss: 0.22399 loss: -18757.63281]
Iterations:   7%|▋         | 2/30 [00:06<01:26,  3.07s/it, attack_loss: -11.59061 entropy_loss: -18746.26562 self_attn_loss: 0.22399 loss: -18757.63281]
Iterations:   7%|▋         | 2/30 [00:07<01:26,  3.07s/it, attack_loss: -26.10371 entropy_loss: -18742.95508 self_attn_loss: 0.30844 loss: -18768.75000]
Iterations:  10%|█         | 3/30 [00:09<01:22,  3.04s/it, attack_loss: -26.10371 entropy_loss: -18742.95508 self_attn_loss: 0.30844 loss: -18768.75000]
Iterations:  10%|█         | 3/30 [00:10<01:22,  3.04s/it, attack_loss: -41.50280 entropy_loss: -18740.86523 self_attn_loss: 0.30163 loss: -18782.06641]
Iterations:  13%|█▎        | 4/30 [00:11<01:14,  2.88s/it, attack_loss: -41.50280 entropy_loss: -18740.86523 self_attn_loss: 0.30163 loss: -18782.06641]
Iterations:  13%|█▎        | 4/30 [00:13<01:14,  2.88s/it, attack_loss: -57.24791 entropy_loss: -18727.81250 self_attn_loss: 0.44520 loss: -18784.61523]
Iterations:  17%|█▋        | 5/30 [00:14<01:09,  2.78s/it, attack_loss: -57.24791 entropy_loss: -18727.81250 self_attn_loss: 0.44520 loss: -18784.61523]
Iterations:  17%|█▋        | 5/30 [00:15<01:09,  2.78s/it, attack_loss: -74.01887 entropy_loss: -18751.83984 self_attn_loss: 0.40646 loss: -18825.45312]
Iterations:  20%|██        | 6/30 [00:17<01:07,  2.83s/it, attack_loss: -74.01887 entropy_loss: -18751.83984 self_attn_loss: 0.40646 loss: -18825.45312]
Iterations:  20%|██        | 6/30 [00:19<01:07,  2.83s/it, attack_loss: -91.31165 entropy_loss: -18761.01758 self_attn_loss: 0.52124 loss: -18851.80859]
Iterations:  23%|██▎       | 7/30 [00:20<01:07,  2.94s/it, attack_loss: -91.31165 entropy_loss: -18761.01758 self_attn_loss: 0.52124 loss: -18851.80859]
Iterations:  23%|██▎       | 7/30 [00:22<01:07,  2.94s/it, attack_loss: -107.00658 entropy_loss: -18760.88672 self_attn_loss: 0.62881 loss: -18867.26367]
Iterations:  27%|██▋       | 8/30 [00:23<01:06,  3.02s/it, attack_loss: -107.00658 entropy_loss: -18760.88672 self_attn_loss: 0.62881 loss: -18867.26367]
Iterations:  27%|██▋       | 8/30 [00:25<01:06,  3.02s/it, attack_loss: -119.94190 entropy_loss: -18761.41992 self_attn_loss: 0.69372 loss: -18880.66797]
Iterations:  30%|███       | 9/30 [00:26<01:04,  3.06s/it, attack_loss: -119.94190 entropy_loss: -18761.41992 self_attn_loss: 0.69372 loss: -18880.66797]
Iterations:  30%|███       | 9/30 [00:28<01:04,  3.06s/it, attack_loss: -131.96008 entropy_loss: -18763.58984 self_attn_loss: 0.71288 loss: -18894.83789]
Iterations:  33%|███▎      | 10/30 [00:30<01:02,  3.10s/it, attack_loss: -131.96008 entropy_loss: -18763.58984 self_attn_loss: 0.71288 loss: -18894.83789]
Iterations:  33%|███▎      | 10/30 [00:31<01:02,  3.10s/it, attack_loss: -142.54195 entropy_loss: -18769.49414 self_attn_loss: 0.72108 loss: -18911.31445]
Iterations:  37%|███▋      | 11/30 [00:32<00:57,  3.05s/it, attack_loss: -142.54195 entropy_loss: -18769.49414 self_attn_loss: 0.72108 loss: -18911.31445]
Iterations:  37%|███▋      | 11/30 [00:34<00:57,  3.05s/it, attack_loss: -156.68312 entropy_loss: -18773.09961 self_attn_loss: 0.75012 loss: -18929.03320]
Iterations:  40%|████      | 12/30 [00:35<00:52,  2.92s/it, attack_loss: -156.68312 entropy_loss: -18773.09961 self_attn_loss: 0.75012 loss: -18929.03320]
Iterations:  40%|████      | 12/30 [00:37<00:52,  2.92s/it, attack_loss: -169.62189 entropy_loss: -18779.12109 self_attn_loss: 0.78424 loss: -18947.95898]
Iterations:  43%|████▎     | 13/30 [00:38<00:49,  2.89s/it, attack_loss: -169.62189 entropy_loss: -18779.12109 self_attn_loss: 0.78424 loss: -18947.95898]
Iterations:  43%|████▎     | 13/30 [00:39<00:49,  2.89s/it, attack_loss: -180.31161 entropy_loss: -18785.52148 self_attn_loss: 0.83301 loss: -18965.00000]
Iterations:  47%|████▋     | 14/30 [00:41<00:46,  2.92s/it, attack_loss: -180.31161 entropy_loss: -18785.52148 self_attn_loss: 0.83301 loss: -18965.00000]
Iterations:  47%|████▋     | 14/30 [00:43<00:46,  2.92s/it, attack_loss: -191.64456 entropy_loss: -18791.15430 self_attn_loss: 0.85496 loss: -18981.94336]
Iterations:  50%|█████     | 15/30 [00:44<00:44,  2.97s/it, attack_loss: -191.64456 entropy_loss: -18791.15430 self_attn_loss: 0.85496 loss: -18981.94336]
Iterations:  50%|█████     | 15/30 [00:46<00:44,  2.97s/it, attack_loss: -203.97830 entropy_loss: -18798.38867 self_attn_loss: 0.88235 loss: -19001.48438]
Iterations:  53%|█████▎    | 16/30 [00:47<00:42,  3.04s/it, attack_loss: -203.97830 entropy_loss: -18798.38867 self_attn_loss: 0.88235 loss: -19001.48438]
Iterations:  53%|█████▎    | 16/30 [00:49<00:42,  3.04s/it, attack_loss: -212.30629 entropy_loss: -18803.77539 self_attn_loss: 0.93469 loss: -19015.14648]
Iterations:  57%|█████▋    | 17/30 [00:50<00:39,  3.06s/it, attack_loss: -212.30629 entropy_loss: -18803.77539 self_attn_loss: 0.93469 loss: -19015.14648]
Iterations:  57%|█████▋    | 17/30 [00:52<00:39,  3.06s/it, attack_loss: -220.71930 entropy_loss: -18807.05078 self_attn_loss: 0.94505 loss: -19026.82422]
Iterations:  60%|██████    | 18/30 [00:53<00:37,  3.09s/it, attack_loss: -220.71930 entropy_loss: -18807.05078 self_attn_loss: 0.94505 loss: -19026.82422]
Iterations:  60%|██████    | 18/30 [00:55<00:37,  3.09s/it, attack_loss: -228.22562 entropy_loss: -18804.90039 self_attn_loss: 0.94862 loss: -19032.17773]
Iterations:  63%|██████▎   | 19/30 [00:56<00:33,  3.08s/it, attack_loss: -228.22562 entropy_loss: -18804.90039 self_attn_loss: 0.94862 loss: -19032.17773]
Iterations:  63%|██████▎   | 19/30 [00:58<00:33,  3.08s/it, attack_loss: -238.68716 entropy_loss: -18813.01172 self_attn_loss: 1.00149 loss: -19050.69727]
Iterations:  67%|██████▋   | 20/30 [00:59<00:30,  3.01s/it, attack_loss: -238.68716 entropy_loss: -18813.01172 self_attn_loss: 1.00149 loss: -19050.69727]
Iterations:  67%|██████▋   | 20/30 [01:01<00:30,  3.01s/it, attack_loss: -246.59254 entropy_loss: -18814.30078 self_attn_loss: 1.04216 loss: -19059.85156]
Iterations:  70%|███████   | 21/30 [01:02<00:25,  2.82s/it, attack_loss: -246.59254 entropy_loss: -18814.30078 self_attn_loss: 1.04216 loss: -19059.85156]
Iterations:  70%|███████   | 21/30 [01:03<00:25,  2.82s/it, attack_loss: -254.77661 entropy_loss: -18817.52344 self_attn_loss: 1.07511 loss: -19071.22461]
Iterations:  73%|███████▎  | 22/30 [01:05<00:23,  2.88s/it, attack_loss: -254.77661 entropy_loss: -18817.52344 self_attn_loss: 1.07511 loss: -19071.22461]
Iterations:  73%|███████▎  | 22/30 [01:06<00:23,  2.88s/it, attack_loss: -263.22635 entropy_loss: -18823.57227 self_attn_loss: 1.07910 loss: -19085.71875]
Iterations:  77%|███████▋  | 23/30 [01:08<00:20,  2.97s/it, attack_loss: -263.22635 entropy_loss: -18823.57227 self_attn_loss: 1.07910 loss: -19085.71875]
Iterations:  77%|███████▋  | 23/30 [01:10<00:20,  2.97s/it, attack_loss: -271.68341 entropy_loss: -18826.03125 self_attn_loss: 1.10015 loss: -19096.61523]
Iterations:  80%|████████  | 24/30 [01:11<00:18,  3.07s/it, attack_loss: -271.68341 entropy_loss: -18826.03125 self_attn_loss: 1.10015 loss: -19096.61523]
Iterations:  80%|████████  | 24/30 [01:13<00:18,  3.07s/it, attack_loss: -277.10562 entropy_loss: -18827.71875 self_attn_loss: 1.12022 loss: -19103.70508]
Iterations:  83%|████████▎ | 25/30 [01:14<00:15,  3.08s/it, attack_loss: -277.10562 entropy_loss: -18827.71875 self_attn_loss: 1.12022 loss: -19103.70508]
Iterations:  83%|████████▎ | 25/30 [01:16<00:15,  3.08s/it, attack_loss: -287.57309 entropy_loss: -18825.95117 self_attn_loss: 1.14729 loss: -19112.37695]
Iterations:  87%|████████▋ | 26/30 [01:18<00:12,  3.12s/it, attack_loss: -287.57309 entropy_loss: -18825.95117 self_attn_loss: 1.14729 loss: -19112.37695]
Iterations:  87%|████████▋ | 26/30 [01:19<00:12,  3.12s/it, attack_loss: -296.07202 entropy_loss: -18825.36328 self_attn_loss: 1.16585 loss: -19120.26953]
Iterations:  90%|█████████ | 27/30 [01:20<00:09,  3.01s/it, attack_loss: -296.07202 entropy_loss: -18825.36328 self_attn_loss: 1.16585 loss: -19120.26953]
Iterations:  90%|█████████ | 27/30 [01:22<00:09,  3.01s/it, attack_loss: -303.60205 entropy_loss: -18826.37695 self_attn_loss: 1.17343 loss: -19128.80469]
Iterations:  93%|█████████▎| 28/30 [01:23<00:05,  2.89s/it, attack_loss: -303.60205 entropy_loss: -18826.37695 self_attn_loss: 1.17343 loss: -19128.80469]
Iterations:  93%|█████████▎| 28/30 [01:24<00:05,  2.89s/it, attack_loss: -310.25055 entropy_loss: -18826.59961 self_attn_loss: 1.18040 loss: -19135.66992]
Iterations:  97%|█████████▋| 29/30 [01:26<00:02,  2.84s/it, attack_loss: -310.25055 entropy_loss: -18826.59961 self_attn_loss: 1.18040 loss: -19135.66992]
Iterations:  97%|█████████▋| 29/30 [01:27<00:02,  2.84s/it, attack_loss: -316.24026 entropy_loss: -18826.80273 self_attn_loss: 1.18128 loss: -19141.86133]
Iterations: 100%|██████████| 30/30 [01:29<00:00,  2.92s/it, attack_loss: -316.24026 entropy_loss: -18826.80273 self_attn_loss: 1.18128 loss: -19141.86133]
Iterations: 100%|██████████| 30/30 [01:29<00:00,  2.97s/it, attack_loss: -316.24026 entropy_loss: -18826.80273 self_attn_loss: 1.18128 loss: -19141.86133]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([893], device='cuda:0') tensor(0.9872, device='cuda:0')
after_true: tensor([777], device='cuda:0') tensor(8.9251e-15, device='cuda:0')
L1: [5080.5527]	L2: [19.111351]	Linf: [0.6862745]

Accuracy on benign examples: 100.0%
gt_label: 768 pred_label: 768 pred_clean_logit 0.3755243420600891
prompt generate:  rugby ball  	labels:  [[768]]
decoder:  [49406, 4964, 1069, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:03<00:00,  5.05it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:31<00:00,  6.25s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -11.71479 entropy_loss: -19334.07422 self_attn_loss: 0.00000 loss: -19345.78906]
Iterations:   3%|▎         | 1/30 [00:02<01:23,  2.89s/it, attack_loss: -11.71479 entropy_loss: -19334.07422 self_attn_loss: 0.00000 loss: -19345.78906]
Iterations:   3%|▎         | 1/30 [00:04<01:23,  2.89s/it, attack_loss: -35.22984 entropy_loss: -19336.56836 self_attn_loss: 2.20675 loss: -19369.59180]
Iterations:   7%|▋         | 2/30 [00:05<01:24,  3.00s/it, attack_loss: -35.22984 entropy_loss: -19336.56836 self_attn_loss: 2.20675 loss: -19369.59180]
Iterations:   7%|▋         | 2/30 [00:07<01:24,  3.00s/it, attack_loss: -45.01444 entropy_loss: -19329.55664 self_attn_loss: 2.13087 loss: -19372.43945]
Iterations:  10%|█         | 3/30 [00:08<01:17,  2.88s/it, attack_loss: -45.01444 entropy_loss: -19329.55664 self_attn_loss: 2.13087 loss: -19372.43945]
Iterations:  10%|█         | 3/30 [00:10<01:17,  2.88s/it, attack_loss: -53.70856 entropy_loss: -19331.64453 self_attn_loss: 2.54303 loss: -19382.81055]
Iterations:  13%|█▎        | 4/30 [00:11<01:15,  2.91s/it, attack_loss: -53.70856 entropy_loss: -19331.64453 self_attn_loss: 2.54303 loss: -19382.81055]
Iterations:  13%|█▎        | 4/30 [00:13<01:15,  2.91s/it, attack_loss: -61.58626 entropy_loss: -19331.29297 self_attn_loss: 2.61153 loss: -19390.26758]
Iterations:  17%|█▋        | 5/30 [00:14<01:10,  2.82s/it, attack_loss: -61.58626 entropy_loss: -19331.29297 self_attn_loss: 2.61153 loss: -19390.26758]
Iterations:  17%|█▋        | 5/30 [00:15<01:10,  2.82s/it, attack_loss: -61.51642 entropy_loss: -19333.94336 self_attn_loss: 2.64170 loss: -19392.81836]
Iterations:  20%|██        | 6/30 [00:17<01:06,  2.78s/it, attack_loss: -61.51642 entropy_loss: -19333.94336 self_attn_loss: 2.64170 loss: -19392.81836]
Iterations:  20%|██        | 6/30 [00:18<01:06,  2.78s/it, attack_loss: -70.82363 entropy_loss: -19336.19531 self_attn_loss: 2.79068 loss: -19404.22852]
Iterations:  23%|██▎       | 7/30 [00:19<01:03,  2.78s/it, attack_loss: -70.82363 entropy_loss: -19336.19531 self_attn_loss: 2.79068 loss: -19404.22852]
Iterations:  23%|██▎       | 7/30 [00:21<01:03,  2.78s/it, attack_loss: -76.55598 entropy_loss: -19328.19531 self_attn_loss: 2.74071 loss: -19402.00977]
Iterations:  27%|██▋       | 8/30 [00:22<01:03,  2.88s/it, attack_loss: -76.55598 entropy_loss: -19328.19531 self_attn_loss: 2.74071 loss: -19402.00977]
Iterations:  27%|██▋       | 8/30 [00:24<01:03,  2.88s/it, attack_loss: -79.93697 entropy_loss: -19329.51367 self_attn_loss: 2.78597 loss: -19406.66406]
Iterations:  30%|███       | 9/30 [00:26<01:02,  2.96s/it, attack_loss: -79.93697 entropy_loss: -19329.51367 self_attn_loss: 2.78597 loss: -19406.66406]
Iterations:  30%|███       | 9/30 [00:27<01:02,  2.96s/it, attack_loss: -88.44807 entropy_loss: -19328.29297 self_attn_loss: 2.83585 loss: -19413.90430]
Iterations:  33%|███▎      | 10/30 [00:29<01:01,  3.08s/it, attack_loss: -88.44807 entropy_loss: -19328.29297 self_attn_loss: 2.83585 loss: -19413.90430]
Iterations:  33%|███▎      | 10/30 [00:31<01:01,  3.08s/it, attack_loss: -94.48170 entropy_loss: -19328.09766 self_attn_loss: 2.88341 loss: -19419.69531]
Iterations:  37%|███▋      | 11/30 [00:32<00:58,  3.09s/it, attack_loss: -94.48170 entropy_loss: -19328.09766 self_attn_loss: 2.88341 loss: -19419.69531]
Iterations:  37%|███▋      | 11/30 [00:34<00:58,  3.09s/it, attack_loss: -100.18860 entropy_loss: -19327.66406 self_attn_loss: 2.91946 loss: -19424.93359]
Iterations:  40%|████      | 12/30 [00:35<00:54,  3.05s/it, attack_loss: -100.18860 entropy_loss: -19327.66406 self_attn_loss: 2.91946 loss: -19424.93359]
Iterations:  40%|████      | 12/30 [00:36<00:54,  3.05s/it, attack_loss: -105.31529 entropy_loss: -19326.97852 self_attn_loss: 2.94212 loss: -19429.35156]
Iterations:  43%|████▎     | 13/30 [00:38<00:49,  2.90s/it, attack_loss: -105.31529 entropy_loss: -19326.97852 self_attn_loss: 2.94212 loss: -19429.35156]
Iterations:  43%|████▎     | 13/30 [00:39<00:49,  2.90s/it, attack_loss: -109.14874 entropy_loss: -19326.47070 self_attn_loss: 2.91717 loss: -19432.70312]
Iterations:  47%|████▋     | 14/30 [00:40<00:44,  2.76s/it, attack_loss: -109.14874 entropy_loss: -19326.47070 self_attn_loss: 2.91717 loss: -19432.70312]
Iterations:  47%|████▋     | 14/30 [00:41<00:44,  2.76s/it, attack_loss: -113.28391 entropy_loss: -19325.50000 self_attn_loss: 2.93486 loss: -19435.84961]
Iterations:  50%|█████     | 15/30 [00:43<00:41,  2.78s/it, attack_loss: -113.28391 entropy_loss: -19325.50000 self_attn_loss: 2.93486 loss: -19435.84961]
Iterations:  50%|█████     | 15/30 [00:44<00:41,  2.78s/it, attack_loss: -117.83199 entropy_loss: -19324.64453 self_attn_loss: 2.95950 loss: -19439.51758]
Iterations:  53%|█████▎    | 16/30 [00:46<00:40,  2.87s/it, attack_loss: -117.83199 entropy_loss: -19324.64453 self_attn_loss: 2.95950 loss: -19439.51758]
Iterations:  53%|█████▎    | 16/30 [00:47<00:40,  2.87s/it, attack_loss: -122.29324 entropy_loss: -19323.96094 self_attn_loss: 2.96324 loss: -19443.29102]
Iterations:  57%|█████▋    | 17/30 [00:49<00:38,  2.93s/it, attack_loss: -122.29324 entropy_loss: -19323.96094 self_attn_loss: 2.96324 loss: -19443.29102]
Iterations:  57%|█████▋    | 17/30 [00:51<00:38,  2.93s/it, attack_loss: -127.43509 entropy_loss: -19322.88867 self_attn_loss: 2.94662 loss: -19447.37695]
Iterations:  60%|██████    | 18/30 [00:52<00:35,  2.97s/it, attack_loss: -127.43509 entropy_loss: -19322.88867 self_attn_loss: 2.94662 loss: -19447.37695]
Iterations:  60%|██████    | 18/30 [00:54<00:35,  2.97s/it, attack_loss: -131.45509 entropy_loss: -19322.63086 self_attn_loss: 2.95343 loss: -19451.13281]
Iterations:  63%|██████▎   | 19/30 [00:55<00:33,  3.01s/it, attack_loss: -131.45509 entropy_loss: -19322.63086 self_attn_loss: 2.95343 loss: -19451.13281]
Iterations:  63%|██████▎   | 19/30 [00:57<00:33,  3.01s/it, attack_loss: -135.68750 entropy_loss: -19323.59180 self_attn_loss: 2.96102 loss: -19456.31836]
Iterations:  67%|██████▋   | 20/30 [00:58<00:30,  3.02s/it, attack_loss: -135.68750 entropy_loss: -19323.59180 self_attn_loss: 2.96102 loss: -19456.31836]
Iterations:  67%|██████▋   | 20/30 [00:59<00:30,  3.02s/it, attack_loss: -139.32672 entropy_loss: -19323.70898 self_attn_loss: 3.01371 loss: -19460.02148]
Iterations:  70%|███████   | 21/30 [01:01<00:25,  2.86s/it, attack_loss: -139.32672 entropy_loss: -19323.70898 self_attn_loss: 3.01371 loss: -19460.02148]
Iterations:  70%|███████   | 21/30 [01:02<00:25,  2.86s/it, attack_loss: -141.80582 entropy_loss: -19325.31055 self_attn_loss: 3.00327 loss: -19464.11328]
Iterations:  73%|███████▎  | 22/30 [01:03<00:22,  2.80s/it, attack_loss: -141.80582 entropy_loss: -19325.31055 self_attn_loss: 3.00327 loss: -19464.11328]
Iterations:  73%|███████▎  | 22/30 [01:05<00:22,  2.80s/it, attack_loss: -146.88885 entropy_loss: -19325.01758 self_attn_loss: 3.02416 loss: -19468.88281]
Iterations:  77%|███████▋  | 23/30 [01:06<00:19,  2.79s/it, attack_loss: -146.88885 entropy_loss: -19325.01758 self_attn_loss: 3.02416 loss: -19468.88281]
Iterations:  77%|███████▋  | 23/30 [01:08<00:19,  2.79s/it, attack_loss: -150.56929 entropy_loss: -19324.68750 self_attn_loss: 3.08602 loss: -19472.16992]
Iterations:  80%|████████  | 24/30 [01:09<00:17,  2.88s/it, attack_loss: -150.56929 entropy_loss: -19324.68750 self_attn_loss: 3.08602 loss: -19472.16992]
Iterations:  80%|████████  | 24/30 [01:11<00:17,  2.88s/it, attack_loss: -153.73537 entropy_loss: -19323.82812 self_attn_loss: 3.12517 loss: -19474.43750]
Iterations:  83%|████████▎ | 25/30 [01:12<00:14,  2.94s/it, attack_loss: -153.73537 entropy_loss: -19323.82812 self_attn_loss: 3.12517 loss: -19474.43750]
Iterations:  83%|████████▎ | 25/30 [01:14<00:14,  2.94s/it, attack_loss: -157.22427 entropy_loss: -19322.96484 self_attn_loss: 3.10644 loss: -19477.08203]
Iterations:  87%|████████▋ | 26/30 [01:16<00:12,  3.13s/it, attack_loss: -157.22427 entropy_loss: -19322.96484 self_attn_loss: 3.10644 loss: -19477.08203]
Iterations:  87%|████████▋ | 26/30 [01:17<00:12,  3.13s/it, attack_loss: -160.92688 entropy_loss: -19322.19727 self_attn_loss: 3.11361 loss: -19480.00977]
Iterations:  90%|█████████ | 27/30 [01:19<00:09,  3.08s/it, attack_loss: -160.92688 entropy_loss: -19322.19727 self_attn_loss: 3.11361 loss: -19480.00977]
Iterations:  90%|█████████ | 27/30 [01:20<00:09,  3.08s/it, attack_loss: -164.20862 entropy_loss: -19322.41602 self_attn_loss: 3.13339 loss: -19483.49219]
Iterations:  93%|█████████▎| 28/30 [01:22<00:06,  3.04s/it, attack_loss: -164.20862 entropy_loss: -19322.41602 self_attn_loss: 3.13339 loss: -19483.49219]
Iterations:  93%|█████████▎| 28/30 [01:23<00:06,  3.04s/it, attack_loss: -168.38409 entropy_loss: -19321.93945 self_attn_loss: 3.16139 loss: -19487.16211]
Iterations:  97%|█████████▋| 29/30 [01:24<00:02,  2.91s/it, attack_loss: -168.38409 entropy_loss: -19321.93945 self_attn_loss: 3.16139 loss: -19487.16211]
Iterations:  97%|█████████▋| 29/30 [01:26<00:02,  2.91s/it, attack_loss: -171.58998 entropy_loss: -19321.74414 self_attn_loss: 3.17814 loss: -19490.15625]
Iterations: 100%|██████████| 30/30 [01:27<00:00,  2.82s/it, attack_loss: -171.58998 entropy_loss: -19321.74414 self_attn_loss: 3.17814 loss: -19490.15625]
Iterations: 100%|██████████| 30/30 [01:27<00:00,  2.91s/it, attack_loss: -171.58998 entropy_loss: -19321.74414 self_attn_loss: 3.17814 loss: -19490.15625]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([981], device='cuda:0') tensor(0.9791, device='cuda:0')
after_true: tensor([768], device='cuda:0') tensor(2.5281e-08, device='cuda:0')
L1: [8065.945]	L2: [30.932642]	Linf: [0.8666667]

Accuracy on benign examples: 100.0%
gt_label: 663 pred_label: 663 pred_clean_logit 0.8165990710258484
prompt generate:  monastery  	labels:  [[663]]
decoder:  [49406, 21850, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.35it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:30<00:00,  6.15s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -1.12910 entropy_loss: -19029.64648 self_attn_loss: 0.00000 loss: -19030.77539]
Iterations:   3%|▎         | 1/30 [00:02<01:12,  2.50s/it, attack_loss: -1.12910 entropy_loss: -19029.64648 self_attn_loss: 0.00000 loss: -19030.77539]
Iterations:   3%|▎         | 1/30 [00:04<01:12,  2.50s/it, attack_loss: -4.04150 entropy_loss: -19056.20117 self_attn_loss: 0.92397 loss: -19059.31836]
Iterations:   7%|▋         | 2/30 [00:05<01:20,  2.87s/it, attack_loss: -4.04150 entropy_loss: -19056.20117 self_attn_loss: 0.92397 loss: -19059.31836]
Iterations:   7%|▋         | 2/30 [00:07<01:20,  2.87s/it, attack_loss: -13.84039 entropy_loss: -19079.39453 self_attn_loss: 1.28010 loss: -19091.95508]
Iterations:  10%|█         | 3/30 [00:08<01:20,  2.97s/it, attack_loss: -13.84039 entropy_loss: -19079.39453 self_attn_loss: 1.28010 loss: -19091.95508]
Iterations:  10%|█         | 3/30 [00:10<01:20,  2.97s/it, attack_loss: -25.95852 entropy_loss: -19085.82422 self_attn_loss: 1.42672 loss: -19110.35547]
Iterations:  13%|█▎        | 4/30 [00:11<01:18,  3.03s/it, attack_loss: -25.95852 entropy_loss: -19085.82422 self_attn_loss: 1.42672 loss: -19110.35547]
Iterations:  13%|█▎        | 4/30 [00:13<01:18,  3.03s/it, attack_loss: -38.74557 entropy_loss: -19098.82812 self_attn_loss: 1.49977 loss: -19136.07422]
Iterations:  17%|█▋        | 5/30 [00:14<01:15,  3.00s/it, attack_loss: -38.74557 entropy_loss: -19098.82812 self_attn_loss: 1.49977 loss: -19136.07422]
Iterations:  17%|█▋        | 5/30 [00:16<01:15,  3.00s/it, attack_loss: -47.78202 entropy_loss: -19112.64844 self_attn_loss: 1.60179 loss: -19158.82812]
Iterations:  20%|██        | 6/30 [00:17<01:12,  3.03s/it, attack_loss: -47.78202 entropy_loss: -19112.64844 self_attn_loss: 1.60179 loss: -19158.82812]
Iterations:  20%|██        | 6/30 [00:19<01:12,  3.03s/it, attack_loss: -57.77281 entropy_loss: -19121.01172 self_attn_loss: 1.66195 loss: -19177.12305]
Iterations:  23%|██▎       | 7/30 [00:20<01:06,  2.89s/it, attack_loss: -57.77281 entropy_loss: -19121.01172 self_attn_loss: 1.66195 loss: -19177.12305]
Iterations:  23%|██▎       | 7/30 [00:22<01:06,  2.89s/it, attack_loss: -67.58770 entropy_loss: -19128.11719 self_attn_loss: 1.69137 loss: -19194.01367]
Iterations:  27%|██▋       | 8/30 [00:23<01:03,  2.88s/it, attack_loss: -67.58770 entropy_loss: -19128.11719 self_attn_loss: 1.69137 loss: -19194.01367]
Iterations:  27%|██▋       | 8/30 [00:24<01:03,  2.88s/it, attack_loss: -76.23781 entropy_loss: -19139.47070 self_attn_loss: 1.77974 loss: -19213.92969]
Iterations:  30%|███       | 9/30 [00:25<00:58,  2.81s/it, attack_loss: -76.23781 entropy_loss: -19139.47070 self_attn_loss: 1.77974 loss: -19213.92969]
Iterations:  30%|███       | 9/30 [00:27<00:58,  2.81s/it, attack_loss: -82.35872 entropy_loss: -19149.33203 self_attn_loss: 1.91132 loss: -19229.77930]
Iterations:  33%|███▎      | 10/30 [00:29<00:58,  2.91s/it, attack_loss: -82.35872 entropy_loss: -19149.33203 self_attn_loss: 1.91132 loss: -19229.77930]
Iterations:  33%|███▎      | 10/30 [00:30<00:58,  2.91s/it, attack_loss: -88.00415 entropy_loss: -19158.85547 self_attn_loss: 1.97584 loss: -19244.88281]
Iterations:  37%|███▋      | 11/30 [00:32<00:56,  3.00s/it, attack_loss: -88.00415 entropy_loss: -19158.85547 self_attn_loss: 1.97584 loss: -19244.88281]
Iterations:  37%|███▋      | 11/30 [00:34<00:56,  3.00s/it, attack_loss: -96.09633 entropy_loss: -19159.75195 self_attn_loss: 2.02448 loss: -19253.82422]
Iterations:  40%|████      | 12/30 [00:35<00:54,  3.04s/it, attack_loss: -96.09633 entropy_loss: -19159.75195 self_attn_loss: 2.02448 loss: -19253.82422]
Iterations:  40%|████      | 12/30 [00:37<00:54,  3.04s/it, attack_loss: -102.71111 entropy_loss: -19160.58398 self_attn_loss: 2.04544 loss: -19261.25000]
Iterations:  43%|████▎     | 13/30 [00:38<00:52,  3.10s/it, attack_loss: -102.71111 entropy_loss: -19160.58398 self_attn_loss: 2.04544 loss: -19261.25000]
Iterations:  43%|████▎     | 13/30 [00:40<00:52,  3.10s/it, attack_loss: -107.83195 entropy_loss: -19161.43555 self_attn_loss: 2.06045 loss: -19267.20703]
Iterations:  47%|████▋     | 14/30 [00:41<00:48,  3.06s/it, attack_loss: -107.83195 entropy_loss: -19161.43555 self_attn_loss: 2.06045 loss: -19267.20703]
Iterations:  47%|████▋     | 14/30 [00:43<00:48,  3.06s/it, attack_loss: -114.91634 entropy_loss: -19163.37695 self_attn_loss: 2.09533 loss: -19276.19727]
Iterations:  50%|█████     | 15/30 [00:44<00:44,  2.94s/it, attack_loss: -114.91634 entropy_loss: -19163.37695 self_attn_loss: 2.09533 loss: -19276.19727]
Iterations:  50%|█████     | 15/30 [00:45<00:44,  2.94s/it, attack_loss: -120.52142 entropy_loss: -19164.65430 self_attn_loss: 2.12865 loss: -19283.04688]
Iterations:  53%|█████▎    | 16/30 [00:46<00:39,  2.79s/it, attack_loss: -120.52142 entropy_loss: -19164.65430 self_attn_loss: 2.12865 loss: -19283.04688]
Iterations:  53%|█████▎    | 16/30 [00:48<00:39,  2.79s/it, attack_loss: -125.02282 entropy_loss: -19165.86328 self_attn_loss: 2.14941 loss: -19288.73633]
Iterations:  57%|█████▋    | 17/30 [00:49<00:36,  2.78s/it, attack_loss: -125.02282 entropy_loss: -19165.86328 self_attn_loss: 2.14941 loss: -19288.73633]
Iterations:  57%|█████▋    | 17/30 [00:51<00:36,  2.78s/it, attack_loss: -131.41435 entropy_loss: -19168.14062 self_attn_loss: 2.18101 loss: -19297.37305]
Iterations:  60%|██████    | 18/30 [00:52<00:34,  2.87s/it, attack_loss: -131.41435 entropy_loss: -19168.14062 self_attn_loss: 2.18101 loss: -19297.37305]
Iterations:  60%|██████    | 18/30 [00:54<00:34,  2.87s/it, attack_loss: -137.91696 entropy_loss: -19170.53516 self_attn_loss: 2.22039 loss: -19306.23242]
Iterations:  63%|██████▎   | 19/30 [00:55<00:32,  2.96s/it, attack_loss: -137.91696 entropy_loss: -19170.53516 self_attn_loss: 2.22039 loss: -19306.23242]
Iterations:  63%|██████▎   | 19/30 [00:57<00:32,  2.96s/it, attack_loss: -137.77713 entropy_loss: -19172.03125 self_attn_loss: 2.24338 loss: -19307.56445]
Iterations:  67%|██████▋   | 20/30 [00:58<00:29,  2.99s/it, attack_loss: -137.77713 entropy_loss: -19172.03125 self_attn_loss: 2.24338 loss: -19307.56445]
Iterations:  67%|██████▋   | 20/30 [01:00<00:29,  2.99s/it, attack_loss: -148.46973 entropy_loss: -19170.21484 self_attn_loss: 2.24215 loss: -19316.44336]
Iterations:  70%|███████   | 21/30 [01:01<00:26,  2.92s/it, attack_loss: -148.46973 entropy_loss: -19170.21484 self_attn_loss: 2.24215 loss: -19316.44336]
Iterations:  70%|███████   | 21/30 [01:03<00:26,  2.92s/it, attack_loss: -153.12428 entropy_loss: -19170.31445 self_attn_loss: 2.25130 loss: -19321.18750]
Iterations:  73%|███████▎  | 22/30 [01:04<00:22,  2.79s/it, attack_loss: -153.12428 entropy_loss: -19170.31445 self_attn_loss: 2.25130 loss: -19321.18750]
Iterations:  73%|███████▎  | 22/30 [01:05<00:22,  2.79s/it, attack_loss: -157.03430 entropy_loss: -19170.90820 self_attn_loss: 2.26636 loss: -19325.67578]
Iterations:  77%|███████▋  | 23/30 [01:06<00:19,  2.73s/it, attack_loss: -157.03430 entropy_loss: -19170.90820 self_attn_loss: 2.26636 loss: -19325.67578]
Iterations:  77%|███████▋  | 23/30 [01:08<00:19,  2.73s/it, attack_loss: -162.91803 entropy_loss: -19171.40430 self_attn_loss: 2.28636 loss: -19332.03516]
Iterations:  80%|████████  | 24/30 [01:09<00:16,  2.73s/it, attack_loss: -162.91803 entropy_loss: -19171.40430 self_attn_loss: 2.28636 loss: -19332.03516]
Iterations:  80%|████████  | 24/30 [01:10<00:16,  2.73s/it, attack_loss: -168.90776 entropy_loss: -19172.16992 self_attn_loss: 2.30307 loss: -19338.77539]
Iterations:  83%|████████▎ | 25/30 [01:12<00:13,  2.77s/it, attack_loss: -168.90776 entropy_loss: -19172.16992 self_attn_loss: 2.30307 loss: -19338.77539]
Iterations:  83%|████████▎ | 25/30 [01:13<00:13,  2.77s/it, attack_loss: -172.95457 entropy_loss: -19178.05469 self_attn_loss: 2.32642 loss: -19348.68359]
Iterations:  87%|████████▋ | 26/30 [01:15<00:11,  2.86s/it, attack_loss: -172.95457 entropy_loss: -19178.05469 self_attn_loss: 2.32642 loss: -19348.68359]
Iterations:  87%|████████▋ | 26/30 [01:17<00:11,  2.86s/it, attack_loss: -178.12529 entropy_loss: -19179.09180 self_attn_loss: 2.34405 loss: -19354.87305]
Iterations:  90%|█████████ | 27/30 [01:18<00:08,  2.94s/it, attack_loss: -178.12529 entropy_loss: -19179.09180 self_attn_loss: 2.34405 loss: -19354.87305]
Iterations:  90%|█████████ | 27/30 [01:20<00:08,  2.94s/it, attack_loss: -183.01659 entropy_loss: -19180.00977 self_attn_loss: 2.36461 loss: -19360.66211]
Iterations:  93%|█████████▎| 28/30 [01:21<00:06,  3.02s/it, attack_loss: -183.01659 entropy_loss: -19180.00977 self_attn_loss: 2.36461 loss: -19360.66211]
Iterations:  93%|█████████▎| 28/30 [01:23<00:06,  3.02s/it, attack_loss: -187.09302 entropy_loss: -19181.26367 self_attn_loss: 2.39529 loss: -19365.96094]
Iterations:  97%|█████████▋| 29/30 [01:25<00:03,  3.12s/it, attack_loss: -187.09302 entropy_loss: -19181.26367 self_attn_loss: 2.39529 loss: -19365.96094]
Iterations:  97%|█████████▋| 29/30 [01:26<00:03,  3.12s/it, attack_loss: -190.65384 entropy_loss: -19182.81641 self_attn_loss: 2.41470 loss: -19371.05469]
Iterations: 100%|██████████| 30/30 [01:27<00:00,  3.07s/it, attack_loss: -190.65384 entropy_loss: -19182.81641 self_attn_loss: 2.41470 loss: -19371.05469]
Iterations: 100%|██████████| 30/30 [01:27<00:00,  2.93s/it, attack_loss: -190.65384 entropy_loss: -19182.81641 self_attn_loss: 2.41470 loss: -19371.05469]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([497], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([663], device='cuda:0') tensor(3.5756e-09, device='cuda:0')
L1: [10414.848]	L2: [40.737457]	Linf: [0.79607844]

Accuracy on benign examples: 100.0%
gt_label: 717 pred_label: 717 pred_clean_logit 0.9892811179161072
prompt generate:  pickup  	labels:  [[717]]
decoder:  [49406, 15382, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.15it/s]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:32<00:00,  6.49s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -0.88946 entropy_loss: -19184.62500 self_attn_loss: 0.00000 loss: -19185.51367]
Iterations:   3%|▎         | 1/30 [00:02<01:13,  2.52s/it, attack_loss: -0.88946 entropy_loss: -19184.62500 self_attn_loss: 0.00000 loss: -19185.51367]
Iterations:   3%|▎         | 1/30 [00:04<01:13,  2.52s/it, attack_loss: -5.06031 entropy_loss: -19149.69922 self_attn_loss: 0.47626 loss: -19154.28320]
Iterations:   7%|▋         | 2/30 [00:05<01:16,  2.74s/it, attack_loss: -5.06031 entropy_loss: -19149.69922 self_attn_loss: 0.47626 loss: -19154.28320]
Iterations:   7%|▋         | 2/30 [00:06<01:16,  2.74s/it, attack_loss: -20.85033 entropy_loss: -19165.15430 self_attn_loss: 0.53253 loss: -19185.47266]
Iterations:  10%|█         | 3/30 [00:08<01:13,  2.73s/it, attack_loss: -20.85033 entropy_loss: -19165.15430 self_attn_loss: 0.53253 loss: -19185.47266]
Iterations:  10%|█         | 3/30 [00:09<01:13,  2.73s/it, attack_loss: -36.68945 entropy_loss: -19176.06445 self_attn_loss: 0.57557 loss: -19212.17773]
Iterations:  13%|█▎        | 4/30 [00:11<01:15,  2.90s/it, attack_loss: -36.68945 entropy_loss: -19176.06445 self_attn_loss: 0.57557 loss: -19212.17773]
Iterations:  13%|█▎        | 4/30 [00:12<01:15,  2.90s/it, attack_loss: -56.56769 entropy_loss: -19159.46094 self_attn_loss: 0.57846 loss: -19215.44922]
Iterations:  17%|█▋        | 5/30 [00:14<01:14,  2.98s/it, attack_loss: -56.56769 entropy_loss: -19159.46094 self_attn_loss: 0.57846 loss: -19215.44922]
Iterations:  17%|█▋        | 5/30 [00:16<01:14,  2.98s/it, attack_loss: -72.86279 entropy_loss: -19132.20117 self_attn_loss: 0.56901 loss: -19204.49414]
Iterations:  20%|██        | 6/30 [00:17<01:12,  3.04s/it, attack_loss: -72.86279 entropy_loss: -19132.20117 self_attn_loss: 0.56901 loss: -19204.49414]
Iterations:  20%|██        | 6/30 [00:19<01:12,  3.04s/it, attack_loss: -87.01231 entropy_loss: -19154.58008 self_attn_loss: 0.64377 loss: -19240.94922]
Iterations:  23%|██▎       | 7/30 [00:20<01:10,  3.07s/it, attack_loss: -87.01231 entropy_loss: -19154.58008 self_attn_loss: 0.64377 loss: -19240.94922]
Iterations:  23%|██▎       | 7/30 [00:22<01:10,  3.07s/it, attack_loss: -98.52032 entropy_loss: -19157.23633 self_attn_loss: 0.71696 loss: -19255.03906]
Iterations:  27%|██▋       | 8/30 [00:24<01:10,  3.20s/it, attack_loss: -98.52032 entropy_loss: -19157.23633 self_attn_loss: 0.71696 loss: -19255.03906]
Iterations:  27%|██▋       | 8/30 [00:25<01:10,  3.20s/it, attack_loss: -109.76170 entropy_loss: -19135.49609 self_attn_loss: 0.73621 loss: -19244.52148]
Iterations:  30%|███       | 9/30 [00:26<01:03,  3.04s/it, attack_loss: -109.76170 entropy_loss: -19135.49609 self_attn_loss: 0.73621 loss: -19244.52148]
Iterations:  30%|███       | 9/30 [00:28<01:03,  3.04s/it, attack_loss: -119.12350 entropy_loss: -19152.09570 self_attn_loss: 0.69292 loss: -19270.52539]
Iterations:  33%|███▎      | 10/30 [00:29<00:57,  2.89s/it, attack_loss: -119.12350 entropy_loss: -19152.09570 self_attn_loss: 0.69292 loss: -19270.52539]
Iterations:  33%|███▎      | 10/30 [00:30<00:57,  2.89s/it, attack_loss: -128.52887 entropy_loss: -19158.95898 self_attn_loss: 0.70151 loss: -19286.78711]
Iterations:  37%|███▋      | 11/30 [00:32<00:54,  2.87s/it, attack_loss: -128.52887 entropy_loss: -19158.95898 self_attn_loss: 0.70151 loss: -19286.78711]
Iterations:  37%|███▋      | 11/30 [00:34<00:54,  2.87s/it, attack_loss: -136.54063 entropy_loss: -19139.97266 self_attn_loss: 0.75273 loss: -19275.75977]
Iterations:  40%|████      | 12/30 [00:35<00:54,  3.00s/it, attack_loss: -136.54063 entropy_loss: -19139.97266 self_attn_loss: 0.75273 loss: -19275.75977]
Iterations:  40%|████      | 12/30 [00:37<00:54,  3.00s/it, attack_loss: -143.41237 entropy_loss: -19135.56055 self_attn_loss: 0.82424 loss: -19278.14844]
Iterations:  43%|████▎     | 13/30 [00:38<00:52,  3.07s/it, attack_loss: -143.41237 entropy_loss: -19135.56055 self_attn_loss: 0.82424 loss: -19278.14844]
Iterations:  43%|████▎     | 13/30 [00:40<00:52,  3.07s/it, attack_loss: -150.96284 entropy_loss: -19141.98438 self_attn_loss: 0.84940 loss: -19292.09766]
Iterations:  47%|████▋     | 14/30 [00:41<00:49,  3.10s/it, attack_loss: -150.96284 entropy_loss: -19141.98438 self_attn_loss: 0.84940 loss: -19292.09766]
Iterations:  47%|████▋     | 14/30 [00:43<00:49,  3.10s/it, attack_loss: -158.01266 entropy_loss: -19133.80859 self_attn_loss: 0.87392 loss: -19290.94727]
Iterations:  50%|█████     | 15/30 [00:44<00:44,  2.99s/it, attack_loss: -158.01266 entropy_loss: -19133.80859 self_attn_loss: 0.87392 loss: -19290.94727]
Iterations:  50%|█████     | 15/30 [00:46<00:44,  2.99s/it, attack_loss: -164.84712 entropy_loss: -19127.70312 self_attn_loss: 0.88228 loss: -19291.66797]
Iterations:  53%|█████▎    | 16/30 [00:47<00:40,  2.89s/it, attack_loss: -164.84712 entropy_loss: -19127.70312 self_attn_loss: 0.88228 loss: -19291.66797]
Iterations:  53%|█████▎    | 16/30 [00:48<00:40,  2.89s/it, attack_loss: -172.23782 entropy_loss: -19123.76367 self_attn_loss: 0.89959 loss: -19295.10156]
Iterations:  57%|█████▋    | 17/30 [00:49<00:36,  2.81s/it, attack_loss: -172.23782 entropy_loss: -19123.76367 self_attn_loss: 0.89959 loss: -19295.10156]
Iterations:  57%|█████▋    | 17/30 [00:51<00:36,  2.81s/it, attack_loss: -178.27620 entropy_loss: -19118.92383 self_attn_loss: 0.91158 loss: -19296.28906]
Iterations:  60%|██████    | 18/30 [00:52<00:32,  2.75s/it, attack_loss: -178.27620 entropy_loss: -19118.92383 self_attn_loss: 0.91158 loss: -19296.28906]
Iterations:  60%|██████    | 18/30 [00:54<00:32,  2.75s/it, attack_loss: -184.20714 entropy_loss: -19110.27734 self_attn_loss: 0.91030 loss: -19293.57422]
Iterations:  63%|██████▎   | 19/30 [00:55<00:30,  2.78s/it, attack_loss: -184.20714 entropy_loss: -19110.27734 self_attn_loss: 0.91030 loss: -19293.57422]
Iterations:  63%|██████▎   | 19/30 [00:57<00:30,  2.78s/it, attack_loss: -189.71681 entropy_loss: -19112.96680 self_attn_loss: 0.92992 loss: -19301.75391]
Iterations:  67%|██████▋   | 20/30 [00:58<00:29,  2.99s/it, attack_loss: -189.71681 entropy_loss: -19112.96680 self_attn_loss: 0.92992 loss: -19301.75391]
Iterations:  67%|██████▋   | 20/30 [01:00<00:29,  2.99s/it, attack_loss: -194.80368 entropy_loss: -19116.37891 self_attn_loss: 0.95042 loss: -19310.23242]
Iterations:  70%|███████   | 21/30 [01:02<00:27,  3.07s/it, attack_loss: -194.80368 entropy_loss: -19116.37891 self_attn_loss: 0.95042 loss: -19310.23242]
Iterations:  70%|███████   | 21/30 [01:03<00:27,  3.07s/it, attack_loss: -200.58221 entropy_loss: -19114.41406 self_attn_loss: 0.95597 loss: -19314.04102]
Iterations:  73%|███████▎  | 22/30 [01:05<00:24,  3.11s/it, attack_loss: -200.58221 entropy_loss: -19114.41406 self_attn_loss: 0.95597 loss: -19314.04102]
Iterations:  73%|███████▎  | 22/30 [01:07<00:24,  3.11s/it, attack_loss: -206.30006 entropy_loss: -19109.43555 self_attn_loss: 0.94962 loss: -19314.78516]
Iterations:  77%|███████▋  | 23/30 [01:08<00:21,  3.12s/it, attack_loss: -206.30006 entropy_loss: -19109.43555 self_attn_loss: 0.94962 loss: -19314.78516]
Iterations:  77%|███████▋  | 23/30 [01:10<00:21,  3.12s/it, attack_loss: -211.31950 entropy_loss: -19111.33008 self_attn_loss: 0.96087 loss: -19321.68945]
Iterations:  80%|████████  | 24/30 [01:11<00:18,  3.06s/it, attack_loss: -211.31950 entropy_loss: -19111.33008 self_attn_loss: 0.96087 loss: -19321.68945]
Iterations:  80%|████████  | 24/30 [01:12<00:18,  3.06s/it, attack_loss: -216.24088 entropy_loss: -19105.48438 self_attn_loss: 0.98892 loss: -19320.73633]
Iterations:  83%|████████▎ | 25/30 [01:14<00:14,  2.94s/it, attack_loss: -216.24088 entropy_loss: -19105.48438 self_attn_loss: 0.98892 loss: -19320.73633]
Iterations:  83%|████████▎ | 25/30 [01:15<00:14,  2.94s/it, attack_loss: -221.91824 entropy_loss: -19094.83008 self_attn_loss: 0.99093 loss: -19315.75781]
Iterations:  87%|████████▋ | 26/30 [01:16<00:11,  2.83s/it, attack_loss: -221.91824 entropy_loss: -19094.83008 self_attn_loss: 0.99093 loss: -19315.75781]
Iterations:  87%|████████▋ | 26/30 [01:18<00:11,  2.83s/it, attack_loss: -227.15765 entropy_loss: -19085.46875 self_attn_loss: 0.99586 loss: -19311.63086]
Iterations:  90%|█████████ | 27/30 [01:19<00:08,  2.86s/it, attack_loss: -227.15765 entropy_loss: -19085.46875 self_attn_loss: 0.99586 loss: -19311.63086]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.86s/it, attack_loss: -232.75714 entropy_loss: -19095.35156 self_attn_loss: 1.03058 loss: -19327.07812]
Iterations:  93%|█████████▎| 28/30 [01:22<00:05,  2.94s/it, attack_loss: -232.75714 entropy_loss: -19095.35156 self_attn_loss: 1.03058 loss: -19327.07812]
Iterations:  93%|█████████▎| 28/30 [01:24<00:05,  2.94s/it, attack_loss: -237.60124 entropy_loss: -19099.41797 self_attn_loss: 1.05524 loss: -19335.96484]
Iterations:  97%|█████████▋| 29/30 [01:25<00:03,  3.02s/it, attack_loss: -237.60124 entropy_loss: -19099.41797 self_attn_loss: 1.05524 loss: -19335.96484]
Iterations:  97%|█████████▋| 29/30 [01:27<00:03,  3.02s/it, attack_loss: -243.21466 entropy_loss: -19100.95898 self_attn_loss: 1.07102 loss: -19343.10352]
Iterations: 100%|██████████| 30/30 [01:29<00:00,  3.07s/it, attack_loss: -243.21466 entropy_loss: -19100.95898 self_attn_loss: 1.07102 loss: -19343.10352]
Iterations: 100%|██████████| 30/30 [01:29<00:00,  2.97s/it, attack_loss: -243.21466 entropy_loss: -19100.95898 self_attn_loss: 1.07102 loss: -19343.10352]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([468], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([717], device='cuda:0') tensor(1.4704e-11, device='cuda:0')
L1: [8254.741]	L2: [35.50124]	Linf: [0.83137256]

Accuracy on benign examples: 100.0%
gt_label: 671 pred_label: 671 pred_clean_logit 0.6306856274604797
prompt generate:  mountain bike  	labels:  [[671]]
decoder:  [49406, 3965, 3701, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:03<00:00,  5.08it/s]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:32<00:00,  6.52s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -11.61487 entropy_loss: -18829.59961 self_attn_loss: 0.00000 loss: -18841.21484]
Iterations:   3%|▎         | 1/30 [00:02<01:25,  2.95s/it, attack_loss: -11.61487 entropy_loss: -18829.59961 self_attn_loss: 0.00000 loss: -18841.21484]
Iterations:   3%|▎         | 1/30 [00:04<01:25,  2.95s/it, attack_loss: -39.57614 entropy_loss: -18815.28125 self_attn_loss: 0.50911 loss: -18854.34766]
Iterations:   7%|▋         | 2/30 [00:06<01:29,  3.19s/it, attack_loss: -39.57614 entropy_loss: -18815.28125 self_attn_loss: 0.50911 loss: -18854.34766]
Iterations:   7%|▋         | 2/30 [00:07<01:29,  3.19s/it, attack_loss: -63.04490 entropy_loss: -18813.81445 self_attn_loss: 1.10050 loss: -18875.75977]
Iterations:  10%|█         | 3/30 [00:09<01:21,  3.01s/it, attack_loss: -63.04490 entropy_loss: -18813.81445 self_attn_loss: 1.10050 loss: -18875.75977]
Iterations:  10%|█         | 3/30 [00:10<01:21,  3.01s/it, attack_loss: -87.17744 entropy_loss: -18831.20703 self_attn_loss: 1.24630 loss: -18917.13867]
Iterations:  13%|█▎        | 4/30 [00:11<01:15,  2.90s/it, attack_loss: -87.17744 entropy_loss: -18831.20703 self_attn_loss: 1.24630 loss: -18917.13867]
Iterations:  13%|█▎        | 4/30 [00:13<01:15,  2.90s/it, attack_loss: -102.21274 entropy_loss: -18840.17188 self_attn_loss: 1.45557 loss: -18940.92969]
Iterations:  17%|█▋        | 5/30 [00:14<01:10,  2.80s/it, attack_loss: -102.21274 entropy_loss: -18840.17188 self_attn_loss: 1.45557 loss: -18940.92969]
Iterations:  17%|█▋        | 5/30 [00:16<01:10,  2.80s/it, attack_loss: -109.85915 entropy_loss: -18821.42578 self_attn_loss: 1.76700 loss: -18929.51758]
Iterations:  20%|██        | 6/30 [00:17<01:09,  2.90s/it, attack_loss: -109.85915 entropy_loss: -18821.42578 self_attn_loss: 1.76700 loss: -18929.51758]
Iterations:  20%|██        | 6/30 [00:19<01:09,  2.90s/it, attack_loss: -124.85070 entropy_loss: -18832.66992 self_attn_loss: 1.83032 loss: -18955.68945]
Iterations:  23%|██▎       | 7/30 [00:20<01:08,  2.97s/it, attack_loss: -124.85070 entropy_loss: -18832.66992 self_attn_loss: 1.83032 loss: -18955.68945]
Iterations:  23%|██▎       | 7/30 [00:22<01:08,  2.97s/it, attack_loss: -131.63618 entropy_loss: -18856.23633 self_attn_loss: 1.87061 loss: -18986.00195]
Iterations:  27%|██▋       | 8/30 [00:24<01:08,  3.11s/it, attack_loss: -131.63618 entropy_loss: -18856.23633 self_attn_loss: 1.87061 loss: -18986.00195]
Iterations:  27%|██▋       | 8/30 [00:26<01:08,  3.11s/it, attack_loss: -144.89430 entropy_loss: -18862.85547 self_attn_loss: 1.89059 loss: -19005.85938]
Iterations:  30%|███       | 9/30 [00:27<01:07,  3.20s/it, attack_loss: -144.89430 entropy_loss: -18862.85547 self_attn_loss: 1.89059 loss: -19005.85938]
Iterations:  30%|███       | 9/30 [00:29<01:07,  3.20s/it, attack_loss: -156.97997 entropy_loss: -18866.71484 self_attn_loss: 1.90604 loss: -19021.78906]
Iterations:  33%|███▎      | 10/30 [00:30<01:02,  3.11s/it, attack_loss: -156.97997 entropy_loss: -18866.71484 self_attn_loss: 1.90604 loss: -19021.78906]
Iterations:  33%|███▎      | 10/30 [00:31<01:02,  3.11s/it, attack_loss: -167.00024 entropy_loss: -18868.04883 self_attn_loss: 1.92486 loss: -19033.12500]
Iterations:  37%|███▋      | 11/30 [00:32<00:53,  2.82s/it, attack_loss: -167.00024 entropy_loss: -18868.04883 self_attn_loss: 1.92486 loss: -19033.12500]
Iterations:  37%|███▋      | 11/30 [00:33<00:53,  2.82s/it, attack_loss: -177.69308 entropy_loss: -18867.82031 self_attn_loss: 1.94583 loss: -19043.56836]
Iterations:  40%|████      | 12/30 [00:34<00:48,  2.67s/it, attack_loss: -177.69308 entropy_loss: -18867.82031 self_attn_loss: 1.94583 loss: -19043.56836]
Iterations:  40%|████      | 12/30 [00:36<00:48,  2.67s/it, attack_loss: -188.30777 entropy_loss: -18867.33398 self_attn_loss: 1.99061 loss: -19053.65039]
Iterations:  43%|████▎     | 13/30 [00:37<00:45,  2.71s/it, attack_loss: -188.30777 entropy_loss: -18867.33398 self_attn_loss: 1.99061 loss: -19053.65039]
Iterations:  43%|████▎     | 13/30 [00:39<00:45,  2.71s/it, attack_loss: -197.71799 entropy_loss: -18870.42383 self_attn_loss: 2.00145 loss: -19066.14062]
Iterations:  47%|████▋     | 14/30 [00:40<00:45,  2.87s/it, attack_loss: -197.71799 entropy_loss: -18870.42383 self_attn_loss: 2.00145 loss: -19066.14062]
Iterations:  47%|████▋     | 14/30 [00:42<00:45,  2.87s/it, attack_loss: -206.42337 entropy_loss: -18880.35352 self_attn_loss: 1.98725 loss: -19084.78906]
Iterations:  50%|█████     | 15/30 [00:44<00:44,  2.96s/it, attack_loss: -206.42337 entropy_loss: -18880.35352 self_attn_loss: 1.98725 loss: -19084.78906]
Iterations:  50%|█████     | 15/30 [00:45<00:44,  2.96s/it, attack_loss: -213.61249 entropy_loss: -18880.75977 self_attn_loss: 2.03052 loss: -19092.34180]
Iterations:  53%|█████▎    | 16/30 [00:47<00:41,  3.00s/it, attack_loss: -213.61249 entropy_loss: -18880.75977 self_attn_loss: 2.03052 loss: -19092.34180]
Iterations:  53%|█████▎    | 16/30 [00:48<00:41,  3.00s/it, attack_loss: -221.08948 entropy_loss: -18873.99023 self_attn_loss: 2.06658 loss: -19093.01367]
Iterations:  57%|█████▋    | 17/30 [00:50<00:39,  3.03s/it, attack_loss: -221.08948 entropy_loss: -18873.99023 self_attn_loss: 2.06658 loss: -19093.01367]
Iterations:  57%|█████▋    | 17/30 [00:51<00:39,  3.03s/it, attack_loss: -227.48772 entropy_loss: -18878.46289 self_attn_loss: 2.08881 loss: -19103.86133]
Iterations:  60%|██████    | 18/30 [00:53<00:36,  3.04s/it, attack_loss: -227.48772 entropy_loss: -18878.46289 self_attn_loss: 2.08881 loss: -19103.86133]
Iterations:  60%|██████    | 18/30 [00:54<00:36,  3.04s/it, attack_loss: -234.64584 entropy_loss: -18876.73828 self_attn_loss: 2.16013 loss: -19109.22461]
Iterations:  63%|██████▎   | 19/30 [00:56<00:32,  2.99s/it, attack_loss: -234.64584 entropy_loss: -18876.73828 self_attn_loss: 2.16013 loss: -19109.22461]
Iterations:  63%|██████▎   | 19/30 [00:57<00:32,  2.99s/it, attack_loss: -242.20151 entropy_loss: -18875.57227 self_attn_loss: 2.21245 loss: -19115.56055]
Iterations:  67%|██████▋   | 20/30 [00:58<00:28,  2.85s/it, attack_loss: -242.20151 entropy_loss: -18875.57227 self_attn_loss: 2.21245 loss: -19115.56055]
Iterations:  67%|██████▋   | 20/30 [01:00<00:28,  2.85s/it, attack_loss: -248.27637 entropy_loss: -18879.94336 self_attn_loss: 2.26166 loss: -19125.95898]
Iterations:  70%|███████   | 21/30 [01:01<00:25,  2.84s/it, attack_loss: -248.27637 entropy_loss: -18879.94336 self_attn_loss: 2.26166 loss: -19125.95898]
Iterations:  70%|███████   | 21/30 [01:03<00:25,  2.84s/it, attack_loss: -255.17505 entropy_loss: -18882.48242 self_attn_loss: 2.29341 loss: -19135.36328]
Iterations:  73%|███████▎  | 22/30 [01:04<00:23,  2.99s/it, attack_loss: -255.17505 entropy_loss: -18882.48242 self_attn_loss: 2.29341 loss: -19135.36328]
Iterations:  73%|███████▎  | 22/30 [01:06<00:23,  2.99s/it, attack_loss: -261.78201 entropy_loss: -18884.04102 self_attn_loss: 2.31371 loss: -19143.50977]
Iterations:  77%|███████▋  | 23/30 [01:08<00:21,  3.04s/it, attack_loss: -261.78201 entropy_loss: -18884.04102 self_attn_loss: 2.31371 loss: -19143.50977]
Iterations:  77%|███████▋  | 23/30 [01:09<00:21,  3.04s/it, attack_loss: -268.04541 entropy_loss: -18884.25977 self_attn_loss: 2.32903 loss: -19149.97656]
Iterations:  80%|████████  | 24/30 [01:11<00:18,  3.04s/it, attack_loss: -268.04541 entropy_loss: -18884.25977 self_attn_loss: 2.32903 loss: -19149.97656]
Iterations:  80%|████████  | 24/30 [01:12<00:18,  3.04s/it, attack_loss: -274.61707 entropy_loss: -18884.14062 self_attn_loss: 2.34189 loss: -19156.41602]
Iterations:  83%|████████▎ | 25/30 [01:14<00:15,  3.08s/it, attack_loss: -274.61707 entropy_loss: -18884.14062 self_attn_loss: 2.34189 loss: -19156.41602]
Iterations:  83%|████████▎ | 25/30 [01:15<00:15,  3.08s/it, attack_loss: -280.55698 entropy_loss: -18884.30859 self_attn_loss: 2.34740 loss: -19162.51758]
Iterations:  87%|████████▋ | 26/30 [01:17<00:12,  3.06s/it, attack_loss: -280.55698 entropy_loss: -18884.30859 self_attn_loss: 2.34740 loss: -19162.51758]
Iterations:  87%|████████▋ | 26/30 [01:18<00:12,  3.06s/it, attack_loss: -286.07193 entropy_loss: -18885.34180 self_attn_loss: 2.34908 loss: -19169.06445]
Iterations:  90%|█████████ | 27/30 [01:19<00:08,  2.90s/it, attack_loss: -286.07193 entropy_loss: -18885.34180 self_attn_loss: 2.34908 loss: -19169.06445]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.90s/it, attack_loss: -290.74875 entropy_loss: -18886.63477 self_attn_loss: 2.34868 loss: -19175.03516]
Iterations:  93%|█████████▎| 28/30 [01:22<00:05,  2.83s/it, attack_loss: -290.74875 entropy_loss: -18886.63477 self_attn_loss: 2.34868 loss: -19175.03516]
Iterations:  93%|█████████▎| 28/30 [01:23<00:05,  2.83s/it, attack_loss: -296.10498 entropy_loss: -18887.27344 self_attn_loss: 2.34451 loss: -19181.03320]
Iterations:  97%|█████████▋| 29/30 [01:25<00:02,  2.78s/it, attack_loss: -296.10498 entropy_loss: -18887.27344 self_attn_loss: 2.34451 loss: -19181.03320]
Iterations:  97%|█████████▋| 29/30 [01:26<00:02,  2.78s/it, attack_loss: -301.05801 entropy_loss: -18888.07031 self_attn_loss: 2.33987 loss: -19186.78906]
Iterations: 100%|██████████| 30/30 [01:28<00:00,  2.90s/it, attack_loss: -301.05801 entropy_loss: -18888.07031 self_attn_loss: 2.33987 loss: -19186.78906]
Iterations: 100%|██████████| 30/30 [01:28<00:00,  2.94s/it, attack_loss: -301.05801 entropy_loss: -18888.07031 self_attn_loss: 2.33987 loss: -19186.78906]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([880], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([671], device='cuda:0') tensor(5.1871e-14, device='cuda:0')
L1: [7204.623]	L2: [28.063627]	Linf: [0.9019608]

Accuracy on benign examples: 100.0%
gt_label: 324 pred_label: 324 pred_clean_logit 0.9429625272750854
prompt generate:  cabbage butterfly  	labels:  [[324]]
decoder:  [49406, 18407, 9738, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  4.42it/s]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:31<00:00,  6.31s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -8.53176 entropy_loss: -18943.47266 self_attn_loss: 0.00000 loss: -18952.00391]
Iterations:   3%|▎         | 1/30 [00:02<01:26,  2.99s/it, attack_loss: -8.53176 entropy_loss: -18943.47266 self_attn_loss: 0.00000 loss: -18952.00391]
Iterations:   3%|▎         | 1/30 [00:04<01:26,  2.99s/it, attack_loss: -18.88255 entropy_loss: -18956.83008 self_attn_loss: 0.97374 loss: -18974.73828]
Iterations:   7%|▋         | 2/30 [00:06<01:28,  3.16s/it, attack_loss: -18.88255 entropy_loss: -18956.83008 self_attn_loss: 0.97374 loss: -18974.73828]
Iterations:   7%|▋         | 2/30 [00:08<01:28,  3.16s/it, attack_loss: -37.58075 entropy_loss: -18979.79883 self_attn_loss: 1.12190 loss: -19016.25781]
Iterations:  10%|█         | 3/30 [00:09<01:25,  3.16s/it, attack_loss: -37.58075 entropy_loss: -18979.79883 self_attn_loss: 1.12190 loss: -19016.25781]
Iterations:  10%|█         | 3/30 [00:11<01:25,  3.16s/it, attack_loss: -48.62551 entropy_loss: -19012.41406 self_attn_loss: 1.13617 loss: -19059.90430]
Iterations:  13%|█▎        | 4/30 [00:12<01:21,  3.15s/it, attack_loss: -48.62551 entropy_loss: -19012.41406 self_attn_loss: 1.13617 loss: -19059.90430]
Iterations:  13%|█▎        | 4/30 [00:14<01:21,  3.15s/it, attack_loss: -56.66725 entropy_loss: -19040.32422 self_attn_loss: 1.19478 loss: -19095.79688]
Iterations:  17%|█▋        | 5/30 [00:15<01:17,  3.11s/it, attack_loss: -56.66725 entropy_loss: -19040.32422 self_attn_loss: 1.19478 loss: -19095.79688]
Iterations:  17%|█▋        | 5/30 [00:17<01:17,  3.11s/it, attack_loss: -66.72945 entropy_loss: -19059.73242 self_attn_loss: 1.30640 loss: -19125.15625]
Iterations:  20%|██        | 6/30 [00:18<01:10,  2.94s/it, attack_loss: -66.72945 entropy_loss: -19059.73242 self_attn_loss: 1.30640 loss: -19125.15625]
Iterations:  20%|██        | 6/30 [00:19<01:10,  2.94s/it, attack_loss: -78.38637 entropy_loss: -19068.02734 self_attn_loss: 1.40476 loss: -19145.00977]
Iterations:  23%|██▎       | 7/30 [00:20<01:06,  2.88s/it, attack_loss: -78.38637 entropy_loss: -19068.02734 self_attn_loss: 1.40476 loss: -19145.00977]
Iterations:  23%|██▎       | 7/30 [00:22<01:06,  2.88s/it, attack_loss: -91.60834 entropy_loss: -19069.71484 self_attn_loss: 1.50336 loss: -19159.82031]
Iterations:  27%|██▋       | 8/30 [00:23<01:04,  2.92s/it, attack_loss: -91.60834 entropy_loss: -19069.71484 self_attn_loss: 1.50336 loss: -19159.82031]
Iterations:  27%|██▋       | 8/30 [00:25<01:04,  2.92s/it, attack_loss: -105.83931 entropy_loss: -19078.10742 self_attn_loss: 1.60255 loss: -19182.34375]
Iterations:  30%|███       | 9/30 [00:27<01:02,  2.99s/it, attack_loss: -105.83931 entropy_loss: -19078.10742 self_attn_loss: 1.60255 loss: -19182.34375]
Iterations:  30%|███       | 9/30 [00:28<01:02,  2.99s/it, attack_loss: -123.15820 entropy_loss: -19085.00586 self_attn_loss: 1.68731 loss: -19206.47656]
Iterations:  33%|███▎      | 10/30 [00:30<01:00,  3.04s/it, attack_loss: -123.15820 entropy_loss: -19085.00586 self_attn_loss: 1.68731 loss: -19206.47656]
Iterations:  33%|███▎      | 10/30 [00:32<01:00,  3.04s/it, attack_loss: -143.55124 entropy_loss: -19095.69922 self_attn_loss: 1.85106 loss: -19237.39844]
Iterations:  37%|███▋      | 11/30 [00:33<00:58,  3.08s/it, attack_loss: -143.55124 entropy_loss: -19095.69922 self_attn_loss: 1.85106 loss: -19237.39844]
Iterations:  37%|███▋      | 11/30 [00:35<00:58,  3.08s/it, attack_loss: -161.66296 entropy_loss: -19090.18555 self_attn_loss: 1.94026 loss: -19249.90820]
Iterations:  40%|████      | 12/30 [00:36<00:57,  3.20s/it, attack_loss: -161.66296 entropy_loss: -19090.18555 self_attn_loss: 1.94026 loss: -19249.90820]
Iterations:  40%|████      | 12/30 [00:38<00:57,  3.20s/it, attack_loss: -180.51210 entropy_loss: -19090.99609 self_attn_loss: 1.96112 loss: -19269.54688]
Iterations:  43%|████▎     | 13/30 [00:40<00:54,  3.19s/it, attack_loss: -180.51210 entropy_loss: -19090.99609 self_attn_loss: 1.96112 loss: -19269.54688]
Iterations:  43%|████▎     | 13/30 [00:41<00:54,  3.19s/it, attack_loss: -198.33931 entropy_loss: -19094.63477 self_attn_loss: 2.00380 loss: -19290.97070]
Iterations:  47%|████▋     | 14/30 [00:42<00:48,  3.04s/it, attack_loss: -198.33931 entropy_loss: -19094.63477 self_attn_loss: 2.00380 loss: -19290.97070]
Iterations:  47%|████▋     | 14/30 [00:44<00:48,  3.04s/it, attack_loss: -213.52899 entropy_loss: -19089.88477 self_attn_loss: 1.98334 loss: -19301.42969]
Iterations:  50%|█████     | 15/30 [00:45<00:45,  3.05s/it, attack_loss: -213.52899 entropy_loss: -19089.88477 self_attn_loss: 1.98334 loss: -19301.42969]
Iterations:  50%|█████     | 15/30 [00:47<00:45,  3.05s/it, attack_loss: -226.74258 entropy_loss: -19082.32617 self_attn_loss: 2.02557 loss: -19307.04297]
Iterations:  53%|█████▎    | 16/30 [00:48<00:41,  2.97s/it, attack_loss: -226.74258 entropy_loss: -19082.32617 self_attn_loss: 2.02557 loss: -19307.04297]
Iterations:  53%|█████▎    | 16/30 [00:50<00:41,  2.97s/it, attack_loss: -236.65933 entropy_loss: -19079.81641 self_attn_loss: 1.95864 loss: -19314.51758]
Iterations:  57%|█████▋    | 17/30 [00:51<00:39,  3.02s/it, attack_loss: -236.65933 entropy_loss: -19079.81641 self_attn_loss: 1.95864 loss: -19314.51758]
Iterations:  57%|█████▋    | 17/30 [00:53<00:39,  3.02s/it, attack_loss: -246.81116 entropy_loss: -19078.48633 self_attn_loss: 2.18179 loss: -19323.11523]
Iterations:  60%|██████    | 18/30 [00:54<00:36,  3.08s/it, attack_loss: -246.81116 entropy_loss: -19078.48633 self_attn_loss: 2.18179 loss: -19323.11523]
Iterations:  60%|██████    | 18/30 [00:56<00:36,  3.08s/it, attack_loss: -252.11266 entropy_loss: -19082.14062 self_attn_loss: 2.35044 loss: -19331.90234]
Iterations:  63%|██████▎   | 19/30 [00:58<00:34,  3.14s/it, attack_loss: -252.11266 entropy_loss: -19082.14062 self_attn_loss: 2.35044 loss: -19331.90234]
Iterations:  63%|██████▎   | 19/30 [01:00<00:34,  3.14s/it, attack_loss: -266.47943 entropy_loss: -19075.97852 self_attn_loss: 2.26790 loss: -19340.18945]
Iterations:  67%|██████▋   | 20/30 [01:01<00:31,  3.15s/it, attack_loss: -266.47943 entropy_loss: -19075.97852 self_attn_loss: 2.26790 loss: -19340.18945]
Iterations:  67%|██████▋   | 20/30 [01:03<00:31,  3.15s/it, attack_loss: -277.47092 entropy_loss: -19061.77734 self_attn_loss: 2.22380 loss: -19337.02539]
Iterations:  70%|███████   | 21/30 [01:04<00:28,  3.13s/it, attack_loss: -277.47092 entropy_loss: -19061.77734 self_attn_loss: 2.22380 loss: -19337.02539]
Iterations:  70%|███████   | 21/30 [01:06<00:28,  3.13s/it, attack_loss: -287.35144 entropy_loss: -19052.59375 self_attn_loss: 2.23368 loss: -19337.71094]
Iterations:  73%|███████▎  | 22/30 [01:07<00:24,  3.09s/it, attack_loss: -287.35144 entropy_loss: -19052.59375 self_attn_loss: 2.23368 loss: -19337.71094]
Iterations:  73%|███████▎  | 22/30 [01:09<00:24,  3.09s/it, attack_loss: -297.71732 entropy_loss: -19052.91602 self_attn_loss: 2.29191 loss: -19348.34180]
Iterations:  77%|███████▋  | 23/30 [01:10<00:20,  2.98s/it, attack_loss: -297.71732 entropy_loss: -19052.91602 self_attn_loss: 2.29191 loss: -19348.34180]
Iterations:  77%|███████▋  | 23/30 [01:11<00:20,  2.98s/it, attack_loss: -309.78928 entropy_loss: -19063.02734 self_attn_loss: 2.32785 loss: -19370.48828]
Iterations:  80%|████████  | 24/30 [01:13<00:17,  2.96s/it, attack_loss: -309.78928 entropy_loss: -19063.02734 self_attn_loss: 2.32785 loss: -19370.48828]
Iterations:  80%|████████  | 24/30 [01:14<00:17,  2.96s/it, attack_loss: -319.43652 entropy_loss: -19073.23828 self_attn_loss: 2.33005 loss: -19390.34570]
Iterations:  83%|████████▎ | 25/30 [01:16<00:15,  3.03s/it, attack_loss: -319.43652 entropy_loss: -19073.23828 self_attn_loss: 2.33005 loss: -19390.34570]
Iterations:  83%|████████▎ | 25/30 [01:18<00:15,  3.03s/it, attack_loss: -329.71347 entropy_loss: -19075.54102 self_attn_loss: 2.34561 loss: -19402.90820]
Iterations:  87%|████████▋ | 26/30 [01:19<00:11,  2.98s/it, attack_loss: -329.71347 entropy_loss: -19075.54102 self_attn_loss: 2.34561 loss: -19402.90820]
Iterations:  87%|████████▋ | 26/30 [01:20<00:11,  2.98s/it, attack_loss: -340.70197 entropy_loss: -19072.07031 self_attn_loss: 2.33928 loss: -19410.43359]
Iterations:  90%|█████████ | 27/30 [01:21<00:08,  2.90s/it, attack_loss: -340.70197 entropy_loss: -19072.07031 self_attn_loss: 2.33928 loss: -19410.43359]
Iterations:  90%|█████████ | 27/30 [01:23<00:08,  2.90s/it, attack_loss: -352.11975 entropy_loss: -19068.58789 self_attn_loss: 2.37101 loss: -19418.33594]
Iterations:  93%|█████████▎| 28/30 [01:24<00:05,  2.89s/it, attack_loss: -352.11975 entropy_loss: -19068.58789 self_attn_loss: 2.37101 loss: -19418.33594]
Iterations:  93%|█████████▎| 28/30 [01:26<00:05,  2.89s/it, attack_loss: -363.36456 entropy_loss: -19066.04102 self_attn_loss: 2.40853 loss: -19426.99609]
Iterations:  97%|█████████▋| 29/30 [01:27<00:02,  2.94s/it, attack_loss: -363.36456 entropy_loss: -19066.04102 self_attn_loss: 2.40853 loss: -19426.99609]
Iterations:  97%|█████████▋| 29/30 [01:29<00:02,  2.94s/it, attack_loss: -375.21375 entropy_loss: -19061.94531 self_attn_loss: 2.42611 loss: -19434.73242]
Iterations: 100%|██████████| 30/30 [01:30<00:00,  2.85s/it, attack_loss: -375.21375 entropy_loss: -19061.94531 self_attn_loss: 2.42611 loss: -19434.73242]
Iterations: 100%|██████████| 30/30 [01:30<00:00,  3.02s/it, attack_loss: -375.21375 entropy_loss: -19061.94531 self_attn_loss: 2.42611 loss: -19434.73242]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([55], device='cuda:0') tensor(0.5682, device='cuda:0')
after_true: tensor([324], device='cuda:0') tensor(1.5394e-17, device='cuda:0')
L1: [6475.7095]	L2: [23.839241]	Linf: [0.6431373]

Accuracy on benign examples: 100.0%
gt_label: 759 pred_label: 759 pred_clean_logit 0.9951533079147339
prompt generate:  reflex camera  	labels:  [[759]]
decoder:  [49406, 36050, 3934, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:04<00:00,  3.90it/s]

Optimize_uncond_embed: 100%|██████████| 5/5 [00:32<00:00,  6.60s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -0.10091 entropy_loss: -19159.84180 self_attn_loss: 0.00000 loss: -19159.94336]
Iterations:   3%|▎         | 1/30 [00:02<01:08,  2.35s/it, attack_loss: -0.10091 entropy_loss: -19159.84180 self_attn_loss: 0.00000 loss: -19159.94336]
Iterations:   3%|▎         | 1/30 [00:03<01:08,  2.35s/it, attack_loss: -6.20976 entropy_loss: -19114.59180 self_attn_loss: 2.01514 loss: -19118.78711]
Iterations:   7%|▋         | 2/30 [00:04<01:03,  2.25s/it, attack_loss: -6.20976 entropy_loss: -19114.59180 self_attn_loss: 2.01514 loss: -19118.78711]
Iterations:   7%|▋         | 2/30 [00:05<01:03,  2.25s/it, attack_loss: -12.93653 entropy_loss: -19149.88086 self_attn_loss: 1.82888 loss: -19160.98828]
Iterations:  10%|█         | 3/30 [00:07<01:07,  2.52s/it, attack_loss: -12.93653 entropy_loss: -19149.88086 self_attn_loss: 1.82888 loss: -19160.98828]
Iterations:  10%|█         | 3/30 [00:09<01:07,  2.52s/it, attack_loss: -27.82208 entropy_loss: -19145.98242 self_attn_loss: 2.25407 loss: -19171.55078]
Iterations:  13%|█▎        | 4/30 [00:10<01:11,  2.76s/it, attack_loss: -27.82208 entropy_loss: -19145.98242 self_attn_loss: 2.25407 loss: -19171.55078]
Iterations:  13%|█▎        | 4/30 [00:12<01:11,  2.76s/it, attack_loss: -37.52922 entropy_loss: -19145.50195 self_attn_loss: 2.39945 loss: -19180.63086]
Iterations:  17%|█▋        | 5/30 [00:13<01:12,  2.88s/it, attack_loss: -37.52922 entropy_loss: -19145.50195 self_attn_loss: 2.39945 loss: -19180.63086]
Iterations:  17%|█▋        | 5/30 [00:15<01:12,  2.88s/it, attack_loss: -60.88770 entropy_loss: -19153.15039 self_attn_loss: 2.40932 loss: -19211.62891]
Iterations:  20%|██        | 6/30 [00:16<01:11,  2.96s/it, attack_loss: -60.88770 entropy_loss: -19153.15039 self_attn_loss: 2.40932 loss: -19211.62891]
Iterations:  20%|██        | 6/30 [00:18<01:11,  2.96s/it, attack_loss: -64.48641 entropy_loss: -19198.11523 self_attn_loss: 2.00257 loss: -19260.59961]
Iterations:  23%|██▎       | 7/30 [00:19<01:09,  3.02s/it, attack_loss: -64.48641 entropy_loss: -19198.11523 self_attn_loss: 2.00257 loss: -19260.59961]
Iterations:  23%|██▎       | 7/30 [00:21<01:09,  3.02s/it, attack_loss: -81.37615 entropy_loss: -19166.55078 self_attn_loss: 2.46843 loss: -19245.45898]
Iterations:  27%|██▋       | 8/30 [00:22<01:06,  3.02s/it, attack_loss: -81.37615 entropy_loss: -19166.55078 self_attn_loss: 2.46843 loss: -19245.45898]
Iterations:  27%|██▋       | 8/30 [00:24<01:06,  3.02s/it, attack_loss: -85.75558 entropy_loss: -19164.32617 self_attn_loss: 2.77368 loss: -19247.30859]
Iterations:  30%|███       | 9/30 [00:25<01:00,  2.90s/it, attack_loss: -85.75558 entropy_loss: -19164.32617 self_attn_loss: 2.77368 loss: -19247.30859]
Iterations:  30%|███       | 9/30 [00:26<01:00,  2.90s/it, attack_loss: -91.27843 entropy_loss: -19163.08008 self_attn_loss: 2.90962 loss: -19251.44922]
Iterations:  33%|███▎      | 10/30 [00:28<00:56,  2.82s/it, attack_loss: -91.27843 entropy_loss: -19163.08008 self_attn_loss: 2.90962 loss: -19251.44922]
Iterations:  33%|███▎      | 10/30 [00:29<00:56,  2.82s/it, attack_loss: -101.02174 entropy_loss: -19166.76562 self_attn_loss: 3.02509 loss: -19264.76172]
Iterations:  37%|███▋      | 11/30 [00:30<00:53,  2.81s/it, attack_loss: -101.02174 entropy_loss: -19166.76562 self_attn_loss: 3.02509 loss: -19264.76172]
Iterations:  37%|███▋      | 11/30 [00:32<00:53,  2.81s/it, attack_loss: -107.93909 entropy_loss: -19162.54492 self_attn_loss: 3.12112 loss: -19267.36328]
Iterations:  40%|████      | 12/30 [00:34<00:52,  2.91s/it, attack_loss: -107.93909 entropy_loss: -19162.54492 self_attn_loss: 3.12112 loss: -19267.36328]
Iterations:  40%|████      | 12/30 [00:35<00:52,  2.91s/it, attack_loss: -114.56132 entropy_loss: -19154.20898 self_attn_loss: 3.20859 loss: -19265.56250]
Iterations:  43%|████▎     | 13/30 [00:37<00:50,  3.00s/it, attack_loss: -114.56132 entropy_loss: -19154.20898 self_attn_loss: 3.20859 loss: -19265.56250]
Iterations:  43%|████▎     | 13/30 [00:39<00:50,  3.00s/it, attack_loss: -120.15370 entropy_loss: -19142.20117 self_attn_loss: 3.16690 loss: -19259.18750]
Iterations:  47%|████▋     | 14/30 [00:40<00:48,  3.04s/it, attack_loss: -120.15370 entropy_loss: -19142.20117 self_attn_loss: 3.16690 loss: -19259.18750]
Iterations:  47%|████▋     | 14/30 [00:42<00:48,  3.04s/it, attack_loss: -126.10817 entropy_loss: -19138.46289 self_attn_loss: 3.17771 loss: -19261.39258]
Iterations:  50%|█████     | 15/30 [00:43<00:46,  3.08s/it, attack_loss: -126.10817 entropy_loss: -19138.46289 self_attn_loss: 3.17771 loss: -19261.39258]
Iterations:  50%|█████     | 15/30 [00:45<00:46,  3.08s/it, attack_loss: -137.40160 entropy_loss: -19142.78906 self_attn_loss: 3.21311 loss: -19276.97852]
Iterations:  53%|█████▎    | 16/30 [00:46<00:42,  3.05s/it, attack_loss: -137.40160 entropy_loss: -19142.78906 self_attn_loss: 3.21311 loss: -19276.97852]
Iterations:  53%|█████▎    | 16/30 [00:47<00:42,  3.05s/it, attack_loss: -153.30887 entropy_loss: -19145.87695 self_attn_loss: 3.28220 loss: -19295.90430]
Iterations:  57%|█████▋    | 17/30 [00:49<00:37,  2.91s/it, attack_loss: -153.30887 entropy_loss: -19145.87695 self_attn_loss: 3.28220 loss: -19295.90430]
Iterations:  57%|█████▋    | 17/30 [00:50<00:37,  2.91s/it, attack_loss: -161.58235 entropy_loss: -19150.34766 self_attn_loss: 3.27096 loss: -19308.65820]
Iterations:  60%|██████    | 18/30 [00:51<00:34,  2.84s/it, attack_loss: -161.58235 entropy_loss: -19150.34766 self_attn_loss: 3.27096 loss: -19308.65820]
Iterations:  60%|██████    | 18/30 [00:53<00:34,  2.84s/it, attack_loss: -173.28912 entropy_loss: -19147.82812 self_attn_loss: 3.35371 loss: -19317.76367]
Iterations:  63%|██████▎   | 19/30 [00:54<00:30,  2.82s/it, attack_loss: -173.28912 entropy_loss: -19147.82812 self_attn_loss: 3.35371 loss: -19317.76367]
Iterations:  63%|██████▎   | 19/30 [00:56<00:30,  2.82s/it, attack_loss: -183.38724 entropy_loss: -19147.86523 self_attn_loss: 3.27750 loss: -19327.97461]
Iterations:  67%|██████▋   | 20/30 [00:57<00:29,  2.93s/it, attack_loss: -183.38724 entropy_loss: -19147.86523 self_attn_loss: 3.27750 loss: -19327.97461]
Iterations:  67%|██████▋   | 20/30 [00:59<00:29,  2.93s/it, attack_loss: -188.75505 entropy_loss: -19140.06250 self_attn_loss: 3.24227 loss: -19325.57617]
Iterations:  70%|███████   | 21/30 [01:00<00:26,  3.00s/it, attack_loss: -188.75505 entropy_loss: -19140.06250 self_attn_loss: 3.24227 loss: -19325.57617]
Iterations:  70%|███████   | 21/30 [01:02<00:26,  3.00s/it, attack_loss: -200.20459 entropy_loss: -19143.13477 self_attn_loss: 3.21930 loss: -19340.11914]
Iterations:  73%|███████▎  | 22/30 [01:04<00:24,  3.05s/it, attack_loss: -200.20459 entropy_loss: -19143.13477 self_attn_loss: 3.21930 loss: -19340.11914]
Iterations:  73%|███████▎  | 22/30 [01:05<00:24,  3.05s/it, attack_loss: -209.07413 entropy_loss: -19152.10938 self_attn_loss: 3.18698 loss: -19357.99609]
Iterations:  77%|███████▋  | 23/30 [01:07<00:21,  3.08s/it, attack_loss: -209.07413 entropy_loss: -19152.10938 self_attn_loss: 3.18698 loss: -19357.99609]
Iterations:  77%|███████▋  | 23/30 [01:09<00:21,  3.08s/it, attack_loss: -202.00504 entropy_loss: -19167.18750 self_attn_loss: 3.04354 loss: -19366.14844]
Iterations:  80%|████████  | 24/30 [01:10<00:18,  3.06s/it, attack_loss: -202.00504 entropy_loss: -19167.18750 self_attn_loss: 3.04354 loss: -19366.14844]
Iterations:  80%|████████  | 24/30 [01:11<00:18,  3.06s/it, attack_loss: -213.72984 entropy_loss: -19162.49805 self_attn_loss: 3.02222 loss: -19373.20508]
Iterations:  83%|████████▎ | 25/30 [01:13<00:15,  3.05s/it, attack_loss: -213.72984 entropy_loss: -19162.49805 self_attn_loss: 3.02222 loss: -19373.20508]
Iterations:  83%|████████▎ | 25/30 [01:14<00:15,  3.05s/it, attack_loss: -223.24739 entropy_loss: -19162.52539 self_attn_loss: 3.02208 loss: -19382.75000]
Iterations:  87%|████████▋ | 26/30 [01:16<00:11,  2.95s/it, attack_loss: -223.24739 entropy_loss: -19162.52539 self_attn_loss: 3.02208 loss: -19382.75000]
Iterations:  87%|████████▋ | 26/30 [01:17<00:11,  2.95s/it, attack_loss: -230.56364 entropy_loss: -19168.50977 self_attn_loss: 3.02292 loss: -19396.05078]
Iterations:  90%|█████████ | 27/30 [01:18<00:08,  2.91s/it, attack_loss: -230.56364 entropy_loss: -19168.50977 self_attn_loss: 3.02292 loss: -19396.05078]
Iterations:  90%|█████████ | 27/30 [01:20<00:08,  2.91s/it, attack_loss: -239.73737 entropy_loss: -19162.85156 self_attn_loss: 3.10216 loss: -19399.48633]
Iterations:  93%|█████████▎| 28/30 [01:22<00:05,  2.99s/it, attack_loss: -239.73737 entropy_loss: -19162.85156 self_attn_loss: 3.10216 loss: -19399.48633]
Iterations:  93%|█████████▎| 28/30 [01:23<00:05,  2.99s/it, attack_loss: -246.17844 entropy_loss: -19164.76953 self_attn_loss: 3.19646 loss: -19407.75195]
Iterations:  97%|█████████▋| 29/30 [01:25<00:03,  3.16s/it, attack_loss: -246.17844 entropy_loss: -19164.76953 self_attn_loss: 3.19646 loss: -19407.75195]
Iterations:  97%|█████████▋| 29/30 [01:27<00:03,  3.16s/it, attack_loss: -251.66422 entropy_loss: -19162.32422 self_attn_loss: 3.25709 loss: -19410.73047]
Iterations: 100%|██████████| 30/30 [01:28<00:00,  3.17s/it, attack_loss: -251.66422 entropy_loss: -19162.32422 self_attn_loss: 3.25709 loss: -19410.73047]
Iterations: 100%|██████████| 30/30 [01:28<00:00,  2.96s/it, attack_loss: -251.66422 entropy_loss: -19162.32422 self_attn_loss: 3.25709 loss: -19410.73047]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([704], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([759], device='cuda:0') tensor(5.0605e-12, device='cuda:0')
L1: [5597.3687]	L2: [23.767752]	Linf: [0.6666667]

Accuracy on benign examples: 0.0%
gt_label: 634 pred_label: 388 pred_clean_logit 0.00823988951742649
prompt generate:  lumbermill  	labels:  [[388]]
decoder:  [49406, 27421, 6637, 49407] [49406, 49407]

DDIM_inverse: 100%|██████████| 19/19 [00:03<00:00,  4.98it/s]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:32<00:00,  6.58s/it]

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:01<?, ?it/s, attack_loss: -44.48468 entropy_loss: -19212.73828 self_attn_loss: 0.00000 loss: -19257.22266]
Iterations:   3%|▎         | 1/30 [00:02<01:25,  2.96s/it, attack_loss: -44.48468 entropy_loss: -19212.73828 self_attn_loss: 0.00000 loss: -19257.22266]
Iterations:   3%|▎         | 1/30 [00:04<01:25,  2.96s/it, attack_loss: -66.73033 entropy_loss: -19234.31836 self_attn_loss: 0.97855 loss: -19300.07031]
Iterations:   7%|▋         | 2/30 [00:06<01:25,  3.05s/it, attack_loss: -66.73033 entropy_loss: -19234.31836 self_attn_loss: 0.97855 loss: -19300.07031]
Iterations:   7%|▋         | 2/30 [00:07<01:25,  3.05s/it, attack_loss: -92.56673 entropy_loss: -19236.70508 self_attn_loss: 1.39402 loss: -19327.87695]
Iterations:  10%|█         | 3/30 [00:09<01:22,  3.07s/it, attack_loss: -92.56673 entropy_loss: -19236.70508 self_attn_loss: 1.39402 loss: -19327.87695]
Iterations:  10%|█         | 3/30 [00:10<01:22,  3.07s/it, attack_loss: -125.46440 entropy_loss: -19237.90430 self_attn_loss: 1.43913 loss: -19361.92969]
Iterations:  13%|█▎        | 4/30 [00:11<01:15,  2.89s/it, attack_loss: -125.46440 entropy_loss: -19237.90430 self_attn_loss: 1.43913 loss: -19361.92969]
Iterations:  13%|█▎        | 4/30 [00:13<01:15,  2.89s/it, attack_loss: -167.11365 entropy_loss: -19240.57617 self_attn_loss: 1.52276 loss: -19406.16797]
Iterations:  17%|█▋        | 5/30 [00:14<01:10,  2.83s/it, attack_loss: -167.11365 entropy_loss: -19240.57617 self_attn_loss: 1.52276 loss: -19406.16797]
Iterations:  17%|█▋        | 5/30 [00:15<01:10,  2.83s/it, attack_loss: -196.69455 entropy_loss: -19242.55078 self_attn_loss: 1.60455 loss: -19437.64062]
Iterations:  20%|██        | 6/30 [00:17<01:06,  2.78s/it, attack_loss: -196.69455 entropy_loss: -19242.55078 self_attn_loss: 1.60455 loss: -19437.64062]
Iterations:  20%|██        | 6/30 [00:19<01:06,  2.78s/it, attack_loss: -211.48660 entropy_loss: -19244.10938 self_attn_loss: 1.71820 loss: -19453.87695]
Iterations:  23%|██▎       | 7/30 [00:20<01:07,  2.95s/it, attack_loss: -211.48660 entropy_loss: -19244.10938 self_attn_loss: 1.71820 loss: -19453.87695]
Iterations:  23%|██▎       | 7/30 [00:22<01:07,  2.95s/it, attack_loss: -224.73579 entropy_loss: -19246.93750 self_attn_loss: 1.83412 loss: -19469.83984]
Iterations:  27%|██▋       | 8/30 [00:23<01:06,  3.02s/it, attack_loss: -224.73579 entropy_loss: -19246.93750 self_attn_loss: 1.83412 loss: -19469.83984]
Iterations:  27%|██▋       | 8/30 [00:25<01:06,  3.02s/it, attack_loss: -243.05739 entropy_loss: -19247.38477 self_attn_loss: 1.86772 loss: -19488.57422]
Iterations:  30%|███       | 9/30 [00:26<01:05,  3.10s/it, attack_loss: -243.05739 entropy_loss: -19247.38477 self_attn_loss: 1.86772 loss: -19488.57422]
Iterations:  30%|███       | 9/30 [00:28<01:05,  3.10s/it, attack_loss: -260.57858 entropy_loss: -19225.37500 self_attn_loss: 1.82128 loss: -19484.13281]
Iterations:  33%|███▎      | 10/30 [00:30<01:04,  3.20s/it, attack_loss: -260.57858 entropy_loss: -19225.37500 self_attn_loss: 1.82128 loss: -19484.13281]
Iterations:  33%|███▎      | 10/30 [00:32<01:04,  3.20s/it, attack_loss: -271.55362 entropy_loss: -19218.06836 self_attn_loss: 1.84930 loss: -19487.77344]
Iterations:  37%|███▋      | 11/30 [00:33<01:00,  3.17s/it, attack_loss: -271.55362 entropy_loss: -19218.06836 self_attn_loss: 1.84930 loss: -19487.77344]
Iterations:  37%|███▋      | 11/30 [00:34<01:00,  3.17s/it, attack_loss: -287.16080 entropy_loss: -19217.84375 self_attn_loss: 1.88162 loss: -19503.12305]
Iterations:  40%|████      | 12/30 [00:36<00:54,  3.01s/it, attack_loss: -287.16080 entropy_loss: -19217.84375 self_attn_loss: 1.88162 loss: -19503.12305]
Iterations:  40%|████      | 12/30 [00:37<00:54,  3.01s/it, attack_loss: -305.59320 entropy_loss: -19222.87305 self_attn_loss: 1.91636 loss: -19526.55078]
Iterations:  43%|████▎     | 13/30 [00:38<00:49,  2.91s/it, attack_loss: -305.59320 entropy_loss: -19222.87305 self_attn_loss: 1.91636 loss: -19526.55078]
Iterations:  43%|████▎     | 13/30 [00:40<00:49,  2.91s/it, attack_loss: -319.22009 entropy_loss: -19228.35352 self_attn_loss: 1.96756 loss: -19545.60547]
Iterations:  47%|████▋     | 14/30 [00:41<00:45,  2.85s/it, attack_loss: -319.22009 entropy_loss: -19228.35352 self_attn_loss: 1.96756 loss: -19545.60547]
Iterations:  47%|████▋     | 14/30 [00:43<00:45,  2.85s/it, attack_loss: -335.59201 entropy_loss: -19228.99219 self_attn_loss: 1.99034 loss: -19562.59375]
Iterations:  50%|█████     | 15/30 [00:44<00:44,  2.95s/it, attack_loss: -335.59201 entropy_loss: -19228.99219 self_attn_loss: 1.99034 loss: -19562.59375]
Iterations:  50%|█████     | 15/30 [00:46<00:44,  2.95s/it, attack_loss: -349.92093 entropy_loss: -19228.70312 self_attn_loss: 2.00022 loss: -19576.62305]
Iterations:  53%|█████▎    | 16/30 [00:48<00:43,  3.08s/it, attack_loss: -349.92093 entropy_loss: -19228.70312 self_attn_loss: 2.00022 loss: -19576.62305]
Iterations:  53%|█████▎    | 16/30 [00:49<00:43,  3.08s/it, attack_loss: -361.01407 entropy_loss: -19230.76562 self_attn_loss: 2.02119 loss: -19589.75781]
Iterations:  57%|█████▋    | 17/30 [00:51<00:40,  3.14s/it, attack_loss: -361.01407 entropy_loss: -19230.76562 self_attn_loss: 2.02119 loss: -19589.75781]
Iterations:  57%|█████▋    | 17/30 [00:53<00:40,  3.14s/it, attack_loss: -375.21786 entropy_loss: -19230.28320 self_attn_loss: 2.03364 loss: -19603.46680]
Iterations:  60%|██████    | 18/30 [00:54<00:37,  3.16s/it, attack_loss: -375.21786 entropy_loss: -19230.28320 self_attn_loss: 2.03364 loss: -19603.46680]
Iterations:  60%|██████    | 18/30 [00:56<00:37,  3.16s/it, attack_loss: -381.44354 entropy_loss: -19230.77734 self_attn_loss: 2.05091 loss: -19610.16992]
Iterations:  63%|██████▎   | 19/30 [00:57<00:35,  3.20s/it, attack_loss: -381.44354 entropy_loss: -19230.77734 self_attn_loss: 2.05091 loss: -19610.16992]
Iterations:  63%|██████▎   | 19/30 [00:59<00:35,  3.20s/it, attack_loss: -389.40579 entropy_loss: -19229.40820 self_attn_loss: 2.06554 loss: -19616.74805]
Iterations:  67%|██████▋   | 20/30 [01:00<00:30,  3.04s/it, attack_loss: -389.40579 entropy_loss: -19229.40820 self_attn_loss: 2.06554 loss: -19616.74805]
Iterations:  67%|██████▋   | 20/30 [01:02<00:30,  3.04s/it, attack_loss: -401.84412 entropy_loss: -19237.36719 self_attn_loss: 2.12764 loss: -19637.08398]
Iterations:  70%|███████   | 21/30 [01:03<00:27,  3.02s/it, attack_loss: -401.84412 entropy_loss: -19237.36719 self_attn_loss: 2.12764 loss: -19637.08398]
Iterations:  70%|███████   | 21/30 [01:04<00:27,  3.02s/it, attack_loss: -411.85870 entropy_loss: -19239.14648 self_attn_loss: 2.14848 loss: -19648.85742]
Iterations:  73%|███████▎  | 22/30 [01:06<00:23,  2.94s/it, attack_loss: -411.85870 entropy_loss: -19239.14648 self_attn_loss: 2.14848 loss: -19648.85742]
Iterations:  73%|███████▎  | 22/30 [01:08<00:23,  2.94s/it, attack_loss: -424.84827 entropy_loss: -19237.91016 self_attn_loss: 2.14295 loss: -19660.61523]
Iterations:  77%|███████▋  | 23/30 [01:09<00:21,  3.09s/it, attack_loss: -424.84827 entropy_loss: -19237.91016 self_attn_loss: 2.14295 loss: -19660.61523]
Iterations:  77%|███████▋  | 23/30 [01:11<00:21,  3.09s/it, attack_loss: -435.39871 entropy_loss: -19235.82422 self_attn_loss: 2.13726 loss: -19669.08594]
Iterations:  80%|████████  | 24/30 [01:12<00:18,  3.12s/it, attack_loss: -435.39871 entropy_loss: -19235.82422 self_attn_loss: 2.13726 loss: -19669.08594]
Iterations:  80%|████████  | 24/30 [01:14<00:18,  3.12s/it, attack_loss: -446.08252 entropy_loss: -19233.74609 self_attn_loss: 2.13701 loss: -19677.69141]
Iterations:  83%|████████▎ | 25/30 [01:16<00:15,  3.14s/it, attack_loss: -446.08252 entropy_loss: -19233.74609 self_attn_loss: 2.13701 loss: -19677.69141]
Iterations:  83%|████████▎ | 25/30 [01:17<00:15,  3.14s/it, attack_loss: -450.30768 entropy_loss: -19234.08203 self_attn_loss: 2.14457 loss: -19682.24609]
Iterations:  87%|████████▋ | 26/30 [01:19<00:12,  3.23s/it, attack_loss: -450.30768 entropy_loss: -19234.08203 self_attn_loss: 2.14457 loss: -19682.24609]
Iterations:  87%|████████▋ | 26/30 [01:21<00:12,  3.23s/it, attack_loss: -460.19577 entropy_loss: -19237.40820 self_attn_loss: 2.19816 loss: -19695.40625]
Iterations:  90%|█████████ | 27/30 [01:22<00:09,  3.23s/it, attack_loss: -460.19577 entropy_loss: -19237.40820 self_attn_loss: 2.19816 loss: -19695.40625]
Iterations:  90%|█████████ | 27/30 [01:24<00:09,  3.23s/it, attack_loss: -468.37219 entropy_loss: -19238.36328 self_attn_loss: 2.22702 loss: -19704.50781]
Iterations:  93%|█████████▎| 28/30 [01:25<00:06,  3.08s/it, attack_loss: -468.37219 entropy_loss: -19238.36328 self_attn_loss: 2.22702 loss: -19704.50781]
Iterations:  93%|█████████▎| 28/30 [01:26<00:06,  3.08s/it, attack_loss: -478.83002 entropy_loss: -19237.46289 self_attn_loss: 2.23870 loss: -19714.05469]
Iterations:  97%|█████████▋| 29/30 [01:28<00:02,  3.00s/it, attack_loss: -478.83002 entropy_loss: -19237.46289 self_attn_loss: 2.23870 loss: -19714.05469]
Iterations:  97%|█████████▋| 29/30 [01:29<00:02,  3.00s/it, attack_loss: -487.55600 entropy_loss: -19237.60352 self_attn_loss: 2.25551 loss: -19722.90430]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  2.93s/it, attack_loss: -487.55600 entropy_loss: -19237.60352 self_attn_loss: 2.25551 loss: -19722.90430]
Iterations: 100%|██████████| 30/30 [01:31<00:00,  3.03s/it, attack_loss: -487.55600 entropy_loss: -19237.60352 self_attn_loss: 2.25551 loss: -19722.90430]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([388], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([634], device='cuda:0') tensor(2.6173e-22, device='cuda:0')
L1: [7070.3926]	L2: [27.585947]	Linf: [0.6901961]
Clean acc: 0.0%
Adv acc: 0.0%

*********Transfer to resnet********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 0.0%

*********Transfer to vgg********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to mobile********
Accuracy on benign examples: 72.72727272727273%
Accuracy on adversarial examples: 0.0%

*********Transfer to inception********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to convnext********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to vit********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to swin********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to deit-b********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to deit-s********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 27.27272727272727%

*********Transfer to mixer-b********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to mixer-l********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 18.181818181818183%
Warning: batch size is bigger than the data size. Setting batch size to data size

FID:  317.9945726384158

*********fid: 317.9945726384158********
