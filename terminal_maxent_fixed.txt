
******Attack based on Diffusion, Attacked Dataset: imagenet_compatible*********

Loading pipeline components...:   0%|          | 0/6 [00:00<?, ?it/s]
Loading pipeline components...:  17%|█▋        | 1/6 [00:00<00:00,  5.50it/s]
Loading pipeline components...:  33%|███▎      | 2/6 [00:00<00:00,  7.17it/s]
Loading pipeline components...: 100%|██████████| 6/6 [00:00<00:00, 17.47it/s]
Loading pipeline components...: 100%|██████████| 6/6 [00:00<00:00, 14.18it/s]

Accuracy on benign examples: 100.0%
gt_label: 809 pred_label: 809 pred_clean_logit 0.9425603747367859

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:07<02:12,  7.34s/it]
DDIM_inverse:  11%|█         | 2/19 [00:07<00:52,  3.08s/it]
DDIM_inverse:  16%|█▌        | 3/19 [00:07<00:28,  1.80s/it]
DDIM_inverse:  21%|██        | 4/19 [00:07<00:17,  1.19s/it]
DDIM_inverse:  26%|██▋       | 5/19 [00:08<00:11,  1.17it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:08<00:08,  1.53it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:08<00:06,  1.87it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:09<00:04,  2.25it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:09<00:03,  2.54it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:09<00:03,  2.79it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:09<00:02,  2.98it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:10<00:02,  3.11it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:10<00:01,  3.32it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:10<00:01,  3.55it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:10<00:01,  3.46it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:11<00:00,  3.53it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:11<00:00,  3.78it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:11<00:00,  3.74it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:12<00:00,  3.62it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:12<00:00,  1.58it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:11<00:46, 11.56s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:19<00:27,  9.20s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:27<00:17,  8.87s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:37<00:09,  9.35s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:48<00:00, 10.02s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:48<00:00,  9.78s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:06<?, ?it/s, atk: -0.996 ent: -11.257 str: 0.000 loss: -12.254]
Iterations:   3%|▎         | 1/30 [00:38<18:44, 38.78s/it, atk: -0.996 ent: -11.257 str: 0.000 loss: -12.254]
Iterations:   3%|▎         | 1/30 [00:41<18:44, 38.78s/it, atk: -3.701 ent: -11.259 str: 1.024 loss: -13.936]
Iterations:   7%|▋         | 2/30 [00:43<08:37, 18.48s/it, atk: -3.701 ent: -11.259 str: 1.024 loss: -13.936]
Iterations:   7%|▋         | 2/30 [00:45<08:37, 18.48s/it, atk: -9.961 ent: -11.258 str: 1.154 loss: -20.065]
Iterations:  10%|█         | 3/30 [00:47<05:19, 11.85s/it, atk: -9.961 ent: -11.258 str: 1.154 loss: -20.065]
Iterations:  10%|█         | 3/30 [00:49<05:19, 11.85s/it, atk: -14.479 ent: -11.257 str: 1.360 loss: -24.377]
Iterations:  13%|█▎        | 4/30 [00:50<03:46,  8.70s/it, atk: -14.479 ent: -11.257 str: 1.360 loss: -24.377]
Iterations:  13%|█▎        | 4/30 [00:53<03:46,  8.70s/it, atk: -19.126 ent: -11.257 str: 1.501 loss: -28.883]
Iterations:  17%|█▋        | 5/30 [00:54<02:53,  6.96s/it, atk: -19.126 ent: -11.257 str: 1.501 loss: -28.883]
Iterations:  17%|█▋        | 5/30 [00:57<02:53,  6.96s/it, atk: -29.042 ent: -11.258 str: 1.385 loss: -38.915]
Iterations:  20%|██        | 6/30 [00:58<02:24,  6.01s/it, atk: -29.042 ent: -11.258 str: 1.385 loss: -38.915]
Iterations:  20%|██        | 6/30 [01:01<02:24,  6.01s/it, atk: -40.110 ent: -11.258 str: 1.202 loss: -50.166]
Iterations:  23%|██▎       | 7/30 [01:03<02:04,  5.42s/it, atk: -40.110 ent: -11.258 str: 1.202 loss: -50.166]
Iterations:  23%|██▎       | 7/30 [01:05<02:04,  5.42s/it, atk: -47.165 ent: -11.258 str: 1.326 loss: -57.097]
Iterations:  27%|██▋       | 8/30 [01:07<01:50,  5.03s/it, atk: -47.165 ent: -11.258 str: 1.326 loss: -57.097]
Iterations:  27%|██▋       | 8/30 [01:09<01:50,  5.03s/it, atk: -50.422 ent: -11.259 str: 1.350 loss: -60.331]
Iterations:  30%|███       | 9/30 [01:11<01:39,  4.73s/it, atk: -50.422 ent: -11.259 str: 1.350 loss: -60.331]
Iterations:  30%|███       | 9/30 [01:13<01:39,  4.73s/it, atk: -55.583 ent: -11.259 str: 1.302 loss: -65.540]
Iterations:  33%|███▎      | 10/30 [01:15<01:31,  4.56s/it, atk: -55.583 ent: -11.259 str: 1.302 loss: -65.540]
Iterations:  33%|███▎      | 10/30 [01:17<01:31,  4.56s/it, atk: -58.563 ent: -11.259 str: 1.515 loss: -68.306]
Iterations:  37%|███▋      | 11/30 [01:19<01:24,  4.44s/it, atk: -58.563 ent: -11.259 str: 1.515 loss: -68.306]
Iterations:  37%|███▋      | 11/30 [01:21<01:24,  4.44s/it, atk: -64.013 ent: -11.259 str: 1.573 loss: -73.699]
Iterations:  40%|████      | 12/30 [01:23<01:17,  4.32s/it, atk: -64.013 ent: -11.259 str: 1.573 loss: -73.699]
Iterations:  40%|████      | 12/30 [01:25<01:17,  4.32s/it, atk: -70.331 ent: -11.259 str: 1.644 loss: -79.946]
Iterations:  43%|████▎     | 13/30 [01:27<01:11,  4.23s/it, atk: -70.331 ent: -11.259 str: 1.644 loss: -79.946]
Iterations:  43%|████▎     | 13/30 [01:30<01:11,  4.23s/it, atk: -77.043 ent: -11.259 str: 1.662 loss: -86.639]
Iterations:  47%|████▋     | 14/30 [01:32<01:07,  4.24s/it, atk: -77.043 ent: -11.259 str: 1.662 loss: -86.639]
Iterations:  47%|████▋     | 14/30 [01:34<01:07,  4.24s/it, atk: -80.303 ent: -11.259 str: 1.688 loss: -89.874]
Iterations:  50%|█████     | 15/30 [01:36<01:02,  4.19s/it, atk: -80.303 ent: -11.259 str: 1.688 loss: -89.874]
Iterations:  50%|█████     | 15/30 [01:38<01:02,  4.19s/it, atk: -81.025 ent: -11.259 str: 1.792 loss: -90.492]
Iterations:  53%|█████▎    | 16/30 [01:40<00:58,  4.18s/it, atk: -81.025 ent: -11.259 str: 1.792 loss: -90.492]
Iterations:  53%|█████▎    | 16/30 [01:42<00:58,  4.18s/it, atk: -84.916 ent: -11.259 str: 1.869 loss: -94.306]
Iterations:  57%|█████▋    | 17/30 [01:44<00:54,  4.20s/it, atk: -84.916 ent: -11.259 str: 1.869 loss: -94.306]
Iterations:  57%|█████▋    | 17/30 [01:46<00:54,  4.20s/it, atk: -89.500 ent: -11.259 str: 1.951 loss: -98.808]
Iterations:  60%|██████    | 18/30 [01:48<00:50,  4.21s/it, atk: -89.500 ent: -11.259 str: 1.951 loss: -98.808]
Iterations:  60%|██████    | 18/30 [01:51<00:50,  4.21s/it, atk: -94.293 ent: -11.259 str: 1.972 loss: -103.580]
Iterations:  63%|██████▎   | 19/30 [01:52<00:46,  4.18s/it, atk: -94.293 ent: -11.259 str: 1.972 loss: -103.580]
Iterations:  63%|██████▎   | 19/30 [01:55<00:46,  4.18s/it, atk: -99.105 ent: -11.259 str: 1.951 loss: -108.413]
Iterations:  67%|██████▋   | 20/30 [01:57<00:41,  4.16s/it, atk: -99.105 ent: -11.259 str: 1.951 loss: -108.413]
Iterations:  67%|██████▋   | 20/30 [01:59<00:41,  4.16s/it, atk: -103.406 ent: -11.260 str: 1.910 loss: -112.756]
Iterations:  70%|███████   | 21/30 [02:01<00:37,  4.15s/it, atk: -103.406 ent: -11.260 str: 1.910 loss: -112.756]
Iterations:  70%|███████   | 21/30 [02:03<00:37,  4.15s/it, atk: -107.499 ent: -11.260 str: 1.915 loss: -116.844]
Iterations:  73%|███████▎  | 22/30 [02:05<00:33,  4.17s/it, atk: -107.499 ent: -11.260 str: 1.915 loss: -116.844]
Iterations:  73%|███████▎  | 22/30 [02:07<00:33,  4.17s/it, atk: -111.051 ent: -11.260 str: 1.929 loss: -120.381]
Iterations:  77%|███████▋  | 23/30 [02:09<00:29,  4.17s/it, atk: -111.051 ent: -11.260 str: 1.929 loss: -120.381]
Iterations:  77%|███████▋  | 23/30 [02:11<00:29,  4.17s/it, atk: -115.264 ent: -11.260 str: 1.959 loss: -124.565]
Iterations:  80%|████████  | 24/30 [02:13<00:25,  4.17s/it, atk: -115.264 ent: -11.260 str: 1.959 loss: -124.565]
Iterations:  80%|████████  | 24/30 [02:16<00:25,  4.17s/it, atk: -120.209 ent: -11.260 str: 2.000 loss: -129.469]
Iterations:  83%|████████▎ | 25/30 [02:17<00:20,  4.18s/it, atk: -120.209 ent: -11.260 str: 2.000 loss: -129.469]
Iterations:  83%|████████▎ | 25/30 [02:20<00:20,  4.18s/it, atk: -125.163 ent: -11.260 str: 1.960 loss: -134.463]
Iterations:  87%|████████▋ | 26/30 [02:22<00:16,  4.18s/it, atk: -125.163 ent: -11.260 str: 1.960 loss: -134.463]
Iterations:  87%|████████▋ | 26/30 [02:24<00:16,  4.18s/it, atk: -129.509 ent: -11.260 str: 1.960 loss: -138.809]
Iterations:  90%|█████████ | 27/30 [02:25<00:12,  4.10s/it, atk: -129.509 ent: -11.260 str: 1.960 loss: -138.809]
Iterations:  90%|█████████ | 27/30 [02:28<00:12,  4.10s/it, atk: -133.804 ent: -11.260 str: 1.970 loss: -143.095]
Iterations:  93%|█████████▎| 28/30 [02:30<00:08,  4.10s/it, atk: -133.804 ent: -11.260 str: 1.970 loss: -143.095]
Iterations:  93%|█████████▎| 28/30 [02:32<00:08,  4.10s/it, atk: -138.883 ent: -11.260 str: 1.984 loss: -148.160]
Iterations:  97%|█████████▋| 29/30 [02:34<00:04,  4.13s/it, atk: -138.883 ent: -11.260 str: 1.984 loss: -148.160]
Iterations:  97%|█████████▋| 29/30 [02:36<00:04,  4.13s/it, atk: -143.039 ent: -11.260 str: 1.998 loss: -152.301]
Iterations: 100%|██████████| 30/30 [02:38<00:00,  4.13s/it, atk: -143.039 ent: -11.260 str: 1.998 loss: -152.301]
Iterations: 100%|██████████| 30/30 [02:38<00:00,  5.28s/it, atk: -143.039 ent: -11.260 str: 1.998 loss: -152.301]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([666], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([809], device='cuda:0') tensor(4.3872e-07, device='cuda:0')
L1: [1184.2784]	L2: [7.5844307]	Linf: [0.4509804]

Accuracy on benign examples: 100.0%
gt_label: 605 pred_label: 605 pred_clean_logit 0.882628321647644

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.94it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.88it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.50it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.43it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.24it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:04,  3.23it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.16it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.13it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.11it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.11it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.25it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.24it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.17it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.10it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.10it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.21it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.24it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.13it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.14it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.22it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:26,  6.55s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:14<00:21,  7.20s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:23<00:15,  7.98s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:33<00:08,  8.77s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  9.46s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  8.76s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -1.723 ent: -5.615 str: 0.000 loss: -7.338]
Iterations:   3%|▎         | 1/30 [00:04<02:01,  4.19s/it, atk: -1.723 ent: -5.615 str: 0.000 loss: -7.338]
Iterations:   3%|▎         | 1/30 [00:06<02:01,  4.19s/it, atk: -9.698 ent: -5.614 str: 0.806 loss: -14.507]
Iterations:   7%|▋         | 2/30 [00:08<01:56,  4.17s/it, atk: -9.698 ent: -5.614 str: 0.806 loss: -14.507]
Iterations:   7%|▋         | 2/30 [00:10<01:56,  4.17s/it, atk: -18.689 ent: -5.614 str: 1.341 loss: -22.963]
Iterations:  10%|█         | 3/30 [00:12<01:53,  4.20s/it, atk: -18.689 ent: -5.614 str: 1.341 loss: -22.963]
Iterations:  10%|█         | 3/30 [00:14<01:53,  4.20s/it, atk: -26.067 ent: -5.615 str: 1.580 loss: -30.103]
Iterations:  13%|█▎        | 4/30 [00:16<01:47,  4.12s/it, atk: -26.067 ent: -5.615 str: 1.580 loss: -30.103]
Iterations:  13%|█▎        | 4/30 [00:18<01:47,  4.12s/it, atk: -40.033 ent: -5.615 str: 1.684 loss: -43.964]
Iterations:  17%|█▋        | 5/30 [00:20<01:42,  4.12s/it, atk: -40.033 ent: -5.615 str: 1.684 loss: -43.964]
Iterations:  17%|█▋        | 5/30 [00:23<01:42,  4.12s/it, atk: -50.535 ent: -5.615 str: 1.693 loss: -54.456]
Iterations:  20%|██        | 6/30 [00:24<01:39,  4.15s/it, atk: -50.535 ent: -5.615 str: 1.693 loss: -54.456]
Iterations:  20%|██        | 6/30 [00:27<01:39,  4.15s/it, atk: -61.080 ent: -5.615 str: 1.628 loss: -65.068]
Iterations:  23%|██▎       | 7/30 [00:28<01:32,  4.03s/it, atk: -61.080 ent: -5.615 str: 1.628 loss: -65.068]
Iterations:  23%|██▎       | 7/30 [00:30<01:32,  4.03s/it, atk: -70.767 ent: -5.615 str: 1.805 loss: -74.578]
Iterations:  27%|██▋       | 8/30 [00:32<01:26,  3.92s/it, atk: -70.767 ent: -5.615 str: 1.805 loss: -74.578]
Iterations:  27%|██▋       | 8/30 [00:34<01:26,  3.92s/it, atk: -78.285 ent: -5.616 str: 1.792 loss: -82.109]
Iterations:  30%|███       | 9/30 [00:36<01:24,  4.01s/it, atk: -78.285 ent: -5.616 str: 1.792 loss: -82.109]
Iterations:  30%|███       | 9/30 [00:38<01:24,  4.01s/it, atk: -89.391 ent: -5.615 str: 1.864 loss: -93.143]
Iterations:  33%|███▎      | 10/30 [00:40<01:21,  4.08s/it, atk: -89.391 ent: -5.615 str: 1.864 loss: -93.143]
Iterations:  33%|███▎      | 10/30 [00:43<01:21,  4.08s/it, atk: -97.959 ent: -5.615 str: 1.917 loss: -101.658]
Iterations:  37%|███▋      | 11/30 [00:44<01:17,  4.08s/it, atk: -97.959 ent: -5.615 str: 1.917 loss: -101.658]
Iterations:  37%|███▋      | 11/30 [00:47<01:17,  4.08s/it, atk: -106.200 ent: -5.615 str: 1.957 loss: -109.859]
Iterations:  40%|████      | 12/30 [00:48<01:12,  4.05s/it, atk: -106.200 ent: -5.615 str: 1.957 loss: -109.859]
Iterations:  40%|████      | 12/30 [00:51<01:12,  4.05s/it, atk: -115.331 ent: -5.615 str: 1.985 loss: -118.961]
Iterations:  43%|████▎     | 13/30 [00:53<01:09,  4.11s/it, atk: -115.331 ent: -5.615 str: 1.985 loss: -118.961]
Iterations:  43%|████▎     | 13/30 [00:55<01:09,  4.11s/it, atk: -125.972 ent: -5.616 str: 1.995 loss: -129.592]
Iterations:  47%|████▋     | 14/30 [00:57<01:05,  4.11s/it, atk: -125.972 ent: -5.616 str: 1.995 loss: -129.592]
Iterations:  47%|████▋     | 14/30 [00:59<01:05,  4.11s/it, atk: -136.159 ent: -5.616 str: 1.994 loss: -139.781]
Iterations:  50%|█████     | 15/30 [01:01<01:01,  4.11s/it, atk: -136.159 ent: -5.616 str: 1.994 loss: -139.781]
Iterations:  50%|█████     | 15/30 [01:03<01:01,  4.11s/it, atk: -144.856 ent: -5.616 str: 2.013 loss: -148.460]
Iterations:  53%|█████▎    | 16/30 [01:05<00:57,  4.13s/it, atk: -144.856 ent: -5.616 str: 2.013 loss: -148.460]
Iterations:  53%|█████▎    | 16/30 [01:07<00:57,  4.13s/it, atk: -154.770 ent: -5.616 str: 2.025 loss: -158.361]
Iterations:  57%|█████▋    | 17/30 [01:09<00:54,  4.16s/it, atk: -154.770 ent: -5.616 str: 2.025 loss: -158.361]
Iterations:  57%|█████▋    | 17/30 [01:12<00:54,  4.16s/it, atk: -165.551 ent: -5.616 str: 2.037 loss: -169.130]
Iterations:  60%|██████    | 18/30 [01:13<00:49,  4.14s/it, atk: -165.551 ent: -5.616 str: 2.037 loss: -169.130]
Iterations:  60%|██████    | 18/30 [01:16<00:49,  4.14s/it, atk: -173.760 ent: -5.617 str: 2.052 loss: -177.325]
Iterations:  63%|██████▎   | 19/30 [01:17<00:44,  4.09s/it, atk: -173.760 ent: -5.617 str: 2.052 loss: -177.325]
Iterations:  63%|██████▎   | 19/30 [01:19<00:44,  4.09s/it, atk: -181.892 ent: -5.617 str: 2.068 loss: -185.440]
Iterations:  67%|██████▋   | 20/30 [01:21<00:40,  4.06s/it, atk: -181.892 ent: -5.617 str: 2.068 loss: -185.440]
Iterations:  67%|██████▋   | 20/30 [01:24<00:40,  4.06s/it, atk: -189.945 ent: -5.617 str: 2.085 loss: -193.476]
Iterations:  70%|███████   | 21/30 [01:25<00:36,  4.09s/it, atk: -189.945 ent: -5.617 str: 2.085 loss: -193.476]
Iterations:  70%|███████   | 21/30 [01:28<00:36,  4.09s/it, atk: -197.762 ent: -5.617 str: 2.101 loss: -201.278]
Iterations:  73%|███████▎  | 22/30 [01:30<00:32,  4.11s/it, atk: -197.762 ent: -5.617 str: 2.101 loss: -201.278]
Iterations:  73%|███████▎  | 22/30 [01:32<00:32,  4.11s/it, atk: -204.442 ent: -5.617 str: 2.118 loss: -207.941]
Iterations:  77%|███████▋  | 23/30 [01:34<00:29,  4.15s/it, atk: -204.442 ent: -5.617 str: 2.118 loss: -207.941]
Iterations:  77%|███████▋  | 23/30 [01:36<00:29,  4.15s/it, atk: -211.132 ent: -5.617 str: 2.137 loss: -214.612]
Iterations:  80%|████████  | 24/30 [01:38<00:24,  4.15s/it, atk: -211.132 ent: -5.617 str: 2.137 loss: -214.612]
Iterations:  80%|████████  | 24/30 [01:40<00:24,  4.15s/it, atk: -217.905 ent: -5.617 str: 2.169 loss: -221.353]
Iterations:  83%|████████▎ | 25/30 [01:42<00:20,  4.14s/it, atk: -217.905 ent: -5.617 str: 2.169 loss: -221.353]
Iterations:  83%|████████▎ | 25/30 [01:44<00:20,  4.14s/it, atk: -225.218 ent: -5.617 str: 2.176 loss: -228.659]
Iterations:  87%|████████▋ | 26/30 [01:46<00:16,  4.09s/it, atk: -225.218 ent: -5.617 str: 2.176 loss: -228.659]
Iterations:  87%|████████▋ | 26/30 [01:48<00:16,  4.09s/it, atk: -232.127 ent: -5.617 str: 2.200 loss: -235.544]
Iterations:  90%|█████████ | 27/30 [01:50<00:12,  4.07s/it, atk: -232.127 ent: -5.617 str: 2.200 loss: -235.544]
Iterations:  90%|█████████ | 27/30 [01:52<00:12,  4.07s/it, atk: -237.714 ent: -5.617 str: 2.227 loss: -241.104]
Iterations:  93%|█████████▎| 28/30 [01:54<00:08,  4.09s/it, atk: -237.714 ent: -5.617 str: 2.227 loss: -241.104]
Iterations:  93%|█████████▎| 28/30 [01:57<00:08,  4.09s/it, atk: -241.988 ent: -5.617 str: 2.251 loss: -245.355]
Iterations:  97%|█████████▋| 29/30 [01:58<00:04,  4.09s/it, atk: -241.988 ent: -5.617 str: 2.251 loss: -245.355]
Iterations:  97%|█████████▋| 29/30 [02:01<00:04,  4.09s/it, atk: -245.901 ent: -5.617 str: 2.286 loss: -249.233]
Iterations: 100%|██████████| 30/30 [02:02<00:00,  4.10s/it, atk: -245.901 ent: -5.617 str: 2.286 loss: -249.233]
Iterations: 100%|██████████| 30/30 [02:02<00:00,  4.10s/it, atk: -245.901 ent: -5.617 str: 2.286 loss: -249.233]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([419], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([605], device='cuda:0') tensor(1.1462e-11, device='cuda:0')
L1: [1959.9453]	L2: [14.819549]	Linf: [0.8117647]

Accuracy on benign examples: 100.0%
gt_label: 94 pred_label: 94 pred_clean_logit 0.9314026236534119

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:02,  6.13it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.79it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.44it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.26it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.18it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:04,  3.10it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.19it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.16it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.14it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.16it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.21it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.24it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.19it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.17it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.22it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.14it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.28it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.24it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.21it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.24it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:27,  6.82s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:14<00:21,  7.28s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:23<00:15,  7.90s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:32<00:08,  8.64s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  9.55s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  8.80s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -0.720 ent: -5.589 str: 0.000 loss: -6.308]
Iterations:   3%|▎         | 1/30 [00:04<01:57,  4.04s/it, atk: -0.720 ent: -5.589 str: 0.000 loss: -6.308]
Iterations:   3%|▎         | 1/30 [00:06<01:57,  4.04s/it, atk: -1.516 ent: -5.587 str: 0.944 loss: -6.159]
Iterations:   7%|▋         | 2/30 [00:08<01:53,  4.07s/it, atk: -1.516 ent: -5.587 str: 0.944 loss: -6.159]
Iterations:   7%|▋         | 2/30 [00:10<01:53,  4.07s/it, atk: -4.244 ent: -5.588 str: 1.129 loss: -8.703]
Iterations:  10%|█         | 3/30 [00:12<01:50,  4.08s/it, atk: -4.244 ent: -5.588 str: 1.129 loss: -8.703]
Iterations:  10%|█         | 3/30 [00:14<01:50,  4.08s/it, atk: -10.676 ent: -5.588 str: 1.119 loss: -15.145]
Iterations:  13%|█▎        | 4/30 [00:16<01:45,  4.07s/it, atk: -10.676 ent: -5.588 str: 1.119 loss: -15.145]
Iterations:  13%|█▎        | 4/30 [00:18<01:45,  4.07s/it, atk: -16.761 ent: -5.588 str: 1.244 loss: -21.105]
Iterations:  17%|█▋        | 5/30 [00:20<01:42,  4.11s/it, atk: -16.761 ent: -5.588 str: 1.244 loss: -21.105]
Iterations:  17%|█▋        | 5/30 [00:22<01:42,  4.11s/it, atk: -22.804 ent: -5.588 str: 1.187 loss: -27.206]
Iterations:  20%|██        | 6/30 [00:24<01:39,  4.13s/it, atk: -22.804 ent: -5.588 str: 1.187 loss: -27.206]
Iterations:  20%|██        | 6/30 [00:26<01:39,  4.13s/it, atk: -27.622 ent: -5.588 str: 1.146 loss: -32.065]
Iterations:  23%|██▎       | 7/30 [00:28<01:35,  4.14s/it, atk: -27.622 ent: -5.588 str: 1.146 loss: -32.065]
Iterations:  23%|██▎       | 7/30 [00:31<01:35,  4.14s/it, atk: -33.896 ent: -5.589 str: 1.305 loss: -38.179]
Iterations:  27%|██▋       | 8/30 [00:32<01:31,  4.14s/it, atk: -33.896 ent: -5.589 str: 1.305 loss: -38.179]
Iterations:  27%|██▋       | 8/30 [00:35<01:31,  4.14s/it, atk: -38.329 ent: -5.589 str: 1.476 loss: -42.442]
Iterations:  30%|███       | 9/30 [00:37<01:27,  4.14s/it, atk: -38.329 ent: -5.589 str: 1.476 loss: -42.442]
Iterations:  30%|███       | 9/30 [00:39<01:27,  4.14s/it, atk: -43.686 ent: -5.588 str: 1.605 loss: -47.669]
Iterations:  33%|███▎      | 10/30 [00:41<01:22,  4.12s/it, atk: -43.686 ent: -5.588 str: 1.605 loss: -47.669]
Iterations:  33%|███▎      | 10/30 [00:43<01:22,  4.12s/it, atk: -50.070 ent: -5.589 str: 1.455 loss: -54.203]
Iterations:  37%|███▋      | 11/30 [00:45<01:17,  4.07s/it, atk: -50.070 ent: -5.589 str: 1.455 loss: -54.203]
Iterations:  37%|███▋      | 11/30 [00:47<01:17,  4.07s/it, atk: -55.272 ent: -5.589 str: 1.491 loss: -59.370]
Iterations:  40%|████      | 12/30 [00:49<01:13,  4.11s/it, atk: -55.272 ent: -5.589 str: 1.491 loss: -59.370]
Iterations:  40%|████      | 12/30 [00:51<01:13,  4.11s/it, atk: -61.775 ent: -5.588 str: 1.603 loss: -65.760]
Iterations:  43%|████▎     | 13/30 [00:53<01:09,  4.12s/it, atk: -61.775 ent: -5.588 str: 1.603 loss: -65.760]
Iterations:  43%|████▎     | 13/30 [00:55<01:09,  4.12s/it, atk: -67.038 ent: -5.588 str: 1.678 loss: -70.949]
Iterations:  47%|████▋     | 14/30 [00:57<01:05,  4.06s/it, atk: -67.038 ent: -5.588 str: 1.678 loss: -70.949]
Iterations:  47%|████▋     | 14/30 [00:59<01:05,  4.06s/it, atk: -72.130 ent: -5.588 str: 1.722 loss: -75.997]
Iterations:  50%|█████     | 15/30 [01:01<01:01,  4.10s/it, atk: -72.130 ent: -5.588 str: 1.722 loss: -75.997]
Iterations:  50%|█████     | 15/30 [01:03<01:01,  4.10s/it, atk: -78.241 ent: -5.588 str: 1.754 loss: -82.075]
Iterations:  53%|█████▎    | 16/30 [01:05<00:57,  4.09s/it, atk: -78.241 ent: -5.588 str: 1.754 loss: -82.075]
Iterations:  53%|█████▎    | 16/30 [01:07<00:57,  4.09s/it, atk: -83.304 ent: -5.588 str: 1.813 loss: -87.079]
Iterations:  57%|█████▋    | 17/30 [01:09<00:53,  4.11s/it, atk: -83.304 ent: -5.588 str: 1.813 loss: -87.079]
Iterations:  57%|█████▋    | 17/30 [01:11<00:53,  4.11s/it, atk: -88.789 ent: -5.588 str: 1.851 loss: -92.526]
Iterations:  60%|██████    | 18/30 [01:13<00:48,  4.07s/it, atk: -88.789 ent: -5.588 str: 1.851 loss: -92.526]
Iterations:  60%|██████    | 18/30 [01:15<00:48,  4.07s/it, atk: -94.101 ent: -5.588 str: 1.877 loss: -97.812]
Iterations:  63%|██████▎   | 19/30 [01:17<00:44,  4.07s/it, atk: -94.101 ent: -5.588 str: 1.877 loss: -97.812]
Iterations:  63%|██████▎   | 19/30 [01:20<00:44,  4.07s/it, atk: -98.503 ent: -5.588 str: 1.893 loss: -102.198]
Iterations:  67%|██████▋   | 20/30 [01:21<00:40,  4.09s/it, atk: -98.503 ent: -5.588 str: 1.893 loss: -102.198]
Iterations:  67%|██████▋   | 20/30 [01:24<00:40,  4.09s/it, atk: -102.510 ent: -5.588 str: 1.911 loss: -106.186]
Iterations:  70%|███████   | 21/30 [01:26<00:37,  4.12s/it, atk: -102.510 ent: -5.588 str: 1.911 loss: -106.186]
Iterations:  70%|███████   | 21/30 [01:28<00:37,  4.12s/it, atk: -106.937 ent: -5.588 str: 1.947 loss: -110.578]
Iterations:  73%|███████▎  | 22/30 [01:30<00:32,  4.12s/it, atk: -106.937 ent: -5.588 str: 1.947 loss: -110.578]
Iterations:  73%|███████▎  | 22/30 [01:32<00:32,  4.12s/it, atk: -111.387 ent: -5.588 str: 1.983 loss: -114.992]
Iterations:  77%|███████▋  | 23/30 [01:34<00:28,  4.13s/it, atk: -111.387 ent: -5.588 str: 1.983 loss: -114.992]
Iterations:  77%|███████▋  | 23/30 [01:36<00:28,  4.13s/it, atk: -115.176 ent: -5.588 str: 2.014 loss: -118.750]
Iterations:  80%|████████  | 24/30 [01:38<00:24,  4.08s/it, atk: -115.176 ent: -5.588 str: 2.014 loss: -118.750]
Iterations:  80%|████████  | 24/30 [01:40<00:24,  4.08s/it, atk: -116.090 ent: -5.588 str: 2.080 loss: -119.598]
Iterations:  83%|████████▎ | 25/30 [01:42<00:20,  4.07s/it, atk: -116.090 ent: -5.588 str: 2.080 loss: -119.598]
Iterations:  83%|████████▎ | 25/30 [01:44<00:20,  4.07s/it, atk: -119.663 ent: -5.588 str: 2.022 loss: -123.228]
Iterations:  87%|████████▋ | 26/30 [01:46<00:16,  4.07s/it, atk: -119.663 ent: -5.588 str: 2.022 loss: -123.228]
Iterations:  87%|████████▋ | 26/30 [01:48<00:16,  4.07s/it, atk: -119.309 ent: -5.588 str: 2.172 loss: -122.725]
Iterations:  90%|█████████ | 27/30 [01:50<00:12,  4.01s/it, atk: -119.309 ent: -5.588 str: 2.172 loss: -122.725]
Iterations:  90%|█████████ | 27/30 [01:52<00:12,  4.01s/it, atk: -122.514 ent: -5.588 str: 2.192 loss: -125.909]
Iterations:  93%|█████████▎| 28/30 [01:54<00:07,  3.93s/it, atk: -122.514 ent: -5.588 str: 2.192 loss: -125.909]
Iterations:  93%|█████████▎| 28/30 [01:55<00:07,  3.93s/it, atk: -125.171 ent: -5.588 str: 2.227 loss: -128.532]
Iterations:  97%|█████████▋| 29/30 [01:57<00:03,  3.81s/it, atk: -125.171 ent: -5.588 str: 2.227 loss: -128.532]
Iterations:  97%|█████████▋| 29/30 [01:59<00:03,  3.81s/it, atk: -128.103 ent: -5.588 str: 2.269 loss: -131.422]
Iterations: 100%|██████████| 30/30 [02:01<00:00,  3.89s/it, atk: -128.103 ent: -5.588 str: 2.269 loss: -131.422]
Iterations: 100%|██████████| 30/30 [02:01<00:00,  4.06s/it, atk: -128.103 ent: -5.588 str: 2.269 loss: -131.422]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([95], device='cuda:0') tensor(0.9925, device='cuda:0')
after_true: tensor([94], device='cuda:0') tensor(1.9227e-06, device='cuda:0')
L1: [1904.1805]	L2: [12.923567]	Linf: [0.48235297]

Accuracy on benign examples: 100.0%
gt_label: 777 pred_label: 777 pred_clean_logit 0.8415653109550476

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:02,  6.33it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.86it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.62it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.44it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.39it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.34it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.25it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.39it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.23it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.36it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.33it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.25it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.27it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.31it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.29it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.34it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.19it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.20it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.14it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.32it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:25,  6.30s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:21,  7.04s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:21<00:15,  7.54s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.19s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  9.23s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  8.45s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -0.863 ent: -11.263 str: 0.000 loss: -12.126]
Iterations:   3%|▎         | 1/30 [00:04<02:08,  4.45s/it, atk: -0.863 ent: -11.263 str: 0.000 loss: -12.126]
Iterations:   3%|▎         | 1/30 [00:06<02:08,  4.45s/it, atk: -2.752 ent: -11.262 str: 0.249 loss: -13.765]
Iterations:   7%|▋         | 2/30 [00:08<01:59,  4.25s/it, atk: -2.752 ent: -11.262 str: 0.249 loss: -13.765]
Iterations:   7%|▋         | 2/30 [00:10<01:59,  4.25s/it, atk: -6.013 ent: -11.263 str: 0.377 loss: -16.900]
Iterations:  10%|█         | 3/30 [00:12<01:52,  4.16s/it, atk: -6.013 ent: -11.263 str: 0.377 loss: -16.900]
Iterations:  10%|█         | 3/30 [00:14<01:52,  4.16s/it, atk: -11.617 ent: -11.263 str: 0.361 loss: -22.519]
Iterations:  13%|█▎        | 4/30 [00:16<01:48,  4.19s/it, atk: -11.617 ent: -11.263 str: 0.361 loss: -22.519]
Iterations:  13%|█▎        | 4/30 [00:19<01:48,  4.19s/it, atk: -16.800 ent: -11.263 str: 0.531 loss: -27.532]
Iterations:  17%|█▋        | 5/30 [00:21<01:44,  4.20s/it, atk: -16.800 ent: -11.263 str: 0.531 loss: -27.532]
Iterations:  17%|█▋        | 5/30 [00:23<01:44,  4.20s/it, atk: -23.221 ent: -11.263 str: 0.663 loss: -33.821]
Iterations:  20%|██        | 6/30 [00:25<01:40,  4.18s/it, atk: -23.221 ent: -11.263 str: 0.663 loss: -33.821]
Iterations:  20%|██        | 6/30 [00:27<01:40,  4.18s/it, atk: -30.005 ent: -11.263 str: 0.713 loss: -40.555]
Iterations:  23%|██▎       | 7/30 [00:29<01:36,  4.19s/it, atk: -30.005 ent: -11.263 str: 0.713 loss: -40.555]
Iterations:  23%|██▎       | 7/30 [00:31<01:36,  4.19s/it, atk: -36.704 ent: -11.263 str: 0.761 loss: -47.206]
Iterations:  27%|██▋       | 8/30 [00:33<01:31,  4.17s/it, atk: -36.704 ent: -11.263 str: 0.761 loss: -47.206]
Iterations:  27%|██▋       | 8/30 [00:35<01:31,  4.17s/it, atk: -39.376 ent: -11.263 str: 0.831 loss: -49.809]
Iterations:  30%|███       | 9/30 [00:37<01:26,  4.13s/it, atk: -39.376 ent: -11.263 str: 0.831 loss: -49.809]
Iterations:  30%|███       | 9/30 [00:39<01:26,  4.13s/it, atk: -46.816 ent: -11.263 str: 0.866 loss: -57.213]
Iterations:  33%|███▎      | 10/30 [00:41<01:22,  4.11s/it, atk: -46.816 ent: -11.263 str: 0.866 loss: -57.213]
Iterations:  33%|███▎      | 10/30 [00:43<01:22,  4.11s/it, atk: -51.556 ent: -11.263 str: 0.898 loss: -61.922]
Iterations:  37%|███▋      | 11/30 [00:45<01:18,  4.12s/it, atk: -51.556 ent: -11.263 str: 0.898 loss: -61.922]
Iterations:  37%|███▋      | 11/30 [00:48<01:18,  4.12s/it, atk: -56.564 ent: -11.263 str: 0.939 loss: -66.888]
Iterations:  40%|████      | 12/30 [00:49<01:14,  4.13s/it, atk: -56.564 ent: -11.263 str: 0.939 loss: -66.888]
Iterations:  40%|████      | 12/30 [00:52<01:14,  4.13s/it, atk: -61.815 ent: -11.263 str: 0.985 loss: -72.093]
Iterations:  43%|████▎     | 13/30 [00:54<01:10,  4.14s/it, atk: -61.815 ent: -11.263 str: 0.985 loss: -72.093]
Iterations:  43%|████▎     | 13/30 [00:56<01:10,  4.14s/it, atk: -67.503 ent: -11.263 str: 1.029 loss: -77.737]
Iterations:  47%|████▋     | 14/30 [00:58<01:06,  4.15s/it, atk: -67.503 ent: -11.263 str: 1.029 loss: -77.737]
Iterations:  47%|████▋     | 14/30 [01:00<01:06,  4.15s/it, atk: -73.722 ent: -11.263 str: 1.065 loss: -83.921]
Iterations:  50%|█████     | 15/30 [01:02<01:02,  4.16s/it, atk: -73.722 ent: -11.263 str: 1.065 loss: -83.921]
Iterations:  50%|█████     | 15/30 [01:04<01:02,  4.16s/it, atk: -79.315 ent: -11.263 str: 1.079 loss: -89.500]
Iterations:  53%|█████▎    | 16/30 [01:06<00:58,  4.17s/it, atk: -79.315 ent: -11.263 str: 1.079 loss: -89.500]
Iterations:  53%|█████▎    | 16/30 [01:09<00:58,  4.17s/it, atk: -85.761 ent: -11.264 str: 1.111 loss: -95.913]
Iterations:  57%|█████▋    | 17/30 [01:10<00:53,  4.15s/it, atk: -85.761 ent: -11.264 str: 1.111 loss: -95.913]
Iterations:  57%|█████▋    | 17/30 [01:12<00:53,  4.15s/it, atk: -90.686 ent: -11.264 str: 1.146 loss: -100.804]
Iterations:  60%|██████    | 18/30 [01:14<00:49,  4.10s/it, atk: -90.686 ent: -11.264 str: 1.146 loss: -100.804]
Iterations:  60%|██████    | 18/30 [01:16<00:49,  4.10s/it, atk: -97.370 ent: -11.264 str: 1.179 loss: -107.455]
Iterations:  63%|██████▎   | 19/30 [01:18<00:45,  4.10s/it, atk: -97.370 ent: -11.264 str: 1.179 loss: -107.455]
Iterations:  63%|██████▎   | 19/30 [01:21<00:45,  4.10s/it, atk: -102.782 ent: -11.264 str: 1.233 loss: -112.812]
Iterations:  67%|██████▋   | 20/30 [01:22<00:40,  4.09s/it, atk: -102.782 ent: -11.264 str: 1.233 loss: -112.812]
Iterations:  67%|██████▋   | 20/30 [01:25<00:40,  4.09s/it, atk: -108.289 ent: -11.264 str: 1.254 loss: -118.298]
Iterations:  70%|███████   | 21/30 [01:27<00:36,  4.09s/it, atk: -108.289 ent: -11.264 str: 1.254 loss: -118.298]
Iterations:  70%|███████   | 21/30 [01:29<00:36,  4.09s/it, atk: -113.630 ent: -11.264 str: 1.274 loss: -123.620]
Iterations:  73%|███████▎  | 22/30 [01:31<00:32,  4.10s/it, atk: -113.630 ent: -11.264 str: 1.274 loss: -123.620]
Iterations:  73%|███████▎  | 22/30 [01:33<00:32,  4.10s/it, atk: -120.008 ent: -11.264 str: 1.293 loss: -129.979]
Iterations:  77%|███████▋  | 23/30 [01:35<00:28,  4.10s/it, atk: -120.008 ent: -11.264 str: 1.293 loss: -129.979]
Iterations:  77%|███████▋  | 23/30 [01:37<00:28,  4.10s/it, atk: -123.581 ent: -11.264 str: 1.321 loss: -133.524]
Iterations:  80%|████████  | 24/30 [01:39<00:24,  4.11s/it, atk: -123.581 ent: -11.264 str: 1.321 loss: -133.524]
Iterations:  80%|████████  | 24/30 [01:41<00:24,  4.11s/it, atk: -130.361 ent: -11.264 str: 1.347 loss: -140.278]
Iterations:  83%|████████▎ | 25/30 [01:43<00:20,  4.05s/it, atk: -130.361 ent: -11.264 str: 1.347 loss: -140.278]
Iterations:  83%|████████▎ | 25/30 [01:45<00:20,  4.05s/it, atk: -135.439 ent: -11.264 str: 1.374 loss: -145.329]
Iterations:  87%|████████▋ | 26/30 [01:47<00:16,  4.07s/it, atk: -135.439 ent: -11.264 str: 1.374 loss: -145.329]
Iterations:  87%|████████▋ | 26/30 [01:49<00:16,  4.07s/it, atk: -140.951 ent: -11.264 str: 1.404 loss: -150.811]
Iterations:  90%|█████████ | 27/30 [01:51<00:12,  4.04s/it, atk: -140.951 ent: -11.264 str: 1.404 loss: -150.811]
Iterations:  90%|█████████ | 27/30 [01:53<00:12,  4.04s/it, atk: -146.312 ent: -11.264 str: 1.433 loss: -156.143]
Iterations:  93%|█████████▎| 28/30 [01:55<00:08,  4.05s/it, atk: -146.312 ent: -11.264 str: 1.433 loss: -156.143]
Iterations:  93%|█████████▎| 28/30 [01:57<00:08,  4.05s/it, atk: -150.438 ent: -11.264 str: 1.462 loss: -160.239]
Iterations:  97%|█████████▋| 29/30 [01:59<00:04,  4.07s/it, atk: -150.438 ent: -11.264 str: 1.462 loss: -160.239]
Iterations:  97%|█████████▋| 29/30 [02:01<00:04,  4.07s/it, atk: -154.437 ent: -11.264 str: 1.492 loss: -164.209]
Iterations: 100%|██████████| 30/30 [02:03<00:00,  4.08s/it, atk: -154.437 ent: -11.264 str: 1.492 loss: -164.209]
Iterations: 100%|██████████| 30/30 [02:03<00:00,  4.12s/it, atk: -154.437 ent: -11.264 str: 1.492 loss: -164.209]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([893], device='cuda:0') tensor(0.4134, device='cuda:0')
after_true: tensor([777], device='cuda:0') tensor(1.3226e-07, device='cuda:0')
L1: [2113.843]	L2: [14.809088]	Linf: [0.8156863]

Accuracy on benign examples: 100.0%
gt_label: 768 pred_label: 768 pred_clean_logit 0.3755243420600891

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:06,  2.74it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:05,  2.96it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:05,  3.09it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.06it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.26it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:04,  3.16it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.15it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.10it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.09it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.12it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.14it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.12it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:04<00:01,  3.15it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.14it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.13it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:05<00:00,  3.15it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.12it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.17it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:06<00:00,  3.15it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:06<00:00,  3.13it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:25,  6.28s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:21,  7.04s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.70s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:32<00:08,  8.49s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  9.45s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  8.64s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -10.759 ent: -11.261 str: 0.000 loss: -22.021]
Iterations:   3%|▎         | 1/30 [00:04<02:03,  4.26s/it, atk: -10.759 ent: -11.261 str: 0.000 loss: -22.021]
Iterations:   3%|▎         | 1/30 [00:06<02:03,  4.26s/it, atk: -19.654 ent: -11.261 str: 1.101 loss: -29.815]
Iterations:   7%|▋         | 2/30 [00:08<01:54,  4.08s/it, atk: -19.654 ent: -11.261 str: 1.101 loss: -29.815]
Iterations:   7%|▋         | 2/30 [00:10<01:54,  4.08s/it, atk: -25.727 ent: -11.262 str: 1.520 loss: -35.468]
Iterations:  10%|█         | 3/30 [00:12<01:47,  3.99s/it, atk: -25.727 ent: -11.262 str: 1.520 loss: -35.468]
Iterations:  10%|█         | 3/30 [00:14<01:47,  3.99s/it, atk: -35.279 ent: -11.262 str: 1.808 loss: -44.732]
Iterations:  13%|█▎        | 4/30 [00:16<01:45,  4.07s/it, atk: -35.279 ent: -11.262 str: 1.808 loss: -44.732]
Iterations:  13%|█▎        | 4/30 [00:18<01:45,  4.07s/it, atk: -40.596 ent: -11.262 str: 2.129 loss: -49.729]
Iterations:  17%|█▋        | 5/30 [00:20<01:42,  4.08s/it, atk: -40.596 ent: -11.262 str: 2.129 loss: -49.729]
Iterations:  17%|█▋        | 5/30 [00:22<01:42,  4.08s/it, atk: -45.149 ent: -11.262 str: 2.291 loss: -54.120]
Iterations:  20%|██        | 6/30 [00:24<01:37,  4.07s/it, atk: -45.149 ent: -11.262 str: 2.291 loss: -54.120]
Iterations:  20%|██        | 6/30 [00:26<01:37,  4.07s/it, atk: -51.277 ent: -11.262 str: 2.413 loss: -60.125]
Iterations:  23%|██▎       | 7/30 [00:28<01:34,  4.10s/it, atk: -51.277 ent: -11.262 str: 2.413 loss: -60.125]
Iterations:  23%|██▎       | 7/30 [00:30<01:34,  4.10s/it, atk: -56.497 ent: -11.262 str: 2.392 loss: -65.366]
Iterations:  27%|██▋       | 8/30 [00:32<01:29,  4.09s/it, atk: -56.497 ent: -11.262 str: 2.392 loss: -65.366]
Iterations:  27%|██▋       | 8/30 [00:34<01:29,  4.09s/it, atk: -62.039 ent: -11.262 str: 2.324 loss: -70.977]
Iterations:  30%|███       | 9/30 [00:36<01:25,  4.05s/it, atk: -62.039 ent: -11.262 str: 2.324 loss: -70.977]
Iterations:  30%|███       | 9/30 [00:38<01:25,  4.05s/it, atk: -65.606 ent: -11.262 str: 2.092 loss: -74.776]
Iterations:  33%|███▎      | 10/30 [00:40<01:20,  4.04s/it, atk: -65.606 ent: -11.262 str: 2.092 loss: -74.776]
Iterations:  33%|███▎      | 10/30 [00:42<01:20,  4.04s/it, atk: -70.330 ent: -11.262 str: 2.338 loss: -79.254]
Iterations:  37%|███▋      | 11/30 [00:44<01:16,  4.00s/it, atk: -70.330 ent: -11.262 str: 2.338 loss: -79.254]
Iterations:  37%|███▋      | 11/30 [00:46<01:16,  4.00s/it, atk: -75.293 ent: -11.262 str: 2.363 loss: -84.192]
Iterations:  40%|████      | 12/30 [00:48<01:09,  3.88s/it, atk: -75.293 ent: -11.262 str: 2.363 loss: -84.192]
Iterations:  40%|████      | 12/30 [00:50<01:09,  3.88s/it, atk: -79.789 ent: -11.262 str: 2.515 loss: -88.536]
Iterations:  43%|████▎     | 13/30 [00:51<01:05,  3.85s/it, atk: -79.789 ent: -11.262 str: 2.515 loss: -88.536]
Iterations:  43%|████▎     | 13/30 [00:54<01:05,  3.85s/it, atk: -83.156 ent: -11.262 str: 2.520 loss: -91.899]
Iterations:  47%|████▋     | 14/30 [00:56<01:02,  3.93s/it, atk: -83.156 ent: -11.262 str: 2.520 loss: -91.899]
Iterations:  47%|████▋     | 14/30 [00:58<01:02,  3.93s/it, atk: -86.767 ent: -11.262 str: 2.475 loss: -95.555]
Iterations:  50%|█████     | 15/30 [01:00<00:59,  3.98s/it, atk: -86.767 ent: -11.262 str: 2.475 loss: -95.555]
Iterations:  50%|█████     | 15/30 [01:02<00:59,  3.98s/it, atk: -92.370 ent: -11.262 str: 2.514 loss: -101.119]
Iterations:  53%|█████▎    | 16/30 [01:04<00:56,  4.02s/it, atk: -92.370 ent: -11.262 str: 2.514 loss: -101.119]
Iterations:  53%|█████▎    | 16/30 [01:06<00:56,  4.02s/it, atk: -97.878 ent: -11.263 str: 2.499 loss: -106.641]
Iterations:  57%|█████▋    | 17/30 [01:08<00:51,  3.99s/it, atk: -97.878 ent: -11.263 str: 2.499 loss: -106.641]
Iterations:  57%|█████▋    | 17/30 [01:10<00:51,  3.99s/it, atk: -102.211 ent: -11.263 str: 2.681 loss: -110.793]
Iterations:  60%|██████    | 18/30 [01:12<00:48,  4.03s/it, atk: -102.211 ent: -11.263 str: 2.681 loss: -110.793]
Iterations:  60%|██████    | 18/30 [01:14<00:48,  4.03s/it, atk: -105.226 ent: -11.263 str: 2.832 loss: -113.656]
Iterations:  63%|██████▎   | 19/30 [01:16<00:44,  4.05s/it, atk: -105.226 ent: -11.263 str: 2.832 loss: -113.656]
Iterations:  63%|██████▎   | 19/30 [01:18<00:44,  4.05s/it, atk: -108.975 ent: -11.263 str: 2.707 loss: -117.530]
Iterations:  67%|██████▋   | 20/30 [01:20<00:40,  4.06s/it, atk: -108.975 ent: -11.263 str: 2.707 loss: -117.530]
Iterations:  67%|██████▋   | 20/30 [01:22<00:40,  4.06s/it, atk: -110.628 ent: -11.263 str: 2.579 loss: -119.311]
Iterations:  70%|███████   | 21/30 [01:24<00:36,  4.08s/it, atk: -110.628 ent: -11.263 str: 2.579 loss: -119.311]
Iterations:  70%|███████   | 21/30 [01:26<00:36,  4.08s/it, atk: -115.693 ent: -11.263 str: 2.589 loss: -124.367]
Iterations:  73%|███████▎  | 22/30 [01:28<00:32,  4.09s/it, atk: -115.693 ent: -11.263 str: 2.589 loss: -124.367]
Iterations:  73%|███████▎  | 22/30 [01:31<00:32,  4.09s/it, atk: -117.218 ent: -11.263 str: 2.427 loss: -126.054]
Iterations:  77%|███████▋  | 23/30 [01:32<00:28,  4.05s/it, atk: -117.218 ent: -11.263 str: 2.427 loss: -126.054]
Iterations:  77%|███████▋  | 23/30 [01:34<00:28,  4.05s/it, atk: -121.732 ent: -11.263 str: 2.543 loss: -130.452]
Iterations:  80%|████████  | 24/30 [01:36<00:24,  4.06s/it, atk: -121.732 ent: -11.263 str: 2.543 loss: -130.452]
Iterations:  80%|████████  | 24/30 [01:39<00:24,  4.06s/it, atk: -125.631 ent: -11.263 str: 2.564 loss: -134.330]
Iterations:  83%|████████▎ | 25/30 [01:40<00:20,  4.07s/it, atk: -125.631 ent: -11.263 str: 2.564 loss: -134.330]
Iterations:  83%|████████▎ | 25/30 [01:43<00:20,  4.07s/it, atk: -129.575 ent: -11.263 str: 2.554 loss: -138.284]
Iterations:  87%|████████▋ | 26/30 [01:44<00:16,  4.02s/it, atk: -129.575 ent: -11.263 str: 2.554 loss: -138.284]
Iterations:  87%|████████▋ | 26/30 [01:46<00:16,  4.02s/it, atk: -132.453 ent: -11.263 str: 2.544 loss: -141.171]
Iterations:  90%|█████████ | 27/30 [01:48<00:11,  3.94s/it, atk: -132.453 ent: -11.263 str: 2.544 loss: -141.171]
Iterations:  90%|█████████ | 27/30 [01:50<00:11,  3.94s/it, atk: -135.753 ent: -11.263 str: 2.731 loss: -144.284]
Iterations:  93%|█████████▎| 28/30 [01:52<00:07,  3.89s/it, atk: -135.753 ent: -11.263 str: 2.731 loss: -144.284]
Iterations:  93%|█████████▎| 28/30 [01:54<00:07,  3.89s/it, atk: -137.398 ent: -11.263 str: 3.072 loss: -145.589]
Iterations:  97%|█████████▋| 29/30 [01:56<00:03,  3.96s/it, atk: -137.398 ent: -11.263 str: 3.072 loss: -145.589]
Iterations:  97%|█████████▋| 29/30 [01:58<00:03,  3.96s/it, atk: -141.631 ent: -11.263 str: 3.021 loss: -149.873]
Iterations: 100%|██████████| 30/30 [02:00<00:00,  3.98s/it, atk: -141.631 ent: -11.263 str: 3.021 loss: -149.873]
Iterations: 100%|██████████| 30/30 [02:00<00:00,  4.02s/it, atk: -141.631 ent: -11.263 str: 3.021 loss: -149.873]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([981], device='cuda:0') tensor(0.9844, device='cuda:0')
after_true: tensor([768], device='cuda:0') tensor(5.0434e-07, device='cuda:0')
L1: [3219.6392]	L2: [23.136763]	Linf: [0.8901961]

Accuracy on benign examples: 100.0%
gt_label: 663 pred_label: 663 pred_clean_logit 0.8165990710258484

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:06,  3.00it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:05,  3.06it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:05,  3.13it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.07it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.16it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.43it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.49it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.40it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.29it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.22it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.28it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.18it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:04<00:01,  3.16it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.14it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.15it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.12it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.08it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.06it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.05it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.17it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:25,  6.37s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:21,  7.02s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.56s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.46s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  9.36s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  8.57s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -1.432 ent: -5.631 str: 0.000 loss: -7.063]
Iterations:   3%|▎         | 1/30 [00:04<02:11,  4.55s/it, atk: -1.432 ent: -5.631 str: 0.000 loss: -7.063]
Iterations:   3%|▎         | 1/30 [00:06<02:11,  4.55s/it, atk: -7.851 ent: -5.631 str: 0.274 loss: -13.208]
Iterations:   7%|▋         | 2/30 [00:08<01:56,  4.17s/it, atk: -7.851 ent: -5.631 str: 0.274 loss: -13.208]
Iterations:   7%|▋         | 2/30 [00:10<01:56,  4.17s/it, atk: -15.434 ent: -5.631 str: 0.311 loss: -20.754]
Iterations:  10%|█         | 3/30 [00:12<01:51,  4.13s/it, atk: -15.434 ent: -5.631 str: 0.311 loss: -20.754]
Iterations:  10%|█         | 3/30 [00:14<01:51,  4.13s/it, atk: -24.254 ent: -5.631 str: 0.407 loss: -29.479]
Iterations:  13%|█▎        | 4/30 [00:16<01:46,  4.11s/it, atk: -24.254 ent: -5.631 str: 0.407 loss: -29.479]
Iterations:  13%|█▎        | 4/30 [00:18<01:46,  4.11s/it, atk: -30.859 ent: -5.631 str: 0.458 loss: -36.032]
Iterations:  17%|█▋        | 5/30 [00:20<01:42,  4.10s/it, atk: -30.859 ent: -5.631 str: 0.458 loss: -36.032]
Iterations:  17%|█▋        | 5/30 [00:22<01:42,  4.10s/it, atk: -35.775 ent: -5.630 str: 0.533 loss: -40.873]
Iterations:  20%|██        | 6/30 [00:24<01:37,  4.08s/it, atk: -35.775 ent: -5.630 str: 0.533 loss: -40.873]
Iterations:  20%|██        | 6/30 [00:27<01:37,  4.08s/it, atk: -40.308 ent: -5.630 str: 0.579 loss: -45.359]
Iterations:  23%|██▎       | 7/30 [00:28<01:34,  4.09s/it, atk: -40.308 ent: -5.630 str: 0.579 loss: -45.359]
Iterations:  23%|██▎       | 7/30 [00:31<01:34,  4.09s/it, atk: -44.659 ent: -5.630 str: 0.582 loss: -49.708]
Iterations:  27%|██▋       | 8/30 [00:32<01:29,  4.07s/it, atk: -44.659 ent: -5.630 str: 0.582 loss: -49.708]
Iterations:  27%|██▋       | 8/30 [00:35<01:29,  4.07s/it, atk: -47.966 ent: -5.630 str: 0.598 loss: -52.999]
Iterations:  30%|███       | 9/30 [00:36<01:25,  4.06s/it, atk: -47.966 ent: -5.630 str: 0.598 loss: -52.999]
Iterations:  30%|███       | 9/30 [00:39<01:25,  4.06s/it, atk: -51.619 ent: -5.630 str: 0.770 loss: -56.478]
Iterations:  33%|███▎      | 10/30 [00:40<01:21,  4.06s/it, atk: -51.619 ent: -5.630 str: 0.770 loss: -56.478]
Iterations:  33%|███▎      | 10/30 [00:43<01:21,  4.06s/it, atk: -54.986 ent: -5.630 str: 0.771 loss: -59.844]
Iterations:  37%|███▋      | 11/30 [00:45<01:17,  4.09s/it, atk: -54.986 ent: -5.630 str: 0.771 loss: -59.844]
Iterations:  37%|███▋      | 11/30 [00:47<01:17,  4.09s/it, atk: -58.813 ent: -5.630 str: 0.774 loss: -63.670]
Iterations:  40%|████      | 12/30 [00:49<01:13,  4.07s/it, atk: -58.813 ent: -5.630 str: 0.774 loss: -63.670]
Iterations:  40%|████      | 12/30 [00:51<01:13,  4.07s/it, atk: -62.614 ent: -5.630 str: 0.860 loss: -67.385]
Iterations:  43%|████▎     | 13/30 [00:53<01:08,  4.05s/it, atk: -62.614 ent: -5.630 str: 0.860 loss: -67.385]
Iterations:  43%|████▎     | 13/30 [00:55<01:08,  4.05s/it, atk: -64.623 ent: -5.630 str: 1.060 loss: -69.193]
Iterations:  47%|████▋     | 14/30 [00:57<01:04,  4.04s/it, atk: -64.623 ent: -5.630 str: 1.060 loss: -69.193]
Iterations:  47%|████▋     | 14/30 [00:59<01:04,  4.04s/it, atk: -68.631 ent: -5.630 str: 1.101 loss: -73.160]
Iterations:  50%|█████     | 15/30 [01:01<01:00,  4.06s/it, atk: -68.631 ent: -5.630 str: 1.101 loss: -73.160]
Iterations:  50%|█████     | 15/30 [01:03<01:00,  4.06s/it, atk: -70.388 ent: -5.630 str: 1.091 loss: -74.928]
Iterations:  53%|█████▎    | 16/30 [01:05<00:56,  4.04s/it, atk: -70.388 ent: -5.630 str: 1.091 loss: -74.928]
Iterations:  53%|█████▎    | 16/30 [01:07<00:56,  4.04s/it, atk: -73.793 ent: -5.630 str: 1.141 loss: -78.282]
Iterations:  57%|█████▋    | 17/30 [01:09<00:52,  4.04s/it, atk: -73.793 ent: -5.630 str: 1.141 loss: -78.282]
Iterations:  57%|█████▋    | 17/30 [01:11<00:52,  4.04s/it, atk: -76.084 ent: -5.630 str: 1.127 loss: -80.587]
Iterations:  60%|██████    | 18/30 [01:13<00:48,  4.07s/it, atk: -76.084 ent: -5.630 str: 1.127 loss: -80.587]
Iterations:  60%|██████    | 18/30 [01:15<00:48,  4.07s/it, atk: -79.288 ent: -5.630 str: 1.135 loss: -83.783]
Iterations:  63%|██████▎   | 19/30 [01:17<00:45,  4.09s/it, atk: -79.288 ent: -5.630 str: 1.135 loss: -83.783]
Iterations:  63%|██████▎   | 19/30 [01:19<00:45,  4.09s/it, atk: -81.918 ent: -5.630 str: 1.141 loss: -86.406]
Iterations:  67%|██████▋   | 20/30 [01:21<00:40,  4.09s/it, atk: -81.918 ent: -5.630 str: 1.141 loss: -86.406]
Iterations:  67%|██████▋   | 20/30 [01:23<00:40,  4.09s/it, atk: -84.919 ent: -5.630 str: 1.166 loss: -89.382]
Iterations:  70%|███████   | 21/30 [01:25<00:36,  4.10s/it, atk: -84.919 ent: -5.630 str: 1.166 loss: -89.382]
Iterations:  70%|███████   | 21/30 [01:28<00:36,  4.10s/it, atk: -88.202 ent: -5.630 str: 1.181 loss: -92.651]
Iterations:  73%|███████▎  | 22/30 [01:29<00:32,  4.12s/it, atk: -88.202 ent: -5.630 str: 1.181 loss: -92.651]
Iterations:  73%|███████▎  | 22/30 [01:32<00:32,  4.12s/it, atk: -90.722 ent: -5.630 str: 1.190 loss: -95.162]
Iterations:  77%|███████▋  | 23/30 [01:34<00:28,  4.11s/it, atk: -90.722 ent: -5.630 str: 1.190 loss: -95.162]
Iterations:  77%|███████▋  | 23/30 [01:36<00:28,  4.11s/it, atk: -93.384 ent: -5.630 str: 1.206 loss: -97.808]
Iterations:  80%|████████  | 24/30 [01:38<00:24,  4.06s/it, atk: -93.384 ent: -5.630 str: 1.206 loss: -97.808]
Iterations:  80%|████████  | 24/30 [01:40<00:24,  4.06s/it, atk: -95.434 ent: -5.630 str: 1.208 loss: -99.856]
Iterations:  83%|████████▎ | 25/30 [01:42<00:20,  4.06s/it, atk: -95.434 ent: -5.630 str: 1.208 loss: -99.856]
Iterations:  83%|████████▎ | 25/30 [01:44<00:20,  4.06s/it, atk: -98.566 ent: -5.630 str: 1.213 loss: -102.983]
Iterations:  87%|████████▋ | 26/30 [01:46<00:16,  4.08s/it, atk: -98.566 ent: -5.630 str: 1.213 loss: -102.983]
Iterations:  87%|████████▋ | 26/30 [01:48<00:16,  4.08s/it, atk: -100.550 ent: -5.630 str: 1.218 loss: -104.961]
Iterations:  90%|█████████ | 27/30 [01:50<00:12,  4.07s/it, atk: -100.550 ent: -5.630 str: 1.218 loss: -104.961]
Iterations:  90%|█████████ | 27/30 [01:52<00:12,  4.07s/it, atk: -103.137 ent: -5.630 str: 1.222 loss: -107.544]
Iterations:  93%|█████████▎| 28/30 [01:54<00:08,  4.10s/it, atk: -103.137 ent: -5.630 str: 1.222 loss: -107.544]
Iterations:  93%|█████████▎| 28/30 [01:56<00:08,  4.10s/it, atk: -105.098 ent: -5.629 str: 1.233 loss: -109.495]
Iterations:  97%|█████████▋| 29/30 [01:58<00:04,  4.10s/it, atk: -105.098 ent: -5.629 str: 1.233 loss: -109.495]
Iterations:  97%|█████████▋| 29/30 [02:00<00:04,  4.10s/it, atk: -106.932 ent: -5.629 str: 1.238 loss: -111.323]
Iterations: 100%|██████████| 30/30 [02:02<00:00,  4.09s/it, atk: -106.932 ent: -5.629 str: 1.238 loss: -111.323]
Iterations: 100%|██████████| 30/30 [02:02<00:00,  4.09s/it, atk: -106.932 ent: -5.629 str: 1.238 loss: -111.323]
Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to /home/clc_hcmus2/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth
Accuracy on adversarial examples: 0.0%
after_pred: tensor([497], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([663], device='cuda:0') tensor(1.7777e-05, device='cuda:0')
L1: [3302.1143]	L2: [22.72637]	Linf: [0.7254902]

  0%|          | 0.00/97.8M [00:00<?, ?B/s]
  1%|          | 608k/97.8M [00:00<00:16, 6.22MB/s]
  8%|▊         | 7.40M/97.8M [00:00<00:02, 44.5MB/s]
 18%|█▊        | 17.7M/97.8M [00:00<00:01, 67.5MB/s]
 26%|██▌       | 25.4M/97.8M [00:00<00:01, 70.4MB/s]
 33%|███▎      | 32.0M/97.8M [00:00<00:01, 67.0MB/s]
 39%|███▉      | 38.3M/97.8M [00:00<00:00, 62.7MB/s]
 45%|████▌     | 44.3M/97.8M [00:00<00:01, 55.7MB/s]
 51%|█████     | 49.9M/97.8M [00:00<00:00, 54.2MB/s]
 58%|█████▊    | 56.5M/97.8M [00:01<00:00, 58.5MB/s]
 64%|██████▎   | 62.2M/97.8M [00:01<00:00, 57.1MB/s]
 69%|██████▉   | 67.7M/97.8M [00:01<00:00, 56.9MB/s]
 75%|███████▌  | 73.5M/97.8M [00:01<00:00, 54.8MB/s]
 82%|████████▏ | 79.8M/97.8M [00:01<00:00, 55.4MB/s]
 88%|████████▊ | 85.9M/97.8M [00:01<00:00, 54.5MB/s]
 95%|█████████▌| 93.1M/97.8M [00:01<00:00, 60.1MB/s]
100%|██████████| 97.8M/97.8M [00:01<00:00, 57.5MB/s]

Accuracy on benign examples: 100.0%
gt_label: 717 pred_label: 717 pred_clean_logit 0.9892811179161072

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.90it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  4.15it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.56it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.35it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.21it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:04,  3.16it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.18it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.11it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.14it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.15it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.14it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.08it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.20it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.12it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.17it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.18it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.11it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.19it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.26it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.24it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:25,  6.29s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:21,  7.03s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.74s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.08s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  9.16s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  8.42s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:03<?, ?it/s, atk: -0.264 ent: -5.634 str: 0.000 loss: -5.898]
Iterations:   3%|▎         | 1/30 [00:05<02:30,  5.19s/it, atk: -0.264 ent: -5.634 str: 0.000 loss: -5.898]
Iterations:   3%|▎         | 1/30 [00:07<02:30,  5.19s/it, atk: -1.268 ent: -5.634 str: 0.453 loss: -6.449]
Iterations:   7%|▋         | 2/30 [00:09<02:08,  4.59s/it, atk: -1.268 ent: -5.634 str: 0.453 loss: -6.449]
Iterations:   7%|▋         | 2/30 [00:11<02:08,  4.59s/it, atk: -4.162 ent: -5.634 str: 0.411 loss: -9.385]
Iterations:  10%|█         | 3/30 [00:13<01:58,  4.37s/it, atk: -4.162 ent: -5.634 str: 0.411 loss: -9.385]
Iterations:  10%|█         | 3/30 [00:15<01:58,  4.37s/it, atk: -9.379 ent: -5.634 str: 0.360 loss: -14.653]
Iterations:  13%|█▎        | 4/30 [00:17<01:49,  4.22s/it, atk: -9.379 ent: -5.634 str: 0.360 loss: -14.653]
Iterations:  13%|█▎        | 4/30 [00:19<01:49,  4.22s/it, atk: -16.401 ent: -5.634 str: 0.458 loss: -21.577]
Iterations:  17%|█▋        | 5/30 [00:21<01:44,  4.18s/it, atk: -16.401 ent: -5.634 str: 0.458 loss: -21.577]
Iterations:  17%|█▋        | 5/30 [00:23<01:44,  4.18s/it, atk: -24.595 ent: -5.634 str: 0.518 loss: -29.711]
Iterations:  20%|██        | 6/30 [00:25<01:40,  4.17s/it, atk: -24.595 ent: -5.634 str: 0.518 loss: -29.711]
Iterations:  20%|██        | 6/30 [00:27<01:40,  4.17s/it, atk: -32.619 ent: -5.633 str: 0.549 loss: -37.704]
Iterations:  23%|██▎       | 7/30 [00:29<01:34,  4.12s/it, atk: -32.619 ent: -5.633 str: 0.549 loss: -37.704]
Iterations:  23%|██▎       | 7/30 [00:31<01:34,  4.12s/it, atk: -39.246 ent: -5.633 str: 0.561 loss: -44.319]
Iterations:  27%|██▋       | 8/30 [00:33<01:29,  4.06s/it, atk: -39.246 ent: -5.633 str: 0.561 loss: -44.319]
Iterations:  27%|██▋       | 8/30 [00:35<01:29,  4.06s/it, atk: -44.970 ent: -5.633 str: 0.575 loss: -50.028]
Iterations:  30%|███       | 9/30 [00:37<01:25,  4.08s/it, atk: -44.970 ent: -5.633 str: 0.575 loss: -50.028]
Iterations:  30%|███       | 9/30 [00:40<01:25,  4.08s/it, atk: -51.209 ent: -5.633 str: 0.604 loss: -56.239]
Iterations:  33%|███▎      | 10/30 [00:41<01:21,  4.09s/it, atk: -51.209 ent: -5.633 str: 0.604 loss: -56.239]
Iterations:  33%|███▎      | 10/30 [00:44<01:21,  4.09s/it, atk: -56.070 ent: -5.633 str: 0.659 loss: -61.044]
Iterations:  37%|███▋      | 11/30 [00:45<01:17,  4.09s/it, atk: -56.070 ent: -5.633 str: 0.659 loss: -61.044]
Iterations:  37%|███▋      | 11/30 [00:48<01:17,  4.09s/it, atk: -60.341 ent: -5.633 str: 0.698 loss: -65.277]
Iterations:  40%|████      | 12/30 [00:49<01:11,  3.97s/it, atk: -60.341 ent: -5.633 str: 0.698 loss: -65.277]
Iterations:  40%|████      | 12/30 [00:51<01:11,  3.97s/it, atk: -66.224 ent: -5.633 str: 0.734 loss: -71.124]
Iterations:  43%|████▎     | 13/30 [00:53<01:05,  3.87s/it, atk: -66.224 ent: -5.633 str: 0.734 loss: -71.124]
Iterations:  43%|████▎     | 13/30 [00:55<01:05,  3.87s/it, atk: -71.405 ent: -5.633 str: 0.764 loss: -76.275]
Iterations:  47%|████▋     | 14/30 [00:56<01:00,  3.79s/it, atk: -71.405 ent: -5.633 str: 0.764 loss: -76.275]
Iterations:  47%|████▋     | 14/30 [00:59<01:00,  3.79s/it, atk: -77.337 ent: -5.633 str: 0.758 loss: -82.212]
Iterations:  50%|█████     | 15/30 [01:00<00:57,  3.84s/it, atk: -77.337 ent: -5.633 str: 0.758 loss: -82.212]
Iterations:  50%|█████     | 15/30 [01:03<00:57,  3.84s/it, atk: -83.553 ent: -5.633 str: 0.734 loss: -88.453]
Iterations:  53%|█████▎    | 16/30 [01:04<00:54,  3.87s/it, atk: -83.553 ent: -5.633 str: 0.734 loss: -88.453]
Iterations:  53%|█████▎    | 16/30 [01:07<00:54,  3.87s/it, atk: -87.527 ent: -5.633 str: 0.726 loss: -92.434]
Iterations:  57%|█████▋    | 17/30 [01:08<00:50,  3.88s/it, atk: -87.527 ent: -5.633 str: 0.726 loss: -92.434]
Iterations:  57%|█████▋    | 17/30 [01:11<00:50,  3.88s/it, atk: -92.327 ent: -5.633 str: 0.742 loss: -97.219]
Iterations:  60%|██████    | 18/30 [01:12<00:47,  3.95s/it, atk: -92.327 ent: -5.633 str: 0.742 loss: -97.219]
Iterations:  60%|██████    | 18/30 [01:15<00:47,  3.95s/it, atk: -97.215 ent: -5.633 str: 0.776 loss: -102.072]
Iterations:  63%|██████▎   | 19/30 [01:16<00:43,  3.98s/it, atk: -97.215 ent: -5.633 str: 0.776 loss: -102.072]
Iterations:  63%|██████▎   | 19/30 [01:19<00:43,  3.98s/it, atk: -101.201 ent: -5.633 str: 0.801 loss: -106.033]
Iterations:  67%|██████▋   | 20/30 [01:20<00:39,  4.00s/it, atk: -101.201 ent: -5.633 str: 0.801 loss: -106.033]
Iterations:  67%|██████▋   | 20/30 [01:23<00:39,  4.00s/it, atk: -105.123 ent: -5.633 str: 0.786 loss: -109.970]
Iterations:  70%|███████   | 21/30 [01:24<00:35,  4.00s/it, atk: -105.123 ent: -5.633 str: 0.786 loss: -109.970]
Iterations:  70%|███████   | 21/30 [01:27<00:35,  4.00s/it, atk: -108.568 ent: -5.633 str: 0.807 loss: -113.394]
Iterations:  73%|███████▎  | 22/30 [01:28<00:31,  4.00s/it, atk: -108.568 ent: -5.633 str: 0.807 loss: -113.394]
Iterations:  73%|███████▎  | 22/30 [01:31<00:31,  4.00s/it, atk: -112.244 ent: -5.633 str: 0.830 loss: -117.048]
Iterations:  77%|███████▋  | 23/30 [01:32<00:27,  3.97s/it, atk: -112.244 ent: -5.633 str: 0.830 loss: -117.048]
Iterations:  77%|███████▋  | 23/30 [01:34<00:27,  3.97s/it, atk: -116.639 ent: -5.633 str: 0.831 loss: -121.441]
Iterations:  80%|████████  | 24/30 [01:36<00:23,  3.99s/it, atk: -116.639 ent: -5.633 str: 0.831 loss: -121.441]
Iterations:  80%|████████  | 24/30 [01:39<00:23,  3.99s/it, atk: -120.188 ent: -5.633 str: 0.829 loss: -124.992]
Iterations:  83%|████████▎ | 25/30 [01:40<00:20,  4.03s/it, atk: -120.188 ent: -5.633 str: 0.829 loss: -124.992]
Iterations:  83%|████████▎ | 25/30 [01:43<00:20,  4.03s/it, atk: -122.389 ent: -5.633 str: 0.896 loss: -127.126]
Iterations:  87%|████████▋ | 26/30 [01:45<00:16,  4.07s/it, atk: -122.389 ent: -5.633 str: 0.896 loss: -127.126]
Iterations:  87%|████████▋ | 26/30 [01:47<00:16,  4.07s/it, atk: -125.987 ent: -5.633 str: 0.977 loss: -130.643]
Iterations:  90%|█████████ | 27/30 [01:49<00:12,  4.11s/it, atk: -125.987 ent: -5.633 str: 0.977 loss: -130.643]
Iterations:  90%|█████████ | 27/30 [01:51<00:12,  4.11s/it, atk: -130.037 ent: -5.633 str: 0.982 loss: -134.688]
Iterations:  93%|█████████▎| 28/30 [01:53<00:08,  4.12s/it, atk: -130.037 ent: -5.633 str: 0.982 loss: -134.688]
Iterations:  93%|█████████▎| 28/30 [01:55<00:08,  4.12s/it, atk: -134.171 ent: -5.633 str: 0.962 loss: -138.842]
Iterations:  97%|█████████▋| 29/30 [01:57<00:04,  4.13s/it, atk: -134.171 ent: -5.633 str: 0.962 loss: -138.842]
Iterations:  97%|█████████▋| 29/30 [01:59<00:04,  4.13s/it, atk: -137.628 ent: -5.633 str: 0.955 loss: -142.306]
Iterations: 100%|██████████| 30/30 [02:01<00:00,  4.11s/it, atk: -137.628 ent: -5.633 str: 0.955 loss: -142.306]
Iterations: 100%|██████████| 30/30 [02:01<00:00,  4.06s/it, atk: -137.628 ent: -5.633 str: 0.955 loss: -142.306]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([468], device='cuda:0') tensor(0.9990, device='cuda:0')
after_true: tensor([717], device='cuda:0') tensor(7.5044e-07, device='cuda:0')
L1: [3881.2822]	L2: [26.319147]	Linf: [0.8352941]

Accuracy on benign examples: 100.0%
gt_label: 671 pred_label: 671 pred_clean_logit 0.6306856274604797

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.72it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.88it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.38it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.26it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.27it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.29it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.24it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.20it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.31it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.26it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.19it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.14it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.16it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.11it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.11it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.10it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.09it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.13it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.27it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.24it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:25,  6.36s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.98s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.71s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:32<00:08,  8.51s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  9.36s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  8.59s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -8.199 ent: -11.259 str: 0.000 loss: -19.458]
Iterations:   3%|▎         | 1/30 [00:04<02:04,  4.29s/it, atk: -8.199 ent: -11.259 str: 0.000 loss: -19.458]
Iterations:   3%|▎         | 1/30 [00:06<02:04,  4.29s/it, atk: -11.244 ent: -11.259 str: 1.662 loss: -20.842]
Iterations:   7%|▋         | 2/30 [00:08<01:56,  4.17s/it, atk: -11.244 ent: -11.259 str: 1.662 loss: -20.842]
Iterations:   7%|▋         | 2/30 [00:10<01:56,  4.17s/it, atk: -22.481 ent: -11.260 str: 2.026 loss: -31.716]
Iterations:  10%|█         | 3/30 [00:12<01:52,  4.16s/it, atk: -22.481 ent: -11.260 str: 2.026 loss: -31.716]
Iterations:  10%|█         | 3/30 [00:14<01:52,  4.16s/it, atk: -39.043 ent: -11.260 str: 1.851 loss: -48.452]
Iterations:  13%|█▎        | 4/30 [00:16<01:47,  4.14s/it, atk: -39.043 ent: -11.260 str: 1.851 loss: -48.452]
Iterations:  13%|█▎        | 4/30 [00:18<01:47,  4.14s/it, atk: -48.554 ent: -11.260 str: 1.669 loss: -58.145]
Iterations:  17%|█▋        | 5/30 [00:20<01:43,  4.13s/it, atk: -48.554 ent: -11.260 str: 1.669 loss: -58.145]
Iterations:  17%|█▋        | 5/30 [00:23<01:43,  4.13s/it, atk: -60.823 ent: -11.260 str: 1.702 loss: -70.381]
Iterations:  20%|██        | 6/30 [00:24<01:38,  4.12s/it, atk: -60.823 ent: -11.260 str: 1.702 loss: -70.381]
Iterations:  20%|██        | 6/30 [00:27<01:38,  4.12s/it, atk: -76.439 ent: -11.260 str: 1.776 loss: -85.923]
Iterations:  23%|██▎       | 7/30 [00:28<01:33,  4.09s/it, atk: -76.439 ent: -11.260 str: 1.776 loss: -85.923]
Iterations:  23%|██▎       | 7/30 [00:30<01:33,  4.09s/it, atk: -87.883 ent: -11.260 str: 1.857 loss: -97.286]
Iterations:  27%|██▋       | 8/30 [00:32<01:27,  3.98s/it, atk: -87.883 ent: -11.260 str: 1.857 loss: -97.286]
Iterations:  27%|██▋       | 8/30 [00:34<01:27,  3.98s/it, atk: -98.173 ent: -11.260 str: 1.891 loss: -107.541]
Iterations:  30%|███       | 9/30 [00:36<01:24,  4.04s/it, atk: -98.173 ent: -11.260 str: 1.891 loss: -107.541]
Iterations:  30%|███       | 9/30 [00:39<01:24,  4.04s/it, atk: -107.895 ent: -11.260 str: 1.882 loss: -117.272]
Iterations:  33%|███▎      | 10/30 [00:40<01:20,  4.04s/it, atk: -107.895 ent: -11.260 str: 1.882 loss: -117.272]
Iterations:  33%|███▎      | 10/30 [00:43<01:20,  4.04s/it, atk: -115.142 ent: -11.260 str: 1.945 loss: -124.457]
Iterations:  37%|███▋      | 11/30 [00:44<01:17,  4.05s/it, atk: -115.142 ent: -11.260 str: 1.945 loss: -124.457]
Iterations:  37%|███▋      | 11/30 [00:47<01:17,  4.05s/it, atk: -122.195 ent: -11.260 str: 1.967 loss: -131.488]
Iterations:  40%|████      | 12/30 [00:49<01:13,  4.09s/it, atk: -122.195 ent: -11.260 str: 1.967 loss: -131.488]
Iterations:  40%|████      | 12/30 [00:51<01:13,  4.09s/it, atk: -131.802 ent: -11.260 str: 2.015 loss: -141.047]
Iterations:  43%|████▎     | 13/30 [00:53<01:09,  4.11s/it, atk: -131.802 ent: -11.260 str: 2.015 loss: -141.047]
Iterations:  43%|████▎     | 13/30 [00:55<01:09,  4.11s/it, atk: -139.021 ent: -11.260 str: 2.049 loss: -148.232]
Iterations:  47%|████▋     | 14/30 [00:57<01:05,  4.11s/it, atk: -139.021 ent: -11.260 str: 2.049 loss: -148.232]
Iterations:  47%|████▋     | 14/30 [00:59<01:05,  4.11s/it, atk: -144.613 ent: -11.260 str: 2.073 loss: -153.800]
Iterations:  50%|█████     | 15/30 [01:01<01:00,  4.02s/it, atk: -144.613 ent: -11.260 str: 2.073 loss: -153.800]
Iterations:  50%|█████     | 15/30 [01:03<01:00,  4.02s/it, atk: -151.914 ent: -11.260 str: 2.102 loss: -161.073]
Iterations:  53%|█████▎    | 16/30 [01:04<00:55,  3.93s/it, atk: -151.914 ent: -11.260 str: 2.102 loss: -161.073]
Iterations:  53%|█████▎    | 16/30 [01:07<00:55,  3.93s/it, atk: -158.921 ent: -11.260 str: 2.128 loss: -168.053]
Iterations:  57%|█████▋    | 17/30 [01:08<00:51,  3.93s/it, atk: -158.921 ent: -11.260 str: 2.128 loss: -168.053]
Iterations:  57%|█████▋    | 17/30 [01:11<00:51,  3.93s/it, atk: -164.999 ent: -11.260 str: 2.150 loss: -174.110]
Iterations:  60%|██████    | 18/30 [01:12<00:47,  3.93s/it, atk: -164.999 ent: -11.260 str: 2.150 loss: -174.110]
Iterations:  60%|██████    | 18/30 [01:15<00:47,  3.93s/it, atk: -171.189 ent: -11.260 str: 2.173 loss: -180.277]
Iterations:  63%|██████▎   | 19/30 [01:16<00:43,  3.98s/it, atk: -171.189 ent: -11.260 str: 2.173 loss: -180.277]
Iterations:  63%|██████▎   | 19/30 [01:19<00:43,  3.98s/it, atk: -176.787 ent: -11.260 str: 2.193 loss: -185.854]
Iterations:  67%|██████▋   | 20/30 [01:20<00:39,  3.99s/it, atk: -176.787 ent: -11.260 str: 2.193 loss: -185.854]
Iterations:  67%|██████▋   | 20/30 [01:23<00:39,  3.99s/it, atk: -182.138 ent: -11.260 str: 2.216 loss: -191.183]
Iterations:  70%|███████   | 21/30 [01:24<00:35,  4.00s/it, atk: -182.138 ent: -11.260 str: 2.216 loss: -191.183]
Iterations:  70%|███████   | 21/30 [01:27<00:35,  4.00s/it, atk: -187.121 ent: -11.260 str: 2.231 loss: -196.151]
Iterations:  73%|███████▎  | 22/30 [01:28<00:31,  3.97s/it, atk: -187.121 ent: -11.260 str: 2.231 loss: -196.151]
Iterations:  73%|███████▎  | 22/30 [01:30<00:31,  3.97s/it, atk: -191.953 ent: -11.260 str: 2.235 loss: -200.979]
Iterations:  77%|███████▋  | 23/30 [01:32<00:27,  3.96s/it, atk: -191.953 ent: -11.260 str: 2.235 loss: -200.979]
Iterations:  77%|███████▋  | 23/30 [01:34<00:27,  3.96s/it, atk: -196.368 ent: -11.260 str: 2.239 loss: -205.390]
Iterations:  80%|████████  | 24/30 [01:36<00:23,  3.92s/it, atk: -196.368 ent: -11.260 str: 2.239 loss: -205.390]
Iterations:  80%|████████  | 24/30 [01:38<00:23,  3.92s/it, atk: -200.160 ent: -11.260 str: 2.244 loss: -209.177]
Iterations:  83%|████████▎ | 25/30 [01:40<00:19,  3.83s/it, atk: -200.160 ent: -11.260 str: 2.244 loss: -209.177]
Iterations:  83%|████████▎ | 25/30 [01:42<00:19,  3.83s/it, atk: -204.001 ent: -11.260 str: 2.259 loss: -213.002]
Iterations:  87%|████████▋ | 26/30 [01:43<00:15,  3.80s/it, atk: -204.001 ent: -11.260 str: 2.259 loss: -213.002]
Iterations:  87%|████████▋ | 26/30 [01:46<00:15,  3.80s/it, atk: -208.421 ent: -11.260 str: 2.275 loss: -217.406]
Iterations:  90%|█████████ | 27/30 [01:47<00:11,  3.84s/it, atk: -208.421 ent: -11.260 str: 2.275 loss: -217.406]
Iterations:  90%|█████████ | 27/30 [01:50<00:11,  3.84s/it, atk: -212.573 ent: -11.260 str: 2.280 loss: -221.554]
Iterations:  93%|█████████▎| 28/30 [01:51<00:07,  3.89s/it, atk: -212.573 ent: -11.260 str: 2.280 loss: -221.554]
Iterations:  93%|█████████▎| 28/30 [01:53<00:07,  3.89s/it, atk: -216.372 ent: -11.260 str: 2.280 loss: -225.353]
Iterations:  97%|█████████▋| 29/30 [01:55<00:03,  3.88s/it, atk: -216.372 ent: -11.260 str: 2.280 loss: -225.353]
Iterations:  97%|█████████▋| 29/30 [01:57<00:03,  3.88s/it, atk: -220.600 ent: -11.260 str: 2.278 loss: -229.583]
Iterations: 100%|██████████| 30/30 [01:59<00:00,  3.84s/it, atk: -220.600 ent: -11.260 str: 2.278 loss: -229.583]
Iterations: 100%|██████████| 30/30 [01:59<00:00,  3.98s/it, atk: -220.600 ent: -11.260 str: 2.278 loss: -229.583]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([880], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([671], device='cuda:0') tensor(1.8172e-10, device='cuda:0')
L1: [3445.251]	L2: [22.675325]	Linf: [0.89411765]

Accuracy on benign examples: 100.0%
gt_label: 324 pred_label: 324 pred_clean_logit 0.9429625272750854

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:02,  6.38it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  4.07it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.64it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.43it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.38it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.25it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.27it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.20it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.30it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.22it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.42it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.33it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.30it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.22it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.25it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.16it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.17it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.15it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.19it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.30it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:24,  6.13s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.72s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:21<00:14,  7.47s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.29s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:40<00:00,  8.78s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:40<00:00,  8.17s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:03<?, ?it/s, atk: -5.765 ent: -11.248 str: 0.000 loss: -17.013]
Iterations:   3%|▎         | 1/30 [00:05<02:30,  5.20s/it, atk: -5.765 ent: -11.248 str: 0.000 loss: -17.013]
Iterations:   3%|▎         | 1/30 [00:07<02:30,  5.20s/it, atk: -17.078 ent: -11.248 str: 0.930 loss: -27.395]
Iterations:   7%|▋         | 2/30 [00:09<02:08,  4.59s/it, atk: -17.078 ent: -11.248 str: 0.930 loss: -27.395]
Iterations:   7%|▋         | 2/30 [00:11<02:08,  4.59s/it, atk: -32.050 ent: -11.249 str: 1.076 loss: -42.222]
Iterations:  10%|█         | 3/30 [00:13<01:58,  4.40s/it, atk: -32.050 ent: -11.249 str: 1.076 loss: -42.222]
Iterations:  10%|█         | 3/30 [00:15<01:58,  4.40s/it, atk: -43.570 ent: -11.249 str: 1.146 loss: -53.673]
Iterations:  13%|█▎        | 4/30 [00:17<01:51,  4.29s/it, atk: -43.570 ent: -11.249 str: 1.146 loss: -53.673]
Iterations:  13%|█▎        | 4/30 [00:19<01:51,  4.29s/it, atk: -49.471 ent: -11.249 str: 1.286 loss: -59.435]
Iterations:  17%|█▋        | 5/30 [00:21<01:45,  4.23s/it, atk: -49.471 ent: -11.249 str: 1.286 loss: -59.435]
Iterations:  17%|█▋        | 5/30 [00:24<01:45,  4.23s/it, atk: -52.080 ent: -11.249 str: 1.598 loss: -61.732]
Iterations:  20%|██        | 6/30 [00:25<01:40,  4.18s/it, atk: -52.080 ent: -11.249 str: 1.598 loss: -61.732]
Iterations:  20%|██        | 6/30 [00:28<01:40,  4.18s/it, atk: -57.019 ent: -11.249 str: 1.823 loss: -66.444]
Iterations:  23%|██▎       | 7/30 [00:29<01:35,  4.15s/it, atk: -57.019 ent: -11.249 str: 1.823 loss: -66.444]
Iterations:  23%|██▎       | 7/30 [00:32<01:35,  4.15s/it, atk: -64.314 ent: -11.249 str: 1.954 loss: -73.609]
Iterations:  27%|██▋       | 8/30 [00:33<01:29,  4.09s/it, atk: -64.314 ent: -11.249 str: 1.954 loss: -73.609]
Iterations:  27%|██▋       | 8/30 [00:36<01:29,  4.09s/it, atk: -71.355 ent: -11.249 str: 1.993 loss: -80.611]
Iterations:  30%|███       | 9/30 [00:37<01:25,  4.08s/it, atk: -71.355 ent: -11.249 str: 1.993 loss: -80.611]
Iterations:  30%|███       | 9/30 [00:40<01:25,  4.08s/it, atk: -77.627 ent: -11.250 str: 2.043 loss: -86.834]
Iterations:  33%|███▎      | 10/30 [00:42<01:22,  4.11s/it, atk: -77.627 ent: -11.250 str: 2.043 loss: -86.834]
Iterations:  33%|███▎      | 10/30 [00:44<01:22,  4.11s/it, atk: -81.832 ent: -11.250 str: 2.122 loss: -90.960]
Iterations:  37%|███▋      | 11/30 [00:46<01:17,  4.09s/it, atk: -81.832 ent: -11.250 str: 2.122 loss: -90.960]
Iterations:  37%|███▋      | 11/30 [00:48<01:17,  4.09s/it, atk: -88.919 ent: -11.250 str: 2.175 loss: -97.994]
Iterations:  40%|████      | 12/30 [00:50<01:13,  4.11s/it, atk: -88.919 ent: -11.250 str: 2.175 loss: -97.994]
Iterations:  40%|████      | 12/30 [00:52<01:13,  4.11s/it, atk: -95.826 ent: -11.250 str: 2.243 loss: -104.833]
Iterations:  43%|████▎     | 13/30 [00:54<01:10,  4.13s/it, atk: -95.826 ent: -11.250 str: 2.243 loss: -104.833]
Iterations:  43%|████▎     | 13/30 [00:56<01:10,  4.13s/it, atk: -103.429 ent: -11.250 str: 2.288 loss: -112.391]
Iterations:  47%|████▋     | 14/30 [00:58<01:05,  4.11s/it, atk: -103.429 ent: -11.250 str: 2.288 loss: -112.391]
Iterations:  47%|████▋     | 14/30 [01:00<01:05,  4.11s/it, atk: -110.510 ent: -11.250 str: 2.321 loss: -119.439]
Iterations:  50%|█████     | 15/30 [01:02<01:01,  4.09s/it, atk: -110.510 ent: -11.250 str: 2.321 loss: -119.439]
Iterations:  50%|█████     | 15/30 [01:04<01:01,  4.09s/it, atk: -115.895 ent: -11.250 str: 2.323 loss: -124.822]
Iterations:  53%|█████▎    | 16/30 [01:06<00:57,  4.10s/it, atk: -115.895 ent: -11.250 str: 2.323 loss: -124.822]
Iterations:  53%|█████▎    | 16/30 [01:09<00:57,  4.10s/it, atk: -121.755 ent: -11.249 str: 2.334 loss: -130.670]
Iterations:  57%|█████▋    | 17/30 [01:10<00:53,  4.11s/it, atk: -121.755 ent: -11.249 str: 2.334 loss: -130.670]
Iterations:  57%|█████▋    | 17/30 [01:13<00:53,  4.11s/it, atk: -126.273 ent: -11.249 str: 2.387 loss: -135.136]
Iterations:  60%|██████    | 18/30 [01:14<00:47,  3.97s/it, atk: -126.273 ent: -11.249 str: 2.387 loss: -135.136]
Iterations:  60%|██████    | 18/30 [01:16<00:47,  3.97s/it, atk: -131.379 ent: -11.249 str: 2.425 loss: -140.203]
Iterations:  63%|██████▎   | 19/30 [01:18<00:44,  4.00s/it, atk: -131.379 ent: -11.249 str: 2.425 loss: -140.203]
Iterations:  63%|██████▎   | 19/30 [01:20<00:44,  4.00s/it, atk: -136.954 ent: -11.250 str: 2.457 loss: -145.747]
Iterations:  67%|██████▋   | 20/30 [01:22<00:40,  4.04s/it, atk: -136.954 ent: -11.250 str: 2.457 loss: -145.747]
Iterations:  67%|██████▋   | 20/30 [01:25<00:40,  4.04s/it, atk: -141.233 ent: -11.250 str: 2.481 loss: -150.002]
Iterations:  70%|███████   | 21/30 [01:26<00:36,  4.06s/it, atk: -141.233 ent: -11.250 str: 2.481 loss: -150.002]
Iterations:  70%|███████   | 21/30 [01:29<00:36,  4.06s/it, atk: -147.801 ent: -11.250 str: 2.500 loss: -156.551]
Iterations:  73%|███████▎  | 22/30 [01:30<00:32,  4.06s/it, atk: -147.801 ent: -11.250 str: 2.500 loss: -156.551]
Iterations:  73%|███████▎  | 22/30 [01:33<00:32,  4.06s/it, atk: -153.671 ent: -11.251 str: 2.517 loss: -162.404]
Iterations:  77%|███████▋  | 23/30 [01:34<00:28,  4.05s/it, atk: -153.671 ent: -11.251 str: 2.517 loss: -162.404]
Iterations:  77%|███████▋  | 23/30 [01:37<00:28,  4.05s/it, atk: -159.113 ent: -11.251 str: 2.529 loss: -167.835]
Iterations:  80%|████████  | 24/30 [01:39<00:24,  4.08s/it, atk: -159.113 ent: -11.251 str: 2.529 loss: -167.835]
Iterations:  80%|████████  | 24/30 [01:41<00:24,  4.08s/it, atk: -164.075 ent: -11.251 str: 2.521 loss: -172.805]
Iterations:  83%|████████▎ | 25/30 [01:43<00:20,  4.08s/it, atk: -164.075 ent: -11.251 str: 2.521 loss: -172.805]
Iterations:  83%|████████▎ | 25/30 [01:45<00:20,  4.08s/it, atk: -168.503 ent: -11.251 str: 2.517 loss: -177.237]
Iterations:  87%|████████▋ | 26/30 [01:47<00:16,  4.10s/it, atk: -168.503 ent: -11.251 str: 2.517 loss: -177.237]
Iterations:  87%|████████▋ | 26/30 [01:49<00:16,  4.10s/it, atk: -173.056 ent: -11.251 str: 2.519 loss: -181.788]
Iterations:  90%|█████████ | 27/30 [01:51<00:12,  4.12s/it, atk: -173.056 ent: -11.251 str: 2.519 loss: -181.788]
Iterations:  90%|█████████ | 27/30 [01:53<00:12,  4.12s/it, atk: -177.058 ent: -11.250 str: 2.511 loss: -185.797]
Iterations:  93%|█████████▎| 28/30 [01:55<00:08,  4.13s/it, atk: -177.058 ent: -11.250 str: 2.511 loss: -185.797]
Iterations:  93%|█████████▎| 28/30 [01:57<00:08,  4.13s/it, atk: -180.739 ent: -11.250 str: 2.519 loss: -189.470]
Iterations:  97%|█████████▋| 29/30 [01:59<00:04,  4.09s/it, atk: -180.739 ent: -11.250 str: 2.519 loss: -189.470]
Iterations:  97%|█████████▋| 29/30 [02:01<00:04,  4.09s/it, atk: -184.850 ent: -11.251 str: 2.536 loss: -193.564]
Iterations: 100%|██████████| 30/30 [02:03<00:00,  4.08s/it, atk: -184.850 ent: -11.251 str: 2.536 loss: -193.564]
Iterations: 100%|██████████| 30/30 [02:03<00:00,  4.12s/it, atk: -184.850 ent: -11.251 str: 2.536 loss: -193.564]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([77], device='cuda:0') tensor(0.9111, device='cuda:0')
after_true: tensor([324], device='cuda:0') tensor(7.1051e-09, device='cuda:0')
L1: [2336.867]	L2: [16.164614]	Linf: [0.6784314]

Accuracy on benign examples: 100.0%
gt_label: 759 pred_label: 759 pred_clean_logit 0.9951533079147339

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.87it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.84it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.53it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.32it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.30it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.33it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.32it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.31it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:02,  3.33it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.29it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.45it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.33it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.28it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.22it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.47it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.49it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:04<00:00,  3.47it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.51it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.37it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.40it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:24,  6.12s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.74s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:21<00:14,  7.40s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.32s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  9.28s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  8.44s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:03<?, ?it/s, atk: -0.026 ent: -11.256 str: 0.000 loss: -11.282]
Iterations:   3%|▎         | 1/30 [00:04<02:20,  4.85s/it, atk: -0.026 ent: -11.256 str: 0.000 loss: -11.282]
Iterations:   3%|▎         | 1/30 [00:07<02:20,  4.85s/it, atk: -0.086 ent: -11.256 str: 1.357 loss: -9.985] 
Iterations:   7%|▋         | 2/30 [00:08<02:03,  4.43s/it, atk: -0.086 ent: -11.256 str: 1.357 loss: -9.985]
Iterations:   7%|▋         | 2/30 [00:11<02:03,  4.43s/it, atk: -0.113 ent: -11.256 str: 1.686 loss: -9.683]
Iterations:  10%|█         | 3/30 [00:13<01:54,  4.25s/it, atk: -0.113 ent: -11.256 str: 1.686 loss: -9.683]
Iterations:  10%|█         | 3/30 [00:15<01:54,  4.25s/it, atk: -0.162 ent: -11.256 str: 1.355 loss: -10.063]
Iterations:  13%|█▎        | 4/30 [00:17<01:49,  4.19s/it, atk: -0.162 ent: -11.256 str: 1.355 loss: -10.063]
Iterations:  13%|█▎        | 4/30 [00:19<01:49,  4.19s/it, atk: -0.330 ent: -11.256 str: 1.433 loss: -10.153]
Iterations:  17%|█▋        | 5/30 [00:21<01:43,  4.13s/it, atk: -0.330 ent: -11.256 str: 1.433 loss: -10.153]
Iterations:  17%|█▋        | 5/30 [00:23<01:43,  4.13s/it, atk: -0.352 ent: -11.256 str: 1.412 loss: -10.196]
Iterations:  20%|██        | 6/30 [00:25<01:39,  4.16s/it, atk: -0.352 ent: -11.256 str: 1.412 loss: -10.196]
Iterations:  20%|██        | 6/30 [00:27<01:39,  4.16s/it, atk: -0.931 ent: -11.256 str: 1.162 loss: -11.024]
Iterations:  23%|██▎       | 7/30 [00:29<01:33,  4.08s/it, atk: -0.931 ent: -11.256 str: 1.162 loss: -11.024]
Iterations:  23%|██▎       | 7/30 [00:31<01:33,  4.08s/it, atk: -1.709 ent: -11.256 str: 1.179 loss: -11.786]
Iterations:  27%|██▋       | 8/30 [00:33<01:28,  4.04s/it, atk: -1.709 ent: -11.256 str: 1.179 loss: -11.786]
Iterations:  27%|██▋       | 8/30 [00:35<01:28,  4.04s/it, atk: -4.153 ent: -11.256 str: 1.574 loss: -13.836]
Iterations:  30%|███       | 9/30 [00:37<01:24,  4.01s/it, atk: -4.153 ent: -11.256 str: 1.574 loss: -13.836]
Iterations:  30%|███       | 9/30 [00:39<01:24,  4.01s/it, atk: -14.049 ent: -11.256 str: 1.093 loss: -24.212]
Iterations:  33%|███▎      | 10/30 [00:40<01:17,  3.85s/it, atk: -14.049 ent: -11.256 str: 1.093 loss: -24.212]
Iterations:  33%|███▎      | 10/30 [00:42<01:17,  3.85s/it, atk: -30.574 ent: -11.255 str: 1.145 loss: -40.685]
Iterations:  37%|███▋      | 11/30 [00:44<01:11,  3.79s/it, atk: -30.574 ent: -11.255 str: 1.145 loss: -40.685]
Iterations:  37%|███▋      | 11/30 [00:46<01:11,  3.79s/it, atk: -34.483 ent: -11.255 str: 1.361 loss: -44.377]
Iterations:  40%|████      | 12/30 [00:48<01:09,  3.89s/it, atk: -34.483 ent: -11.255 str: 1.361 loss: -44.377]
Iterations:  40%|████      | 12/30 [00:50<01:09,  3.89s/it, atk: -49.805 ent: -11.256 str: 1.331 loss: -59.729]
Iterations:  43%|████▎     | 13/30 [00:52<01:06,  3.93s/it, atk: -49.805 ent: -11.256 str: 1.331 loss: -59.729]
Iterations:  43%|████▎     | 13/30 [00:54<01:06,  3.93s/it, atk: -59.606 ent: -11.256 str: 1.408 loss: -69.454]
Iterations:  47%|████▋     | 14/30 [00:56<01:03,  3.99s/it, atk: -59.606 ent: -11.256 str: 1.408 loss: -69.454]
Iterations:  47%|████▋     | 14/30 [00:58<01:03,  3.99s/it, atk: -66.081 ent: -11.256 str: 1.525 loss: -75.812]
Iterations:  50%|█████     | 15/30 [01:00<00:59,  3.99s/it, atk: -66.081 ent: -11.256 str: 1.525 loss: -75.812]
Iterations:  50%|█████     | 15/30 [01:02<00:59,  3.99s/it, atk: -78.644 ent: -11.256 str: 1.462 loss: -88.438]
Iterations:  53%|█████▎    | 16/30 [01:04<00:56,  4.01s/it, atk: -78.644 ent: -11.256 str: 1.462 loss: -88.438]
Iterations:  53%|█████▎    | 16/30 [01:06<00:56,  4.01s/it, atk: -88.024 ent: -11.256 str: 1.605 loss: -97.675]
Iterations:  57%|█████▋    | 17/30 [01:08<00:52,  4.04s/it, atk: -88.024 ent: -11.256 str: 1.605 loss: -97.675]
Iterations:  57%|█████▋    | 17/30 [01:11<00:52,  4.04s/it, atk: -91.615 ent: -11.256 str: 1.613 loss: -101.258]
Iterations:  60%|██████    | 18/30 [01:12<00:48,  4.06s/it, atk: -91.615 ent: -11.256 str: 1.613 loss: -101.258]
Iterations:  60%|██████    | 18/30 [01:15<00:48,  4.06s/it, atk: -108.108 ent: -11.256 str: 1.609 loss: -117.755]
Iterations:  63%|██████▎   | 19/30 [01:17<00:44,  4.09s/it, atk: -108.108 ent: -11.256 str: 1.609 loss: -117.755]
Iterations:  63%|██████▎   | 19/30 [01:19<00:44,  4.09s/it, atk: -117.495 ent: -11.256 str: 1.680 loss: -127.071]
Iterations:  67%|██████▋   | 20/30 [01:21<00:40,  4.09s/it, atk: -117.495 ent: -11.256 str: 1.680 loss: -127.071]
Iterations:  67%|██████▋   | 20/30 [01:23<00:40,  4.09s/it, atk: -126.342 ent: -11.256 str: 1.741 loss: -135.857]
Iterations:  70%|███████   | 21/30 [01:25<00:36,  4.08s/it, atk: -126.342 ent: -11.256 str: 1.741 loss: -135.857]
Iterations:  70%|███████   | 21/30 [01:27<00:36,  4.08s/it, atk: -136.032 ent: -11.256 str: 1.758 loss: -145.530]
Iterations:  73%|███████▎  | 22/30 [01:29<00:32,  4.07s/it, atk: -136.032 ent: -11.256 str: 1.758 loss: -145.530]
Iterations:  73%|███████▎  | 22/30 [01:31<00:32,  4.07s/it, atk: -144.630 ent: -11.256 str: 1.782 loss: -154.104]
Iterations:  77%|███████▋  | 23/30 [01:33<00:28,  4.06s/it, atk: -144.630 ent: -11.256 str: 1.782 loss: -154.104]
Iterations:  77%|███████▋  | 23/30 [01:35<00:28,  4.06s/it, atk: -153.060 ent: -11.256 str: 1.816 loss: -162.500]
Iterations:  80%|████████  | 24/30 [01:37<00:24,  4.06s/it, atk: -153.060 ent: -11.256 str: 1.816 loss: -162.500]
Iterations:  80%|████████  | 24/30 [01:39<00:24,  4.06s/it, atk: -160.358 ent: -11.256 str: 1.850 loss: -169.764]
Iterations:  83%|████████▎ | 25/30 [01:41<00:20,  4.06s/it, atk: -160.358 ent: -11.256 str: 1.850 loss: -169.764]
Iterations:  83%|████████▎ | 25/30 [01:43<00:20,  4.06s/it, atk: -167.885 ent: -11.256 str: 1.872 loss: -177.269]
Iterations:  87%|████████▋ | 26/30 [01:45<00:16,  4.04s/it, atk: -167.885 ent: -11.256 str: 1.872 loss: -177.269]
Iterations:  87%|████████▋ | 26/30 [01:47<00:16,  4.04s/it, atk: -172.990 ent: -11.256 str: 1.886 loss: -182.360]
Iterations:  90%|█████████ | 27/30 [01:49<00:12,  4.04s/it, atk: -172.990 ent: -11.256 str: 1.886 loss: -182.360]
Iterations:  90%|█████████ | 27/30 [01:51<00:12,  4.04s/it, atk: -178.523 ent: -11.256 str: 1.907 loss: -187.872]
Iterations:  93%|█████████▎| 28/30 [01:53<00:08,  4.02s/it, atk: -178.523 ent: -11.256 str: 1.907 loss: -187.872]
Iterations:  93%|█████████▎| 28/30 [01:55<00:08,  4.02s/it, atk: -184.330 ent: -11.256 str: 1.952 loss: -193.634]
Iterations:  97%|█████████▋| 29/30 [01:57<00:03,  4.00s/it, atk: -184.330 ent: -11.256 str: 1.952 loss: -193.634]
Iterations:  97%|█████████▋| 29/30 [01:59<00:03,  4.00s/it, atk: -190.750 ent: -11.256 str: 1.943 loss: -200.062]
Iterations: 100%|██████████| 30/30 [02:00<00:00,  3.91s/it, atk: -190.750 ent: -11.256 str: 1.943 loss: -200.062]
Iterations: 100%|██████████| 30/30 [02:00<00:00,  4.03s/it, atk: -190.750 ent: -11.256 str: 1.943 loss: -200.062]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([704], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([759], device='cuda:0') tensor(2.9451e-09, device='cuda:0')
L1: [2615.604]	L2: [18.821653]	Linf: [0.6901961]

Accuracy on benign examples: 0.0%
gt_label: 634 pred_label: 388 pred_clean_logit 0.00823988951742649

DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]
DDIM_inverse:   5%|▌         | 1/19 [00:00<00:02,  7.55it/s]
DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.92it/s]
DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.93it/s]
DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.43it/s]
DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:03,  3.54it/s]
DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.29it/s]
DDIM_inverse:  37%|███▋      | 7/19 [00:01<00:03,  3.27it/s]
DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.35it/s]
DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.29it/s]
DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.27it/s]
DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.27it/s]
DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.18it/s]
DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.31it/s]
DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.16it/s]
DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.23it/s]
DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.14it/s]
DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.25it/s]
DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.17it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.21it/s]
DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.32it/s]

Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]
Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:24,  6.17s/it]
Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.79s/it]
Optimize_uncond_embed:  60%|██████    | 3/5 [00:21<00:14,  7.48s/it]
Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.38s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  9.28s/it]
Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  8.46s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%

Iterations:   0%|          | 0/30 [00:00<?, ?it/s]
Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -51.835 ent: -11.269 str: 0.000 loss: -63.104]
Iterations:   3%|▎         | 1/30 [00:04<02:14,  4.65s/it, atk: -51.835 ent: -11.269 str: 0.000 loss: -63.104]
Iterations:   3%|▎         | 1/30 [00:06<02:14,  4.65s/it, atk: -59.428 ent: -11.269 str: 1.176 loss: -69.521]
Iterations:   7%|▋         | 2/30 [00:08<02:02,  4.37s/it, atk: -59.428 ent: -11.269 str: 1.176 loss: -69.521]
Iterations:   7%|▋         | 2/30 [00:11<02:02,  4.37s/it, atk: -70.867 ent: -11.269 str: 1.605 loss: -80.530]
Iterations:  10%|█         | 3/30 [00:12<01:54,  4.25s/it, atk: -70.867 ent: -11.269 str: 1.605 loss: -80.530]
Iterations:  10%|█         | 3/30 [00:15<01:54,  4.25s/it, atk: -88.646 ent: -11.269 str: 1.828 loss: -98.087]
Iterations:  13%|█▎        | 4/30 [00:17<01:48,  4.19s/it, atk: -88.646 ent: -11.269 str: 1.828 loss: -98.087]
Iterations:  13%|█▎        | 4/30 [00:19<01:48,  4.19s/it, atk: -102.296 ent: -11.269 str: 1.957 loss: -111.608]
Iterations:  17%|█▋        | 5/30 [00:21<01:44,  4.17s/it, atk: -102.296 ent: -11.269 str: 1.957 loss: -111.608]
Iterations:  17%|█▋        | 5/30 [00:23<01:44,  4.17s/it, atk: -113.091 ent: -11.269 str: 2.109 loss: -122.251]
Iterations:  20%|██        | 6/30 [00:25<01:38,  4.12s/it, atk: -113.091 ent: -11.269 str: 2.109 loss: -122.251]
Iterations:  20%|██        | 6/30 [00:27<01:38,  4.12s/it, atk: -127.242 ent: -11.269 str: 2.234 loss: -136.277]
Iterations:  23%|██▎       | 7/30 [00:29<01:34,  4.11s/it, atk: -127.242 ent: -11.269 str: 2.234 loss: -136.277]
Iterations:  23%|██▎       | 7/30 [00:31<01:34,  4.11s/it, atk: -137.724 ent: -11.269 str: 2.387 loss: -146.606]
Iterations:  27%|██▋       | 8/30 [00:33<01:29,  4.09s/it, atk: -137.724 ent: -11.269 str: 2.387 loss: -146.606]
Iterations:  27%|██▋       | 8/30 [00:35<01:29,  4.09s/it, atk: -150.917 ent: -11.269 str: 2.495 loss: -159.691]
Iterations:  30%|███       | 9/30 [00:37<01:26,  4.11s/it, atk: -150.917 ent: -11.269 str: 2.495 loss: -159.691]
Iterations:  30%|███       | 9/30 [00:39<01:26,  4.11s/it, atk: -165.804 ent: -11.269 str: 2.582 loss: -174.491]
Iterations:  33%|███▎      | 10/30 [00:41<01:22,  4.11s/it, atk: -165.804 ent: -11.269 str: 2.582 loss: -174.491]
Iterations:  33%|███▎      | 10/30 [00:43<01:22,  4.11s/it, atk: -176.597 ent: -11.269 str: 2.651 loss: -185.215]
Iterations:  37%|███▋      | 11/30 [00:45<01:18,  4.12s/it, atk: -176.597 ent: -11.269 str: 2.651 loss: -185.215]
Iterations:  37%|███▋      | 11/30 [00:48<01:18,  4.12s/it, atk: -187.873 ent: -11.269 str: 2.696 loss: -196.446]
Iterations:  40%|████      | 12/30 [00:49<01:14,  4.15s/it, atk: -187.873 ent: -11.269 str: 2.696 loss: -196.446]
Iterations:  40%|████      | 12/30 [00:52<01:14,  4.15s/it, atk: -200.700 ent: -11.269 str: 2.729 loss: -209.240]
Iterations:  43%|████▎     | 13/30 [00:54<01:10,  4.16s/it, atk: -200.700 ent: -11.269 str: 2.729 loss: -209.240]
Iterations:  43%|████▎     | 13/30 [00:56<01:10,  4.16s/it, atk: -211.104 ent: -11.269 str: 2.760 loss: -219.613]
Iterations:  47%|████▋     | 14/30 [00:58<01:06,  4.16s/it, atk: -211.104 ent: -11.269 str: 2.760 loss: -219.613]
Iterations:  47%|████▋     | 14/30 [01:00<01:06,  4.16s/it, atk: -220.935 ent: -11.268 str: 2.774 loss: -229.429]
Iterations:  50%|█████     | 15/30 [01:02<01:01,  4.13s/it, atk: -220.935 ent: -11.268 str: 2.774 loss: -229.429]
Iterations:  50%|█████     | 15/30 [01:04<01:01,  4.13s/it, atk: -229.941 ent: -11.268 str: 2.792 loss: -238.418]
Iterations:  53%|█████▎    | 16/30 [01:06<00:57,  4.10s/it, atk: -229.941 ent: -11.268 str: 2.792 loss: -238.418]
Iterations:  53%|█████▎    | 16/30 [01:08<00:57,  4.10s/it, atk: -237.792 ent: -11.268 str: 2.815 loss: -246.246]
Iterations:  57%|█████▋    | 17/30 [01:10<00:53,  4.12s/it, atk: -237.792 ent: -11.268 str: 2.815 loss: -246.246]
Iterations:  57%|█████▋    | 17/30 [01:12<00:53,  4.12s/it, atk: -245.149 ent: -11.268 str: 2.834 loss: -253.583]
Iterations:  60%|██████    | 18/30 [01:14<00:49,  4.13s/it, atk: -245.149 ent: -11.268 str: 2.834 loss: -253.583]
Iterations:  60%|██████    | 18/30 [01:16<00:49,  4.13s/it, atk: -253.509 ent: -11.268 str: 2.841 loss: -261.937]
Iterations:  63%|██████▎   | 19/30 [01:18<00:45,  4.11s/it, atk: -253.509 ent: -11.268 str: 2.841 loss: -261.937]
Iterations:  63%|██████▎   | 19/30 [01:21<00:45,  4.11s/it, atk: -260.732 ent: -11.269 str: 2.841 loss: -269.160]
Iterations:  67%|██████▋   | 20/30 [01:22<00:40,  4.09s/it, atk: -260.732 ent: -11.269 str: 2.841 loss: -269.160]
Iterations:  67%|██████▋   | 20/30 [01:25<00:40,  4.09s/it, atk: -266.899 ent: -11.269 str: 2.837 loss: -275.330]
Iterations:  70%|███████   | 21/30 [01:26<00:36,  4.08s/it, atk: -266.899 ent: -11.269 str: 2.837 loss: -275.330]
Iterations:  70%|███████   | 21/30 [01:29<00:36,  4.08s/it, atk: -273.732 ent: -11.269 str: 2.827 loss: -282.173]
Iterations:  73%|███████▎  | 22/30 [01:30<00:32,  4.03s/it, atk: -273.732 ent: -11.269 str: 2.827 loss: -282.173]
Iterations:  73%|███████▎  | 22/30 [01:33<00:32,  4.03s/it, atk: -280.673 ent: -11.269 str: 2.840 loss: -289.102]
Iterations:  77%|███████▋  | 23/30 [01:34<00:28,  4.05s/it, atk: -280.673 ent: -11.269 str: 2.840 loss: -289.102]
Iterations:  77%|███████▋  | 23/30 [01:37<00:28,  4.05s/it, atk: -287.438 ent: -11.269 str: 2.872 loss: -295.835]
Iterations:  80%|████████  | 24/30 [01:38<00:24,  4.04s/it, atk: -287.438 ent: -11.269 str: 2.872 loss: -295.835]
Iterations:  80%|████████  | 24/30 [01:41<00:24,  4.04s/it, atk: -293.100 ent: -11.269 str: 2.899 loss: -301.469]
Iterations:  83%|████████▎ | 25/30 [01:42<00:20,  4.00s/it, atk: -293.100 ent: -11.269 str: 2.899 loss: -301.469]
Iterations:  83%|████████▎ | 25/30 [01:45<00:20,  4.00s/it, atk: -298.586 ent: -11.269 str: 2.920 loss: -306.935]
Iterations:  87%|████████▋ | 26/30 [01:46<00:16,  4.02s/it, atk: -298.586 ent: -11.269 str: 2.920 loss: -306.935]
Iterations:  87%|████████▋ | 26/30 [01:49<00:16,  4.02s/it, atk: -304.565 ent: -11.269 str: 2.928 loss: -312.905]
Iterations:  90%|█████████ | 27/30 [01:50<00:11,  3.96s/it, atk: -304.565 ent: -11.269 str: 2.928 loss: -312.905]
Iterations:  90%|█████████ | 27/30 [01:52<00:11,  3.96s/it, atk: -309.776 ent: -11.269 str: 2.934 loss: -318.110]
Iterations:  93%|█████████▎| 28/30 [01:54<00:07,  4.00s/it, atk: -309.776 ent: -11.269 str: 2.934 loss: -318.110]
Iterations:  93%|█████████▎| 28/30 [01:57<00:07,  4.00s/it, atk: -314.993 ent: -11.269 str: 2.947 loss: -323.314]
Iterations:  97%|█████████▋| 29/30 [01:58<00:03,  3.99s/it, atk: -314.993 ent: -11.269 str: 2.947 loss: -323.314]
Iterations:  97%|█████████▋| 29/30 [02:00<00:03,  3.99s/it, atk: -320.631 ent: -11.269 str: 2.965 loss: -328.935]
Iterations: 100%|██████████| 30/30 [02:02<00:00,  3.95s/it, atk: -320.631 ent: -11.269 str: 2.965 loss: -328.935]
Iterations: 100%|██████████| 30/30 [02:02<00:00,  4.09s/it, atk: -320.631 ent: -11.269 str: 2.965 loss: -328.935]
Downloading: "https://download.pytorch.org/models/vgg19-dcbb9e9d.pth" to /home/clc_hcmus2/.cache/torch/hub/checkpoints/vgg19-dcbb9e9d.pth
Accuracy on adversarial examples: 0.0%
after_pred: tensor([388], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([634], device='cuda:0') tensor(8.0281e-15, device='cuda:0')
L1: [2570.765]	L2: [17.197031]	Linf: [0.62352943]
Clean acc: 0.0%
Adv acc: 0.0%

*********Transfer to resnet********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 0.0%

*********Transfer to vgg********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to mobile********
Accuracy on benign examples: 72.72727272727273%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to inception********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 45.45454545454545%

*********Transfer to convnext********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 63.63636363636363%

*********Transfer to vit********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 54.54545454545454%

*********Transfer to swin********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to deit-b********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 45.45454545454545%

*********Transfer to deit-s********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to mixer-b********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to mixer-l********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 18.181818181818183%

FID:  290.7222106437402

*********fid: 290.7222106437402********
