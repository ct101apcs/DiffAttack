
******Attack based on Diffusion, Attacked Dataset: imagenet_compatible*********
Loading pipeline components...:   0%|          | 0/6 [00:00<?, ?it/s]Loading pipeline components...:  33%|███▎      | 2/6 [00:00<00:00, 11.10it/s]Loading pipeline components...:  67%|██████▋   | 4/6 [00:00<00:00, 11.01it/s]Loading pipeline components...: 100%|██████████| 6/6 [00:00<00:00, 14.84it/s]

Accuracy on benign examples: 100.0%
gt_label: 809 pred_label: 809 pred_clean_logit 0.9425923228263855
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:06<02:01,  6.74s/it]DDIM_inverse:  11%|█         | 2/19 [00:06<00:48,  2.84s/it]DDIM_inverse:  16%|█▌        | 3/19 [00:07<00:27,  1.69s/it]DDIM_inverse:  21%|██        | 4/19 [00:07<00:17,  1.16s/it]DDIM_inverse:  26%|██▋       | 5/19 [00:07<00:12,  1.17it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:08<00:08,  1.51it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:08<00:06,  1.80it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:08<00:05,  2.11it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:09<00:04,  2.34it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:09<00:03,  2.52it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:09<00:02,  2.71it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:10<00:02,  2.80it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:10<00:02,  2.85it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:10<00:01,  2.90it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:11<00:01,  2.98it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:11<00:01,  2.99it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:11<00:00,  3.00it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:12<00:00,  3.01it/s]DDIM_inverse: 100%|██████████| 19/19 [00:12<00:00,  3.01it/s]DDIM_inverse: 100%|██████████| 19/19 [00:12<00:00,  1.54it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:13<00:52, 13.03s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:20<00:29,  9.75s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:29<00:18,  9.34s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:39<00:09,  9.57s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:50<00:00, 10.23s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:50<00:00, 10.13s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:07<?, ?it/s, atk: -0.959 ent: -562.868 str: 0.000 loss: -563.827]Iterations:   3%|▎         | 1/30 [00:39<19:14, 39.79s/it, atk: -0.959 ent: -562.868 str: 0.000 loss: -563.827]Iterations:   3%|▎         | 1/30 [00:42<19:14, 39.79s/it, atk: -2.679 ent: -562.935 str: 1.058 loss: -564.556]Iterations:   7%|▋         | 2/30 [00:43<08:46, 18.81s/it, atk: -2.679 ent: -562.935 str: 1.058 loss: -564.556]Iterations:   7%|▋         | 2/30 [00:46<08:46, 18.81s/it, atk: -5.572 ent: -562.964 str: 1.194 loss: -567.342]Iterations:  10%|█         | 3/30 [00:47<05:25, 12.07s/it, atk: -5.572 ent: -562.964 str: 1.194 loss: -567.342]Iterations:  10%|█         | 3/30 [00:50<05:25, 12.07s/it, atk: -14.240 ent: -562.970 str: 1.281 loss: -575.930]Iterations:  13%|█▎        | 4/30 [00:52<03:52,  8.94s/it, atk: -14.240 ent: -562.970 str: 1.281 loss: -575.930]Iterations:  13%|█▎        | 4/30 [00:54<03:52,  8.94s/it, atk: -20.766 ent: -562.990 str: 1.263 loss: -582.492]Iterations:  17%|█▋        | 5/30 [00:56<02:59,  7.20s/it, atk: -20.766 ent: -562.990 str: 1.263 loss: -582.492]Iterations:  17%|█▋        | 5/30 [00:58<02:59,  7.20s/it, atk: -31.597 ent: -563.007 str: 1.485 loss: -593.119]Iterations:  20%|██        | 6/30 [01:00<02:27,  6.13s/it, atk: -31.597 ent: -563.007 str: 1.485 loss: -593.119]Iterations:  20%|██        | 6/30 [01:02<02:27,  6.13s/it, atk: -41.676 ent: -563.006 str: 1.790 loss: -602.893]Iterations:  23%|██▎       | 7/30 [01:04<02:05,  5.45s/it, atk: -41.676 ent: -563.006 str: 1.790 loss: -602.893]Iterations:  23%|██▎       | 7/30 [01:06<02:05,  5.45s/it, atk: -48.044 ent: -563.005 str: 1.790 loss: -609.259]Iterations:  27%|██▋       | 8/30 [01:08<01:50,  5.00s/it, atk: -48.044 ent: -563.005 str: 1.790 loss: -609.259]Iterations:  27%|██▋       | 8/30 [01:10<01:50,  5.00s/it, atk: -55.979 ent: -563.016 str: 1.770 loss: -617.225]Iterations:  30%|███       | 9/30 [01:12<01:38,  4.70s/it, atk: -55.979 ent: -563.016 str: 1.770 loss: -617.225]Iterations:  30%|███       | 9/30 [01:14<01:38,  4.70s/it, atk: -63.736 ent: -563.046 str: 1.758 loss: -625.023]Iterations:  33%|███▎      | 10/30 [01:16<01:29,  4.50s/it, atk: -63.736 ent: -563.046 str: 1.758 loss: -625.023]Iterations:  33%|███▎      | 10/30 [01:18<01:29,  4.50s/it, atk: -71.107 ent: -563.053 str: 1.866 loss: -632.294]Iterations:  37%|███▋      | 11/30 [01:20<01:23,  4.39s/it, atk: -71.107 ent: -563.053 str: 1.866 loss: -632.294]Iterations:  37%|███▋      | 11/30 [01:22<01:23,  4.39s/it, atk: -78.499 ent: -563.048 str: 1.953 loss: -639.594]Iterations:  40%|████      | 12/30 [01:24<01:17,  4.28s/it, atk: -78.499 ent: -563.048 str: 1.953 loss: -639.594]Iterations:  40%|████      | 12/30 [01:26<01:17,  4.28s/it, atk: -84.147 ent: -563.047 str: 1.947 loss: -645.247]Iterations:  43%|████▎     | 13/30 [01:28<01:11,  4.23s/it, atk: -84.147 ent: -563.047 str: 1.947 loss: -645.247]Iterations:  43%|████▎     | 13/30 [01:31<01:11,  4.23s/it, atk: -89.640 ent: -563.031 str: 1.982 loss: -650.688]Iterations:  47%|████▋     | 14/30 [01:32<01:06,  4.18s/it, atk: -89.640 ent: -563.031 str: 1.982 loss: -650.688]Iterations:  47%|████▋     | 14/30 [01:35<01:06,  4.18s/it, atk: -94.525 ent: -563.039 str: 1.906 loss: -655.658]Iterations:  50%|█████     | 15/30 [01:36<01:02,  4.15s/it, atk: -94.525 ent: -563.039 str: 1.906 loss: -655.658]Iterations:  50%|█████     | 15/30 [01:39<01:02,  4.15s/it, atk: -99.879 ent: -563.041 str: 1.888 loss: -661.031]Iterations:  53%|█████▎    | 16/30 [01:40<00:57,  4.09s/it, atk: -99.879 ent: -563.041 str: 1.888 loss: -661.031]Iterations:  53%|█████▎    | 16/30 [01:43<00:57,  4.09s/it, atk: -103.690 ent: -563.042 str: 1.932 loss: -664.800]Iterations:  57%|█████▋    | 17/30 [01:44<00:53,  4.10s/it, atk: -103.690 ent: -563.042 str: 1.932 loss: -664.800]Iterations:  57%|█████▋    | 17/30 [01:47<00:53,  4.10s/it, atk: -109.079 ent: -563.046 str: 1.927 loss: -670.198]Iterations:  60%|██████    | 18/30 [01:49<00:49,  4.09s/it, atk: -109.079 ent: -563.046 str: 1.927 loss: -670.198]Iterations:  60%|██████    | 18/30 [01:51<00:49,  4.09s/it, atk: -113.574 ent: -563.056 str: 1.959 loss: -674.671]Iterations:  63%|██████▎   | 19/30 [01:53<00:45,  4.11s/it, atk: -113.574 ent: -563.056 str: 1.959 loss: -674.671]Iterations:  63%|██████▎   | 19/30 [01:55<00:45,  4.11s/it, atk: -116.589 ent: -563.065 str: 2.004 loss: -677.649]Iterations:  67%|██████▋   | 20/30 [01:57<00:41,  4.10s/it, atk: -116.589 ent: -563.065 str: 2.004 loss: -677.649]Iterations:  67%|██████▋   | 20/30 [01:59<00:41,  4.10s/it, atk: -120.908 ent: -563.069 str: 2.022 loss: -681.955]Iterations:  70%|███████   | 21/30 [02:01<00:37,  4.12s/it, atk: -120.908 ent: -563.069 str: 2.022 loss: -681.955]Iterations:  70%|███████   | 21/30 [02:03<00:37,  4.12s/it, atk: -124.577 ent: -563.072 str: 2.021 loss: -685.628]Iterations:  73%|███████▎  | 22/30 [02:05<00:32,  4.07s/it, atk: -124.577 ent: -563.072 str: 2.021 loss: -685.628]Iterations:  73%|███████▎  | 22/30 [02:07<00:32,  4.07s/it, atk: -128.029 ent: -563.074 str: 2.024 loss: -689.079]Iterations:  77%|███████▋  | 23/30 [02:09<00:28,  4.03s/it, atk: -128.029 ent: -563.074 str: 2.024 loss: -689.079]Iterations:  77%|███████▋  | 23/30 [02:11<00:28,  4.03s/it, atk: -132.067 ent: -563.073 str: 2.023 loss: -693.118]Iterations:  80%|████████  | 24/30 [02:13<00:24,  4.03s/it, atk: -132.067 ent: -563.073 str: 2.023 loss: -693.118]Iterations:  80%|████████  | 24/30 [02:15<00:24,  4.03s/it, atk: -137.080 ent: -563.069 str: 2.032 loss: -698.117]Iterations:  83%|████████▎ | 25/30 [02:17<00:20,  4.06s/it, atk: -137.080 ent: -563.069 str: 2.032 loss: -698.117]Iterations:  83%|████████▎ | 25/30 [02:19<00:20,  4.06s/it, atk: -141.325 ent: -563.065 str: 2.039 loss: -702.351]Iterations:  87%|████████▋ | 26/30 [02:21<00:15,  3.99s/it, atk: -141.325 ent: -563.065 str: 2.039 loss: -702.351]Iterations:  87%|████████▋ | 26/30 [02:23<00:15,  3.99s/it, atk: -146.256 ent: -563.065 str: 2.058 loss: -707.264]Iterations:  90%|█████████ | 27/30 [02:25<00:12,  4.01s/it, atk: -146.256 ent: -563.065 str: 2.058 loss: -707.264]Iterations:  90%|█████████ | 27/30 [02:27<00:12,  4.01s/it, atk: -151.095 ent: -563.069 str: 2.070 loss: -712.094]Iterations:  93%|█████████▎| 28/30 [02:29<00:08,  4.01s/it, atk: -151.095 ent: -563.069 str: 2.070 loss: -712.094]Iterations:  93%|█████████▎| 28/30 [02:31<00:08,  4.01s/it, atk: -155.475 ent: -563.071 str: 2.085 loss: -716.462]Iterations:  97%|█████████▋| 29/30 [02:33<00:04,  4.00s/it, atk: -155.475 ent: -563.071 str: 2.085 loss: -716.462]Iterations:  97%|█████████▋| 29/30 [02:35<00:04,  4.00s/it, atk: -159.280 ent: -563.071 str: 2.105 loss: -720.247]Iterations: 100%|██████████| 30/30 [02:37<00:00,  3.97s/it, atk: -159.280 ent: -563.071 str: 2.105 loss: -720.247]Iterations: 100%|██████████| 30/30 [02:37<00:00,  5.24s/it, atk: -159.280 ent: -563.071 str: 2.105 loss: -720.247]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([666], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([809], device='cuda:0') tensor(8.1093e-08, device='cuda:0')
L1: [1248.7609]	L2: [7.8444333]	Linf: [0.4862745]

Accuracy on benign examples: 100.0%
gt_label: 605 pred_label: 605 pred_clean_logit 0.8827539086341858
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:02,  6.92it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:03,  4.33it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.72it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.44it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.33it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.30it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.24it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.25it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.22it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.16it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.21it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.17it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.17it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.17it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.18it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.25it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.19it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.15it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.24it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.29it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:24,  6.23s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.79s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:21<00:15,  7.53s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.36s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  9.25s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  8.46s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -1.699 ent: -280.726 str: 0.000 loss: -282.425]Iterations:   3%|▎         | 1/30 [00:04<02:08,  4.42s/it, atk: -1.699 ent: -280.726 str: 0.000 loss: -282.425]Iterations:   3%|▎         | 1/30 [00:06<02:08,  4.42s/it, atk: -9.143 ent: -280.698 str: 2.134 loss: -287.706]Iterations:   7%|▋         | 2/30 [00:08<01:54,  4.10s/it, atk: -9.143 ent: -280.698 str: 2.134 loss: -287.706]Iterations:   7%|▋         | 2/30 [00:10<01:54,  4.10s/it, atk: -18.627 ent: -280.672 str: 2.630 loss: -296.669]Iterations:  10%|█         | 3/30 [00:12<01:48,  4.00s/it, atk: -18.627 ent: -280.672 str: 2.630 loss: -296.669]Iterations:  10%|█         | 3/30 [00:14<01:48,  4.00s/it, atk: -28.353 ent: -280.700 str: 2.716 loss: -306.338]Iterations:  13%|█▎        | 4/30 [00:16<01:45,  4.05s/it, atk: -28.353 ent: -280.700 str: 2.716 loss: -306.338]Iterations:  13%|█▎        | 4/30 [00:18<01:45,  4.05s/it, atk: -40.512 ent: -280.714 str: 2.891 loss: -318.335]Iterations:  17%|█▋        | 5/30 [00:20<01:41,  4.05s/it, atk: -40.512 ent: -280.714 str: 2.891 loss: -318.335]Iterations:  17%|█▋        | 5/30 [00:22<01:41,  4.05s/it, atk: -54.202 ent: -280.715 str: 2.904 loss: -332.014]Iterations:  20%|██        | 6/30 [00:24<01:37,  4.08s/it, atk: -54.202 ent: -280.715 str: 2.904 loss: -332.014]Iterations:  20%|██        | 6/30 [00:26<01:37,  4.08s/it, atk: -67.999 ent: -280.723 str: 3.047 loss: -345.676]Iterations:  23%|██▎       | 7/30 [00:28<01:33,  4.06s/it, atk: -67.999 ent: -280.723 str: 3.047 loss: -345.676]Iterations:  23%|██▎       | 7/30 [00:30<01:33,  4.06s/it, atk: -82.090 ent: -280.713 str: 3.133 loss: -359.669]Iterations:  27%|██▋       | 8/30 [00:32<01:29,  4.07s/it, atk: -82.090 ent: -280.713 str: 3.133 loss: -359.669]Iterations:  27%|██▋       | 8/30 [00:34<01:29,  4.07s/it, atk: -96.169 ent: -280.711 str: 3.193 loss: -373.687]Iterations:  30%|███       | 9/30 [00:36<01:24,  4.05s/it, atk: -96.169 ent: -280.711 str: 3.193 loss: -373.687]Iterations:  30%|███       | 9/30 [00:38<01:24,  4.05s/it, atk: -106.381 ent: -280.716 str: 3.230 loss: -383.867]Iterations:  33%|███▎      | 10/30 [00:40<01:20,  4.01s/it, atk: -106.381 ent: -280.716 str: 3.230 loss: -383.867]Iterations:  33%|███▎      | 10/30 [00:42<01:20,  4.01s/it, atk: -114.711 ent: -280.713 str: 3.300 loss: -392.124]Iterations:  37%|███▋      | 11/30 [00:44<01:15,  3.99s/it, atk: -114.711 ent: -280.713 str: 3.300 loss: -392.124]Iterations:  37%|███▋      | 11/30 [00:46<01:15,  3.99s/it, atk: -125.584 ent: -280.707 str: 3.322 loss: -402.970]Iterations:  40%|████      | 12/30 [00:48<01:11,  3.98s/it, atk: -125.584 ent: -280.707 str: 3.322 loss: -402.970]Iterations:  40%|████      | 12/30 [00:50<01:11,  3.98s/it, atk: -134.337 ent: -280.704 str: 3.328 loss: -411.713]Iterations:  43%|████▎     | 13/30 [00:52<01:07,  3.97s/it, atk: -134.337 ent: -280.704 str: 3.328 loss: -411.713]Iterations:  43%|████▎     | 13/30 [00:54<01:07,  3.97s/it, atk: -140.927 ent: -280.702 str: 3.335 loss: -418.294]Iterations:  47%|████▋     | 14/30 [00:56<01:03,  3.98s/it, atk: -140.927 ent: -280.702 str: 3.335 loss: -418.294]Iterations:  47%|████▋     | 14/30 [00:58<01:03,  3.98s/it, atk: -149.629 ent: -280.702 str: 3.322 loss: -427.009]Iterations:  50%|█████     | 15/30 [01:00<00:59,  3.97s/it, atk: -149.629 ent: -280.702 str: 3.322 loss: -427.009]Iterations:  50%|█████     | 15/30 [01:02<00:59,  3.97s/it, atk: -158.573 ent: -280.705 str: 3.278 loss: -436.000]Iterations:  53%|█████▎    | 16/30 [01:04<00:55,  3.97s/it, atk: -158.573 ent: -280.705 str: 3.278 loss: -436.000]Iterations:  53%|█████▎    | 16/30 [01:06<00:55,  3.97s/it, atk: -167.820 ent: -280.703 str: 3.310 loss: -445.213]Iterations:  57%|█████▋    | 17/30 [01:08<00:51,  3.98s/it, atk: -167.820 ent: -280.703 str: 3.310 loss: -445.213]Iterations:  57%|█████▋    | 17/30 [01:10<00:51,  3.98s/it, atk: -176.172 ent: -280.702 str: 3.318 loss: -453.556]Iterations:  60%|██████    | 18/30 [01:12<00:47,  4.00s/it, atk: -176.172 ent: -280.702 str: 3.318 loss: -453.556]Iterations:  60%|██████    | 18/30 [01:14<00:47,  4.00s/it, atk: -182.820 ent: -280.708 str: 3.324 loss: -460.203]Iterations:  63%|██████▎   | 19/30 [01:16<00:44,  4.02s/it, atk: -182.820 ent: -280.708 str: 3.324 loss: -460.203]Iterations:  63%|██████▎   | 19/30 [01:18<00:44,  4.02s/it, atk: -189.578 ent: -280.717 str: 3.335 loss: -466.960]Iterations:  67%|██████▋   | 20/30 [01:20<00:40,  4.02s/it, atk: -189.578 ent: -280.717 str: 3.335 loss: -466.960]Iterations:  67%|██████▋   | 20/30 [01:22<00:40,  4.02s/it, atk: -195.651 ent: -280.728 str: 3.335 loss: -473.043]Iterations:  70%|███████   | 21/30 [01:23<00:34,  3.88s/it, atk: -195.651 ent: -280.728 str: 3.335 loss: -473.043]Iterations:  70%|███████   | 21/30 [01:25<00:34,  3.88s/it, atk: -202.214 ent: -280.738 str: 3.322 loss: -479.630]Iterations:  73%|███████▎  | 22/30 [01:27<00:30,  3.78s/it, atk: -202.214 ent: -280.738 str: 3.322 loss: -479.630]Iterations:  73%|███████▎  | 22/30 [01:29<00:30,  3.78s/it, atk: -207.247 ent: -280.741 str: 3.326 loss: -484.662]Iterations:  77%|███████▋  | 23/30 [01:31<00:26,  3.73s/it, atk: -207.247 ent: -280.741 str: 3.326 loss: -484.662]Iterations:  77%|███████▋  | 23/30 [01:33<00:26,  3.73s/it, atk: -214.378 ent: -280.744 str: 3.305 loss: -491.817]Iterations:  80%|████████  | 24/30 [01:34<00:22,  3.76s/it, atk: -214.378 ent: -280.744 str: 3.305 loss: -491.817]Iterations:  80%|████████  | 24/30 [01:36<00:22,  3.76s/it, atk: -221.473 ent: -280.749 str: 3.281 loss: -498.940]Iterations:  83%|████████▎ | 25/30 [01:38<00:18,  3.70s/it, atk: -221.473 ent: -280.749 str: 3.281 loss: -498.940]Iterations:  83%|████████▎ | 25/30 [01:40<00:18,  3.70s/it, atk: -228.108 ent: -280.753 str: 3.271 loss: -505.589]Iterations:  87%|████████▋ | 26/30 [01:42<00:14,  3.65s/it, atk: -228.108 ent: -280.753 str: 3.271 loss: -505.589]Iterations:  87%|████████▋ | 26/30 [01:44<00:14,  3.65s/it, atk: -232.474 ent: -280.755 str: 3.273 loss: -509.957]Iterations:  90%|█████████ | 27/30 [01:46<00:11,  3.76s/it, atk: -232.474 ent: -280.755 str: 3.273 loss: -509.957]Iterations:  90%|█████████ | 27/30 [01:48<00:11,  3.76s/it, atk: -237.932 ent: -280.755 str: 3.296 loss: -515.391]Iterations:  93%|█████████▎| 28/30 [01:50<00:07,  3.84s/it, atk: -237.932 ent: -280.755 str: 3.296 loss: -515.391]Iterations:  93%|█████████▎| 28/30 [01:52<00:07,  3.84s/it, atk: -244.042 ent: -280.752 str: 3.341 loss: -521.454]Iterations:  97%|█████████▋| 29/30 [01:53<00:03,  3.84s/it, atk: -244.042 ent: -280.752 str: 3.341 loss: -521.454]Iterations:  97%|█████████▋| 29/30 [01:56<00:03,  3.84s/it, atk: -247.872 ent: -280.752 str: 3.366 loss: -525.258]Iterations: 100%|██████████| 30/30 [01:57<00:00,  3.89s/it, atk: -247.872 ent: -280.752 str: 3.366 loss: -525.258]Iterations: 100%|██████████| 30/30 [01:57<00:00,  3.93s/it, atk: -247.872 ent: -280.752 str: 3.366 loss: -525.258]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([419], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([605], device='cuda:0') tensor(1.1127e-11, device='cuda:0')
L1: [1823.5841]	L2: [15.168965]	Linf: [0.8117647]

Accuracy on benign examples: 100.0%
gt_label: 94 pred_label: 94 pred_clean_logit 0.9313978552818298
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:02,  6.47it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.87it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.62it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.44it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.22it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.27it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.16it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.25it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.19it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.15it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.15it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.17it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.14it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.10it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.07it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.07it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.06it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.15it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.12it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.21it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:25,  6.27s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.94s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.64s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.42s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  9.28s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  8.51s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -0.812 ent: -279.429 str: 0.000 loss: -280.241]Iterations:   3%|▎         | 1/30 [00:04<02:12,  4.58s/it, atk: -0.812 ent: -279.429 str: 0.000 loss: -280.241]Iterations:   3%|▎         | 1/30 [00:06<02:12,  4.58s/it, atk: -1.640 ent: -279.377 str: 0.956 loss: -280.061]Iterations:   7%|▋         | 2/30 [00:08<01:58,  4.25s/it, atk: -1.640 ent: -279.377 str: 0.956 loss: -280.061]Iterations:   7%|▋         | 2/30 [00:10<01:58,  4.25s/it, atk: -3.427 ent: -279.389 str: 1.192 loss: -281.624]Iterations:  10%|█         | 3/30 [00:12<01:50,  4.08s/it, atk: -3.427 ent: -279.389 str: 1.192 loss: -281.624]Iterations:  10%|█         | 3/30 [00:14<01:50,  4.08s/it, atk: -8.356 ent: -279.382 str: 1.279 loss: -286.459]Iterations:  13%|█▎        | 4/30 [00:16<01:43,  3.99s/it, atk: -8.356 ent: -279.382 str: 1.279 loss: -286.459]Iterations:  13%|█▎        | 4/30 [00:18<01:43,  3.99s/it, atk: -14.678 ent: -279.380 str: 1.108 loss: -292.950]Iterations:  17%|█▋        | 5/30 [00:20<01:39,  3.99s/it, atk: -14.678 ent: -279.380 str: 1.108 loss: -292.950]Iterations:  17%|█▋        | 5/30 [00:22<01:39,  3.99s/it, atk: -20.784 ent: -279.377 str: 1.374 loss: -298.787]Iterations:  20%|██        | 6/30 [00:24<01:35,  3.98s/it, atk: -20.784 ent: -279.377 str: 1.374 loss: -298.787]Iterations:  20%|██        | 6/30 [00:26<01:35,  3.98s/it, atk: -27.499 ent: -279.365 str: 1.480 loss: -305.384]Iterations:  23%|██▎       | 7/30 [00:28<01:30,  3.95s/it, atk: -27.499 ent: -279.365 str: 1.480 loss: -305.384]Iterations:  23%|██▎       | 7/30 [00:30<01:30,  3.95s/it, atk: -34.141 ent: -279.363 str: 1.543 loss: -311.961]Iterations:  27%|██▋       | 8/30 [00:31<01:25,  3.87s/it, atk: -34.141 ent: -279.363 str: 1.543 loss: -311.961]Iterations:  27%|██▋       | 8/30 [00:34<01:25,  3.87s/it, atk: -40.961 ent: -279.367 str: 1.591 loss: -318.737]Iterations:  30%|███       | 9/30 [00:35<01:21,  3.90s/it, atk: -40.961 ent: -279.367 str: 1.591 loss: -318.737]Iterations:  30%|███       | 9/30 [00:38<01:21,  3.90s/it, atk: -47.176 ent: -279.349 str: 1.671 loss: -324.853]Iterations:  33%|███▎      | 10/30 [00:39<01:18,  3.93s/it, atk: -47.176 ent: -279.349 str: 1.671 loss: -324.853]Iterations:  33%|███▎      | 10/30 [00:42<01:18,  3.93s/it, atk: -52.136 ent: -279.335 str: 1.747 loss: -329.723]Iterations:  37%|███▋      | 11/30 [00:43<01:14,  3.94s/it, atk: -52.136 ent: -279.335 str: 1.747 loss: -329.723]Iterations:  37%|███▋      | 11/30 [00:46<01:14,  3.94s/it, atk: -58.772 ent: -279.324 str: 1.789 loss: -336.307]Iterations:  40%|████      | 12/30 [00:47<01:11,  3.97s/it, atk: -58.772 ent: -279.324 str: 1.789 loss: -336.307]Iterations:  40%|████      | 12/30 [00:50<01:11,  3.97s/it, atk: -64.209 ent: -279.317 str: 1.811 loss: -341.714]Iterations:  43%|████▎     | 13/30 [00:51<01:06,  3.94s/it, atk: -64.209 ent: -279.317 str: 1.811 loss: -341.714]Iterations:  43%|████▎     | 13/30 [00:53<01:06,  3.94s/it, atk: -69.252 ent: -279.311 str: 1.862 loss: -346.700]Iterations:  47%|████▋     | 14/30 [00:55<01:02,  3.93s/it, atk: -69.252 ent: -279.311 str: 1.862 loss: -346.700]Iterations:  47%|████▋     | 14/30 [00:57<01:02,  3.93s/it, atk: -74.685 ent: -279.301 str: 1.903 loss: -352.082]Iterations:  50%|█████     | 15/30 [00:59<00:59,  3.96s/it, atk: -74.685 ent: -279.301 str: 1.903 loss: -352.082]Iterations:  50%|█████     | 15/30 [01:01<00:59,  3.96s/it, atk: -80.005 ent: -279.293 str: 1.937 loss: -357.362]Iterations:  53%|█████▎    | 16/30 [01:03<00:55,  3.97s/it, atk: -80.005 ent: -279.293 str: 1.937 loss: -357.362]Iterations:  53%|█████▎    | 16/30 [01:05<00:55,  3.97s/it, atk: -84.858 ent: -279.285 str: 1.958 loss: -362.185]Iterations:  57%|█████▋    | 17/30 [01:07<00:52,  4.00s/it, atk: -84.858 ent: -279.285 str: 1.958 loss: -362.185]Iterations:  57%|█████▋    | 17/30 [01:09<00:52,  4.00s/it, atk: -90.406 ent: -279.278 str: 1.989 loss: -367.694]Iterations:  60%|██████    | 18/30 [01:11<00:48,  4.03s/it, atk: -90.406 ent: -279.278 str: 1.989 loss: -367.694]Iterations:  60%|██████    | 18/30 [01:14<00:48,  4.03s/it, atk: -94.534 ent: -279.273 str: 2.019 loss: -371.788]Iterations:  63%|██████▎   | 19/30 [01:15<00:44,  4.03s/it, atk: -94.534 ent: -279.273 str: 2.019 loss: -371.788]Iterations:  63%|██████▎   | 19/30 [01:18<00:44,  4.03s/it, atk: -98.221 ent: -279.273 str: 2.025 loss: -375.469]Iterations:  67%|██████▋   | 20/30 [01:19<00:40,  4.03s/it, atk: -98.221 ent: -279.273 str: 2.025 loss: -375.469]Iterations:  67%|██████▋   | 20/30 [01:22<00:40,  4.03s/it, atk: -102.298 ent: -279.278 str: 2.036 loss: -379.541]Iterations:  70%|███████   | 21/30 [01:23<00:36,  4.04s/it, atk: -102.298 ent: -279.278 str: 2.036 loss: -379.541]Iterations:  70%|███████   | 21/30 [01:26<00:36,  4.04s/it, atk: -105.726 ent: -279.284 str: 2.046 loss: -382.964]Iterations:  73%|███████▎  | 22/30 [01:27<00:32,  4.04s/it, atk: -105.726 ent: -279.284 str: 2.046 loss: -382.964]Iterations:  73%|███████▎  | 22/30 [01:30<00:32,  4.04s/it, atk: -108.928 ent: -279.288 str: 2.044 loss: -386.172]Iterations:  77%|███████▋  | 23/30 [01:31<00:28,  4.02s/it, atk: -108.928 ent: -279.288 str: 2.044 loss: -386.172]Iterations:  77%|███████▋  | 23/30 [01:34<00:28,  4.02s/it, atk: -112.020 ent: -279.289 str: 2.045 loss: -389.265]Iterations:  80%|████████  | 24/30 [01:35<00:24,  4.03s/it, atk: -112.020 ent: -279.289 str: 2.045 loss: -389.265]Iterations:  80%|████████  | 24/30 [01:37<00:24,  4.03s/it, atk: -115.459 ent: -279.287 str: 2.046 loss: -392.701]Iterations:  83%|████████▎ | 25/30 [01:39<00:19,  3.95s/it, atk: -115.459 ent: -279.287 str: 2.046 loss: -392.701]Iterations:  83%|████████▎ | 25/30 [01:42<00:19,  3.95s/it, atk: -118.646 ent: -279.283 str: 2.060 loss: -395.868]Iterations:  87%|████████▋ | 26/30 [01:43<00:15,  3.98s/it, atk: -118.646 ent: -279.283 str: 2.060 loss: -395.868]Iterations:  87%|████████▋ | 26/30 [01:46<00:15,  3.98s/it, atk: -121.729 ent: -279.278 str: 2.081 loss: -398.926]Iterations:  90%|█████████ | 27/30 [01:47<00:12,  4.02s/it, atk: -121.729 ent: -279.278 str: 2.081 loss: -398.926]Iterations:  90%|█████████ | 27/30 [01:50<00:12,  4.02s/it, atk: -124.595 ent: -279.274 str: 2.097 loss: -401.773]Iterations:  93%|█████████▎| 28/30 [01:51<00:08,  4.01s/it, atk: -124.595 ent: -279.274 str: 2.097 loss: -401.773]Iterations:  93%|█████████▎| 28/30 [01:54<00:08,  4.01s/it, atk: -127.377 ent: -279.274 str: 2.111 loss: -404.540]Iterations:  97%|█████████▋| 29/30 [01:56<00:04,  4.06s/it, atk: -127.377 ent: -279.274 str: 2.111 loss: -404.540]Iterations:  97%|█████████▋| 29/30 [01:58<00:04,  4.06s/it, atk: -130.226 ent: -279.276 str: 2.128 loss: -407.374]Iterations: 100%|██████████| 30/30 [02:00<00:00,  4.04s/it, atk: -130.226 ent: -279.276 str: 2.128 loss: -407.374]Iterations: 100%|██████████| 30/30 [02:00<00:00,  4.00s/it, atk: -130.226 ent: -279.276 str: 2.128 loss: -407.374]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([95], device='cuda:0') tensor(0.9913, device='cuda:0')
after_true: tensor([94], device='cuda:0') tensor(1.7270e-06, device='cuda:0')
L1: [1959.1256]	L2: [13.067396]	Linf: [0.43921572]

Accuracy on benign examples: 100.0%
gt_label: 777 pred_label: 777 pred_clean_logit 0.8414513468742371
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:02,  6.88it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  4.01it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.63it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.36it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.38it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.29it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.29it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.24it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.23it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.18it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.14it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.16it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.10it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.17it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.17it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.19it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.14it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.13it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.12it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.25it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:26,  6.56s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:14<00:21,  7.08s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.71s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:32<00:08,  8.57s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  9.43s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  8.66s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -0.859 ent: -563.137 str: 0.000 loss: -563.996]Iterations:   3%|▎         | 1/30 [00:04<02:06,  4.35s/it, atk: -0.859 ent: -563.137 str: 0.000 loss: -563.996]Iterations:   3%|▎         | 1/30 [00:06<02:06,  4.35s/it, atk: -2.317 ent: -563.154 str: 0.246 loss: -565.226]Iterations:   7%|▋         | 2/30 [00:08<01:54,  4.09s/it, atk: -2.317 ent: -563.154 str: 0.246 loss: -565.226]Iterations:   7%|▋         | 2/30 [00:10<01:54,  4.09s/it, atk: -5.187 ent: -563.189 str: 0.315 loss: -568.061]Iterations:  10%|█         | 3/30 [00:12<01:50,  4.09s/it, atk: -5.187 ent: -563.189 str: 0.315 loss: -568.061]Iterations:  10%|█         | 3/30 [00:14<01:50,  4.09s/it, atk: -9.305 ent: -563.174 str: 0.432 loss: -572.047]Iterations:  13%|█▎        | 4/30 [00:16<01:46,  4.09s/it, atk: -9.305 ent: -563.174 str: 0.432 loss: -572.047]Iterations:  13%|█▎        | 4/30 [00:18<01:46,  4.09s/it, atk: -14.496 ent: -563.153 str: 0.413 loss: -577.236]Iterations:  17%|█▋        | 5/30 [00:20<01:40,  4.03s/it, atk: -14.496 ent: -563.153 str: 0.413 loss: -577.236]Iterations:  17%|█▋        | 5/30 [00:22<01:40,  4.03s/it, atk: -20.630 ent: -563.171 str: 0.569 loss: -583.231]Iterations:  20%|██        | 6/30 [00:24<01:36,  4.03s/it, atk: -20.630 ent: -563.171 str: 0.569 loss: -583.231]Iterations:  20%|██        | 6/30 [00:26<01:36,  4.03s/it, atk: -27.838 ent: -563.174 str: 0.717 loss: -590.295]Iterations:  23%|██▎       | 7/30 [00:28<01:31,  3.99s/it, atk: -27.838 ent: -563.174 str: 0.717 loss: -590.295]Iterations:  23%|██▎       | 7/30 [00:30<01:31,  3.99s/it, atk: -35.118 ent: -563.192 str: 0.792 loss: -597.518]Iterations:  27%|██▋       | 8/30 [00:32<01:25,  3.90s/it, atk: -35.118 ent: -563.192 str: 0.792 loss: -597.518]Iterations:  27%|██▋       | 8/30 [00:33<01:25,  3.90s/it, atk: -41.843 ent: -563.197 str: 0.833 loss: -604.208]Iterations:  30%|███       | 9/30 [00:35<01:19,  3.79s/it, atk: -41.843 ent: -563.197 str: 0.833 loss: -604.208]Iterations:  30%|███       | 9/30 [00:37<01:19,  3.79s/it, atk: -49.039 ent: -563.214 str: 0.893 loss: -611.360]Iterations:  33%|███▎      | 10/30 [00:39<01:14,  3.73s/it, atk: -49.039 ent: -563.214 str: 0.893 loss: -611.360]Iterations:  33%|███▎      | 10/30 [00:41<01:14,  3.73s/it, atk: -55.681 ent: -563.212 str: 0.920 loss: -617.973]Iterations:  37%|███▋      | 11/30 [00:42<01:10,  3.69s/it, atk: -55.681 ent: -563.212 str: 0.920 loss: -617.973]Iterations:  37%|███▋      | 11/30 [00:44<01:10,  3.69s/it, atk: -61.274 ent: -563.192 str: 0.918 loss: -623.548]Iterations:  40%|████      | 12/30 [00:46<01:07,  3.75s/it, atk: -61.274 ent: -563.192 str: 0.918 loss: -623.548]Iterations:  40%|████      | 12/30 [00:48<01:07,  3.75s/it, atk: -68.001 ent: -563.189 str: 1.052 loss: -630.139]Iterations:  43%|████▎     | 13/30 [00:50<01:04,  3.80s/it, atk: -68.001 ent: -563.189 str: 1.052 loss: -630.139]Iterations:  43%|████▎     | 13/30 [00:52<01:04,  3.80s/it, atk: -73.299 ent: -563.185 str: 1.101 loss: -635.383]Iterations:  47%|████▋     | 14/30 [00:54<01:02,  3.90s/it, atk: -73.299 ent: -563.185 str: 1.101 loss: -635.383]Iterations:  47%|████▋     | 14/30 [00:56<01:02,  3.90s/it, atk: -79.133 ent: -563.184 str: 1.145 loss: -641.172]Iterations:  50%|█████     | 15/30 [00:58<00:59,  3.93s/it, atk: -79.133 ent: -563.184 str: 1.145 loss: -641.172]Iterations:  50%|█████     | 15/30 [01:00<00:59,  3.93s/it, atk: -84.767 ent: -563.185 str: 1.189 loss: -646.763]Iterations:  53%|█████▎    | 16/30 [01:02<00:55,  3.97s/it, atk: -84.767 ent: -563.185 str: 1.189 loss: -646.763]Iterations:  53%|█████▎    | 16/30 [01:04<00:55,  3.97s/it, atk: -89.929 ent: -563.185 str: 1.231 loss: -651.883]Iterations:  57%|█████▋    | 17/30 [01:06<00:51,  3.98s/it, atk: -89.929 ent: -563.185 str: 1.231 loss: -651.883]Iterations:  57%|█████▋    | 17/30 [01:08<00:51,  3.98s/it, atk: -95.015 ent: -563.183 str: 1.259 loss: -656.940]Iterations:  60%|██████    | 18/30 [01:10<00:48,  4.01s/it, atk: -95.015 ent: -563.183 str: 1.259 loss: -656.940]Iterations:  60%|██████    | 18/30 [01:13<00:48,  4.01s/it, atk: -99.443 ent: -563.182 str: 1.275 loss: -661.349]Iterations:  63%|██████▎   | 19/30 [01:14<00:44,  4.03s/it, atk: -99.443 ent: -563.182 str: 1.275 loss: -661.349]Iterations:  63%|██████▎   | 19/30 [01:17<00:44,  4.03s/it, atk: -102.463 ent: -563.182 str: 1.283 loss: -664.362]Iterations:  67%|██████▋   | 20/30 [01:18<00:40,  4.00s/it, atk: -102.463 ent: -563.182 str: 1.283 loss: -664.362]Iterations:  67%|██████▋   | 20/30 [01:21<00:40,  4.00s/it, atk: -107.988 ent: -563.186 str: 1.310 loss: -669.863]Iterations:  70%|███████   | 21/30 [01:22<00:36,  4.01s/it, atk: -107.988 ent: -563.186 str: 1.310 loss: -669.863]Iterations:  70%|███████   | 21/30 [01:25<00:36,  4.01s/it, atk: -113.567 ent: -563.193 str: 1.338 loss: -675.422]Iterations:  73%|███████▎  | 22/30 [01:26<00:32,  4.01s/it, atk: -113.567 ent: -563.193 str: 1.338 loss: -675.422]Iterations:  73%|███████▎  | 22/30 [01:29<00:32,  4.01s/it, atk: -117.765 ent: -563.196 str: 1.363 loss: -679.598]Iterations:  77%|███████▋  | 23/30 [01:30<00:28,  4.04s/it, atk: -117.765 ent: -563.196 str: 1.363 loss: -679.598]Iterations:  77%|███████▋  | 23/30 [01:33<00:28,  4.04s/it, atk: -122.403 ent: -563.197 str: 1.384 loss: -684.216]Iterations:  80%|████████  | 24/30 [01:35<00:24,  4.04s/it, atk: -122.403 ent: -563.197 str: 1.384 loss: -684.216]Iterations:  80%|████████  | 24/30 [01:37<00:24,  4.04s/it, atk: -127.317 ent: -563.195 str: 1.396 loss: -689.116]Iterations:  83%|████████▎ | 25/30 [01:39<00:20,  4.06s/it, atk: -127.317 ent: -563.195 str: 1.396 loss: -689.116]Iterations:  83%|████████▎ | 25/30 [01:41<00:20,  4.06s/it, atk: -131.871 ent: -563.193 str: 1.397 loss: -693.668]Iterations:  87%|████████▋ | 26/30 [01:43<00:16,  4.08s/it, atk: -131.871 ent: -563.193 str: 1.397 loss: -693.668]Iterations:  87%|████████▋ | 26/30 [01:45<00:16,  4.08s/it, atk: -135.167 ent: -563.192 str: 1.396 loss: -696.963]Iterations:  90%|█████████ | 27/30 [01:47<00:12,  4.09s/it, atk: -135.167 ent: -563.192 str: 1.396 loss: -696.963]Iterations:  90%|█████████ | 27/30 [01:49<00:12,  4.09s/it, atk: -138.130 ent: -563.191 str: 1.415 loss: -699.906]Iterations:  93%|█████████▎| 28/30 [01:51<00:08,  4.08s/it, atk: -138.130 ent: -563.191 str: 1.415 loss: -699.906]Iterations:  93%|█████████▎| 28/30 [01:53<00:08,  4.08s/it, atk: -142.052 ent: -563.187 str: 1.425 loss: -703.813]Iterations:  97%|█████████▋| 29/30 [01:55<00:04,  4.09s/it, atk: -142.052 ent: -563.187 str: 1.425 loss: -703.813]Iterations:  97%|█████████▋| 29/30 [01:57<00:04,  4.09s/it, atk: -146.123 ent: -563.184 str: 1.432 loss: -707.875]Iterations: 100%|██████████| 30/30 [01:59<00:00,  4.10s/it, atk: -146.123 ent: -563.184 str: 1.432 loss: -707.875]Iterations: 100%|██████████| 30/30 [01:59<00:00,  3.99s/it, atk: -146.123 ent: -563.184 str: 1.432 loss: -707.875]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([709], device='cuda:0') tensor(0.5259, device='cuda:0')
after_true: tensor([777], device='cuda:0') tensor(2.8715e-07, device='cuda:0')
L1: [2149.7844]	L2: [14.933284]	Linf: [0.67058825]

Accuracy on benign examples: 100.0%
gt_label: 768 pred_label: 768 pred_clean_logit 0.37560755014419556
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.90it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.84it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.44it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.41it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.34it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:04,  3.20it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.26it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.20it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.11it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.14it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.09it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.10it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:04<00:01,  3.12it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.14it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.16it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.14it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.15it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.22it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.27it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.24it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:24,  6.24s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.91s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.72s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:32<00:08,  8.57s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  9.53s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  8.68s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -9.891 ent: -563.050 str: 0.000 loss: -572.941]Iterations:   3%|▎         | 1/30 [00:04<02:07,  4.40s/it, atk: -9.891 ent: -563.050 str: 0.000 loss: -572.941]Iterations:   3%|▎         | 1/30 [00:06<02:07,  4.40s/it, atk: -18.432 ent: -563.050 str: 1.867 loss: -579.615]Iterations:   7%|▋         | 2/30 [00:08<01:59,  4.26s/it, atk: -18.432 ent: -563.050 str: 1.867 loss: -579.615]Iterations:   7%|▋         | 2/30 [00:10<01:59,  4.26s/it, atk: -25.722 ent: -563.053 str: 2.312 loss: -586.464]Iterations:  10%|█         | 3/30 [00:12<01:54,  4.22s/it, atk: -25.722 ent: -563.053 str: 2.312 loss: -586.464]Iterations:  10%|█         | 3/30 [00:15<01:54,  4.22s/it, atk: -32.237 ent: -563.045 str: 2.549 loss: -592.733]Iterations:  13%|█▎        | 4/30 [00:16<01:50,  4.23s/it, atk: -32.237 ent: -563.045 str: 2.549 loss: -592.733]Iterations:  13%|█▎        | 4/30 [00:19<01:50,  4.23s/it, atk: -39.073 ent: -563.051 str: 2.800 loss: -599.324]Iterations:  17%|█▋        | 5/30 [00:21<01:44,  4.18s/it, atk: -39.073 ent: -563.051 str: 2.800 loss: -599.324]Iterations:  17%|█▋        | 5/30 [00:23<01:44,  4.18s/it, atk: -45.495 ent: -563.052 str: 2.708 loss: -605.840]Iterations:  20%|██        | 6/30 [00:24<01:38,  4.08s/it, atk: -45.495 ent: -563.052 str: 2.708 loss: -605.840]Iterations:  20%|██        | 6/30 [00:27<01:38,  4.08s/it, atk: -52.105 ent: -563.059 str: 2.603 loss: -612.561]Iterations:  23%|██▎       | 7/30 [00:29<01:34,  4.10s/it, atk: -52.105 ent: -563.059 str: 2.603 loss: -612.561]Iterations:  23%|██▎       | 7/30 [00:31<01:34,  4.10s/it, atk: -56.369 ent: -563.064 str: 2.852 loss: -616.580]Iterations:  27%|██▋       | 8/30 [00:33<01:30,  4.10s/it, atk: -56.369 ent: -563.064 str: 2.852 loss: -616.580]Iterations:  27%|██▋       | 8/30 [00:35<01:30,  4.10s/it, atk: -60.508 ent: -563.066 str: 2.844 loss: -620.730]Iterations:  30%|███       | 9/30 [00:37<01:25,  4.09s/it, atk: -60.508 ent: -563.066 str: 2.844 loss: -620.730]Iterations:  30%|███       | 9/30 [00:39<01:25,  4.09s/it, atk: -63.797 ent: -563.071 str: 2.683 loss: -624.184]Iterations:  33%|███▎      | 10/30 [00:41<01:22,  4.13s/it, atk: -63.797 ent: -563.071 str: 2.683 loss: -624.184]Iterations:  33%|███▎      | 10/30 [00:43<01:22,  4.13s/it, atk: -69.476 ent: -563.072 str: 2.756 loss: -629.791]Iterations:  37%|███▋      | 11/30 [00:45<01:18,  4.15s/it, atk: -69.476 ent: -563.072 str: 2.756 loss: -629.791]Iterations:  37%|███▋      | 11/30 [00:47<01:18,  4.15s/it, atk: -74.074 ent: -563.077 str: 2.912 loss: -634.239]Iterations:  40%|████      | 12/30 [00:49<01:14,  4.15s/it, atk: -74.074 ent: -563.077 str: 2.912 loss: -634.239]Iterations:  40%|████      | 12/30 [00:52<01:14,  4.15s/it, atk: -77.219 ent: -563.078 str: 3.010 loss: -637.288]Iterations:  43%|████▎     | 13/30 [00:53<01:10,  4.14s/it, atk: -77.219 ent: -563.078 str: 3.010 loss: -637.288]Iterations:  43%|████▎     | 13/30 [00:56<01:10,  4.14s/it, atk: -79.984 ent: -563.079 str: 2.924 loss: -640.139]Iterations:  47%|████▋     | 14/30 [00:57<01:05,  4.11s/it, atk: -79.984 ent: -563.079 str: 2.924 loss: -640.139]Iterations:  47%|████▋     | 14/30 [01:00<01:05,  4.11s/it, atk: -82.510 ent: -563.077 str: 2.841 loss: -642.745]Iterations:  50%|█████     | 15/30 [01:01<01:01,  4.08s/it, atk: -82.510 ent: -563.077 str: 2.841 loss: -642.745]Iterations:  50%|█████     | 15/30 [01:04<01:01,  4.08s/it, atk: -84.951 ent: -563.085 str: 2.732 loss: -645.304]Iterations:  53%|█████▎    | 16/30 [01:06<00:57,  4.10s/it, atk: -84.951 ent: -563.085 str: 2.732 loss: -645.304]Iterations:  53%|█████▎    | 16/30 [01:08<00:57,  4.10s/it, atk: -88.939 ent: -563.085 str: 2.703 loss: -649.321]Iterations:  57%|█████▋    | 17/30 [01:10<00:53,  4.12s/it, atk: -88.939 ent: -563.085 str: 2.703 loss: -649.321]Iterations:  57%|█████▋    | 17/30 [01:12<00:53,  4.12s/it, atk: -92.944 ent: -563.079 str: 2.653 loss: -653.369]Iterations:  60%|██████    | 18/30 [01:14<00:49,  4.15s/it, atk: -92.944 ent: -563.079 str: 2.653 loss: -653.369]Iterations:  60%|██████    | 18/30 [01:16<00:49,  4.15s/it, atk: -96.694 ent: -563.075 str: 2.606 loss: -657.162]Iterations:  63%|██████▎   | 19/30 [01:18<00:45,  4.15s/it, atk: -96.694 ent: -563.075 str: 2.606 loss: -657.162]Iterations:  63%|██████▎   | 19/30 [01:21<00:45,  4.15s/it, atk: -99.639 ent: -563.067 str: 2.679 loss: -660.027]Iterations:  67%|██████▋   | 20/30 [01:22<00:41,  4.17s/it, atk: -99.639 ent: -563.067 str: 2.679 loss: -660.027]Iterations:  67%|██████▋   | 20/30 [01:25<00:41,  4.17s/it, atk: -103.340 ent: -563.072 str: 2.664 loss: -663.747]Iterations:  70%|███████   | 21/30 [01:27<00:37,  4.15s/it, atk: -103.340 ent: -563.072 str: 2.664 loss: -663.747]Iterations:  70%|███████   | 21/30 [01:29<00:37,  4.15s/it, atk: -106.540 ent: -563.077 str: 2.690 loss: -666.927]Iterations:  73%|███████▎  | 22/30 [01:31<00:33,  4.13s/it, atk: -106.540 ent: -563.077 str: 2.690 loss: -666.927]Iterations:  73%|███████▎  | 22/30 [01:33<00:33,  4.13s/it, atk: -108.193 ent: -563.080 str: 2.684 loss: -668.589]Iterations:  77%|███████▋  | 23/30 [01:35<00:28,  4.14s/it, atk: -108.193 ent: -563.080 str: 2.684 loss: -668.589]Iterations:  77%|███████▋  | 23/30 [01:37<00:28,  4.14s/it, atk: -110.685 ent: -563.081 str: 2.770 loss: -670.997]Iterations:  80%|████████  | 24/30 [01:39<00:24,  4.13s/it, atk: -110.685 ent: -563.081 str: 2.770 loss: -670.997]Iterations:  80%|████████  | 24/30 [01:41<00:24,  4.13s/it, atk: -113.015 ent: -563.087 str: 2.937 loss: -673.165]Iterations:  83%|████████▎ | 25/30 [01:43<00:20,  4.15s/it, atk: -113.015 ent: -563.087 str: 2.937 loss: -673.165]Iterations:  83%|████████▎ | 25/30 [01:45<00:20,  4.15s/it, atk: -115.460 ent: -563.095 str: 2.939 loss: -675.616]Iterations:  87%|████████▋ | 26/30 [01:47<00:16,  4.15s/it, atk: -115.460 ent: -563.095 str: 2.939 loss: -675.616]Iterations:  87%|████████▋ | 26/30 [01:49<00:16,  4.15s/it, atk: -118.095 ent: -563.102 str: 2.853 loss: -678.344]Iterations:  90%|█████████ | 27/30 [01:51<00:12,  4.14s/it, atk: -118.095 ent: -563.102 str: 2.853 loss: -678.344]Iterations:  90%|█████████ | 27/30 [01:54<00:12,  4.14s/it, atk: -119.515 ent: -563.099 str: 3.059 loss: -679.555]Iterations:  93%|█████████▎| 28/30 [01:55<00:08,  4.10s/it, atk: -119.515 ent: -563.099 str: 3.059 loss: -679.555]Iterations:  93%|█████████▎| 28/30 [01:58<00:08,  4.10s/it, atk: -121.250 ent: -563.095 str: 2.945 loss: -681.400]Iterations:  97%|█████████▋| 29/30 [01:59<00:04,  4.10s/it, atk: -121.250 ent: -563.095 str: 2.945 loss: -681.400]Iterations:  97%|█████████▋| 29/30 [02:02<00:04,  4.10s/it, atk: -123.310 ent: -563.089 str: 2.954 loss: -683.445]Iterations: 100%|██████████| 30/30 [02:04<00:00,  4.10s/it, atk: -123.310 ent: -563.089 str: 2.954 loss: -683.445]Iterations: 100%|██████████| 30/30 [02:04<00:00,  4.13s/it, atk: -123.310 ent: -563.089 str: 2.954 loss: -683.445]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([981], device='cuda:0') tensor(0.9629, device='cuda:0')
after_true: tensor([768], device='cuda:0') tensor(4.0117e-06, device='cuda:0')
L1: [3200.0469]	L2: [23.081192]	Linf: [0.9372549]

Accuracy on benign examples: 100.0%
gt_label: 663 pred_label: 663 pred_clean_logit 0.8164234161376953
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.51it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.94it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.52it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.37it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.28it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:04,  3.16it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.14it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.11it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.17it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.10it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.07it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.20it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:04<00:01,  3.15it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.10it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.19it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.15it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.27it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.28it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.32it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.25it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:26,  6.58s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:14<00:21,  7.14s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.61s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.20s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:41<00:00,  8.93s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:41<00:00,  8.32s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -1.588 ent: -281.543 str: 0.000 loss: -283.132]Iterations:   3%|▎         | 1/30 [00:04<02:03,  4.25s/it, atk: -1.588 ent: -281.543 str: 0.000 loss: -283.132]Iterations:   3%|▎         | 1/30 [00:06<02:03,  4.25s/it, atk: -5.777 ent: -281.521 str: 0.695 loss: -286.603]Iterations:   7%|▋         | 2/30 [00:08<01:56,  4.16s/it, atk: -5.777 ent: -281.521 str: 0.695 loss: -286.603]Iterations:   7%|▋         | 2/30 [00:10<01:56,  4.16s/it, atk: -12.514 ent: -281.512 str: 0.694 loss: -293.331]Iterations:  10%|█         | 3/30 [00:12<01:52,  4.17s/it, atk: -12.514 ent: -281.512 str: 0.694 loss: -293.331]Iterations:  10%|█         | 3/30 [00:14<01:52,  4.17s/it, atk: -21.697 ent: -281.504 str: 0.775 loss: -302.426]Iterations:  13%|█▎        | 4/30 [00:16<01:47,  4.14s/it, atk: -21.697 ent: -281.504 str: 0.775 loss: -302.426]Iterations:  13%|█▎        | 4/30 [00:18<01:47,  4.14s/it, atk: -28.011 ent: -281.502 str: 0.874 loss: -308.639]Iterations:  17%|█▋        | 5/30 [00:20<01:43,  4.12s/it, atk: -28.011 ent: -281.502 str: 0.874 loss: -308.639]Iterations:  17%|█▋        | 5/30 [00:23<01:43,  4.12s/it, atk: -33.488 ent: -281.513 str: 1.056 loss: -313.944]Iterations:  20%|██        | 6/30 [00:24<01:39,  4.13s/it, atk: -33.488 ent: -281.513 str: 1.056 loss: -313.944]Iterations:  20%|██        | 6/30 [00:27<01:39,  4.13s/it, atk: -38.649 ent: -281.510 str: 1.188 loss: -318.971]Iterations:  23%|██▎       | 7/30 [00:28<01:34,  4.10s/it, atk: -38.649 ent: -281.510 str: 1.188 loss: -318.971]Iterations:  23%|██▎       | 7/30 [00:31<01:34,  4.10s/it, atk: -42.343 ent: -281.498 str: 1.126 loss: -322.715]Iterations:  27%|██▋       | 8/30 [00:32<01:30,  4.10s/it, atk: -42.343 ent: -281.498 str: 1.126 loss: -322.715]Iterations:  27%|██▋       | 8/30 [00:35<01:30,  4.10s/it, atk: -46.727 ent: -281.484 str: 1.120 loss: -327.091]Iterations:  30%|███       | 9/30 [00:37<01:25,  4.08s/it, atk: -46.727 ent: -281.484 str: 1.120 loss: -327.091]Iterations:  30%|███       | 9/30 [00:39<01:25,  4.08s/it, atk: -51.221 ent: -281.472 str: 1.130 loss: -331.563]Iterations:  33%|███▎      | 10/30 [00:41<01:22,  4.11s/it, atk: -51.221 ent: -281.472 str: 1.130 loss: -331.563]Iterations:  33%|███▎      | 10/30 [00:43<01:22,  4.11s/it, atk: -56.043 ent: -281.459 str: 1.146 loss: -336.355]Iterations:  37%|███▋      | 11/30 [00:45<01:18,  4.13s/it, atk: -56.043 ent: -281.459 str: 1.146 loss: -336.355]Iterations:  37%|███▋      | 11/30 [00:47<01:18,  4.13s/it, atk: -59.113 ent: -281.449 str: 1.178 loss: -339.385]Iterations:  40%|████      | 12/30 [00:49<01:14,  4.12s/it, atk: -59.113 ent: -281.449 str: 1.178 loss: -339.385]Iterations:  40%|████      | 12/30 [00:51<01:14,  4.12s/it, atk: -62.738 ent: -281.442 str: 1.189 loss: -342.991]Iterations:  43%|████▎     | 13/30 [00:53<01:09,  4.11s/it, atk: -62.738 ent: -281.442 str: 1.189 loss: -342.991]Iterations:  43%|████▎     | 13/30 [00:55<01:09,  4.11s/it, atk: -66.982 ent: -281.440 str: 1.199 loss: -347.223]Iterations:  47%|████▋     | 14/30 [00:57<01:05,  4.09s/it, atk: -66.982 ent: -281.440 str: 1.199 loss: -347.223]Iterations:  47%|████▋     | 14/30 [00:59<01:05,  4.09s/it, atk: -69.854 ent: -281.435 str: 1.140 loss: -350.150]Iterations:  50%|█████     | 15/30 [01:01<01:01,  4.10s/it, atk: -69.854 ent: -281.435 str: 1.140 loss: -350.150]Iterations:  50%|█████     | 15/30 [01:04<01:01,  4.10s/it, atk: -72.917 ent: -281.431 str: 1.160 loss: -353.188]Iterations:  53%|█████▎    | 16/30 [01:05<00:57,  4.12s/it, atk: -72.917 ent: -281.431 str: 1.160 loss: -353.188]Iterations:  53%|█████▎    | 16/30 [01:08<00:57,  4.12s/it, atk: -76.127 ent: -281.425 str: 1.180 loss: -356.372]Iterations:  57%|█████▋    | 17/30 [01:09<00:52,  4.06s/it, atk: -76.127 ent: -281.425 str: 1.180 loss: -356.372]Iterations:  57%|█████▋    | 17/30 [01:12<00:52,  4.06s/it, atk: -78.910 ent: -281.418 str: 1.197 loss: -359.131]Iterations:  60%|██████    | 18/30 [01:13<00:48,  4.05s/it, atk: -78.910 ent: -281.418 str: 1.197 loss: -359.131]Iterations:  60%|██████    | 18/30 [01:16<00:48,  4.05s/it, atk: -81.548 ent: -281.413 str: 1.199 loss: -361.762]Iterations:  63%|██████▎   | 19/30 [01:17<00:44,  4.03s/it, atk: -81.548 ent: -281.413 str: 1.199 loss: -361.762]Iterations:  63%|██████▎   | 19/30 [01:20<00:44,  4.03s/it, atk: -84.824 ent: -281.411 str: 1.278 loss: -364.957]Iterations:  67%|██████▋   | 20/30 [01:21<00:40,  4.01s/it, atk: -84.824 ent: -281.411 str: 1.278 loss: -364.957]Iterations:  67%|██████▋   | 20/30 [01:23<00:40,  4.01s/it, atk: -87.744 ent: -281.407 str: 1.283 loss: -367.869]Iterations:  70%|███████   | 21/30 [01:25<00:36,  4.00s/it, atk: -87.744 ent: -281.407 str: 1.283 loss: -367.869]Iterations:  70%|███████   | 21/30 [01:27<00:36,  4.00s/it, atk: -90.506 ent: -281.401 str: 1.245 loss: -370.662]Iterations:  73%|███████▎  | 22/30 [01:29<00:31,  3.98s/it, atk: -90.506 ent: -281.401 str: 1.245 loss: -370.662]Iterations:  73%|███████▎  | 22/30 [01:31<00:31,  3.98s/it, atk: -93.246 ent: -281.400 str: 1.263 loss: -373.383]Iterations:  77%|███████▋  | 23/30 [01:33<00:28,  4.02s/it, atk: -93.246 ent: -281.400 str: 1.263 loss: -373.383]Iterations:  77%|███████▋  | 23/30 [01:35<00:28,  4.02s/it, atk: -95.465 ent: -281.398 str: 1.265 loss: -375.598]Iterations:  80%|████████  | 24/30 [01:37<00:23,  4.00s/it, atk: -95.465 ent: -281.398 str: 1.265 loss: -375.598]Iterations:  80%|████████  | 24/30 [01:40<00:23,  4.00s/it, atk: -97.637 ent: -281.395 str: 1.342 loss: -377.690]Iterations:  83%|████████▎ | 25/30 [01:41<00:20,  4.02s/it, atk: -97.637 ent: -281.395 str: 1.342 loss: -377.690]Iterations:  83%|████████▎ | 25/30 [01:44<00:20,  4.02s/it, atk: -100.003 ent: -281.395 str: 1.346 loss: -380.051]Iterations:  87%|████████▋ | 26/30 [01:45<00:16,  4.04s/it, atk: -100.003 ent: -281.395 str: 1.346 loss: -380.051]Iterations:  87%|████████▋ | 26/30 [01:48<00:16,  4.04s/it, atk: -102.191 ent: -281.397 str: 1.353 loss: -382.235]Iterations:  90%|█████████ | 27/30 [01:50<00:12,  4.07s/it, atk: -102.191 ent: -281.397 str: 1.353 loss: -382.235]Iterations:  90%|█████████ | 27/30 [01:52<00:12,  4.07s/it, atk: -104.336 ent: -281.399 str: 1.363 loss: -384.372]Iterations:  93%|█████████▎| 28/30 [01:54<00:08,  4.07s/it, atk: -104.336 ent: -281.399 str: 1.363 loss: -384.372]Iterations:  93%|█████████▎| 28/30 [01:56<00:08,  4.07s/it, atk: -106.658 ent: -281.401 str: 1.383 loss: -386.676]Iterations:  97%|█████████▋| 29/30 [01:58<00:04,  4.06s/it, atk: -106.658 ent: -281.401 str: 1.383 loss: -386.676]Iterations:  97%|█████████▋| 29/30 [02:00<00:04,  4.06s/it, atk: -108.320 ent: -281.400 str: 1.332 loss: -388.388]Iterations: 100%|██████████| 30/30 [02:02<00:00,  4.08s/it, atk: -108.320 ent: -281.400 str: 1.332 loss: -388.388]Iterations: 100%|██████████| 30/30 [02:02<00:00,  4.08s/it, atk: -108.320 ent: -281.400 str: 1.332 loss: -388.388]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([497], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([663], device='cuda:0') tensor(1.5858e-05, device='cuda:0')
L1: [3362.9453]	L2: [23.312998]	Linf: [0.6862745]

Accuracy on benign examples: 100.0%
gt_label: 717 pred_label: 717 pred_clean_logit 0.9892833232879639
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.97it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.89it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.44it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.26it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.18it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:04,  3.20it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.20it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.16it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.14it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.12it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.25it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.28it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.31it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.22it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.23it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.17it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.14it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.16it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.09it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.23it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:24,  6.22s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.90s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.62s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:32<00:08,  8.57s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  9.43s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  8.61s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -0.262 ent: -281.705 str: 0.000 loss: -281.968]Iterations:   3%|▎         | 1/30 [00:04<02:03,  4.27s/it, atk: -0.262 ent: -281.705 str: 0.000 loss: -281.968]Iterations:   3%|▎         | 1/30 [00:06<02:03,  4.27s/it, atk: -1.291 ent: -281.701 str: 0.444 loss: -282.549]Iterations:   7%|▋         | 2/30 [00:08<01:57,  4.21s/it, atk: -1.291 ent: -281.701 str: 0.444 loss: -282.549]Iterations:   7%|▋         | 2/30 [00:10<01:57,  4.21s/it, atk: -4.341 ent: -281.705 str: 0.402 loss: -285.645]Iterations:  10%|█         | 3/30 [00:12<01:52,  4.17s/it, atk: -4.341 ent: -281.705 str: 0.402 loss: -285.645]Iterations:  10%|█         | 3/30 [00:14<01:52,  4.17s/it, atk: -9.341 ent: -281.700 str: 0.335 loss: -290.706]Iterations:  13%|█▎        | 4/30 [00:16<01:48,  4.16s/it, atk: -9.341 ent: -281.700 str: 0.335 loss: -290.706]Iterations:  13%|█▎        | 4/30 [00:18<01:48,  4.16s/it, atk: -16.951 ent: -281.693 str: 0.301 loss: -298.343]Iterations:  17%|█▋        | 5/30 [00:20<01:42,  4.11s/it, atk: -16.951 ent: -281.693 str: 0.301 loss: -298.343]Iterations:  17%|█▋        | 5/30 [00:22<01:42,  4.11s/it, atk: -24.920 ent: -281.686 str: 0.379 loss: -306.228]Iterations:  20%|██        | 6/30 [00:24<01:38,  4.09s/it, atk: -24.920 ent: -281.686 str: 0.379 loss: -306.228]Iterations:  20%|██        | 6/30 [00:27<01:38,  4.09s/it, atk: -34.817 ent: -281.680 str: 0.390 loss: -316.107]Iterations:  23%|██▎       | 7/30 [00:28<01:34,  4.11s/it, atk: -34.817 ent: -281.680 str: 0.390 loss: -316.107]Iterations:  23%|██▎       | 7/30 [00:31<01:34,  4.11s/it, atk: -41.227 ent: -281.675 str: 0.421 loss: -322.481]Iterations:  27%|██▋       | 8/30 [00:33<01:30,  4.13s/it, atk: -41.227 ent: -281.675 str: 0.421 loss: -322.481]Iterations:  27%|██▋       | 8/30 [00:35<01:30,  4.13s/it, atk: -49.513 ent: -281.671 str: 0.482 loss: -330.702]Iterations:  30%|███       | 9/30 [00:37<01:26,  4.12s/it, atk: -49.513 ent: -281.671 str: 0.482 loss: -330.702]Iterations:  30%|███       | 9/30 [00:39<01:26,  4.12s/it, atk: -56.101 ent: -281.667 str: 0.524 loss: -337.244]Iterations:  33%|███▎      | 10/30 [00:41<01:22,  4.14s/it, atk: -56.101 ent: -281.667 str: 0.524 loss: -337.244]Iterations:  33%|███▎      | 10/30 [00:43<01:22,  4.14s/it, atk: -62.266 ent: -281.663 str: 0.547 loss: -343.381]Iterations:  37%|███▋      | 11/30 [00:45<01:18,  4.11s/it, atk: -62.266 ent: -281.663 str: 0.547 loss: -343.381]Iterations:  37%|███▋      | 11/30 [00:47<01:18,  4.11s/it, atk: -68.131 ent: -281.658 str: 0.561 loss: -349.228]Iterations:  40%|████      | 12/30 [00:49<01:14,  4.12s/it, atk: -68.131 ent: -281.658 str: 0.561 loss: -349.228]Iterations:  40%|████      | 12/30 [00:51<01:14,  4.12s/it, atk: -74.192 ent: -281.655 str: 0.586 loss: -355.261]Iterations:  43%|████▎     | 13/30 [00:53<01:09,  4.12s/it, atk: -74.192 ent: -281.655 str: 0.586 loss: -355.261]Iterations:  43%|████▎     | 13/30 [00:55<01:09,  4.12s/it, atk: -80.286 ent: -281.653 str: 0.629 loss: -361.310]Iterations:  47%|████▋     | 14/30 [00:57<01:05,  4.11s/it, atk: -80.286 ent: -281.653 str: 0.629 loss: -361.310]Iterations:  47%|████▋     | 14/30 [01:00<01:05,  4.11s/it, atk: -85.270 ent: -281.651 str: 0.679 loss: -366.243]Iterations:  50%|█████     | 15/30 [01:01<01:01,  4.09s/it, atk: -85.270 ent: -281.651 str: 0.679 loss: -366.243]Iterations:  50%|█████     | 15/30 [01:04<01:01,  4.09s/it, atk: -89.932 ent: -281.650 str: 0.718 loss: -370.864]Iterations:  53%|█████▎    | 16/30 [01:05<00:57,  4.10s/it, atk: -89.932 ent: -281.650 str: 0.718 loss: -370.864]Iterations:  53%|█████▎    | 16/30 [01:08<00:57,  4.10s/it, atk: -94.049 ent: -281.650 str: 0.753 loss: -374.946]Iterations:  57%|█████▋    | 17/30 [01:09<00:52,  4.06s/it, atk: -94.049 ent: -281.650 str: 0.753 loss: -374.946]Iterations:  57%|█████▋    | 17/30 [01:12<00:52,  4.06s/it, atk: -98.620 ent: -281.650 str: 0.781 loss: -379.489]Iterations:  60%|██████    | 18/30 [01:14<00:48,  4.07s/it, atk: -98.620 ent: -281.650 str: 0.781 loss: -379.489]Iterations:  60%|██████    | 18/30 [01:16<00:48,  4.07s/it, atk: -102.871 ent: -281.651 str: 0.800 loss: -383.722]Iterations:  63%|██████▎   | 19/30 [01:18<00:44,  4.08s/it, atk: -102.871 ent: -281.651 str: 0.800 loss: -383.722]Iterations:  63%|██████▎   | 19/30 [01:20<00:44,  4.08s/it, atk: -106.521 ent: -281.650 str: 0.820 loss: -387.351]Iterations:  67%|██████▋   | 20/30 [01:22<00:41,  4.10s/it, atk: -106.521 ent: -281.650 str: 0.820 loss: -387.351]Iterations:  67%|██████▋   | 20/30 [01:24<00:41,  4.10s/it, atk: -110.681 ent: -281.649 str: 0.831 loss: -391.498]Iterations:  70%|███████   | 21/30 [01:26<00:36,  4.09s/it, atk: -110.681 ent: -281.649 str: 0.831 loss: -391.498]Iterations:  70%|███████   | 21/30 [01:28<00:36,  4.09s/it, atk: -114.684 ent: -281.646 str: 0.835 loss: -395.496]Iterations:  73%|███████▎  | 22/30 [01:30<00:32,  4.05s/it, atk: -114.684 ent: -281.646 str: 0.835 loss: -395.496]Iterations:  73%|███████▎  | 22/30 [01:32<00:32,  4.05s/it, atk: -118.196 ent: -281.643 str: 0.839 loss: -399.000]Iterations:  77%|███████▋  | 23/30 [01:33<00:27,  3.94s/it, atk: -118.196 ent: -281.643 str: 0.839 loss: -399.000]Iterations:  77%|███████▋  | 23/30 [01:36<00:27,  3.94s/it, atk: -121.771 ent: -281.639 str: 0.846 loss: -402.564]Iterations:  80%|████████  | 24/30 [01:37<00:23,  3.88s/it, atk: -121.771 ent: -281.639 str: 0.846 loss: -402.564]Iterations:  80%|████████  | 24/30 [01:39<00:23,  3.88s/it, atk: -124.796 ent: -281.636 str: 0.854 loss: -405.578]Iterations:  83%|████████▎ | 25/30 [01:41<00:19,  3.94s/it, atk: -124.796 ent: -281.636 str: 0.854 loss: -405.578]Iterations:  83%|████████▎ | 25/30 [01:44<00:19,  3.94s/it, atk: -127.598 ent: -281.635 str: 0.862 loss: -408.370]Iterations:  87%|████████▋ | 26/30 [01:46<00:16,  4.02s/it, atk: -127.598 ent: -281.635 str: 0.862 loss: -408.370]Iterations:  87%|████████▋ | 26/30 [01:48<00:16,  4.02s/it, atk: -130.399 ent: -281.635 str: 0.874 loss: -411.160]Iterations:  90%|█████████ | 27/30 [01:50<00:12,  4.04s/it, atk: -130.399 ent: -281.635 str: 0.874 loss: -411.160]Iterations:  90%|█████████ | 27/30 [01:52<00:12,  4.04s/it, atk: -133.464 ent: -281.636 str: 0.884 loss: -414.216]Iterations:  93%|█████████▎| 28/30 [01:54<00:08,  4.01s/it, atk: -133.464 ent: -281.636 str: 0.884 loss: -414.216]Iterations:  93%|█████████▎| 28/30 [01:56<00:08,  4.01s/it, atk: -136.554 ent: -281.637 str: 0.900 loss: -417.291]Iterations:  97%|█████████▋| 29/30 [01:57<00:03,  3.94s/it, atk: -136.554 ent: -281.637 str: 0.900 loss: -417.291]Iterations:  97%|█████████▋| 29/30 [01:59<00:03,  3.94s/it, atk: -139.071 ent: -281.638 str: 0.912 loss: -419.797]Iterations: 100%|██████████| 30/30 [02:01<00:00,  3.83s/it, atk: -139.071 ent: -281.638 str: 0.912 loss: -419.797]Iterations: 100%|██████████| 30/30 [02:01<00:00,  4.05s/it, atk: -139.071 ent: -281.638 str: 0.912 loss: -419.797]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([468], device='cuda:0') tensor(0.9992, device='cuda:0')
after_true: tensor([717], device='cuda:0') tensor(6.8327e-07, device='cuda:0')
L1: [3910.1882]	L2: [26.966768]	Linf: [0.84313726]

Accuracy on benign examples: 100.0%
gt_label: 671 pred_label: 671 pred_clean_logit 0.6305927038192749
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.83it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  4.04it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.50it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.41it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.29it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.29it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.35it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.45it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:02,  3.46it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.50it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.60it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.48it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.44it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.36it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.27it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.19it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.15it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.30it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.27it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.39it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:24,  6.14s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.82s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:21<00:15,  7.57s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.40s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:41<00:00,  9.13s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:41<00:00,  8.40s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -8.638 ent: -562.953 str: 0.000 loss: -571.591]Iterations:   3%|▎         | 1/30 [00:03<01:54,  3.93s/it, atk: -8.638 ent: -562.953 str: 0.000 loss: -571.591]Iterations:   3%|▎         | 1/30 [00:06<01:54,  3.93s/it, atk: -19.500 ent: -562.990 str: 0.738 loss: -581.752]Iterations:   7%|▋         | 2/30 [00:07<01:50,  3.95s/it, atk: -19.500 ent: -562.990 str: 0.738 loss: -581.752]Iterations:   7%|▋         | 2/30 [00:10<01:50,  3.95s/it, atk: -31.494 ent: -563.000 str: 0.953 loss: -593.541]Iterations:  10%|█         | 3/30 [00:11<01:45,  3.92s/it, atk: -31.494 ent: -563.000 str: 0.953 loss: -593.541]Iterations:  10%|█         | 3/30 [00:13<01:45,  3.92s/it, atk: -47.623 ent: -563.000 str: 0.647 loss: -609.976]Iterations:  13%|█▎        | 4/30 [00:15<01:41,  3.89s/it, atk: -47.623 ent: -563.000 str: 0.647 loss: -609.976]Iterations:  13%|█▎        | 4/30 [00:17<01:41,  3.89s/it, atk: -51.813 ent: -562.990 str: 0.754 loss: -614.048]Iterations:  17%|█▋        | 5/30 [00:19<01:36,  3.86s/it, atk: -51.813 ent: -562.990 str: 0.754 loss: -614.048]Iterations:  17%|█▋        | 5/30 [00:21<01:36,  3.86s/it, atk: -68.038 ent: -563.008 str: 1.281 loss: -629.765]Iterations:  20%|██        | 6/30 [00:23<01:33,  3.88s/it, atk: -68.038 ent: -563.008 str: 1.281 loss: -629.765]Iterations:  20%|██        | 6/30 [00:25<01:33,  3.88s/it, atk: -79.076 ent: -563.010 str: 1.290 loss: -640.796]Iterations:  23%|██▎       | 7/30 [00:27<01:29,  3.88s/it, atk: -79.076 ent: -563.010 str: 1.290 loss: -640.796]Iterations:  23%|██▎       | 7/30 [00:29<01:29,  3.88s/it, atk: -89.994 ent: -563.011 str: 1.318 loss: -651.688]Iterations:  27%|██▋       | 8/30 [00:31<01:25,  3.90s/it, atk: -89.994 ent: -563.011 str: 1.318 loss: -651.688]Iterations:  27%|██▋       | 8/30 [00:33<01:25,  3.90s/it, atk: -100.362 ent: -563.012 str: 1.335 loss: -662.039]Iterations:  30%|███       | 9/30 [00:35<01:22,  3.93s/it, atk: -100.362 ent: -563.012 str: 1.335 loss: -662.039]Iterations:  30%|███       | 9/30 [00:37<01:22,  3.93s/it, atk: -109.192 ent: -563.010 str: 1.349 loss: -670.853]Iterations:  33%|███▎      | 10/30 [00:39<01:19,  3.98s/it, atk: -109.192 ent: -563.010 str: 1.349 loss: -670.853]Iterations:  33%|███▎      | 10/30 [00:41<01:19,  3.98s/it, atk: -117.645 ent: -563.008 str: 1.387 loss: -679.266]Iterations:  37%|███▋      | 11/30 [00:43<01:15,  3.98s/it, atk: -117.645 ent: -563.008 str: 1.387 loss: -679.266]Iterations:  37%|███▋      | 11/30 [00:45<01:15,  3.98s/it, atk: -126.059 ent: -563.007 str: 1.428 loss: -687.638]Iterations:  40%|████      | 12/30 [00:47<01:11,  3.96s/it, atk: -126.059 ent: -563.007 str: 1.428 loss: -687.638]Iterations:  40%|████      | 12/30 [00:49<01:11,  3.96s/it, atk: -134.487 ent: -563.007 str: 1.451 loss: -696.043]Iterations:  43%|████▎     | 13/30 [00:51<01:06,  3.94s/it, atk: -134.487 ent: -563.007 str: 1.451 loss: -696.043]Iterations:  43%|████▎     | 13/30 [00:53<01:06,  3.94s/it, atk: -141.589 ent: -563.006 str: 1.460 loss: -703.135]Iterations:  47%|████▋     | 14/30 [00:54<01:02,  3.91s/it, atk: -141.589 ent: -563.006 str: 1.460 loss: -703.135]Iterations:  47%|████▋     | 14/30 [00:57<01:02,  3.91s/it, atk: -148.936 ent: -563.006 str: 1.491 loss: -710.451]Iterations:  50%|█████     | 15/30 [00:58<00:59,  3.97s/it, atk: -148.936 ent: -563.006 str: 1.491 loss: -710.451]Iterations:  50%|█████     | 15/30 [01:01<00:59,  3.97s/it, atk: -155.860 ent: -563.006 str: 1.516 loss: -717.350]Iterations:  53%|█████▎    | 16/30 [01:02<00:55,  3.95s/it, atk: -155.860 ent: -563.006 str: 1.516 loss: -717.350]Iterations:  53%|█████▎    | 16/30 [01:05<00:55,  3.95s/it, atk: -161.672 ent: -563.009 str: 1.563 loss: -723.118]Iterations:  57%|█████▋    | 17/30 [01:06<00:51,  3.99s/it, atk: -161.672 ent: -563.009 str: 1.563 loss: -723.118]Iterations:  57%|█████▋    | 17/30 [01:09<00:51,  3.99s/it, atk: -165.134 ent: -563.008 str: 1.644 loss: -726.499]Iterations:  60%|██████    | 18/30 [01:11<00:48,  4.02s/it, atk: -165.134 ent: -563.008 str: 1.644 loss: -726.499]Iterations:  60%|██████    | 18/30 [01:13<00:48,  4.02s/it, atk: -170.670 ent: -563.008 str: 1.647 loss: -732.030]Iterations:  63%|██████▎   | 19/30 [01:14<00:43,  3.97s/it, atk: -170.670 ent: -563.008 str: 1.647 loss: -732.030]Iterations:  63%|██████▎   | 19/30 [01:17<00:43,  3.97s/it, atk: -175.903 ent: -563.012 str: 1.654 loss: -737.261]Iterations:  67%|██████▋   | 20/30 [01:18<00:39,  3.98s/it, atk: -175.903 ent: -563.012 str: 1.654 loss: -737.261]Iterations:  67%|██████▋   | 20/30 [01:21<00:39,  3.98s/it, atk: -180.891 ent: -563.014 str: 1.681 loss: -742.224]Iterations:  70%|███████   | 21/30 [01:22<00:35,  3.98s/it, atk: -180.891 ent: -563.014 str: 1.681 loss: -742.224]Iterations:  70%|███████   | 21/30 [01:25<00:35,  3.98s/it, atk: -185.367 ent: -563.013 str: 1.706 loss: -746.675]Iterations:  73%|███████▎  | 22/30 [01:26<00:31,  3.98s/it, atk: -185.367 ent: -563.013 str: 1.706 loss: -746.675]Iterations:  73%|███████▎  | 22/30 [01:29<00:31,  3.98s/it, atk: -189.856 ent: -563.013 str: 1.717 loss: -751.152]Iterations:  77%|███████▋  | 23/30 [01:30<00:27,  3.99s/it, atk: -189.856 ent: -563.013 str: 1.717 loss: -751.152]Iterations:  77%|███████▋  | 23/30 [01:33<00:27,  3.99s/it, atk: -194.461 ent: -563.012 str: 1.729 loss: -755.744]Iterations:  80%|████████  | 24/30 [01:34<00:24,  4.00s/it, atk: -194.461 ent: -563.012 str: 1.729 loss: -755.744]Iterations:  80%|████████  | 24/30 [01:37<00:24,  4.00s/it, atk: -199.037 ent: -563.010 str: 1.743 loss: -760.305]Iterations:  83%|████████▎ | 25/30 [01:39<00:20,  4.03s/it, atk: -199.037 ent: -563.010 str: 1.743 loss: -760.305]Iterations:  83%|████████▎ | 25/30 [01:41<00:20,  4.03s/it, atk: -203.162 ent: -563.007 str: 1.755 loss: -764.415]Iterations:  87%|████████▋ | 26/30 [01:43<00:16,  4.04s/it, atk: -203.162 ent: -563.007 str: 1.755 loss: -764.415]Iterations:  87%|████████▋ | 26/30 [01:45<00:16,  4.04s/it, atk: -207.115 ent: -563.006 str: 1.761 loss: -768.360]Iterations:  90%|█████████ | 27/30 [01:47<00:12,  4.03s/it, atk: -207.115 ent: -563.006 str: 1.761 loss: -768.360]Iterations:  90%|█████████ | 27/30 [01:49<00:12,  4.03s/it, atk: -211.399 ent: -563.007 str: 1.763 loss: -772.642]Iterations:  93%|█████████▎| 28/30 [01:50<00:07,  3.97s/it, atk: -211.399 ent: -563.007 str: 1.763 loss: -772.642]Iterations:  93%|█████████▎| 28/30 [01:53<00:07,  3.97s/it, atk: -215.907 ent: -563.008 str: 1.768 loss: -777.147]Iterations:  97%|█████████▋| 29/30 [01:54<00:03,  3.99s/it, atk: -215.907 ent: -563.008 str: 1.768 loss: -777.147]Iterations:  97%|█████████▋| 29/30 [01:57<00:03,  3.99s/it, atk: -219.740 ent: -563.009 str: 1.778 loss: -780.971]Iterations: 100%|██████████| 30/30 [01:59<00:00,  4.02s/it, atk: -219.740 ent: -563.009 str: 1.778 loss: -780.971]Iterations: 100%|██████████| 30/30 [01:59<00:00,  3.97s/it, atk: -219.740 ent: -563.009 str: 1.778 loss: -780.971]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([880], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([671], device='cuda:0') tensor(1.9755e-10, device='cuda:0')
L1: [3346.4314]	L2: [21.910765]	Linf: [0.91764706]

Accuracy on benign examples: 100.0%
gt_label: 324 pred_label: 324 pred_clean_logit 0.9427664875984192
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:02,  6.74it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  4.02it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.70it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.39it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.34it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:04,  3.22it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.25it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.24it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.13it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:03<00:02,  3.11it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.10it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.13it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.15it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.26it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.21it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.16it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.15it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.16it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.28it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.27it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:24,  6.19s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.86s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:22<00:15,  7.75s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:32<00:08,  8.51s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  9.46s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:43<00:00,  8.63s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -6.414 ent: -562.395 str: 0.000 loss: -568.810]Iterations:   3%|▎         | 1/30 [00:04<02:10,  4.48s/it, atk: -6.414 ent: -562.395 str: 0.000 loss: -568.810]Iterations:   3%|▎         | 1/30 [00:06<02:10,  4.48s/it, atk: -13.945 ent: -562.384 str: 0.995 loss: -575.334]Iterations:   7%|▋         | 2/30 [00:08<02:02,  4.36s/it, atk: -13.945 ent: -562.384 str: 0.995 loss: -575.334]Iterations:   7%|▋         | 2/30 [00:11<02:02,  4.36s/it, atk: -27.588 ent: -562.374 str: 1.153 loss: -588.809]Iterations:  10%|█         | 3/30 [00:12<01:55,  4.27s/it, atk: -27.588 ent: -562.374 str: 1.153 loss: -588.809]Iterations:  10%|█         | 3/30 [00:15<01:55,  4.27s/it, atk: -36.981 ent: -562.390 str: 1.210 loss: -598.161]Iterations:  13%|█▎        | 4/30 [00:17<01:49,  4.23s/it, atk: -36.981 ent: -562.390 str: 1.210 loss: -598.161]Iterations:  13%|█▎        | 4/30 [00:19<01:49,  4.23s/it, atk: -43.116 ent: -562.412 str: 1.235 loss: -604.293]Iterations:  17%|█▋        | 5/30 [00:21<01:44,  4.18s/it, atk: -43.116 ent: -562.412 str: 1.235 loss: -604.293]Iterations:  17%|█▋        | 5/30 [00:23<01:44,  4.18s/it, atk: -48.415 ent: -562.416 str: 1.294 loss: -609.537]Iterations:  20%|██        | 6/30 [00:25<01:39,  4.15s/it, atk: -48.415 ent: -562.416 str: 1.294 loss: -609.537]Iterations:  20%|██        | 6/30 [00:27<01:39,  4.15s/it, atk: -53.065 ent: -562.419 str: 1.404 loss: -614.079]Iterations:  23%|██▎       | 7/30 [00:29<01:35,  4.14s/it, atk: -53.065 ent: -562.419 str: 1.404 loss: -614.079]Iterations:  23%|██▎       | 7/30 [00:31<01:35,  4.14s/it, atk: -56.498 ent: -562.414 str: 1.573 loss: -617.339]Iterations:  27%|██▋       | 8/30 [00:33<01:27,  3.98s/it, atk: -56.498 ent: -562.414 str: 1.573 loss: -617.339]Iterations:  27%|██▋       | 8/30 [00:35<01:27,  3.98s/it, atk: -60.398 ent: -562.408 str: 1.799 loss: -621.007]Iterations:  30%|███       | 9/30 [00:36<01:21,  3.88s/it, atk: -60.398 ent: -562.408 str: 1.799 loss: -621.007]Iterations:  30%|███       | 9/30 [00:38<01:21,  3.88s/it, atk: -63.405 ent: -562.402 str: 1.697 loss: -624.109]Iterations:  33%|███▎      | 10/30 [00:40<01:17,  3.88s/it, atk: -63.405 ent: -562.402 str: 1.697 loss: -624.109]Iterations:  33%|███▎      | 10/30 [00:42<01:17,  3.88s/it, atk: -66.862 ent: -562.393 str: 1.740 loss: -627.515]Iterations:  37%|███▋      | 11/30 [00:44<01:14,  3.94s/it, atk: -66.862 ent: -562.393 str: 1.740 loss: -627.515]Iterations:  37%|███▋      | 11/30 [00:46<01:14,  3.94s/it, atk: -70.284 ent: -562.388 str: 1.776 loss: -630.897]Iterations:  40%|████      | 12/30 [00:48<01:11,  4.00s/it, atk: -70.284 ent: -562.388 str: 1.776 loss: -630.897]Iterations:  40%|████      | 12/30 [00:51<01:11,  4.00s/it, atk: -73.430 ent: -562.390 str: 1.805 loss: -634.016]Iterations:  43%|████▎     | 13/30 [00:52<01:08,  4.01s/it, atk: -73.430 ent: -562.390 str: 1.805 loss: -634.016]Iterations:  43%|████▎     | 13/30 [00:55<01:08,  4.01s/it, atk: -76.685 ent: -562.399 str: 1.823 loss: -637.261]Iterations:  47%|████▋     | 14/30 [00:56<01:04,  4.01s/it, atk: -76.685 ent: -562.399 str: 1.823 loss: -637.261]Iterations:  47%|████▋     | 14/30 [00:59<01:04,  4.01s/it, atk: -81.488 ent: -562.412 str: 1.819 loss: -642.081]Iterations:  50%|█████     | 15/30 [01:00<00:59,  3.96s/it, atk: -81.488 ent: -562.412 str: 1.819 loss: -642.081]Iterations:  50%|█████     | 15/30 [01:02<00:59,  3.96s/it, atk: -88.824 ent: -562.424 str: 1.746 loss: -649.502]Iterations:  53%|█████▎    | 16/30 [01:04<00:55,  3.95s/it, atk: -88.824 ent: -562.424 str: 1.746 loss: -649.502]Iterations:  53%|█████▎    | 16/30 [01:06<00:55,  3.95s/it, atk: -98.909 ent: -562.425 str: 1.761 loss: -659.573]Iterations:  57%|█████▋    | 17/30 [01:08<00:50,  3.89s/it, atk: -98.909 ent: -562.425 str: 1.761 loss: -659.573]Iterations:  57%|█████▋    | 17/30 [01:10<00:50,  3.89s/it, atk: -111.795 ent: -562.427 str: 1.805 loss: -672.416]Iterations:  60%|██████    | 18/30 [01:11<00:45,  3.80s/it, atk: -111.795 ent: -562.427 str: 1.805 loss: -672.416]Iterations:  60%|██████    | 18/30 [01:13<00:45,  3.80s/it, atk: -125.504 ent: -562.426 str: 1.828 loss: -686.102]Iterations:  63%|██████▎   | 19/30 [01:15<00:41,  3.78s/it, atk: -125.504 ent: -562.426 str: 1.828 loss: -686.102]Iterations:  63%|██████▎   | 19/30 [01:17<00:41,  3.78s/it, atk: -143.948 ent: -562.427 str: 1.860 loss: -704.515]Iterations:  67%|██████▋   | 20/30 [01:19<00:38,  3.84s/it, atk: -143.948 ent: -562.427 str: 1.860 loss: -704.515]Iterations:  67%|██████▋   | 20/30 [01:21<00:38,  3.84s/it, atk: -160.062 ent: -562.431 str: 1.922 loss: -720.571]Iterations:  70%|███████   | 21/30 [01:23<00:34,  3.88s/it, atk: -160.062 ent: -562.431 str: 1.922 loss: -720.571]Iterations:  70%|███████   | 21/30 [01:25<00:34,  3.88s/it, atk: -168.512 ent: -562.433 str: 1.969 loss: -728.976]Iterations:  73%|███████▎  | 22/30 [01:27<00:31,  3.90s/it, atk: -168.512 ent: -562.433 str: 1.969 loss: -728.976]Iterations:  73%|███████▎  | 22/30 [01:29<00:31,  3.90s/it, atk: -180.402 ent: -562.422 str: 1.991 loss: -740.834]Iterations:  77%|███████▋  | 23/30 [01:31<00:27,  3.92s/it, atk: -180.402 ent: -562.422 str: 1.991 loss: -740.834]Iterations:  77%|███████▋  | 23/30 [01:33<00:27,  3.92s/it, atk: -189.502 ent: -562.415 str: 2.018 loss: -749.898]Iterations:  80%|████████  | 24/30 [01:35<00:23,  3.97s/it, atk: -189.502 ent: -562.415 str: 2.018 loss: -749.898]Iterations:  80%|████████  | 24/30 [01:37<00:23,  3.97s/it, atk: -198.869 ent: -562.414 str: 2.033 loss: -759.250]Iterations:  83%|████████▎ | 25/30 [01:39<00:19,  3.98s/it, atk: -198.869 ent: -562.414 str: 2.033 loss: -759.250]Iterations:  83%|████████▎ | 25/30 [01:41<00:19,  3.98s/it, atk: -206.254 ent: -562.400 str: 2.130 loss: -766.523]Iterations:  87%|████████▋ | 26/30 [01:43<00:15,  3.96s/it, atk: -206.254 ent: -562.400 str: 2.130 loss: -766.523]Iterations:  87%|████████▋ | 26/30 [01:45<00:15,  3.96s/it, atk: -213.671 ent: -562.383 str: 2.164 loss: -773.890]Iterations:  90%|█████████ | 27/30 [01:47<00:11,  3.97s/it, atk: -213.671 ent: -562.383 str: 2.164 loss: -773.890]Iterations:  90%|█████████ | 27/30 [01:49<00:11,  3.97s/it, atk: -219.429 ent: -562.375 str: 2.180 loss: -779.624]Iterations:  93%|█████████▎| 28/30 [01:51<00:07,  3.98s/it, atk: -219.429 ent: -562.375 str: 2.180 loss: -779.624]Iterations:  93%|█████████▎| 28/30 [01:53<00:07,  3.98s/it, atk: -225.399 ent: -562.375 str: 2.184 loss: -785.589]Iterations:  97%|█████████▋| 29/30 [01:55<00:03,  3.97s/it, atk: -225.399 ent: -562.375 str: 2.184 loss: -785.589]Iterations:  97%|█████████▋| 29/30 [01:57<00:03,  3.97s/it, atk: -232.807 ent: -562.377 str: 2.127 loss: -793.058]Iterations: 100%|██████████| 30/30 [01:59<00:00,  3.93s/it, atk: -232.807 ent: -562.377 str: 2.127 loss: -793.058]Iterations: 100%|██████████| 30/30 [01:59<00:00,  3.98s/it, atk: -232.807 ent: -562.377 str: 2.127 loss: -793.058]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([59], device='cuda:0') tensor(0.8626, device='cuda:0')
after_true: tensor([324], device='cuda:0') tensor(4.1242e-11, device='cuda:0')
L1: [2439.5178]	L2: [16.151505]	Linf: [0.69803923]

Accuracy on benign examples: 100.0%
gt_label: 759 pred_label: 759 pred_clean_logit 0.9951444268226624
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.72it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  4.13it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.62it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.46it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.38it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.32it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:01<00:03,  3.40it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.26it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.20it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.26it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.28it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.30it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.35it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.27it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.22it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.32it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.22it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.37it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.31it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.36it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:24,  6.23s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.68s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:21<00:15,  7.58s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:31<00:08,  8.46s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  9.32s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:42<00:00,  8.51s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -0.027 ent: -562.789 str: 0.000 loss: -562.816]Iterations:   3%|▎         | 1/30 [00:04<02:13,  4.61s/it, atk: -0.027 ent: -562.789 str: 0.000 loss: -562.816]Iterations:   3%|▎         | 1/30 [00:06<02:13,  4.61s/it, atk: -0.059 ent: -562.899 str: 1.729 loss: -561.229]Iterations:   7%|▋         | 2/30 [00:08<02:01,  4.33s/it, atk: -0.059 ent: -562.899 str: 1.729 loss: -561.229]Iterations:   7%|▋         | 2/30 [00:10<02:01,  4.33s/it, atk: -0.066 ent: -562.937 str: 1.129 loss: -561.875]Iterations:  10%|█         | 3/30 [00:12<01:53,  4.21s/it, atk: -0.066 ent: -562.937 str: 1.129 loss: -561.875]Iterations:  10%|█         | 3/30 [00:15<01:53,  4.21s/it, atk: -0.118 ent: -562.933 str: 1.077 loss: -561.973]Iterations:  13%|█▎        | 4/30 [00:16<01:48,  4.18s/it, atk: -0.118 ent: -562.933 str: 1.077 loss: -561.973]Iterations:  13%|█▎        | 4/30 [00:19<01:48,  4.18s/it, atk: -0.186 ent: -562.970 str: 1.712 loss: -561.444]Iterations:  17%|█▋        | 5/30 [00:21<01:43,  4.15s/it, atk: -0.186 ent: -562.970 str: 1.712 loss: -561.444]Iterations:  17%|█▋        | 5/30 [00:23<01:43,  4.15s/it, atk: -0.178 ent: -562.966 str: 1.453 loss: -561.691]Iterations:  20%|██        | 6/30 [00:24<01:37,  4.07s/it, atk: -0.178 ent: -562.966 str: 1.453 loss: -561.691]Iterations:  20%|██        | 6/30 [00:27<01:37,  4.07s/it, atk: -0.314 ent: -562.945 str: 1.574 loss: -561.684]Iterations:  23%|██▎       | 7/30 [00:29<01:33,  4.07s/it, atk: -0.314 ent: -562.945 str: 1.574 loss: -561.684]Iterations:  23%|██▎       | 7/30 [00:31<01:33,  4.07s/it, atk: -1.051 ent: -562.967 str: 1.425 loss: -562.594]Iterations:  27%|██▋       | 8/30 [00:33<01:30,  4.09s/it, atk: -1.051 ent: -562.967 str: 1.425 loss: -562.594]Iterations:  27%|██▋       | 8/30 [00:35<01:30,  4.09s/it, atk: -3.786 ent: -562.965 str: 1.494 loss: -565.256]Iterations:  30%|███       | 9/30 [00:37<01:26,  4.10s/it, atk: -3.786 ent: -562.965 str: 1.494 loss: -565.256]Iterations:  30%|███       | 9/30 [00:39<01:26,  4.10s/it, atk: -2.672 ent: -562.936 str: 1.945 loss: -563.664]Iterations:  33%|███▎      | 10/30 [00:41<01:22,  4.11s/it, atk: -2.672 ent: -562.936 str: 1.945 loss: -563.664]Iterations:  33%|███▎      | 10/30 [00:43<01:22,  4.11s/it, atk: -10.794 ent: -562.941 str: 2.032 loss: -571.703]Iterations:  37%|███▋      | 11/30 [00:45<01:17,  4.08s/it, atk: -10.794 ent: -562.941 str: 2.032 loss: -571.703]Iterations:  37%|███▋      | 11/30 [00:47<01:17,  4.08s/it, atk: -27.979 ent: -562.952 str: 1.881 loss: -589.050]Iterations:  40%|████      | 12/30 [00:49<01:13,  4.07s/it, atk: -27.979 ent: -562.952 str: 1.881 loss: -589.050]Iterations:  40%|████      | 12/30 [00:51<01:13,  4.07s/it, atk: -22.070 ent: -562.966 str: 2.189 loss: -582.847]Iterations:  43%|████▎     | 13/30 [00:53<01:09,  4.07s/it, atk: -22.070 ent: -562.966 str: 2.189 loss: -582.847]Iterations:  43%|████▎     | 13/30 [00:55<01:09,  4.07s/it, atk: -46.232 ent: -562.945 str: 2.170 loss: -607.007]Iterations:  47%|████▋     | 14/30 [00:57<01:04,  4.06s/it, atk: -46.232 ent: -562.945 str: 2.170 loss: -607.007]Iterations:  47%|████▋     | 14/30 [00:59<01:04,  4.06s/it, atk: -57.605 ent: -562.942 str: 1.967 loss: -618.580]Iterations:  50%|█████     | 15/30 [01:01<01:00,  4.05s/it, atk: -57.605 ent: -562.942 str: 1.967 loss: -618.580]Iterations:  50%|█████     | 15/30 [01:03<01:00,  4.05s/it, atk: -66.212 ent: -562.929 str: 2.023 loss: -627.118]Iterations:  53%|█████▎    | 16/30 [01:05<00:57,  4.08s/it, atk: -66.212 ent: -562.929 str: 2.023 loss: -627.118]Iterations:  53%|█████▎    | 16/30 [01:08<00:57,  4.08s/it, atk: -78.986 ent: -562.953 str: 1.821 loss: -640.119]Iterations:  57%|█████▋    | 17/30 [01:09<00:53,  4.09s/it, atk: -78.986 ent: -562.953 str: 1.821 loss: -640.119]Iterations:  57%|█████▋    | 17/30 [01:12<00:53,  4.09s/it, atk: -92.938 ent: -562.958 str: 1.813 loss: -654.082]Iterations:  60%|██████    | 18/30 [01:13<00:49,  4.10s/it, atk: -92.938 ent: -562.958 str: 1.813 loss: -654.082]Iterations:  60%|██████    | 18/30 [01:16<00:49,  4.10s/it, atk: -103.678 ent: -562.963 str: 1.891 loss: -664.750]Iterations:  63%|██████▎   | 19/30 [01:18<00:44,  4.07s/it, atk: -103.678 ent: -562.963 str: 1.891 loss: -664.750]Iterations:  63%|██████▎   | 19/30 [01:20<00:44,  4.07s/it, atk: -115.013 ent: -562.966 str: 1.956 loss: -676.023]Iterations:  67%|██████▋   | 20/30 [01:22<00:40,  4.07s/it, atk: -115.013 ent: -562.966 str: 1.956 loss: -676.023]Iterations:  67%|██████▋   | 20/30 [01:24<00:40,  4.07s/it, atk: -125.022 ent: -562.967 str: 1.930 loss: -686.058]Iterations:  70%|███████   | 21/30 [01:26<00:36,  4.07s/it, atk: -125.022 ent: -562.967 str: 1.930 loss: -686.058]Iterations:  70%|███████   | 21/30 [01:28<00:36,  4.07s/it, atk: -133.242 ent: -562.968 str: 1.872 loss: -694.338]Iterations:  73%|███████▎  | 22/30 [01:30<00:32,  4.09s/it, atk: -133.242 ent: -562.968 str: 1.872 loss: -694.338]Iterations:  73%|███████▎  | 22/30 [01:32<00:32,  4.09s/it, atk: -139.468 ent: -562.973 str: 1.989 loss: -700.451]Iterations:  77%|███████▋  | 23/30 [01:34<00:28,  4.12s/it, atk: -139.468 ent: -562.973 str: 1.989 loss: -700.451]Iterations:  77%|███████▋  | 23/30 [01:36<00:28,  4.12s/it, atk: -146.011 ent: -562.975 str: 1.979 loss: -707.007]Iterations:  80%|████████  | 24/30 [01:38<00:24,  4.12s/it, atk: -146.011 ent: -562.975 str: 1.979 loss: -707.007]Iterations:  80%|████████  | 24/30 [01:40<00:24,  4.12s/it, atk: -154.077 ent: -562.977 str: 1.980 loss: -715.073]Iterations:  83%|████████▎ | 25/30 [01:42<00:20,  4.13s/it, atk: -154.077 ent: -562.977 str: 1.980 loss: -715.073]Iterations:  83%|████████▎ | 25/30 [01:44<00:20,  4.13s/it, atk: -162.303 ent: -562.982 str: 2.018 loss: -723.266]Iterations:  87%|████████▋ | 26/30 [01:46<00:16,  4.07s/it, atk: -162.303 ent: -562.982 str: 2.018 loss: -723.266]Iterations:  87%|████████▋ | 26/30 [01:48<00:16,  4.07s/it, atk: -168.098 ent: -562.985 str: 2.013 loss: -729.070]Iterations:  90%|█████████ | 27/30 [01:50<00:12,  4.09s/it, atk: -168.098 ent: -562.985 str: 2.013 loss: -729.070]Iterations:  90%|█████████ | 27/30 [01:53<00:12,  4.09s/it, atk: -172.350 ent: -562.981 str: 1.962 loss: -733.370]Iterations:  93%|█████████▎| 28/30 [01:54<00:08,  4.04s/it, atk: -172.350 ent: -562.981 str: 1.962 loss: -733.370]Iterations:  93%|█████████▎| 28/30 [01:56<00:08,  4.04s/it, atk: -177.814 ent: -562.999 str: 2.060 loss: -738.754]Iterations:  97%|█████████▋| 29/30 [01:58<00:04,  4.03s/it, atk: -177.814 ent: -562.999 str: 2.060 loss: -738.754]Iterations:  97%|█████████▋| 29/30 [02:00<00:04,  4.03s/it, atk: -184.870 ent: -562.994 str: 2.033 loss: -745.832]Iterations: 100%|██████████| 30/30 [02:02<00:00,  4.03s/it, atk: -184.870 ent: -562.994 str: 2.033 loss: -745.832]Iterations: 100%|██████████| 30/30 [02:02<00:00,  4.09s/it, atk: -184.870 ent: -562.994 str: 2.033 loss: -745.832]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([704], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([759], device='cuda:0') tensor(5.9081e-09, device='cuda:0')
L1: [2698.5254]	L2: [19.55626]	Linf: [0.7294118]

Accuracy on benign examples: 0.0%
gt_label: 634 pred_label: 388 pred_clean_logit 0.0082473736256361
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  5.48it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:04,  3.89it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:04,  3.49it/s]DDIM_inverse:  21%|██        | 4/19 [00:01<00:04,  3.58it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:01<00:04,  3.44it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:01<00:03,  3.29it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:02<00:03,  3.27it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:02<00:03,  3.24it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:02<00:03,  3.14it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:02<00:02,  3.19it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:03<00:02,  3.08it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:03<00:02,  3.25it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:03<00:01,  3.21it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:04<00:01,  3.18it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:04<00:01,  3.21it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:04<00:00,  3.21it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:05<00:00,  3.18it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:05<00:00,  3.15it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.19it/s]DDIM_inverse: 100%|██████████| 19/19 [00:05<00:00,  3.27it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:06<00:26,  6.51s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:13<00:20,  6.74s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:21<00:14,  7.14s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:30<00:08,  8.10s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:41<00:00,  9.07s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:41<00:00,  8.28s/it]
✓ Patched controller.forward (Structure Loss Restored)
Mask generated. Coverage: 30.1%
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:02<?, ?it/s, atk: -52.000 ent: -563.434 str: 0.000 loss: -615.434]Iterations:   3%|▎         | 1/30 [00:04<02:00,  4.14s/it, atk: -52.000 ent: -563.434 str: 0.000 loss: -615.434]Iterations:   3%|▎         | 1/30 [00:06<02:00,  4.14s/it, atk: -63.922 ent: -563.454 str: 1.247 loss: -626.130]Iterations:   7%|▋         | 2/30 [00:08<01:54,  4.08s/it, atk: -63.922 ent: -563.454 str: 1.247 loss: -626.130]Iterations:   7%|▋         | 2/30 [00:10<01:54,  4.08s/it, atk: -77.087 ent: -563.427 str: 1.579 loss: -638.935]Iterations:  10%|█         | 3/30 [00:11<01:46,  3.96s/it, atk: -77.087 ent: -563.427 str: 1.579 loss: -638.935]Iterations:  10%|█         | 3/30 [00:14<01:46,  3.96s/it, atk: -89.361 ent: -563.418 str: 1.824 loss: -650.955]Iterations:  13%|█▎        | 4/30 [00:15<01:40,  3.88s/it, atk: -89.361 ent: -563.418 str: 1.824 loss: -650.955]Iterations:  13%|█▎        | 4/30 [00:17<01:40,  3.88s/it, atk: -97.861 ent: -563.413 str: 2.029 loss: -659.245]Iterations:  17%|█▋        | 5/30 [00:19<01:34,  3.76s/it, atk: -97.861 ent: -563.413 str: 2.029 loss: -659.245]Iterations:  17%|█▋        | 5/30 [00:21<01:34,  3.76s/it, atk: -109.010 ent: -563.414 str: 2.123 loss: -670.301]Iterations:  20%|██        | 6/30 [00:23<01:29,  3.75s/it, atk: -109.010 ent: -563.414 str: 2.123 loss: -670.301]Iterations:  20%|██        | 6/30 [00:25<01:29,  3.75s/it, atk: -118.781 ent: -563.411 str: 2.203 loss: -679.988]Iterations:  23%|██▎       | 7/30 [00:27<01:28,  3.84s/it, atk: -118.781 ent: -563.411 str: 2.203 loss: -679.988]Iterations:  23%|██▎       | 7/30 [00:29<01:28,  3.84s/it, atk: -134.390 ent: -563.407 str: 2.288 loss: -695.509]Iterations:  27%|██▋       | 8/30 [00:31<01:26,  3.93s/it, atk: -134.390 ent: -563.407 str: 2.288 loss: -695.509]Iterations:  27%|██▋       | 8/30 [00:33<01:26,  3.93s/it, atk: -146.776 ent: -563.400 str: 2.383 loss: -707.793]Iterations:  30%|███       | 9/30 [00:35<01:24,  4.01s/it, atk: -146.776 ent: -563.400 str: 2.383 loss: -707.793]Iterations:  30%|███       | 9/30 [00:37<01:24,  4.01s/it, atk: -156.614 ent: -563.395 str: 2.472 loss: -717.536]Iterations:  33%|███▎      | 10/30 [00:39<01:20,  4.04s/it, atk: -156.614 ent: -563.395 str: 2.472 loss: -717.536]Iterations:  33%|███▎      | 10/30 [00:41<01:20,  4.04s/it, atk: -168.345 ent: -563.392 str: 2.501 loss: -729.236]Iterations:  37%|███▋      | 11/30 [00:43<01:17,  4.06s/it, atk: -168.345 ent: -563.392 str: 2.501 loss: -729.236]Iterations:  37%|███▋      | 11/30 [00:45<01:17,  4.06s/it, atk: -181.018 ent: -563.393 str: 2.561 loss: -741.851]Iterations:  40%|████      | 12/30 [00:47<01:12,  4.05s/it, atk: -181.018 ent: -563.393 str: 2.561 loss: -741.851]Iterations:  40%|████      | 12/30 [00:49<01:12,  4.05s/it, atk: -190.257 ent: -563.391 str: 2.573 loss: -751.075]Iterations:  43%|████▎     | 13/30 [00:51<01:09,  4.06s/it, atk: -190.257 ent: -563.391 str: 2.573 loss: -751.075]Iterations:  43%|████▎     | 13/30 [00:53<01:09,  4.06s/it, atk: -197.460 ent: -563.390 str: 2.621 loss: -758.229]Iterations:  47%|████▋     | 14/30 [00:55<01:05,  4.07s/it, atk: -197.460 ent: -563.390 str: 2.621 loss: -758.229]Iterations:  47%|████▋     | 14/30 [00:58<01:05,  4.07s/it, atk: -205.874 ent: -563.385 str: 2.620 loss: -766.639]Iterations:  50%|█████     | 15/30 [00:59<01:01,  4.09s/it, atk: -205.874 ent: -563.385 str: 2.620 loss: -766.639]Iterations:  50%|█████     | 15/30 [01:02<01:01,  4.09s/it, atk: -211.137 ent: -563.386 str: 2.601 loss: -771.922]Iterations:  53%|█████▎    | 16/30 [01:04<00:57,  4.11s/it, atk: -211.137 ent: -563.386 str: 2.601 loss: -771.922]Iterations:  53%|█████▎    | 16/30 [01:06<00:57,  4.11s/it, atk: -220.644 ent: -563.388 str: 2.646 loss: -781.386]Iterations:  57%|█████▋    | 17/30 [01:08<00:53,  4.14s/it, atk: -220.644 ent: -563.388 str: 2.646 loss: -781.386]Iterations:  57%|█████▋    | 17/30 [01:10<00:53,  4.14s/it, atk: -227.578 ent: -563.389 str: 2.716 loss: -788.251]Iterations:  60%|██████    | 18/30 [01:12<00:49,  4.15s/it, atk: -227.578 ent: -563.389 str: 2.716 loss: -788.251]Iterations:  60%|██████    | 18/30 [01:14<00:49,  4.15s/it, atk: -235.482 ent: -563.389 str: 2.720 loss: -796.151]Iterations:  63%|██████▎   | 19/30 [01:16<00:45,  4.15s/it, atk: -235.482 ent: -563.389 str: 2.720 loss: -796.151]Iterations:  63%|██████▎   | 19/30 [01:18<00:45,  4.15s/it, atk: -243.028 ent: -563.389 str: 2.749 loss: -803.667]Iterations:  67%|██████▋   | 20/30 [01:20<00:41,  4.12s/it, atk: -243.028 ent: -563.389 str: 2.749 loss: -803.667]Iterations:  67%|██████▋   | 20/30 [01:22<00:41,  4.12s/it, atk: -248.946 ent: -563.390 str: 2.795 loss: -809.541]Iterations:  70%|███████   | 21/30 [01:24<00:36,  4.09s/it, atk: -248.946 ent: -563.390 str: 2.795 loss: -809.541]Iterations:  70%|███████   | 21/30 [01:26<00:36,  4.09s/it, atk: -258.750 ent: -563.389 str: 2.812 loss: -819.327]Iterations:  73%|███████▎  | 22/30 [01:28<00:32,  4.09s/it, atk: -258.750 ent: -563.389 str: 2.812 loss: -819.327]Iterations:  73%|███████▎  | 22/30 [01:31<00:32,  4.09s/it, atk: -266.118 ent: -563.388 str: 2.807 loss: -826.698]Iterations:  77%|███████▋  | 23/30 [01:32<00:28,  4.11s/it, atk: -266.118 ent: -563.388 str: 2.807 loss: -826.698]Iterations:  77%|███████▋  | 23/30 [01:35<00:28,  4.11s/it, atk: -274.823 ent: -563.389 str: 2.809 loss: -835.402]Iterations:  80%|████████  | 24/30 [01:37<00:24,  4.14s/it, atk: -274.823 ent: -563.389 str: 2.809 loss: -835.402]Iterations:  80%|████████  | 24/30 [01:39<00:24,  4.14s/it, atk: -281.591 ent: -563.390 str: 2.833 loss: -842.149]Iterations:  83%|████████▎ | 25/30 [01:41<00:20,  4.14s/it, atk: -281.591 ent: -563.390 str: 2.833 loss: -842.149]Iterations:  83%|████████▎ | 25/30 [01:43<00:20,  4.14s/it, atk: -288.743 ent: -563.390 str: 2.813 loss: -849.320]Iterations:  87%|████████▋ | 26/30 [01:45<00:16,  4.16s/it, atk: -288.743 ent: -563.390 str: 2.813 loss: -849.320]Iterations:  87%|████████▋ | 26/30 [01:47<00:16,  4.16s/it, atk: -294.994 ent: -563.388 str: 2.831 loss: -855.551]Iterations:  90%|█████████ | 27/30 [01:49<00:12,  4.16s/it, atk: -294.994 ent: -563.388 str: 2.831 loss: -855.551]Iterations:  90%|█████████ | 27/30 [01:51<00:12,  4.16s/it, atk: -301.458 ent: -563.387 str: 2.868 loss: -861.977]Iterations:  93%|█████████▎| 28/30 [01:53<00:08,  4.15s/it, atk: -301.458 ent: -563.387 str: 2.868 loss: -861.977]Iterations:  93%|█████████▎| 28/30 [01:56<00:08,  4.15s/it, atk: -309.866 ent: -563.387 str: 2.881 loss: -870.372]Iterations:  97%|█████████▋| 29/30 [01:57<00:04,  4.14s/it, atk: -309.866 ent: -563.387 str: 2.881 loss: -870.372]Iterations:  97%|█████████▋| 29/30 [02:00<00:04,  4.14s/it, atk: -316.256 ent: -563.388 str: 2.891 loss: -876.753]Iterations: 100%|██████████| 30/30 [02:01<00:00,  4.12s/it, atk: -316.256 ent: -563.388 str: 2.891 loss: -876.753]Iterations: 100%|██████████| 30/30 [02:01<00:00,  4.07s/it, atk: -316.256 ent: -563.388 str: 2.891 loss: -876.753]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([388], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([634], device='cuda:0') tensor(1.0042e-14, device='cuda:0')
L1: [2441.796]	L2: [16.388525]	Linf: [0.7529412]
Clean acc: 0.0%
Adv acc: 0.0%

*********Transfer to resnet********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 0.0%

*********Transfer to vgg********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to mobile********
Accuracy on benign examples: 72.72727272727273%
Accuracy on adversarial examples: 27.27272727272727%

*********Transfer to inception********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 45.45454545454545%

*********Transfer to convnext********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to vit********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 54.54545454545454%

*********Transfer to swin********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 27.27272727272727%

*********Transfer to deit-b********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 45.45454545454545%

*********Transfer to deit-s********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 27.27272727272727%

*********Transfer to mixer-b********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to mixer-l********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 18.181818181818183%
Warning: batch size is bigger than the data size. Setting batch size to data size
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:05<00:00,  5.08s/it]100%|██████████| 1/1 [00:05<00:00,  5.32s/it]
FID:  292.61773232844956

*********fid: 292.61773232844956********
