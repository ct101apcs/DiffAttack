Cannot initialize model with low cpu memory usage because `accelerate` was not found in the environment. Defaulting to `low_cpu_mem_usage=False`. It is strongly recommended to install `accelerate` for faster and less memory-intense model loading. You can do so with: 
```
pip install accelerate
```
.

******Attack based on Diffusion, Attacked Dataset: imagenet_compatible*********
Loading pipeline components...:   0%|          | 0/6 [00:00<?, ?it/s]Loading pipeline components...:  33%|███▎      | 2/6 [00:00<00:01,  2.17it/s]Loading pipeline components...:  50%|█████     | 3/6 [00:08<00:09,  3.31s/it]Loading pipeline components...: 100%|██████████| 6/6 [00:10<00:00,  1.77s/it]Loading pipeline components...: 100%|██████████| 6/6 [00:10<00:00,  1.83s/it]

Accuracy on benign examples: 100.0%
gt_label: 809 pred_label: 809 pred_clean_logit 0.9941885471343994
prompt generate:  soup bowl  	labels:  [[809]]
decoder:  [49406, 7077, 3814, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:   5%|▌         | 1/19 [00:00<00:03,  4.86it/s]DDIM_inverse:  16%|█▌        | 3/19 [00:00<00:01,  9.91it/s]DDIM_inverse:  26%|██▋       | 5/19 [00:00<00:01, 13.22it/s]DDIM_inverse:  37%|███▋      | 7/19 [00:00<00:00, 12.25it/s]DDIM_inverse:  47%|████▋     | 9/19 [00:00<00:00, 11.65it/s]DDIM_inverse:  58%|█████▊    | 11/19 [00:01<00:00, 10.01it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:01<00:00,  9.28it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:01<00:00,  9.02it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:01<00:00,  8.99it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00,  8.78it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:01<00:00,  8.61it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:01<00:00,  8.72it/s]DDIM_inverse: 100%|██████████| 19/19 [00:02<00:00,  8.55it/s]DDIM_inverse: 100%|██████████| 19/19 [00:02<00:00,  9.42it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:02<00:09,  2.48s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:06<00:09,  3.11s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:09<00:06,  3.25s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:12<00:02,  3.00s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:14<00:00,  2.92s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:14<00:00,  2.97s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -0.13481 variance_cross_attn_loss: 0.05474 self_attn_loss: 0.00000 loss: -0.08008]Iterations:   3%|▎         | 1/30 [00:01<00:45,  1.58s/it, attack_loss: -0.13481 variance_cross_attn_loss: 0.05474 self_attn_loss: 0.00000 loss: -0.08008]Iterations:   3%|▎         | 1/30 [00:02<00:45,  1.58s/it, attack_loss: -0.54147 variance_cross_attn_loss: 0.05608 self_attn_loss: 0.88887 loss: 0.40348] Iterations:   7%|▋         | 2/30 [00:03<00:46,  1.67s/it, attack_loss: -0.54147 variance_cross_attn_loss: 0.05608 self_attn_loss: 0.88887 loss: 0.40348]Iterations:   7%|▋         | 2/30 [00:04<00:46,  1.67s/it, attack_loss: -4.41606 variance_cross_attn_loss: 0.05492 self_attn_loss: 0.99197 loss: -3.36918]Iterations:  10%|█         | 3/30 [00:04<00:40,  1.49s/it, attack_loss: -4.41606 variance_cross_attn_loss: 0.05492 self_attn_loss: 0.99197 loss: -3.36918]Iterations:  10%|█         | 3/30 [00:05<00:40,  1.49s/it, attack_loss: -18.44188 variance_cross_attn_loss: 0.05089 self_attn_loss: 0.93472 loss: -17.45626]Iterations:  13%|█▎        | 4/30 [00:05<00:34,  1.33s/it, attack_loss: -18.44188 variance_cross_attn_loss: 0.05089 self_attn_loss: 0.93472 loss: -17.45626]Iterations:  13%|█▎        | 4/30 [00:06<00:34,  1.33s/it, attack_loss: -24.96065 variance_cross_attn_loss: 0.04905 self_attn_loss: 1.27335 loss: -23.63825]Iterations:  17%|█▋        | 5/30 [00:06<00:31,  1.25s/it, attack_loss: -24.96065 variance_cross_attn_loss: 0.04905 self_attn_loss: 1.27335 loss: -23.63825]Iterations:  17%|█▋        | 5/30 [00:07<00:31,  1.25s/it, attack_loss: -45.32873 variance_cross_attn_loss: 0.04889 self_attn_loss: 1.34304 loss: -43.93680]Iterations:  20%|██        | 6/30 [00:07<00:28,  1.20s/it, attack_loss: -45.32873 variance_cross_attn_loss: 0.04889 self_attn_loss: 1.34304 loss: -43.93680]Iterations:  20%|██        | 6/30 [00:08<00:28,  1.20s/it, attack_loss: -65.56824 variance_cross_attn_loss: 0.04819 self_attn_loss: 1.41122 loss: -64.10884]Iterations:  23%|██▎       | 7/30 [00:08<00:26,  1.17s/it, attack_loss: -65.56824 variance_cross_attn_loss: 0.04819 self_attn_loss: 1.41122 loss: -64.10884]Iterations:  23%|██▎       | 7/30 [00:09<00:26,  1.17s/it, attack_loss: -82.87116 variance_cross_attn_loss: 0.04710 self_attn_loss: 1.45898 loss: -81.36508]Iterations:  27%|██▋       | 8/30 [00:10<00:25,  1.17s/it, attack_loss: -82.87116 variance_cross_attn_loss: 0.04710 self_attn_loss: 1.45898 loss: -81.36508]Iterations:  27%|██▋       | 8/30 [00:11<00:25,  1.17s/it, attack_loss: -95.87853 variance_cross_attn_loss: 0.04667 self_attn_loss: 1.50554 loss: -94.32632]Iterations:  30%|███       | 9/30 [00:11<00:27,  1.33s/it, attack_loss: -95.87853 variance_cross_attn_loss: 0.04667 self_attn_loss: 1.50554 loss: -94.32632]Iterations:  30%|███       | 9/30 [00:12<00:27,  1.33s/it, attack_loss: -104.78667 variance_cross_attn_loss: 0.04605 self_attn_loss: 1.60266 loss: -103.13797]Iterations:  33%|███▎      | 10/30 [00:13<00:29,  1.45s/it, attack_loss: -104.78667 variance_cross_attn_loss: 0.04605 self_attn_loss: 1.60266 loss: -103.13797]Iterations:  33%|███▎      | 10/30 [00:14<00:29,  1.45s/it, attack_loss: -117.32784 variance_cross_attn_loss: 0.04516 self_attn_loss: 1.66212 loss: -115.62054]Iterations:  37%|███▋      | 11/30 [00:15<00:31,  1.67s/it, attack_loss: -117.32784 variance_cross_attn_loss: 0.04516 self_attn_loss: 1.66212 loss: -115.62054]Iterations:  37%|███▋      | 11/30 [00:16<00:31,  1.67s/it, attack_loss: -129.55534 variance_cross_attn_loss: 0.04445 self_attn_loss: 1.69482 loss: -127.81606]Iterations:  40%|████      | 12/30 [00:17<00:29,  1.65s/it, attack_loss: -129.55534 variance_cross_attn_loss: 0.04445 self_attn_loss: 1.69482 loss: -127.81606]Iterations:  40%|████      | 12/30 [00:18<00:29,  1.65s/it, attack_loss: -140.00104 variance_cross_attn_loss: 0.04426 self_attn_loss: 1.71413 loss: -138.24266]Iterations:  43%|████▎     | 13/30 [00:18<00:28,  1.65s/it, attack_loss: -140.00104 variance_cross_attn_loss: 0.04426 self_attn_loss: 1.71413 loss: -138.24266]Iterations:  43%|████▎     | 13/30 [00:19<00:28,  1.65s/it, attack_loss: -149.33434 variance_cross_attn_loss: 0.04381 self_attn_loss: 1.73551 loss: -147.55501]Iterations:  47%|████▋     | 14/30 [00:20<00:26,  1.63s/it, attack_loss: -149.33434 variance_cross_attn_loss: 0.04381 self_attn_loss: 1.73551 loss: -147.55501]Iterations:  47%|████▋     | 14/30 [00:21<00:26,  1.63s/it, attack_loss: -160.48459 variance_cross_attn_loss: 0.04368 self_attn_loss: 1.75964 loss: -158.68127]Iterations:  50%|█████     | 15/30 [00:21<00:22,  1.51s/it, attack_loss: -160.48459 variance_cross_attn_loss: 0.04368 self_attn_loss: 1.75964 loss: -158.68127]Iterations:  50%|█████     | 15/30 [00:22<00:22,  1.51s/it, attack_loss: -170.68478 variance_cross_attn_loss: 0.04313 self_attn_loss: 1.79201 loss: -168.84964]Iterations:  53%|█████▎    | 16/30 [00:22<00:18,  1.35s/it, attack_loss: -170.68478 variance_cross_attn_loss: 0.04313 self_attn_loss: 1.79201 loss: -168.84964]Iterations:  53%|█████▎    | 16/30 [00:23<00:18,  1.35s/it, attack_loss: -179.13760 variance_cross_attn_loss: 0.04255 self_attn_loss: 1.82254 loss: -177.27251]Iterations:  57%|█████▋    | 17/30 [00:24<00:17,  1.32s/it, attack_loss: -179.13760 variance_cross_attn_loss: 0.04255 self_attn_loss: 1.82254 loss: -177.27251]Iterations:  57%|█████▋    | 17/30 [00:24<00:17,  1.32s/it, attack_loss: -186.57234 variance_cross_attn_loss: 0.04183 self_attn_loss: 1.87267 loss: -184.65785]Iterations:  60%|██████    | 18/30 [00:25<00:17,  1.43s/it, attack_loss: -186.57234 variance_cross_attn_loss: 0.04183 self_attn_loss: 1.87267 loss: -184.65785]Iterations:  60%|██████    | 18/30 [00:26<00:17,  1.43s/it, attack_loss: -194.29031 variance_cross_attn_loss: 0.04196 self_attn_loss: 1.88884 loss: -192.35951]Iterations:  63%|██████▎   | 19/30 [00:27<00:16,  1.50s/it, attack_loss: -194.29031 variance_cross_attn_loss: 0.04196 self_attn_loss: 1.88884 loss: -192.35951]Iterations:  63%|██████▎   | 19/30 [00:28<00:16,  1.50s/it, attack_loss: -199.90652 variance_cross_attn_loss: 0.04181 self_attn_loss: 1.92760 loss: -197.93712]Iterations:  67%|██████▋   | 20/30 [00:28<00:14,  1.48s/it, attack_loss: -199.90652 variance_cross_attn_loss: 0.04181 self_attn_loss: 1.92760 loss: -197.93712]Iterations:  67%|██████▋   | 20/30 [00:29<00:14,  1.48s/it, attack_loss: -206.09219 variance_cross_attn_loss: 0.04138 self_attn_loss: 1.94734 loss: -204.10347]Iterations:  70%|███████   | 21/30 [00:29<00:12,  1.37s/it, attack_loss: -206.09219 variance_cross_attn_loss: 0.04138 self_attn_loss: 1.94734 loss: -204.10347]Iterations:  70%|███████   | 21/30 [00:30<00:12,  1.37s/it, attack_loss: -213.14699 variance_cross_attn_loss: 0.04137 self_attn_loss: 1.93342 loss: -211.17221]Iterations:  73%|███████▎  | 22/30 [00:30<00:10,  1.27s/it, attack_loss: -213.14699 variance_cross_attn_loss: 0.04137 self_attn_loss: 1.93342 loss: -211.17221]Iterations:  73%|███████▎  | 22/30 [00:31<00:10,  1.27s/it, attack_loss: -218.08531 variance_cross_attn_loss: 0.04134 self_attn_loss: 1.93507 loss: -216.10890]Iterations:  77%|███████▋  | 23/30 [00:31<00:08,  1.20s/it, attack_loss: -218.08531 variance_cross_attn_loss: 0.04134 self_attn_loss: 1.93507 loss: -216.10890]Iterations:  77%|███████▋  | 23/30 [00:32<00:08,  1.20s/it, attack_loss: -223.05771 variance_cross_attn_loss: 0.04110 self_attn_loss: 1.94503 loss: -221.07156]Iterations:  80%|████████  | 24/30 [00:33<00:06,  1.15s/it, attack_loss: -223.05771 variance_cross_attn_loss: 0.04110 self_attn_loss: 1.94503 loss: -221.07156]Iterations:  80%|████████  | 24/30 [00:33<00:06,  1.15s/it, attack_loss: -227.29546 variance_cross_attn_loss: 0.04081 self_attn_loss: 1.95109 loss: -225.30357]Iterations:  83%|████████▎ | 25/30 [00:34<00:05,  1.12s/it, attack_loss: -227.29546 variance_cross_attn_loss: 0.04081 self_attn_loss: 1.95109 loss: -225.30357]Iterations:  83%|████████▎ | 25/30 [00:34<00:05,  1.12s/it, attack_loss: -231.21762 variance_cross_attn_loss: 0.04065 self_attn_loss: 1.96302 loss: -229.21394]Iterations:  87%|████████▋ | 26/30 [00:35<00:05,  1.26s/it, attack_loss: -231.21762 variance_cross_attn_loss: 0.04065 self_attn_loss: 1.96302 loss: -229.21394]Iterations:  87%|████████▋ | 26/30 [00:36<00:05,  1.26s/it, attack_loss: -235.53404 variance_cross_attn_loss: 0.04074 self_attn_loss: 1.99165 loss: -233.50165]Iterations:  90%|█████████ | 27/30 [00:37<00:04,  1.38s/it, attack_loss: -235.53404 variance_cross_attn_loss: 0.04074 self_attn_loss: 1.99165 loss: -233.50165]Iterations:  90%|█████████ | 27/30 [00:38<00:04,  1.38s/it, attack_loss: -238.94632 variance_cross_attn_loss: 0.04097 self_attn_loss: 2.02470 loss: -236.88065]Iterations:  93%|█████████▎| 28/30 [00:38<00:02,  1.46s/it, attack_loss: -238.94632 variance_cross_attn_loss: 0.04097 self_attn_loss: 2.02470 loss: -236.88065]Iterations:  93%|█████████▎| 28/30 [00:39<00:02,  1.46s/it, attack_loss: -243.90741 variance_cross_attn_loss: 0.04121 self_attn_loss: 2.02536 loss: -241.84084]Iterations:  97%|█████████▋| 29/30 [00:40<00:01,  1.52s/it, attack_loss: -243.90741 variance_cross_attn_loss: 0.04121 self_attn_loss: 2.02536 loss: -241.84084]Iterations:  97%|█████████▋| 29/30 [00:41<00:01,  1.52s/it, attack_loss: -248.64641 variance_cross_attn_loss: 0.04136 self_attn_loss: 2.03764 loss: -246.56741]Iterations: 100%|██████████| 30/30 [00:42<00:00,  1.49s/it, attack_loss: -248.64641 variance_cross_attn_loss: 0.04136 self_attn_loss: 2.03764 loss: -246.56741]Iterations: 100%|██████████| 30/30 [00:42<00:00,  1.40s/it, attack_loss: -248.64641 variance_cross_attn_loss: 0.04136 self_attn_loss: 2.03764 loss: -246.56741]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([925], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([809], device='cuda:0') tensor(1.0516e-11, device='cuda:0')
L1: [3050.961]	L2: [10.619509]	Linf: [0.32941177]

Accuracy on benign examples: 100.0%
gt_label: 605 pred_label: 605 pred_clean_logit 0.9101880788803101
prompt generate:  iPod  	labels:  [[605]]
decoder:  [49406, 17889, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:00, 18.18it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:01, 13.18it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:00, 13.36it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:00, 13.02it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00, 12.23it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:00<00:00, 12.95it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:01<00:00, 12.34it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00, 12.00it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:01<00:00, 12.64it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 12.63it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:01<00:06,  1.56s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:03<00:05,  1.77s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:05<00:03,  1.97s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:09<00:02,  2.53s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:13<00:00,  3.22s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:13<00:00,  2.70s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -0.03057 variance_cross_attn_loss: 0.16439 self_attn_loss: 0.00000 loss: 0.13382]Iterations:   3%|▎         | 1/30 [00:01<00:44,  1.52s/it, attack_loss: -0.03057 variance_cross_attn_loss: 0.16439 self_attn_loss: 0.00000 loss: 0.13382]Iterations:   3%|▎         | 1/30 [00:02<00:44,  1.52s/it, attack_loss: -3.49744 variance_cross_attn_loss: 0.16170 self_attn_loss: 0.66679 loss: -2.66895]Iterations:   7%|▋         | 2/30 [00:03<00:43,  1.56s/it, attack_loss: -3.49744 variance_cross_attn_loss: 0.16170 self_attn_loss: 0.66679 loss: -2.66895]Iterations:   7%|▋         | 2/30 [00:03<00:43,  1.56s/it, attack_loss: -23.80600 variance_cross_attn_loss: 0.14505 self_attn_loss: 1.56485 loss: -22.09610]Iterations:  10%|█         | 3/30 [00:04<00:42,  1.59s/it, attack_loss: -23.80600 variance_cross_attn_loss: 0.14505 self_attn_loss: 1.56485 loss: -22.09610]Iterations:  10%|█         | 3/30 [00:05<00:42,  1.59s/it, attack_loss: -45.41637 variance_cross_attn_loss: 0.13073 self_attn_loss: 2.02368 loss: -43.26196]Iterations:  13%|█▎        | 4/30 [00:06<00:41,  1.61s/it, attack_loss: -45.41637 variance_cross_attn_loss: 0.13073 self_attn_loss: 2.02368 loss: -43.26196]Iterations:  13%|█▎        | 4/30 [00:07<00:41,  1.61s/it, attack_loss: -72.92476 variance_cross_attn_loss: 0.13026 self_attn_loss: 2.20853 loss: -70.58596]Iterations:  17%|█▋        | 5/30 [00:07<00:39,  1.56s/it, attack_loss: -72.92476 variance_cross_attn_loss: 0.13026 self_attn_loss: 2.20853 loss: -70.58596]Iterations:  17%|█▋        | 5/30 [00:08<00:39,  1.56s/it, attack_loss: -96.99569 variance_cross_attn_loss: 0.12528 self_attn_loss: 1.92318 loss: -94.94724]Iterations:  20%|██        | 6/30 [00:09<00:36,  1.53s/it, attack_loss: -96.99569 variance_cross_attn_loss: 0.12528 self_attn_loss: 1.92318 loss: -94.94724]Iterations:  20%|██        | 6/30 [00:10<00:36,  1.53s/it, attack_loss: -110.11575 variance_cross_attn_loss: 0.12245 self_attn_loss: 2.08423 loss: -107.90907]Iterations:  23%|██▎       | 7/30 [00:10<00:34,  1.52s/it, attack_loss: -110.11575 variance_cross_attn_loss: 0.12245 self_attn_loss: 2.08423 loss: -107.90907]Iterations:  23%|██▎       | 7/30 [00:11<00:34,  1.52s/it, attack_loss: -160.34641 variance_cross_attn_loss: 0.12188 self_attn_loss: 2.37826 loss: -157.84628]Iterations:  27%|██▋       | 8/30 [00:12<00:34,  1.55s/it, attack_loss: -160.34641 variance_cross_attn_loss: 0.12188 self_attn_loss: 2.37826 loss: -157.84628]Iterations:  27%|██▋       | 8/30 [00:13<00:34,  1.55s/it, attack_loss: -199.80820 variance_cross_attn_loss: 0.11980 self_attn_loss: 2.31684 loss: -197.37157]Iterations:  30%|███       | 9/30 [00:14<00:32,  1.57s/it, attack_loss: -199.80820 variance_cross_attn_loss: 0.11980 self_attn_loss: 2.31684 loss: -197.37157]Iterations:  30%|███       | 9/30 [00:14<00:32,  1.57s/it, attack_loss: -216.07874 variance_cross_attn_loss: 0.11020 self_attn_loss: 2.62270 loss: -213.34584]Iterations:  33%|███▎      | 10/30 [00:15<00:31,  1.60s/it, attack_loss: -216.07874 variance_cross_attn_loss: 0.11020 self_attn_loss: 2.62270 loss: -213.34584]Iterations:  33%|███▎      | 10/30 [00:16<00:31,  1.60s/it, attack_loss: -225.43336 variance_cross_attn_loss: 0.10532 self_attn_loss: 2.72617 loss: -222.60187]Iterations:  37%|███▋      | 11/30 [00:17<00:30,  1.61s/it, attack_loss: -225.43336 variance_cross_attn_loss: 0.10532 self_attn_loss: 2.72617 loss: -222.60187]Iterations:  37%|███▋      | 11/30 [00:18<00:30,  1.61s/it, attack_loss: -258.51312 variance_cross_attn_loss: 0.10546 self_attn_loss: 2.73947 loss: -255.66820]Iterations:  40%|████      | 12/30 [00:19<00:29,  1.63s/it, attack_loss: -258.51312 variance_cross_attn_loss: 0.10546 self_attn_loss: 2.73947 loss: -255.66820]Iterations:  40%|████      | 12/30 [00:19<00:29,  1.63s/it, attack_loss: -293.84372 variance_cross_attn_loss: 0.10747 self_attn_loss: 2.67975 loss: -291.05649]Iterations:  43%|████▎     | 13/30 [00:20<00:27,  1.62s/it, attack_loss: -293.84372 variance_cross_attn_loss: 0.10747 self_attn_loss: 2.67975 loss: -291.05649]Iterations:  43%|████▎     | 13/30 [00:21<00:27,  1.62s/it, attack_loss: -309.24011 variance_cross_attn_loss: 0.11191 self_attn_loss: 2.63251 loss: -306.49570]Iterations:  47%|████▋     | 14/30 [00:22<00:26,  1.64s/it, attack_loss: -309.24011 variance_cross_attn_loss: 0.11191 self_attn_loss: 2.63251 loss: -306.49570]Iterations:  47%|████▋     | 14/30 [00:23<00:26,  1.64s/it, attack_loss: -329.89679 variance_cross_attn_loss: 0.11459 self_attn_loss: 2.65536 loss: -327.12683]Iterations:  50%|█████     | 15/30 [00:23<00:24,  1.64s/it, attack_loss: -329.89679 variance_cross_attn_loss: 0.11459 self_attn_loss: 2.65536 loss: -327.12683]Iterations:  50%|█████     | 15/30 [00:24<00:24,  1.64s/it, attack_loss: -360.37082 variance_cross_attn_loss: 0.11625 self_attn_loss: 2.67800 loss: -357.57657]Iterations:  53%|█████▎    | 16/30 [00:25<00:20,  1.47s/it, attack_loss: -360.37082 variance_cross_attn_loss: 0.11625 self_attn_loss: 2.67800 loss: -357.57657]Iterations:  53%|█████▎    | 16/30 [00:25<00:20,  1.47s/it, attack_loss: -395.30484 variance_cross_attn_loss: 0.11617 self_attn_loss: 2.71584 loss: -392.47284]Iterations:  57%|█████▋    | 17/30 [00:26<00:17,  1.34s/it, attack_loss: -395.30484 variance_cross_attn_loss: 0.11617 self_attn_loss: 2.71584 loss: -392.47284]Iterations:  57%|█████▋    | 17/30 [00:26<00:17,  1.34s/it, attack_loss: -421.79044 variance_cross_attn_loss: 0.11628 self_attn_loss: 2.75401 loss: -418.92017]Iterations:  60%|██████    | 18/30 [00:27<00:15,  1.26s/it, attack_loss: -421.79044 variance_cross_attn_loss: 0.11628 self_attn_loss: 2.75401 loss: -418.92017]Iterations:  60%|██████    | 18/30 [00:27<00:15,  1.26s/it, attack_loss: -452.19904 variance_cross_attn_loss: 0.11611 self_attn_loss: 2.77403 loss: -449.30890]Iterations:  63%|██████▎   | 19/30 [00:28<00:13,  1.20s/it, attack_loss: -452.19904 variance_cross_attn_loss: 0.11611 self_attn_loss: 2.77403 loss: -449.30890]Iterations:  63%|██████▎   | 19/30 [00:28<00:13,  1.20s/it, attack_loss: -482.90149 variance_cross_attn_loss: 0.11409 self_attn_loss: 2.84840 loss: -479.93896]Iterations:  67%|██████▋   | 20/30 [00:29<00:11,  1.17s/it, attack_loss: -482.90149 variance_cross_attn_loss: 0.11409 self_attn_loss: 2.84840 loss: -479.93896]Iterations:  67%|██████▋   | 20/30 [00:29<00:11,  1.17s/it, attack_loss: -501.77771 variance_cross_attn_loss: 0.11284 self_attn_loss: 2.90982 loss: -498.75504]Iterations:  70%|███████   | 21/30 [00:30<00:10,  1.15s/it, attack_loss: -501.77771 variance_cross_attn_loss: 0.11284 self_attn_loss: 2.90982 loss: -498.75504]Iterations:  70%|███████   | 21/30 [00:31<00:10,  1.15s/it, attack_loss: -520.86292 variance_cross_attn_loss: 0.11225 self_attn_loss: 2.91577 loss: -517.83490]Iterations:  73%|███████▎  | 22/30 [00:31<00:09,  1.15s/it, attack_loss: -520.86292 variance_cross_attn_loss: 0.11225 self_attn_loss: 2.91577 loss: -517.83490]Iterations:  73%|███████▎  | 22/30 [00:32<00:09,  1.15s/it, attack_loss: -538.72888 variance_cross_attn_loss: 0.11226 self_attn_loss: 2.92874 loss: -535.68793]Iterations:  77%|███████▋  | 23/30 [00:32<00:07,  1.12s/it, attack_loss: -538.72888 variance_cross_attn_loss: 0.11226 self_attn_loss: 2.92874 loss: -535.68793]Iterations:  77%|███████▋  | 23/30 [00:33<00:07,  1.12s/it, attack_loss: -563.48468 variance_cross_attn_loss: 0.11269 self_attn_loss: 2.94531 loss: -560.42670]Iterations:  80%|████████  | 24/30 [00:33<00:06,  1.10s/it, attack_loss: -563.48468 variance_cross_attn_loss: 0.11269 self_attn_loss: 2.94531 loss: -560.42670]Iterations:  80%|████████  | 24/30 [00:34<00:06,  1.10s/it, attack_loss: -588.33545 variance_cross_attn_loss: 0.11263 self_attn_loss: 2.96476 loss: -585.25806]Iterations:  83%|████████▎ | 25/30 [00:34<00:05,  1.08s/it, attack_loss: -588.33545 variance_cross_attn_loss: 0.11263 self_attn_loss: 2.96476 loss: -585.25806]Iterations:  83%|████████▎ | 25/30 [00:35<00:05,  1.08s/it, attack_loss: -612.38684 variance_cross_attn_loss: 0.11219 self_attn_loss: 2.98002 loss: -609.29462]Iterations:  87%|████████▋ | 26/30 [00:36<00:04,  1.19s/it, attack_loss: -612.38684 variance_cross_attn_loss: 0.11219 self_attn_loss: 2.98002 loss: -609.29462]Iterations:  87%|████████▋ | 26/30 [00:36<00:04,  1.19s/it, attack_loss: -636.63324 variance_cross_attn_loss: 0.11176 self_attn_loss: 2.99403 loss: -633.52747]Iterations:  90%|█████████ | 27/30 [00:37<00:03,  1.23s/it, attack_loss: -636.63324 variance_cross_attn_loss: 0.11176 self_attn_loss: 2.99403 loss: -633.52747]Iterations:  90%|█████████ | 27/30 [00:38<00:03,  1.23s/it, attack_loss: -661.80627 variance_cross_attn_loss: 0.11131 self_attn_loss: 3.01097 loss: -658.68396]Iterations:  93%|█████████▎| 28/30 [00:38<00:02,  1.18s/it, attack_loss: -661.80627 variance_cross_attn_loss: 0.11131 self_attn_loss: 3.01097 loss: -658.68396]Iterations:  93%|█████████▎| 28/30 [00:39<00:02,  1.18s/it, attack_loss: -685.11536 variance_cross_attn_loss: 0.11118 self_attn_loss: 3.03386 loss: -681.97028]Iterations:  97%|█████████▋| 29/30 [00:39<00:01,  1.14s/it, attack_loss: -685.11536 variance_cross_attn_loss: 0.11118 self_attn_loss: 3.03386 loss: -681.97028]Iterations:  97%|█████████▋| 29/30 [00:40<00:01,  1.14s/it, attack_loss: -709.95734 variance_cross_attn_loss: 0.11088 self_attn_loss: 3.06040 loss: -706.78601]Iterations: 100%|██████████| 30/30 [00:40<00:00,  1.12s/it, attack_loss: -709.95734 variance_cross_attn_loss: 0.11088 self_attn_loss: 3.06040 loss: -706.78601]Iterations: 100%|██████████| 30/30 [00:40<00:00,  1.36s/it, attack_loss: -709.95734 variance_cross_attn_loss: 0.11088 self_attn_loss: 3.06040 loss: -706.78601]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([419], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([605], device='cuda:0') tensor(1.1776e-32, device='cuda:0')
L1: [3649.647]	L2: [16.122066]	Linf: [0.6627451]

Accuracy on benign examples: 100.0%
gt_label: 94 pred_label: 94 pred_clean_logit 0.629352867603302
prompt generate:  hummingbird  	labels:  [[94]]
decoder:  [49406, 33072, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:01, 13.32it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:01, 13.51it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:01, 12.91it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:00, 12.21it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00, 12.30it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:00<00:00, 12.13it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:01<00:00, 12.57it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00, 11.99it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:01<00:00, 12.16it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 12.27it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:02<00:08,  2.05s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:04<00:07,  2.48s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:08<00:06,  3.03s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:12<00:03,  3.33s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:15<00:00,  3.32s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:15<00:00,  3.12s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -6.34311 variance_cross_attn_loss: 1.92502 self_attn_loss: 0.00000 loss: -4.41809]Iterations:   3%|▎         | 1/30 [00:01<00:41,  1.43s/it, attack_loss: -6.34311 variance_cross_attn_loss: 1.92502 self_attn_loss: 0.00000 loss: -4.41809]Iterations:   3%|▎         | 1/30 [00:02<00:41,  1.43s/it, attack_loss: -19.02145 variance_cross_attn_loss: 1.93659 self_attn_loss: 1.03510 loss: -16.04976]Iterations:   7%|▋         | 2/30 [00:02<00:41,  1.49s/it, attack_loss: -19.02145 variance_cross_attn_loss: 1.93659 self_attn_loss: 1.03510 loss: -16.04976]Iterations:   7%|▋         | 2/30 [00:03<00:41,  1.49s/it, attack_loss: -48.22103 variance_cross_attn_loss: 1.97566 self_attn_loss: 0.83281 loss: -45.41256]Iterations:  10%|█         | 3/30 [00:04<00:40,  1.51s/it, attack_loss: -48.22103 variance_cross_attn_loss: 1.97566 self_attn_loss: 0.83281 loss: -45.41256]Iterations:  10%|█         | 3/30 [00:05<00:40,  1.51s/it, attack_loss: -68.57887 variance_cross_attn_loss: 1.99326 self_attn_loss: 0.83108 loss: -65.75452]Iterations:  13%|█▎        | 4/30 [00:06<00:39,  1.54s/it, attack_loss: -68.57887 variance_cross_attn_loss: 1.99326 self_attn_loss: 0.83108 loss: -65.75452]Iterations:  13%|█▎        | 4/30 [00:06<00:39,  1.54s/it, attack_loss: -86.38815 variance_cross_attn_loss: 1.98201 self_attn_loss: 1.00572 loss: -83.40042]Iterations:  17%|█▋        | 5/30 [00:07<00:36,  1.48s/it, attack_loss: -86.38815 variance_cross_attn_loss: 1.98201 self_attn_loss: 1.00572 loss: -83.40042]Iterations:  17%|█▋        | 5/30 [00:08<00:36,  1.48s/it, attack_loss: -98.81885 variance_cross_attn_loss: 2.01730 self_attn_loss: 1.07732 loss: -95.72423]Iterations:  20%|██        | 6/30 [00:08<00:32,  1.36s/it, attack_loss: -98.81885 variance_cross_attn_loss: 2.01730 self_attn_loss: 1.07732 loss: -95.72423]Iterations:  20%|██        | 6/30 [00:09<00:32,  1.36s/it, attack_loss: -109.24178 variance_cross_attn_loss: 2.01811 self_attn_loss: 1.18025 loss: -106.04343]Iterations:  23%|██▎       | 7/30 [00:09<00:29,  1.26s/it, attack_loss: -109.24178 variance_cross_attn_loss: 2.01811 self_attn_loss: 1.18025 loss: -106.04343]Iterations:  23%|██▎       | 7/30 [00:10<00:29,  1.26s/it, attack_loss: -119.52229 variance_cross_attn_loss: 2.01577 self_attn_loss: 1.27677 loss: -116.22975]Iterations:  27%|██▋       | 8/30 [00:10<00:26,  1.21s/it, attack_loss: -119.52229 variance_cross_attn_loss: 2.01577 self_attn_loss: 1.27677 loss: -116.22975]Iterations:  27%|██▋       | 8/30 [00:11<00:26,  1.21s/it, attack_loss: -129.30228 variance_cross_attn_loss: 2.01115 self_attn_loss: 1.35136 loss: -125.93977]Iterations:  30%|███       | 9/30 [00:11<00:24,  1.17s/it, attack_loss: -129.30228 variance_cross_attn_loss: 2.01115 self_attn_loss: 1.35136 loss: -125.93977]Iterations:  30%|███       | 9/30 [00:12<00:24,  1.17s/it, attack_loss: -137.96854 variance_cross_attn_loss: 1.99760 self_attn_loss: 1.41260 loss: -134.55835]Iterations:  33%|███▎      | 10/30 [00:12<00:23,  1.15s/it, attack_loss: -137.96854 variance_cross_attn_loss: 1.99760 self_attn_loss: 1.41260 loss: -134.55835]Iterations:  33%|███▎      | 10/30 [00:13<00:23,  1.15s/it, attack_loss: -145.51633 variance_cross_attn_loss: 1.99051 self_attn_loss: 1.44387 loss: -142.08194]Iterations:  37%|███▋      | 11/30 [00:14<00:21,  1.13s/it, attack_loss: -145.51633 variance_cross_attn_loss: 1.99051 self_attn_loss: 1.44387 loss: -142.08194]Iterations:  37%|███▋      | 11/30 [00:14<00:21,  1.13s/it, attack_loss: -150.33041 variance_cross_attn_loss: 1.98215 self_attn_loss: 1.43950 loss: -146.90877]Iterations:  40%|████      | 12/30 [00:15<00:20,  1.12s/it, attack_loss: -150.33041 variance_cross_attn_loss: 1.98215 self_attn_loss: 1.43950 loss: -146.90877]Iterations:  40%|████      | 12/30 [00:15<00:20,  1.12s/it, attack_loss: -156.23752 variance_cross_attn_loss: 1.97078 self_attn_loss: 1.45646 loss: -152.81027]Iterations:  43%|████▎     | 13/30 [00:16<00:18,  1.11s/it, attack_loss: -156.23752 variance_cross_attn_loss: 1.97078 self_attn_loss: 1.45646 loss: -152.81027]Iterations:  43%|████▎     | 13/30 [00:16<00:18,  1.11s/it, attack_loss: -162.46454 variance_cross_attn_loss: 1.95418 self_attn_loss: 1.49626 loss: -159.01410]Iterations:  47%|████▋     | 14/30 [00:17<00:17,  1.12s/it, attack_loss: -162.46454 variance_cross_attn_loss: 1.95418 self_attn_loss: 1.49626 loss: -159.01410]Iterations:  47%|████▋     | 14/30 [00:18<00:17,  1.12s/it, attack_loss: -168.03174 variance_cross_attn_loss: 1.93628 self_attn_loss: 1.54973 loss: -164.54573]Iterations:  50%|█████     | 15/30 [00:18<00:17,  1.18s/it, attack_loss: -168.03174 variance_cross_attn_loss: 1.93628 self_attn_loss: 1.54973 loss: -164.54573]Iterations:  50%|█████     | 15/30 [00:19<00:17,  1.18s/it, attack_loss: -173.84789 variance_cross_attn_loss: 1.92795 self_attn_loss: 1.51282 loss: -170.40712]Iterations:  53%|█████▎    | 16/30 [00:19<00:16,  1.18s/it, attack_loss: -173.84789 variance_cross_attn_loss: 1.92795 self_attn_loss: 1.51282 loss: -170.40712]Iterations:  53%|█████▎    | 16/30 [00:20<00:16,  1.18s/it, attack_loss: -178.53815 variance_cross_attn_loss: 1.91658 self_attn_loss: 1.50405 loss: -175.11751]Iterations:  57%|█████▋    | 17/30 [00:20<00:14,  1.14s/it, attack_loss: -178.53815 variance_cross_attn_loss: 1.91658 self_attn_loss: 1.50405 loss: -175.11751]Iterations:  57%|█████▋    | 17/30 [00:21<00:14,  1.14s/it, attack_loss: -184.35245 variance_cross_attn_loss: 1.90282 self_attn_loss: 1.53637 loss: -180.91325]Iterations:  60%|██████    | 18/30 [00:21<00:13,  1.10s/it, attack_loss: -184.35245 variance_cross_attn_loss: 1.90282 self_attn_loss: 1.53637 loss: -180.91325]Iterations:  60%|██████    | 18/30 [00:22<00:13,  1.10s/it, attack_loss: -190.29878 variance_cross_attn_loss: 1.87823 self_attn_loss: 1.70380 loss: -186.71675]Iterations:  63%|██████▎   | 19/30 [00:22<00:12,  1.09s/it, attack_loss: -190.29878 variance_cross_attn_loss: 1.87823 self_attn_loss: 1.70380 loss: -186.71675]Iterations:  63%|██████▎   | 19/30 [00:23<00:12,  1.09s/it, attack_loss: -195.96848 variance_cross_attn_loss: 1.85659 self_attn_loss: 1.63663 loss: -192.47527]Iterations:  67%|██████▋   | 20/30 [00:24<00:10,  1.08s/it, attack_loss: -195.96848 variance_cross_attn_loss: 1.85659 self_attn_loss: 1.63663 loss: -192.47527]Iterations:  67%|██████▋   | 20/30 [00:24<00:10,  1.08s/it, attack_loss: -199.96494 variance_cross_attn_loss: 1.82255 self_attn_loss: 1.78566 loss: -196.35672]Iterations:  70%|███████   | 21/30 [00:25<00:09,  1.09s/it, attack_loss: -199.96494 variance_cross_attn_loss: 1.82255 self_attn_loss: 1.78566 loss: -196.35672]Iterations:  70%|███████   | 21/30 [00:25<00:09,  1.09s/it, attack_loss: -204.76326 variance_cross_attn_loss: 1.80221 self_attn_loss: 1.82400 loss: -201.13704]Iterations:  73%|███████▎  | 22/30 [00:26<00:08,  1.10s/it, attack_loss: -204.76326 variance_cross_attn_loss: 1.80221 self_attn_loss: 1.82400 loss: -201.13704]Iterations:  73%|███████▎  | 22/30 [00:26<00:08,  1.10s/it, attack_loss: -210.45990 variance_cross_attn_loss: 1.79345 self_attn_loss: 1.85746 loss: -206.80901]Iterations:  77%|███████▋  | 23/30 [00:27<00:07,  1.08s/it, attack_loss: -210.45990 variance_cross_attn_loss: 1.79345 self_attn_loss: 1.85746 loss: -206.80901]Iterations:  77%|███████▋  | 23/30 [00:27<00:07,  1.08s/it, attack_loss: -214.82491 variance_cross_attn_loss: 1.78461 self_attn_loss: 1.87087 loss: -211.16943]Iterations:  80%|████████  | 24/30 [00:28<00:06,  1.08s/it, attack_loss: -214.82491 variance_cross_attn_loss: 1.78461 self_attn_loss: 1.87087 loss: -211.16943]Iterations:  80%|████████  | 24/30 [00:28<00:06,  1.08s/it, attack_loss: -219.05954 variance_cross_attn_loss: 1.76396 self_attn_loss: 1.87326 loss: -215.42232]Iterations:  83%|████████▎ | 25/30 [00:29<00:05,  1.09s/it, attack_loss: -219.05954 variance_cross_attn_loss: 1.76396 self_attn_loss: 1.87326 loss: -215.42232]Iterations:  83%|████████▎ | 25/30 [00:30<00:05,  1.09s/it, attack_loss: -223.27460 variance_cross_attn_loss: 1.74871 self_attn_loss: 1.87297 loss: -219.65291]Iterations:  87%|████████▋ | 26/30 [00:30<00:04,  1.09s/it, attack_loss: -223.27460 variance_cross_attn_loss: 1.74871 self_attn_loss: 1.87297 loss: -219.65291]Iterations:  87%|████████▋ | 26/30 [00:31<00:04,  1.09s/it, attack_loss: -227.28233 variance_cross_attn_loss: 1.73857 self_attn_loss: 1.87685 loss: -223.66692]Iterations:  90%|█████████ | 27/30 [00:31<00:03,  1.09s/it, attack_loss: -227.28233 variance_cross_attn_loss: 1.73857 self_attn_loss: 1.87685 loss: -223.66692]Iterations:  90%|█████████ | 27/30 [00:32<00:03,  1.09s/it, attack_loss: -231.65079 variance_cross_attn_loss: 1.72727 self_attn_loss: 1.90157 loss: -228.02194]Iterations:  93%|█████████▎| 28/30 [00:32<00:02,  1.08s/it, attack_loss: -231.65079 variance_cross_attn_loss: 1.72727 self_attn_loss: 1.90157 loss: -228.02194]Iterations:  93%|█████████▎| 28/30 [00:33<00:02,  1.08s/it, attack_loss: -235.51422 variance_cross_attn_loss: 1.71506 self_attn_loss: 1.92554 loss: -231.87363]Iterations:  97%|█████████▋| 29/30 [00:33<00:01,  1.07s/it, attack_loss: -235.51422 variance_cross_attn_loss: 1.71506 self_attn_loss: 1.92554 loss: -231.87363]Iterations:  97%|█████████▋| 29/30 [00:34<00:01,  1.07s/it, attack_loss: -238.88551 variance_cross_attn_loss: 1.70410 self_attn_loss: 1.92449 loss: -235.25693]Iterations: 100%|██████████| 30/30 [00:34<00:00,  1.09s/it, attack_loss: -238.88551 variance_cross_attn_loss: 1.70410 self_attn_loss: 1.92449 loss: -235.25693]Iterations: 100%|██████████| 30/30 [00:34<00:00,  1.16s/it, attack_loss: -238.88551 variance_cross_attn_loss: 1.70410 self_attn_loss: 1.92449 loss: -235.25693]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([95], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([94], device='cuda:0') tensor(2.9401e-11, device='cuda:0')
L1: [4208.93]	L2: [16.755655]	Linf: [0.47450984]

Accuracy on benign examples: 100.0%
gt_label: 777 pred_label: 777 pred_clean_logit 0.9999723434448242
prompt generate:  scabbard  	labels:  [[777]]
decoder:  [49406, 31716, 17514, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:00, 19.05it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:00, 15.03it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:01, 11.59it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:01, 10.34it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00,  9.65it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:01<00:00,  9.34it/s]DDIM_inverse:  68%|██████▊   | 13/19 [00:01<00:00,  9.38it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:01<00:00,  9.00it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:01<00:00,  8.94it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00,  9.05it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:01<00:00,  8.64it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 10.84it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 10.17it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:01<00:06,  1.53s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:03<00:05,  1.72s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:05<00:03,  1.89s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:07<00:02,  2.12s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:10<00:00,  2.39s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:10<00:00,  2.16s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -0.00096 variance_cross_attn_loss: 0.04344 self_attn_loss: 0.00000 loss: 0.04248]Iterations:   3%|▎         | 1/30 [00:01<00:30,  1.05s/it, attack_loss: -0.00096 variance_cross_attn_loss: 0.04344 self_attn_loss: 0.00000 loss: 0.04248]Iterations:   3%|▎         | 1/30 [00:01<00:30,  1.05s/it, attack_loss: -0.09991 variance_cross_attn_loss: 0.04335 self_attn_loss: 0.49426 loss: 0.43770]Iterations:   7%|▋         | 2/30 [00:02<00:29,  1.05s/it, attack_loss: -0.09991 variance_cross_attn_loss: 0.04335 self_attn_loss: 0.49426 loss: 0.43770]Iterations:   7%|▋         | 2/30 [00:02<00:29,  1.05s/it, attack_loss: -6.51510 variance_cross_attn_loss: 0.04367 self_attn_loss: 0.31718 loss: -6.15425]Iterations:  10%|█         | 3/30 [00:03<00:28,  1.06s/it, attack_loss: -6.51510 variance_cross_attn_loss: 0.04367 self_attn_loss: 0.31718 loss: -6.15425]Iterations:  10%|█         | 3/30 [00:03<00:28,  1.06s/it, attack_loss: -22.50773 variance_cross_attn_loss: 0.04368 self_attn_loss: 0.23493 loss: -22.22912]Iterations:  13%|█▎        | 4/30 [00:04<00:26,  1.04s/it, attack_loss: -22.50773 variance_cross_attn_loss: 0.04368 self_attn_loss: 0.23493 loss: -22.22912]Iterations:  13%|█▎        | 4/30 [00:04<00:26,  1.04s/it, attack_loss: -47.66785 variance_cross_attn_loss: 0.04290 self_attn_loss: 0.43596 loss: -47.18899]Iterations:  17%|█▋        | 5/30 [00:05<00:26,  1.04s/it, attack_loss: -47.66785 variance_cross_attn_loss: 0.04290 self_attn_loss: 0.43596 loss: -47.18899]Iterations:  17%|█▋        | 5/30 [00:05<00:26,  1.04s/it, attack_loss: -69.54592 variance_cross_attn_loss: 0.04266 self_attn_loss: 0.53247 loss: -68.97079]Iterations:  20%|██        | 6/30 [00:06<00:24,  1.04s/it, attack_loss: -69.54592 variance_cross_attn_loss: 0.04266 self_attn_loss: 0.53247 loss: -68.97079]Iterations:  20%|██        | 6/30 [00:06<00:24,  1.04s/it, attack_loss: -91.63289 variance_cross_attn_loss: 0.04188 self_attn_loss: 0.47033 loss: -91.12067]Iterations:  23%|██▎       | 7/30 [00:07<00:24,  1.05s/it, attack_loss: -91.63289 variance_cross_attn_loss: 0.04188 self_attn_loss: 0.47033 loss: -91.12067]Iterations:  23%|██▎       | 7/30 [00:07<00:24,  1.05s/it, attack_loss: -117.45918 variance_cross_attn_loss: 0.04137 self_attn_loss: 0.49712 loss: -116.92068]Iterations:  27%|██▋       | 8/30 [00:08<00:23,  1.06s/it, attack_loss: -117.45918 variance_cross_attn_loss: 0.04137 self_attn_loss: 0.49712 loss: -116.92068]Iterations:  27%|██▋       | 8/30 [00:09<00:23,  1.06s/it, attack_loss: -148.72546 variance_cross_attn_loss: 0.04073 self_attn_loss: 0.56533 loss: -148.11940]Iterations:  30%|███       | 9/30 [00:09<00:24,  1.19s/it, attack_loss: -148.72546 variance_cross_attn_loss: 0.04073 self_attn_loss: 0.56533 loss: -148.11940]Iterations:  30%|███       | 9/30 [00:10<00:24,  1.19s/it, attack_loss: -169.82231 variance_cross_attn_loss: 0.04032 self_attn_loss: 0.64460 loss: -169.13737]Iterations:  33%|███▎      | 10/30 [00:11<00:25,  1.25s/it, attack_loss: -169.82231 variance_cross_attn_loss: 0.04032 self_attn_loss: 0.64460 loss: -169.13737]Iterations:  33%|███▎      | 10/30 [00:11<00:25,  1.25s/it, attack_loss: -183.97873 variance_cross_attn_loss: 0.03995 self_attn_loss: 0.71788 loss: -183.22090]Iterations:  37%|███▋      | 11/30 [00:12<00:22,  1.21s/it, attack_loss: -183.97873 variance_cross_attn_loss: 0.03995 self_attn_loss: 0.71788 loss: -183.22090]Iterations:  37%|███▋      | 11/30 [00:12<00:22,  1.21s/it, attack_loss: -199.39651 variance_cross_attn_loss: 0.03995 self_attn_loss: 0.75367 loss: -198.60291]Iterations:  40%|████      | 12/30 [00:13<00:20,  1.15s/it, attack_loss: -199.39651 variance_cross_attn_loss: 0.03995 self_attn_loss: 0.75367 loss: -198.60291]Iterations:  40%|████      | 12/30 [00:13<00:20,  1.15s/it, attack_loss: -213.19489 variance_cross_attn_loss: 0.04010 self_attn_loss: 0.79510 loss: -212.35968]Iterations:  43%|████▎     | 13/30 [00:14<00:18,  1.11s/it, attack_loss: -213.19489 variance_cross_attn_loss: 0.04010 self_attn_loss: 0.79510 loss: -212.35968]Iterations:  43%|████▎     | 13/30 [00:15<00:18,  1.11s/it, attack_loss: -226.77019 variance_cross_attn_loss: 0.03992 self_attn_loss: 0.83138 loss: -225.89890]Iterations:  47%|████▋     | 14/30 [00:15<00:17,  1.11s/it, attack_loss: -226.77019 variance_cross_attn_loss: 0.03992 self_attn_loss: 0.83138 loss: -225.89890]Iterations:  47%|████▋     | 14/30 [00:16<00:17,  1.11s/it, attack_loss: -238.15109 variance_cross_attn_loss: 0.03969 self_attn_loss: 0.85355 loss: -237.25784]Iterations:  50%|█████     | 15/30 [00:16<00:16,  1.10s/it, attack_loss: -238.15109 variance_cross_attn_loss: 0.03969 self_attn_loss: 0.85355 loss: -237.25784]Iterations:  50%|█████     | 15/30 [00:17<00:16,  1.10s/it, attack_loss: -248.92923 variance_cross_attn_loss: 0.03958 self_attn_loss: 0.86926 loss: -248.02039]Iterations:  53%|█████▎    | 16/30 [00:17<00:15,  1.10s/it, attack_loss: -248.92923 variance_cross_attn_loss: 0.03958 self_attn_loss: 0.86926 loss: -248.02039]Iterations:  53%|█████▎    | 16/30 [00:18<00:15,  1.10s/it, attack_loss: -259.84103 variance_cross_attn_loss: 0.03949 self_attn_loss: 0.90495 loss: -258.89661]Iterations:  57%|█████▋    | 17/30 [00:18<00:14,  1.11s/it, attack_loss: -259.84103 variance_cross_attn_loss: 0.03949 self_attn_loss: 0.90495 loss: -258.89661]Iterations:  57%|█████▋    | 17/30 [00:19<00:14,  1.11s/it, attack_loss: -267.44037 variance_cross_attn_loss: 0.03916 self_attn_loss: 1.19476 loss: -266.20645]Iterations:  60%|██████    | 18/30 [00:19<00:13,  1.09s/it, attack_loss: -267.44037 variance_cross_attn_loss: 0.03916 self_attn_loss: 1.19476 loss: -266.20645]Iterations:  60%|██████    | 18/30 [00:20<00:13,  1.09s/it, attack_loss: -278.97498 variance_cross_attn_loss: 0.03892 self_attn_loss: 1.21642 loss: -277.71964]Iterations:  63%|██████▎   | 19/30 [00:20<00:11,  1.08s/it, attack_loss: -278.97498 variance_cross_attn_loss: 0.03892 self_attn_loss: 1.21642 loss: -277.71964]Iterations:  63%|██████▎   | 19/30 [00:21<00:11,  1.08s/it, attack_loss: -290.11914 variance_cross_attn_loss: 0.03853 self_attn_loss: 1.23476 loss: -288.84586]Iterations:  67%|██████▋   | 20/30 [00:22<00:10,  1.08s/it, attack_loss: -290.11914 variance_cross_attn_loss: 0.03853 self_attn_loss: 1.23476 loss: -288.84586]Iterations:  67%|██████▋   | 20/30 [00:22<00:10,  1.08s/it, attack_loss: -300.84503 variance_cross_attn_loss: 0.03814 self_attn_loss: 1.21355 loss: -299.59332]Iterations:  70%|███████   | 21/30 [00:23<00:09,  1.07s/it, attack_loss: -300.84503 variance_cross_attn_loss: 0.03814 self_attn_loss: 1.21355 loss: -299.59332]Iterations:  70%|███████   | 21/30 [00:23<00:09,  1.07s/it, attack_loss: -307.81396 variance_cross_attn_loss: 0.03762 self_attn_loss: 1.26179 loss: -306.51456]Iterations:  73%|███████▎  | 22/30 [00:24<00:08,  1.05s/it, attack_loss: -307.81396 variance_cross_attn_loss: 0.03762 self_attn_loss: 1.26179 loss: -306.51456]Iterations:  73%|███████▎  | 22/30 [00:24<00:08,  1.05s/it, attack_loss: -315.91772 variance_cross_attn_loss: 0.03750 self_attn_loss: 1.25288 loss: -314.62735]Iterations:  77%|███████▋  | 23/30 [00:25<00:07,  1.06s/it, attack_loss: -315.91772 variance_cross_attn_loss: 0.03750 self_attn_loss: 1.25288 loss: -314.62735]Iterations:  77%|███████▋  | 23/30 [00:25<00:07,  1.06s/it, attack_loss: -325.31445 variance_cross_attn_loss: 0.03735 self_attn_loss: 1.28103 loss: -323.99606]Iterations:  80%|████████  | 24/30 [00:26<00:06,  1.08s/it, attack_loss: -325.31445 variance_cross_attn_loss: 0.03735 self_attn_loss: 1.28103 loss: -323.99606]Iterations:  80%|████████  | 24/30 [00:26<00:06,  1.08s/it, attack_loss: -333.66397 variance_cross_attn_loss: 0.03726 self_attn_loss: 1.30365 loss: -332.32306]Iterations:  83%|████████▎ | 25/30 [00:27<00:05,  1.10s/it, attack_loss: -333.66397 variance_cross_attn_loss: 0.03726 self_attn_loss: 1.30365 loss: -332.32306]Iterations:  83%|████████▎ | 25/30 [00:28<00:05,  1.10s/it, attack_loss: -341.44778 variance_cross_attn_loss: 0.03728 self_attn_loss: 1.32107 loss: -340.08945]Iterations:  87%|████████▋ | 26/30 [00:28<00:04,  1.10s/it, attack_loss: -341.44778 variance_cross_attn_loss: 0.03728 self_attn_loss: 1.32107 loss: -340.08945]Iterations:  87%|████████▋ | 26/30 [00:29<00:04,  1.10s/it, attack_loss: -347.14154 variance_cross_attn_loss: 0.03730 self_attn_loss: 1.32468 loss: -345.77957]Iterations:  90%|█████████ | 27/30 [00:29<00:03,  1.09s/it, attack_loss: -347.14154 variance_cross_attn_loss: 0.03730 self_attn_loss: 1.32468 loss: -345.77957]Iterations:  90%|█████████ | 27/30 [00:30<00:03,  1.09s/it, attack_loss: -353.67371 variance_cross_attn_loss: 0.03737 self_attn_loss: 1.33773 loss: -352.29861]Iterations:  93%|█████████▎| 28/30 [00:30<00:02,  1.09s/it, attack_loss: -353.67371 variance_cross_attn_loss: 0.03737 self_attn_loss: 1.33773 loss: -352.29861]Iterations:  93%|█████████▎| 28/30 [00:31<00:02,  1.09s/it, attack_loss: -361.12350 variance_cross_attn_loss: 0.03741 self_attn_loss: 1.35996 loss: -359.72614]Iterations:  97%|█████████▋| 29/30 [00:32<00:01,  1.24s/it, attack_loss: -361.12350 variance_cross_attn_loss: 0.03741 self_attn_loss: 1.35996 loss: -359.72614]Iterations:  97%|█████████▋| 29/30 [00:32<00:01,  1.24s/it, attack_loss: -368.78943 variance_cross_attn_loss: 0.03745 self_attn_loss: 1.39359 loss: -367.35840]Iterations: 100%|██████████| 30/30 [00:33<00:00,  1.20s/it, attack_loss: -368.78943 variance_cross_attn_loss: 0.03745 self_attn_loss: 1.39359 loss: -367.35840]Iterations: 100%|██████████| 30/30 [00:33<00:00,  1.11s/it, attack_loss: -368.78943 variance_cross_attn_loss: 0.03745 self_attn_loss: 1.39359 loss: -367.35840]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([597], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([777], device='cuda:0') tensor(5.3147e-17, device='cuda:0')
L1: [5553.474]	L2: [22.182137]	Linf: [0.7254902]

Accuracy on benign examples: 100.0%
gt_label: 768 pred_label: 768 pred_clean_logit 0.7848653793334961
prompt generate:  rugby ball  	labels:  [[768]]
decoder:  [49406, 4964, 1069, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:01, 12.86it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:01, 13.71it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:01, 12.92it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:00, 12.24it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00, 13.24it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:00<00:00, 12.80it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:01<00:00, 11.79it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00, 12.66it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:01<00:00, 12.09it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 12.69it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:03<00:05,  1.75s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:05<00:03,  1.99s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:08<00:02,  2.17s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:11<00:00,  2.59s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:11<00:00,  2.30s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -1.46238 variance_cross_attn_loss: 0.07892 self_attn_loss: 0.00000 loss: -1.38346]Iterations:   3%|▎         | 1/30 [00:00<00:28,  1.01it/s, attack_loss: -1.46238 variance_cross_attn_loss: 0.07892 self_attn_loss: 0.00000 loss: -1.38346]Iterations:   3%|▎         | 1/30 [00:01<00:28,  1.01it/s, attack_loss: -12.02406 variance_cross_attn_loss: 0.07648 self_attn_loss: 2.01554 loss: -9.93204]Iterations:   7%|▋         | 2/30 [00:02<00:29,  1.06s/it, attack_loss: -12.02406 variance_cross_attn_loss: 0.07648 self_attn_loss: 2.01554 loss: -9.93204]Iterations:   7%|▋         | 2/30 [00:02<00:29,  1.06s/it, attack_loss: -49.65763 variance_cross_attn_loss: 0.07765 self_attn_loss: 2.13400 loss: -47.44598]Iterations:  10%|█         | 3/30 [00:03<00:28,  1.06s/it, attack_loss: -49.65763 variance_cross_attn_loss: 0.07765 self_attn_loss: 2.13400 loss: -47.44598]Iterations:  10%|█         | 3/30 [00:03<00:28,  1.06s/it, attack_loss: -43.05158 variance_cross_attn_loss: 0.07613 self_attn_loss: 2.21361 loss: -40.76185]Iterations:  13%|█▎        | 4/30 [00:04<00:27,  1.06s/it, attack_loss: -43.05158 variance_cross_attn_loss: 0.07613 self_attn_loss: 2.21361 loss: -40.76185]Iterations:  13%|█▎        | 4/30 [00:04<00:27,  1.06s/it, attack_loss: -39.29420 variance_cross_attn_loss: 0.07790 self_attn_loss: 2.41997 loss: -36.79633]Iterations:  17%|█▋        | 5/30 [00:05<00:26,  1.07s/it, attack_loss: -39.29420 variance_cross_attn_loss: 0.07790 self_attn_loss: 2.41997 loss: -36.79633]Iterations:  17%|█▋        | 5/30 [00:05<00:26,  1.07s/it, attack_loss: -68.72714 variance_cross_attn_loss: 0.08152 self_attn_loss: 2.67353 loss: -65.97209]Iterations:  20%|██        | 6/30 [00:06<00:25,  1.08s/it, attack_loss: -68.72714 variance_cross_attn_loss: 0.08152 self_attn_loss: 2.67353 loss: -65.97209]Iterations:  20%|██        | 6/30 [00:06<00:25,  1.08s/it, attack_loss: -86.81474 variance_cross_attn_loss: 0.08342 self_attn_loss: 2.81181 loss: -83.91951]Iterations:  23%|██▎       | 7/30 [00:07<00:24,  1.08s/it, attack_loss: -86.81474 variance_cross_attn_loss: 0.08342 self_attn_loss: 2.81181 loss: -83.91951]Iterations:  23%|██▎       | 7/30 [00:08<00:24,  1.08s/it, attack_loss: -94.76070 variance_cross_attn_loss: 0.08432 self_attn_loss: 2.91419 loss: -91.76218]Iterations:  27%|██▋       | 8/30 [00:08<00:23,  1.07s/it, attack_loss: -94.76070 variance_cross_attn_loss: 0.08432 self_attn_loss: 2.91419 loss: -91.76218]Iterations:  27%|██▋       | 8/30 [00:09<00:23,  1.07s/it, attack_loss: -100.17292 variance_cross_attn_loss: 0.08140 self_attn_loss: 2.97304 loss: -97.11848]Iterations:  30%|███       | 9/30 [00:09<00:22,  1.07s/it, attack_loss: -100.17292 variance_cross_attn_loss: 0.08140 self_attn_loss: 2.97304 loss: -97.11848]Iterations:  30%|███       | 9/30 [00:10<00:22,  1.07s/it, attack_loss: -102.85290 variance_cross_attn_loss: 0.08146 self_attn_loss: 2.87506 loss: -99.89638]Iterations:  33%|███▎      | 10/30 [00:10<00:21,  1.09s/it, attack_loss: -102.85290 variance_cross_attn_loss: 0.08146 self_attn_loss: 2.87506 loss: -99.89638]Iterations:  33%|███▎      | 10/30 [00:11<00:21,  1.09s/it, attack_loss: -122.57014 variance_cross_attn_loss: 0.08197 self_attn_loss: 2.95013 loss: -119.53804]Iterations:  37%|███▋      | 11/30 [00:11<00:20,  1.09s/it, attack_loss: -122.57014 variance_cross_attn_loss: 0.08197 self_attn_loss: 2.95013 loss: -119.53804]Iterations:  37%|███▋      | 11/30 [00:12<00:20,  1.09s/it, attack_loss: -122.57770 variance_cross_attn_loss: 0.08346 self_attn_loss: 3.06422 loss: -119.43002]Iterations:  40%|████      | 12/30 [00:12<00:19,  1.08s/it, attack_loss: -122.57770 variance_cross_attn_loss: 0.08346 self_attn_loss: 3.06422 loss: -119.43002]Iterations:  40%|████      | 12/30 [00:13<00:19,  1.08s/it, attack_loss: -128.55559 variance_cross_attn_loss: 0.08394 self_attn_loss: 2.98340 loss: -125.48825]Iterations:  43%|████▎     | 13/30 [00:13<00:18,  1.07s/it, attack_loss: -128.55559 variance_cross_attn_loss: 0.08394 self_attn_loss: 2.98340 loss: -125.48825]Iterations:  43%|████▎     | 13/30 [00:14<00:18,  1.07s/it, attack_loss: -131.51471 variance_cross_attn_loss: 0.08421 self_attn_loss: 2.96750 loss: -128.46300]Iterations:  47%|████▋     | 14/30 [00:14<00:17,  1.07s/it, attack_loss: -131.51471 variance_cross_attn_loss: 0.08421 self_attn_loss: 2.96750 loss: -128.46300]Iterations:  47%|████▋     | 14/30 [00:15<00:17,  1.07s/it, attack_loss: -136.30675 variance_cross_attn_loss: 0.08480 self_attn_loss: 3.04784 loss: -133.17410]Iterations:  50%|█████     | 15/30 [00:16<00:15,  1.07s/it, attack_loss: -136.30675 variance_cross_attn_loss: 0.08480 self_attn_loss: 3.04784 loss: -133.17410]Iterations:  50%|█████     | 15/30 [00:16<00:15,  1.07s/it, attack_loss: -133.36540 variance_cross_attn_loss: 0.08357 self_attn_loss: 3.38049 loss: -129.90134]Iterations:  53%|█████▎    | 16/30 [00:17<00:15,  1.07s/it, attack_loss: -133.36540 variance_cross_attn_loss: 0.08357 self_attn_loss: 3.38049 loss: -129.90134]Iterations:  53%|█████▎    | 16/30 [00:17<00:15,  1.07s/it, attack_loss: -136.07414 variance_cross_attn_loss: 0.08393 self_attn_loss: 3.45157 loss: -132.53865]Iterations:  57%|█████▋    | 17/30 [00:18<00:13,  1.07s/it, attack_loss: -136.07414 variance_cross_attn_loss: 0.08393 self_attn_loss: 3.45157 loss: -132.53865]Iterations:  57%|█████▋    | 17/30 [00:18<00:13,  1.07s/it, attack_loss: -140.54434 variance_cross_attn_loss: 0.08448 self_attn_loss: 3.38958 loss: -137.07028]Iterations:  60%|██████    | 18/30 [00:19<00:13,  1.10s/it, attack_loss: -140.54434 variance_cross_attn_loss: 0.08448 self_attn_loss: 3.38958 loss: -137.07028]Iterations:  60%|██████    | 18/30 [00:20<00:13,  1.10s/it, attack_loss: -144.05310 variance_cross_attn_loss: 0.08507 self_attn_loss: 3.36551 loss: -140.60252]Iterations:  63%|██████▎   | 19/30 [00:20<00:13,  1.23s/it, attack_loss: -144.05310 variance_cross_attn_loss: 0.08507 self_attn_loss: 3.36551 loss: -140.60252]Iterations:  63%|██████▎   | 19/30 [00:21<00:13,  1.23s/it, attack_loss: -146.11664 variance_cross_attn_loss: 0.08517 self_attn_loss: 3.40397 loss: -142.62750]Iterations:  67%|██████▋   | 20/30 [00:21<00:11,  1.17s/it, attack_loss: -146.11664 variance_cross_attn_loss: 0.08517 self_attn_loss: 3.40397 loss: -142.62750]Iterations:  67%|██████▋   | 20/30 [00:22<00:11,  1.17s/it, attack_loss: -152.94753 variance_cross_attn_loss: 0.08499 self_attn_loss: 3.40036 loss: -149.46217]Iterations:  70%|███████   | 21/30 [00:22<00:10,  1.13s/it, attack_loss: -152.94753 variance_cross_attn_loss: 0.08499 self_attn_loss: 3.40036 loss: -149.46217]Iterations:  70%|███████   | 21/30 [00:23<00:10,  1.13s/it, attack_loss: -160.80609 variance_cross_attn_loss: 0.08514 self_attn_loss: 3.48465 loss: -157.23630]Iterations:  73%|███████▎  | 22/30 [00:24<00:08,  1.10s/it, attack_loss: -160.80609 variance_cross_attn_loss: 0.08514 self_attn_loss: 3.48465 loss: -157.23630]Iterations:  73%|███████▎  | 22/30 [00:24<00:08,  1.10s/it, attack_loss: -166.62534 variance_cross_attn_loss: 0.08575 self_attn_loss: 3.45977 loss: -163.07983]Iterations:  77%|███████▋  | 23/30 [00:25<00:07,  1.10s/it, attack_loss: -166.62534 variance_cross_attn_loss: 0.08575 self_attn_loss: 3.45977 loss: -163.07983]Iterations:  77%|███████▋  | 23/30 [00:25<00:07,  1.10s/it, attack_loss: -170.50964 variance_cross_attn_loss: 0.08550 self_attn_loss: 3.46864 loss: -166.95551]Iterations:  80%|████████  | 24/30 [00:26<00:06,  1.10s/it, attack_loss: -170.50964 variance_cross_attn_loss: 0.08550 self_attn_loss: 3.46864 loss: -166.95551]Iterations:  80%|████████  | 24/30 [00:26<00:06,  1.10s/it, attack_loss: -173.79913 variance_cross_attn_loss: 0.08598 self_attn_loss: 3.40107 loss: -170.31207]Iterations:  83%|████████▎ | 25/30 [00:27<00:05,  1.08s/it, attack_loss: -173.79913 variance_cross_attn_loss: 0.08598 self_attn_loss: 3.40107 loss: -170.31207]Iterations:  83%|████████▎ | 25/30 [00:27<00:05,  1.08s/it, attack_loss: -174.15860 variance_cross_attn_loss: 0.08570 self_attn_loss: 3.38553 loss: -170.68736]Iterations:  87%|████████▋ | 26/30 [00:28<00:04,  1.12s/it, attack_loss: -174.15860 variance_cross_attn_loss: 0.08570 self_attn_loss: 3.38553 loss: -170.68736]Iterations:  87%|████████▋ | 26/30 [00:29<00:04,  1.12s/it, attack_loss: -179.34296 variance_cross_attn_loss: 0.08614 self_attn_loss: 3.57455 loss: -175.68227]Iterations:  90%|█████████ | 27/30 [00:29<00:03,  1.10s/it, attack_loss: -179.34296 variance_cross_attn_loss: 0.08614 self_attn_loss: 3.57455 loss: -175.68227]Iterations:  90%|█████████ | 27/30 [00:30<00:03,  1.10s/it, attack_loss: -183.61636 variance_cross_attn_loss: 0.08560 self_attn_loss: 3.66094 loss: -179.86981]Iterations:  93%|█████████▎| 28/30 [00:30<00:02,  1.09s/it, attack_loss: -183.61636 variance_cross_attn_loss: 0.08560 self_attn_loss: 3.66094 loss: -179.86981]Iterations:  93%|█████████▎| 28/30 [00:31<00:02,  1.09s/it, attack_loss: -182.07793 variance_cross_attn_loss: 0.08393 self_attn_loss: 3.76254 loss: -178.23146]Iterations:  97%|█████████▋| 29/30 [00:31<00:01,  1.10s/it, attack_loss: -182.07793 variance_cross_attn_loss: 0.08393 self_attn_loss: 3.76254 loss: -178.23146]Iterations:  97%|█████████▋| 29/30 [00:32<00:01,  1.10s/it, attack_loss: -188.74223 variance_cross_attn_loss: 0.08406 self_attn_loss: 3.76034 loss: -184.89784]Iterations: 100%|██████████| 30/30 [00:32<00:00,  1.09s/it, attack_loss: -188.74223 variance_cross_attn_loss: 0.08406 self_attn_loss: 3.76034 loss: -184.89784]Iterations: 100%|██████████| 30/30 [00:32<00:00,  1.09s/it, attack_loss: -188.74223 variance_cross_attn_loss: 0.08406 self_attn_loss: 3.76034 loss: -184.89784]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([981], device='cuda:0') tensor(1.0000, device='cuda:0')
after_true: tensor([768], device='cuda:0') tensor(2.7774e-09, device='cuda:0')
L1: [8037.126]	L2: [30.938108]	Linf: [0.9764706]

Accuracy on benign examples: 100.0%
gt_label: 663 pred_label: 663 pred_clean_logit 0.9325855374336243
prompt generate:  monastery  	labels:  [[663]]
decoder:  [49406, 21850, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:00, 18.01it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:01, 13.75it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:00, 14.95it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:00, 13.43it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00, 14.44it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:00<00:00, 13.39it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:00<00:00, 14.06it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00, 13.52it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:01<00:00, 13.70it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 13.68it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:01<00:06,  1.66s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:04<00:07,  2.42s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:07<00:05,  2.84s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:11<00:03,  3.23s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:14<00:00,  3.10s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:14<00:00,  2.93s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -1.76338 variance_cross_attn_loss: 0.01047 self_attn_loss: 0.00000 loss: -1.75291]Iterations:   3%|▎         | 1/30 [00:01<00:29,  1.02s/it, attack_loss: -1.76338 variance_cross_attn_loss: 0.01047 self_attn_loss: 0.00000 loss: -1.75291]Iterations:   3%|▎         | 1/30 [00:01<00:29,  1.02s/it, attack_loss: -23.88057 variance_cross_attn_loss: 0.01009 self_attn_loss: 0.46411 loss: -23.40637]Iterations:   7%|▋         | 2/30 [00:02<00:28,  1.03s/it, attack_loss: -23.88057 variance_cross_attn_loss: 0.01009 self_attn_loss: 0.46411 loss: -23.40637]Iterations:   7%|▋         | 2/30 [00:02<00:28,  1.03s/it, attack_loss: -58.59280 variance_cross_attn_loss: 0.01020 self_attn_loss: 0.59399 loss: -57.98861]Iterations:  10%|█         | 3/30 [00:03<00:28,  1.04s/it, attack_loss: -58.59280 variance_cross_attn_loss: 0.01020 self_attn_loss: 0.59399 loss: -57.98861]Iterations:  10%|█         | 3/30 [00:03<00:28,  1.04s/it, attack_loss: -84.72214 variance_cross_attn_loss: 0.01025 self_attn_loss: 0.74001 loss: -83.97188]Iterations:  13%|█▎        | 4/30 [00:04<00:26,  1.01s/it, attack_loss: -84.72214 variance_cross_attn_loss: 0.01025 self_attn_loss: 0.74001 loss: -83.97188]Iterations:  13%|█▎        | 4/30 [00:04<00:26,  1.01s/it, attack_loss: -102.32355 variance_cross_attn_loss: 0.01019 self_attn_loss: 0.83334 loss: -101.48001]Iterations:  17%|█▋        | 5/30 [00:05<00:28,  1.15s/it, attack_loss: -102.32355 variance_cross_attn_loss: 0.01019 self_attn_loss: 0.83334 loss: -101.48001]Iterations:  17%|█▋        | 5/30 [00:06<00:28,  1.15s/it, attack_loss: -113.71925 variance_cross_attn_loss: 0.01022 self_attn_loss: 0.81028 loss: -112.89874]Iterations:  20%|██        | 6/30 [00:06<00:28,  1.20s/it, attack_loss: -113.71925 variance_cross_attn_loss: 0.01022 self_attn_loss: 0.81028 loss: -112.89874]Iterations:  20%|██        | 6/30 [00:07<00:28,  1.20s/it, attack_loss: -129.32027 variance_cross_attn_loss: 0.01022 self_attn_loss: 0.78686 loss: -128.52318]Iterations:  23%|██▎       | 7/30 [00:07<00:26,  1.16s/it, attack_loss: -129.32027 variance_cross_attn_loss: 0.01022 self_attn_loss: 0.78686 loss: -128.52318]Iterations:  23%|██▎       | 7/30 [00:08<00:26,  1.16s/it, attack_loss: -137.68733 variance_cross_attn_loss: 0.01011 self_attn_loss: 0.72268 loss: -136.95454]Iterations:  27%|██▋       | 8/30 [00:08<00:25,  1.14s/it, attack_loss: -137.68733 variance_cross_attn_loss: 0.01011 self_attn_loss: 0.72268 loss: -136.95454]Iterations:  27%|██▋       | 8/30 [00:09<00:25,  1.14s/it, attack_loss: -149.97772 variance_cross_attn_loss: 0.01007 self_attn_loss: 0.76446 loss: -149.20319]Iterations:  30%|███       | 9/30 [00:10<00:23,  1.13s/it, attack_loss: -149.97772 variance_cross_attn_loss: 0.01007 self_attn_loss: 0.76446 loss: -149.20319]Iterations:  30%|███       | 9/30 [00:10<00:23,  1.13s/it, attack_loss: -161.75865 variance_cross_attn_loss: 0.01009 self_attn_loss: 0.80461 loss: -160.94394]Iterations:  33%|███▎      | 10/30 [00:11<00:22,  1.14s/it, attack_loss: -161.75865 variance_cross_attn_loss: 0.01009 self_attn_loss: 0.80461 loss: -160.94394]Iterations:  33%|███▎      | 10/30 [00:11<00:22,  1.14s/it, attack_loss: -171.00955 variance_cross_attn_loss: 0.01015 self_attn_loss: 0.86578 loss: -170.13362]Iterations:  37%|███▋      | 11/30 [00:12<00:23,  1.25s/it, attack_loss: -171.00955 variance_cross_attn_loss: 0.01015 self_attn_loss: 0.86578 loss: -170.13362]Iterations:  37%|███▋      | 11/30 [00:13<00:23,  1.25s/it, attack_loss: -181.09500 variance_cross_attn_loss: 0.01021 self_attn_loss: 0.89714 loss: -180.18765]Iterations:  40%|████      | 12/30 [00:14<00:24,  1.38s/it, attack_loss: -181.09500 variance_cross_attn_loss: 0.01021 self_attn_loss: 0.89714 loss: -180.18765]Iterations:  40%|████      | 12/30 [00:15<00:24,  1.38s/it, attack_loss: -189.75708 variance_cross_attn_loss: 0.01025 self_attn_loss: 0.92267 loss: -188.82416]Iterations:  43%|████▎     | 13/30 [00:16<00:25,  1.48s/it, attack_loss: -189.75708 variance_cross_attn_loss: 0.01025 self_attn_loss: 0.92267 loss: -188.82416]Iterations:  43%|████▎     | 13/30 [00:17<00:25,  1.48s/it, attack_loss: -197.51752 variance_cross_attn_loss: 0.01029 self_attn_loss: 0.94633 loss: -196.56091]Iterations:  47%|████▋     | 14/30 [00:17<00:24,  1.54s/it, attack_loss: -197.51752 variance_cross_attn_loss: 0.01029 self_attn_loss: 0.94633 loss: -196.56091]Iterations:  47%|████▋     | 14/30 [00:18<00:24,  1.54s/it, attack_loss: -204.54614 variance_cross_attn_loss: 0.01032 self_attn_loss: 0.97344 loss: -203.56238]Iterations:  50%|█████     | 15/30 [00:19<00:22,  1.52s/it, attack_loss: -204.54614 variance_cross_attn_loss: 0.01032 self_attn_loss: 0.97344 loss: -203.56238]Iterations:  50%|█████     | 15/30 [00:20<00:22,  1.52s/it, attack_loss: -211.38626 variance_cross_attn_loss: 0.01035 self_attn_loss: 1.00133 loss: -210.37459]Iterations:  53%|█████▎    | 16/30 [00:20<00:21,  1.52s/it, attack_loss: -211.38626 variance_cross_attn_loss: 0.01035 self_attn_loss: 1.00133 loss: -210.37459]Iterations:  53%|█████▎    | 16/30 [00:21<00:21,  1.52s/it, attack_loss: -217.90558 variance_cross_attn_loss: 0.01038 self_attn_loss: 1.02402 loss: -216.87119]Iterations:  57%|█████▋    | 17/30 [00:22<00:19,  1.49s/it, attack_loss: -217.90558 variance_cross_attn_loss: 0.01038 self_attn_loss: 1.02402 loss: -216.87119]Iterations:  57%|█████▋    | 17/30 [00:22<00:19,  1.49s/it, attack_loss: -224.30835 variance_cross_attn_loss: 0.01035 self_attn_loss: 1.04342 loss: -223.25458]Iterations:  60%|██████    | 18/30 [00:23<00:17,  1.49s/it, attack_loss: -224.30835 variance_cross_attn_loss: 0.01035 self_attn_loss: 1.04342 loss: -223.25458]Iterations:  60%|██████    | 18/30 [00:24<00:17,  1.49s/it, attack_loss: -230.47131 variance_cross_attn_loss: 0.01032 self_attn_loss: 1.05984 loss: -229.40115]Iterations:  63%|██████▎   | 19/30 [00:25<00:16,  1.50s/it, attack_loss: -230.47131 variance_cross_attn_loss: 0.01032 self_attn_loss: 1.05984 loss: -229.40115]Iterations:  63%|██████▎   | 19/30 [00:25<00:16,  1.50s/it, attack_loss: -235.79643 variance_cross_attn_loss: 0.01029 self_attn_loss: 1.07958 loss: -234.70657]Iterations:  67%|██████▋   | 20/30 [00:26<00:13,  1.36s/it, attack_loss: -235.79643 variance_cross_attn_loss: 0.01029 self_attn_loss: 1.07958 loss: -234.70657]Iterations:  67%|██████▋   | 20/30 [00:26<00:13,  1.36s/it, attack_loss: -241.89084 variance_cross_attn_loss: 0.01025 self_attn_loss: 1.09921 loss: -240.78137]Iterations:  70%|███████   | 21/30 [00:27<00:11,  1.26s/it, attack_loss: -241.89084 variance_cross_attn_loss: 0.01025 self_attn_loss: 1.09921 loss: -240.78137]Iterations:  70%|███████   | 21/30 [00:27<00:11,  1.26s/it, attack_loss: -248.78233 variance_cross_attn_loss: 0.01027 self_attn_loss: 1.11100 loss: -247.66107]Iterations:  73%|███████▎  | 22/30 [00:28<00:09,  1.18s/it, attack_loss: -248.78233 variance_cross_attn_loss: 0.01027 self_attn_loss: 1.11100 loss: -247.66107]Iterations:  73%|███████▎  | 22/30 [00:28<00:09,  1.18s/it, attack_loss: -253.51546 variance_cross_attn_loss: 0.01028 self_attn_loss: 1.12190 loss: -252.38327]Iterations:  77%|███████▋  | 23/30 [00:29<00:07,  1.14s/it, attack_loss: -253.51546 variance_cross_attn_loss: 0.01028 self_attn_loss: 1.12190 loss: -252.38327]Iterations:  77%|███████▋  | 23/30 [00:29<00:07,  1.14s/it, attack_loss: -258.50391 variance_cross_attn_loss: 0.01027 self_attn_loss: 1.13841 loss: -257.35522]Iterations:  80%|████████  | 24/30 [00:30<00:06,  1.09s/it, attack_loss: -258.50391 variance_cross_attn_loss: 0.01027 self_attn_loss: 1.13841 loss: -257.35522]Iterations:  80%|████████  | 24/30 [00:30<00:06,  1.09s/it, attack_loss: -263.75644 variance_cross_attn_loss: 0.01026 self_attn_loss: 1.15964 loss: -262.58655]Iterations:  83%|████████▎ | 25/30 [00:31<00:05,  1.10s/it, attack_loss: -263.75644 variance_cross_attn_loss: 0.01026 self_attn_loss: 1.15964 loss: -262.58655]Iterations:  83%|████████▎ | 25/30 [00:32<00:05,  1.10s/it, attack_loss: -269.17871 variance_cross_attn_loss: 0.01027 self_attn_loss: 1.16796 loss: -268.00046]Iterations:  87%|████████▋ | 26/30 [00:33<00:05,  1.26s/it, attack_loss: -269.17871 variance_cross_attn_loss: 0.01027 self_attn_loss: 1.16796 loss: -268.00046]Iterations:  87%|████████▋ | 26/30 [00:33<00:05,  1.26s/it, attack_loss: -272.94589 variance_cross_attn_loss: 0.01030 self_attn_loss: 1.17112 loss: -271.76450]Iterations:  90%|█████████ | 27/30 [00:34<00:04,  1.37s/it, attack_loss: -272.94589 variance_cross_attn_loss: 0.01030 self_attn_loss: 1.17112 loss: -271.76450]Iterations:  90%|█████████ | 27/30 [00:35<00:04,  1.37s/it, attack_loss: -278.02496 variance_cross_attn_loss: 0.01027 self_attn_loss: 1.18482 loss: -276.82986]Iterations:  93%|█████████▎| 28/30 [00:35<00:02,  1.26s/it, attack_loss: -278.02496 variance_cross_attn_loss: 0.01027 self_attn_loss: 1.18482 loss: -276.82986]Iterations:  93%|█████████▎| 28/30 [00:36<00:02,  1.26s/it, attack_loss: -283.34708 variance_cross_attn_loss: 0.01022 self_attn_loss: 1.20289 loss: -282.13397]Iterations:  97%|█████████▋| 29/30 [00:36<00:01,  1.22s/it, attack_loss: -283.34708 variance_cross_attn_loss: 0.01022 self_attn_loss: 1.20289 loss: -282.13397]Iterations:  97%|█████████▋| 29/30 [00:37<00:01,  1.22s/it, attack_loss: -288.51767 variance_cross_attn_loss: 0.01015 self_attn_loss: 1.20773 loss: -287.29977]Iterations: 100%|██████████| 30/30 [00:37<00:00,  1.16s/it, attack_loss: -288.51767 variance_cross_attn_loss: 0.01015 self_attn_loss: 1.20773 loss: -287.29977]Iterations: 100%|██████████| 30/30 [00:37<00:00,  1.26s/it, attack_loss: -288.51767 variance_cross_attn_loss: 0.01015 self_attn_loss: 1.20773 loss: -287.29977]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([497], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([663], device='cuda:0') tensor(1.9803e-13, device='cuda:0')
L1: [9330.96]	L2: [37.857876]	Linf: [0.8156863]

Accuracy on benign examples: 100.0%
gt_label: 717 pred_label: 717 pred_clean_logit 0.9781484603881836
prompt generate:  pickup  	labels:  [[717]]
decoder:  [49406, 15382, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:01, 15.22it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:01, 14.93it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:00, 14.16it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:00, 15.14it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00, 15.83it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:00<00:00, 16.13it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:00<00:00, 15.32it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00, 11.70it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:01<00:00, 10.95it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 13.09it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:01<00:06,  1.64s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:03<00:04,  1.54s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:04<00:03,  1.60s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:07<00:02,  2.03s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:12<00:00,  2.95s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:12<00:00,  2.41s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -0.00574 variance_cross_attn_loss: 0.01823 self_attn_loss: 0.00000 loss: 0.01249]Iterations:   3%|▎         | 1/30 [00:01<00:46,  1.59s/it, attack_loss: -0.00574 variance_cross_attn_loss: 0.01823 self_attn_loss: 0.00000 loss: 0.01249]Iterations:   3%|▎         | 1/30 [00:02<00:46,  1.59s/it, attack_loss: -3.07188 variance_cross_attn_loss: 0.01806 self_attn_loss: 0.16122 loss: -2.89260]Iterations:   7%|▋         | 2/30 [00:03<00:45,  1.64s/it, attack_loss: -3.07188 variance_cross_attn_loss: 0.01806 self_attn_loss: 0.16122 loss: -2.89260]Iterations:   7%|▋         | 2/30 [00:04<00:45,  1.64s/it, attack_loss: -23.63963 variance_cross_attn_loss: 0.01868 self_attn_loss: 0.40823 loss: -23.21272]Iterations:  10%|█         | 3/30 [00:04<00:44,  1.65s/it, attack_loss: -23.63963 variance_cross_attn_loss: 0.01868 self_attn_loss: 0.40823 loss: -23.21272]Iterations:  10%|█         | 3/30 [00:05<00:44,  1.65s/it, attack_loss: -66.31699 variance_cross_attn_loss: 0.01908 self_attn_loss: 0.54341 loss: -65.75450]Iterations:  13%|█▎        | 4/30 [00:06<00:43,  1.66s/it, attack_loss: -66.31699 variance_cross_attn_loss: 0.01908 self_attn_loss: 0.54341 loss: -65.75450]Iterations:  13%|█▎        | 4/30 [00:07<00:43,  1.66s/it, attack_loss: -98.97843 variance_cross_attn_loss: 0.01905 self_attn_loss: 0.60192 loss: -98.35747]Iterations:  17%|█▋        | 5/30 [00:08<00:42,  1.68s/it, attack_loss: -98.97843 variance_cross_attn_loss: 0.01905 self_attn_loss: 0.60192 loss: -98.35747]Iterations:  17%|█▋        | 5/30 [00:09<00:42,  1.68s/it, attack_loss: -127.91589 variance_cross_attn_loss: 0.01901 self_attn_loss: 0.67185 loss: -127.22504]Iterations:  20%|██        | 6/30 [00:09<00:40,  1.68s/it, attack_loss: -127.91589 variance_cross_attn_loss: 0.01901 self_attn_loss: 0.67185 loss: -127.22504]Iterations:  20%|██        | 6/30 [00:10<00:40,  1.68s/it, attack_loss: -151.20352 variance_cross_attn_loss: 0.01908 self_attn_loss: 0.72548 loss: -150.45895]Iterations:  23%|██▎       | 7/30 [00:11<00:39,  1.70s/it, attack_loss: -151.20352 variance_cross_attn_loss: 0.01908 self_attn_loss: 0.72548 loss: -150.45895]Iterations:  23%|██▎       | 7/30 [00:12<00:39,  1.70s/it, attack_loss: -166.46695 variance_cross_attn_loss: 0.01922 self_attn_loss: 0.73718 loss: -165.71056]Iterations:  27%|██▋       | 8/30 [00:12<00:33,  1.54s/it, attack_loss: -166.46695 variance_cross_attn_loss: 0.01922 self_attn_loss: 0.73718 loss: -165.71056]Iterations:  27%|██▋       | 8/30 [00:13<00:33,  1.54s/it, attack_loss: -178.12346 variance_cross_attn_loss: 0.01938 self_attn_loss: 0.74970 loss: -177.35439]Iterations:  30%|███       | 9/30 [00:14<00:29,  1.39s/it, attack_loss: -178.12346 variance_cross_attn_loss: 0.01938 self_attn_loss: 0.74970 loss: -177.35439]Iterations:  30%|███       | 9/30 [00:14<00:29,  1.39s/it, attack_loss: -189.93675 variance_cross_attn_loss: 0.01957 self_attn_loss: 0.76718 loss: -189.15001]Iterations:  33%|███▎      | 10/30 [00:15<00:26,  1.30s/it, attack_loss: -189.93675 variance_cross_attn_loss: 0.01957 self_attn_loss: 0.76718 loss: -189.15001]Iterations:  33%|███▎      | 10/30 [00:15<00:26,  1.30s/it, attack_loss: -201.78357 variance_cross_attn_loss: 0.01973 self_attn_loss: 0.78333 loss: -200.98051]Iterations:  37%|███▋      | 11/30 [00:16<00:23,  1.26s/it, attack_loss: -201.78357 variance_cross_attn_loss: 0.01973 self_attn_loss: 0.78333 loss: -200.98051]Iterations:  37%|███▋      | 11/30 [00:16<00:23,  1.26s/it, attack_loss: -212.47903 variance_cross_attn_loss: 0.01983 self_attn_loss: 0.79937 loss: -211.65985]Iterations:  40%|████      | 12/30 [00:17<00:21,  1.22s/it, attack_loss: -212.47903 variance_cross_attn_loss: 0.01983 self_attn_loss: 0.79937 loss: -211.65985]Iterations:  40%|████      | 12/30 [00:18<00:21,  1.22s/it, attack_loss: -222.66579 variance_cross_attn_loss: 0.01993 self_attn_loss: 0.81460 loss: -221.83127]Iterations:  43%|████▎     | 13/30 [00:18<00:20,  1.20s/it, attack_loss: -222.66579 variance_cross_attn_loss: 0.01993 self_attn_loss: 0.81460 loss: -221.83127]Iterations:  43%|████▎     | 13/30 [00:19<00:20,  1.20s/it, attack_loss: -231.36543 variance_cross_attn_loss: 0.02004 self_attn_loss: 0.82994 loss: -230.51546]Iterations:  47%|████▋     | 14/30 [00:19<00:18,  1.18s/it, attack_loss: -231.36543 variance_cross_attn_loss: 0.02004 self_attn_loss: 0.82994 loss: -230.51546]Iterations:  47%|████▋     | 14/30 [00:20<00:18,  1.18s/it, attack_loss: -239.06354 variance_cross_attn_loss: 0.02011 self_attn_loss: 0.84772 loss: -238.19571]Iterations:  50%|█████     | 15/30 [00:20<00:17,  1.15s/it, attack_loss: -239.06354 variance_cross_attn_loss: 0.02011 self_attn_loss: 0.84772 loss: -238.19571]Iterations:  50%|█████     | 15/30 [00:21<00:17,  1.15s/it, attack_loss: -245.52351 variance_cross_attn_loss: 0.02018 self_attn_loss: 0.86583 loss: -244.63751]Iterations:  53%|█████▎    | 16/30 [00:21<00:16,  1.15s/it, attack_loss: -245.52351 variance_cross_attn_loss: 0.02018 self_attn_loss: 0.86583 loss: -244.63751]Iterations:  53%|█████▎    | 16/30 [00:22<00:16,  1.15s/it, attack_loss: -251.26706 variance_cross_attn_loss: 0.02021 self_attn_loss: 0.88522 loss: -250.36163]Iterations:  57%|█████▋    | 17/30 [00:23<00:15,  1.21s/it, attack_loss: -251.26706 variance_cross_attn_loss: 0.02021 self_attn_loss: 0.88522 loss: -250.36163]Iterations:  57%|█████▋    | 17/30 [00:24<00:15,  1.21s/it, attack_loss: -256.87332 variance_cross_attn_loss: 0.02024 self_attn_loss: 0.90341 loss: -255.94966]Iterations:  60%|██████    | 18/30 [00:24<00:15,  1.32s/it, attack_loss: -256.87332 variance_cross_attn_loss: 0.02024 self_attn_loss: 0.90341 loss: -255.94966]Iterations:  60%|██████    | 18/30 [00:25<00:15,  1.32s/it, attack_loss: -262.92316 variance_cross_attn_loss: 0.02027 self_attn_loss: 0.92004 loss: -261.98285]Iterations:  63%|██████▎   | 19/30 [00:26<00:15,  1.37s/it, attack_loss: -262.92316 variance_cross_attn_loss: 0.02027 self_attn_loss: 0.92004 loss: -261.98285]Iterations:  63%|██████▎   | 19/30 [00:26<00:15,  1.37s/it, attack_loss: -267.87695 variance_cross_attn_loss: 0.02031 self_attn_loss: 0.93388 loss: -266.92279]Iterations:  67%|██████▋   | 20/30 [00:27<00:12,  1.23s/it, attack_loss: -267.87695 variance_cross_attn_loss: 0.02031 self_attn_loss: 0.93388 loss: -266.92279]Iterations:  67%|██████▋   | 20/30 [00:27<00:12,  1.23s/it, attack_loss: -272.80490 variance_cross_attn_loss: 0.02035 self_attn_loss: 0.94490 loss: -271.83966]Iterations:  70%|███████   | 21/30 [00:28<00:10,  1.14s/it, attack_loss: -272.80490 variance_cross_attn_loss: 0.02035 self_attn_loss: 0.94490 loss: -271.83966]Iterations:  70%|███████   | 21/30 [00:28<00:10,  1.14s/it, attack_loss: -277.29221 variance_cross_attn_loss: 0.02042 self_attn_loss: 0.95170 loss: -276.32010]Iterations:  73%|███████▎  | 22/30 [00:29<00:08,  1.09s/it, attack_loss: -277.29221 variance_cross_attn_loss: 0.02042 self_attn_loss: 0.95170 loss: -276.32010]Iterations:  73%|███████▎  | 22/30 [00:29<00:08,  1.09s/it, attack_loss: -280.44193 variance_cross_attn_loss: 0.02047 self_attn_loss: 0.95862 loss: -279.46283]Iterations:  77%|███████▋  | 23/30 [00:30<00:07,  1.11s/it, attack_loss: -280.44193 variance_cross_attn_loss: 0.02047 self_attn_loss: 0.95862 loss: -279.46283]Iterations:  77%|███████▋  | 23/30 [00:30<00:07,  1.11s/it, attack_loss: -284.11536 variance_cross_attn_loss: 0.02050 self_attn_loss: 0.96836 loss: -283.12650]Iterations:  80%|████████  | 24/30 [00:31<00:06,  1.12s/it, attack_loss: -284.11536 variance_cross_attn_loss: 0.02050 self_attn_loss: 0.96836 loss: -283.12650]Iterations:  80%|████████  | 24/30 [00:32<00:06,  1.12s/it, attack_loss: -288.24725 variance_cross_attn_loss: 0.02046 self_attn_loss: 0.98155 loss: -287.24524]Iterations:  83%|████████▎ | 25/30 [00:32<00:05,  1.12s/it, attack_loss: -288.24725 variance_cross_attn_loss: 0.02046 self_attn_loss: 0.98155 loss: -287.24524]Iterations:  83%|████████▎ | 25/30 [00:33<00:05,  1.12s/it, attack_loss: -292.42007 variance_cross_attn_loss: 0.02041 self_attn_loss: 0.99641 loss: -291.40326]Iterations:  87%|████████▋ | 26/30 [00:33<00:04,  1.10s/it, attack_loss: -292.42007 variance_cross_attn_loss: 0.02041 self_attn_loss: 0.99641 loss: -291.40326]Iterations:  87%|████████▋ | 26/30 [00:34<00:04,  1.10s/it, attack_loss: -295.78223 variance_cross_attn_loss: 0.02034 self_attn_loss: 1.01043 loss: -294.75143]Iterations:  90%|█████████ | 27/30 [00:34<00:03,  1.10s/it, attack_loss: -295.78223 variance_cross_attn_loss: 0.02034 self_attn_loss: 1.01043 loss: -294.75143]Iterations:  90%|█████████ | 27/30 [00:35<00:03,  1.10s/it, attack_loss: -299.04648 variance_cross_attn_loss: 0.02032 self_attn_loss: 1.02236 loss: -298.00378]Iterations:  93%|█████████▎| 28/30 [00:35<00:02,  1.09s/it, attack_loss: -299.04648 variance_cross_attn_loss: 0.02032 self_attn_loss: 1.02236 loss: -298.00378]Iterations:  93%|█████████▎| 28/30 [00:36<00:02,  1.09s/it, attack_loss: -303.19128 variance_cross_attn_loss: 0.02032 self_attn_loss: 1.03331 loss: -302.13766]Iterations:  97%|█████████▋| 29/30 [00:36<00:01,  1.11s/it, attack_loss: -303.19128 variance_cross_attn_loss: 0.02032 self_attn_loss: 1.03331 loss: -302.13766]Iterations:  97%|█████████▋| 29/30 [00:37<00:01,  1.11s/it, attack_loss: -307.72769 variance_cross_attn_loss: 0.02037 self_attn_loss: 1.04524 loss: -306.66211]Iterations: 100%|██████████| 30/30 [00:38<00:00,  1.28s/it, attack_loss: -307.72769 variance_cross_attn_loss: 0.02037 self_attn_loss: 1.04524 loss: -306.66211]Iterations: 100%|██████████| 30/30 [00:38<00:00,  1.29s/it, attack_loss: -307.72769 variance_cross_attn_loss: 0.02037 self_attn_loss: 1.04524 loss: -306.66211]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([468], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([717], device='cuda:0') tensor(3.0066e-14, device='cuda:0')
L1: [7852.7534]	L2: [34.453175]	Linf: [0.8901961]

Accuracy on benign examples: 100.0%
gt_label: 671 pred_label: 671 pred_clean_logit 0.9998377561569214
prompt generate:  mountain bike  	labels:  [[671]]
decoder:  [49406, 3965, 3701, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:01, 15.66it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:01, 12.75it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:00, 13.40it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:00, 12.00it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00, 13.73it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:00<00:00, 12.37it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:01<00:00, 11.63it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00, 11.97it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:01<00:00, 11.76it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 12.31it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:01<00:07,  2.00s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:04<00:06,  2.09s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:06<00:04,  2.18s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:09<00:02,  2.35s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:11<00:00,  2.55s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:11<00:00,  2.39s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -0.00287 variance_cross_attn_loss: 0.13533 self_attn_loss: 0.00000 loss: 0.13246]Iterations:   3%|▎         | 1/30 [00:01<00:29,  1.01s/it, attack_loss: -0.00287 variance_cross_attn_loss: 0.13533 self_attn_loss: 0.00000 loss: 0.13246]Iterations:   3%|▎         | 1/30 [00:01<00:29,  1.01s/it, attack_loss: -0.16442 variance_cross_attn_loss: 0.13714 self_attn_loss: 1.07439 loss: 1.04711]Iterations:   7%|▋         | 2/30 [00:02<00:29,  1.05s/it, attack_loss: -0.16442 variance_cross_attn_loss: 0.13714 self_attn_loss: 1.07439 loss: 1.04711]Iterations:   7%|▋         | 2/30 [00:02<00:29,  1.05s/it, attack_loss: -2.21153 variance_cross_attn_loss: 0.13717 self_attn_loss: 1.04323 loss: -1.03113]Iterations:  10%|█         | 3/30 [00:03<00:29,  1.08s/it, attack_loss: -2.21153 variance_cross_attn_loss: 0.13717 self_attn_loss: 1.04323 loss: -1.03113]Iterations:  10%|█         | 3/30 [00:03<00:29,  1.08s/it, attack_loss: -16.94393 variance_cross_attn_loss: 0.14188 self_attn_loss: 1.11658 loss: -15.68547]Iterations:  13%|█▎        | 4/30 [00:04<00:28,  1.11s/it, attack_loss: -16.94393 variance_cross_attn_loss: 0.14188 self_attn_loss: 1.11658 loss: -15.68547]Iterations:  13%|█▎        | 4/30 [00:04<00:28,  1.11s/it, attack_loss: -34.04526 variance_cross_attn_loss: 0.13811 self_attn_loss: 1.36746 loss: -32.53970]Iterations:  17%|█▋        | 5/30 [00:05<00:28,  1.13s/it, attack_loss: -34.04526 variance_cross_attn_loss: 0.13811 self_attn_loss: 1.36746 loss: -32.53970]Iterations:  17%|█▋        | 5/30 [00:06<00:28,  1.13s/it, attack_loss: -50.92951 variance_cross_attn_loss: 0.13481 self_attn_loss: 1.66544 loss: -49.12926]Iterations:  20%|██        | 6/30 [00:06<00:27,  1.13s/it, attack_loss: -50.92951 variance_cross_attn_loss: 0.13481 self_attn_loss: 1.66544 loss: -49.12926]Iterations:  20%|██        | 6/30 [00:07<00:27,  1.13s/it, attack_loss: -72.14159 variance_cross_attn_loss: 0.13466 self_attn_loss: 1.66791 loss: -70.33901]Iterations:  23%|██▎       | 7/30 [00:07<00:25,  1.12s/it, attack_loss: -72.14159 variance_cross_attn_loss: 0.13466 self_attn_loss: 1.66791 loss: -70.33901]Iterations:  23%|██▎       | 7/30 [00:08<00:25,  1.12s/it, attack_loss: -95.18800 variance_cross_attn_loss: 0.13774 self_attn_loss: 1.65021 loss: -93.40005]Iterations:  27%|██▋       | 8/30 [00:08<00:24,  1.11s/it, attack_loss: -95.18800 variance_cross_attn_loss: 0.13774 self_attn_loss: 1.65021 loss: -93.40005]Iterations:  27%|██▋       | 8/30 [00:09<00:24,  1.11s/it, attack_loss: -116.62971 variance_cross_attn_loss: 0.13797 self_attn_loss: 1.76927 loss: -114.72248]Iterations:  30%|███       | 9/30 [00:09<00:23,  1.11s/it, attack_loss: -116.62971 variance_cross_attn_loss: 0.13797 self_attn_loss: 1.76927 loss: -114.72248]Iterations:  30%|███       | 9/30 [00:10<00:23,  1.11s/it, attack_loss: -134.12677 variance_cross_attn_loss: 0.13807 self_attn_loss: 1.84776 loss: -132.14093]Iterations:  33%|███▎      | 10/30 [00:11<00:22,  1.10s/it, attack_loss: -134.12677 variance_cross_attn_loss: 0.13807 self_attn_loss: 1.84776 loss: -132.14093]Iterations:  33%|███▎      | 10/30 [00:11<00:22,  1.10s/it, attack_loss: -153.49455 variance_cross_attn_loss: 0.13855 self_attn_loss: 1.86466 loss: -151.49135]Iterations:  37%|███▋      | 11/30 [00:12<00:22,  1.18s/it, attack_loss: -153.49455 variance_cross_attn_loss: 0.13855 self_attn_loss: 1.86466 loss: -151.49135]Iterations:  37%|███▋      | 11/30 [00:13<00:22,  1.18s/it, attack_loss: -174.00726 variance_cross_attn_loss: 0.13909 self_attn_loss: 1.84964 loss: -172.01854]Iterations:  40%|████      | 12/30 [00:13<00:22,  1.27s/it, attack_loss: -174.00726 variance_cross_attn_loss: 0.13909 self_attn_loss: 1.84964 loss: -172.01854]Iterations:  40%|████      | 12/30 [00:14<00:22,  1.27s/it, attack_loss: -191.82808 variance_cross_attn_loss: 0.13885 self_attn_loss: 1.88668 loss: -189.80255]Iterations:  43%|████▎     | 13/30 [00:14<00:20,  1.22s/it, attack_loss: -191.82808 variance_cross_attn_loss: 0.13885 self_attn_loss: 1.88668 loss: -189.80255]Iterations:  43%|████▎     | 13/30 [00:15<00:20,  1.22s/it, attack_loss: -210.48795 variance_cross_attn_loss: 0.13869 self_attn_loss: 1.90423 loss: -208.44502]Iterations:  47%|████▋     | 14/30 [00:16<00:18,  1.18s/it, attack_loss: -210.48795 variance_cross_attn_loss: 0.13869 self_attn_loss: 1.90423 loss: -208.44502]Iterations:  47%|████▋     | 14/30 [00:16<00:18,  1.18s/it, attack_loss: -226.02762 variance_cross_attn_loss: 0.13866 self_attn_loss: 1.89807 loss: -223.99089]Iterations:  50%|█████     | 15/30 [00:17<00:17,  1.14s/it, attack_loss: -226.02762 variance_cross_attn_loss: 0.13866 self_attn_loss: 1.89807 loss: -223.99089]Iterations:  50%|█████     | 15/30 [00:17<00:17,  1.14s/it, attack_loss: -241.92345 variance_cross_attn_loss: 0.13800 self_attn_loss: 1.95968 loss: -239.82576]Iterations:  53%|█████▎    | 16/30 [00:18<00:15,  1.11s/it, attack_loss: -241.92345 variance_cross_attn_loss: 0.13800 self_attn_loss: 1.95968 loss: -239.82576]Iterations:  53%|█████▎    | 16/30 [00:18<00:15,  1.11s/it, attack_loss: -254.57941 variance_cross_attn_loss: 0.13782 self_attn_loss: 1.97839 loss: -252.46320]Iterations:  57%|█████▋    | 17/30 [00:19<00:14,  1.11s/it, attack_loss: -254.57941 variance_cross_attn_loss: 0.13782 self_attn_loss: 1.97839 loss: -252.46320]Iterations:  57%|█████▋    | 17/30 [00:19<00:14,  1.11s/it, attack_loss: -264.55252 variance_cross_attn_loss: 0.13798 self_attn_loss: 1.94539 loss: -262.46915]Iterations:  60%|██████    | 18/30 [00:20<00:13,  1.09s/it, attack_loss: -264.55252 variance_cross_attn_loss: 0.13798 self_attn_loss: 1.94539 loss: -262.46915]Iterations:  60%|██████    | 18/30 [00:20<00:13,  1.09s/it, attack_loss: -272.46497 variance_cross_attn_loss: 0.13868 self_attn_loss: 1.93817 loss: -270.38812]Iterations:  63%|██████▎   | 19/30 [00:21<00:12,  1.09s/it, attack_loss: -272.46497 variance_cross_attn_loss: 0.13868 self_attn_loss: 1.93817 loss: -270.38812]Iterations:  63%|██████▎   | 19/30 [00:21<00:12,  1.09s/it, attack_loss: -282.38095 variance_cross_attn_loss: 0.13920 self_attn_loss: 1.97173 loss: -280.27002]Iterations:  67%|██████▋   | 20/30 [00:22<00:11,  1.10s/it, attack_loss: -282.38095 variance_cross_attn_loss: 0.13920 self_attn_loss: 1.97173 loss: -280.27002]Iterations:  67%|██████▋   | 20/30 [00:23<00:11,  1.10s/it, attack_loss: -294.05701 variance_cross_attn_loss: 0.13944 self_attn_loss: 1.99512 loss: -291.92245]Iterations:  70%|███████   | 21/30 [00:23<00:09,  1.11s/it, attack_loss: -294.05701 variance_cross_attn_loss: 0.13944 self_attn_loss: 1.99512 loss: -291.92245]Iterations:  70%|███████   | 21/30 [00:24<00:09,  1.11s/it, attack_loss: -304.92844 variance_cross_attn_loss: 0.13930 self_attn_loss: 1.99396 loss: -302.79520]Iterations:  73%|███████▎  | 22/30 [00:24<00:08,  1.11s/it, attack_loss: -304.92844 variance_cross_attn_loss: 0.13930 self_attn_loss: 1.99396 loss: -302.79520]Iterations:  73%|███████▎  | 22/30 [00:25<00:08,  1.11s/it, attack_loss: -312.32217 variance_cross_attn_loss: 0.13873 self_attn_loss: 2.00403 loss: -310.17941]Iterations:  77%|███████▋  | 23/30 [00:25<00:07,  1.10s/it, attack_loss: -312.32217 variance_cross_attn_loss: 0.13873 self_attn_loss: 2.00403 loss: -310.17941]Iterations:  77%|███████▋  | 23/30 [00:26<00:07,  1.10s/it, attack_loss: -322.30008 variance_cross_attn_loss: 0.13888 self_attn_loss: 2.01698 loss: -320.14423]Iterations:  80%|████████  | 24/30 [00:26<00:06,  1.09s/it, attack_loss: -322.30008 variance_cross_attn_loss: 0.13888 self_attn_loss: 2.01698 loss: -320.14423]Iterations:  80%|████████  | 24/30 [00:27<00:06,  1.09s/it, attack_loss: -328.86658 variance_cross_attn_loss: 0.13923 self_attn_loss: 2.02736 loss: -326.69998]Iterations:  83%|████████▎ | 25/30 [00:28<00:05,  1.10s/it, attack_loss: -328.86658 variance_cross_attn_loss: 0.13923 self_attn_loss: 2.02736 loss: -326.69998]Iterations:  83%|████████▎ | 25/30 [00:28<00:05,  1.10s/it, attack_loss: -336.30890 variance_cross_attn_loss: 0.13947 self_attn_loss: 2.00306 loss: -334.16638]Iterations:  87%|████████▋ | 26/30 [00:29<00:04,  1.10s/it, attack_loss: -336.30890 variance_cross_attn_loss: 0.13947 self_attn_loss: 2.00306 loss: -334.16638]Iterations:  87%|████████▋ | 26/30 [00:29<00:04,  1.10s/it, attack_loss: -344.28986 variance_cross_attn_loss: 0.13932 self_attn_loss: 1.99385 loss: -342.15671]Iterations:  90%|█████████ | 27/30 [00:30<00:03,  1.10s/it, attack_loss: -344.28986 variance_cross_attn_loss: 0.13932 self_attn_loss: 1.99385 loss: -342.15671]Iterations:  90%|█████████ | 27/30 [00:30<00:03,  1.10s/it, attack_loss: -352.39163 variance_cross_attn_loss: 0.13902 self_attn_loss: 2.00801 loss: -350.24463]Iterations:  93%|█████████▎| 28/30 [00:31<00:02,  1.10s/it, attack_loss: -352.39163 variance_cross_attn_loss: 0.13902 self_attn_loss: 2.00801 loss: -350.24463]Iterations:  93%|█████████▎| 28/30 [00:31<00:02,  1.10s/it, attack_loss: -360.73816 variance_cross_attn_loss: 0.13903 self_attn_loss: 2.01487 loss: -358.58426]Iterations:  97%|█████████▋| 29/30 [00:32<00:01,  1.13s/it, attack_loss: -360.73816 variance_cross_attn_loss: 0.13903 self_attn_loss: 2.01487 loss: -358.58426]Iterations:  97%|█████████▋| 29/30 [00:33<00:01,  1.13s/it, attack_loss: -369.77478 variance_cross_attn_loss: 0.13922 self_attn_loss: 2.02476 loss: -367.61081]Iterations: 100%|██████████| 30/30 [00:33<00:00,  1.12s/it, attack_loss: -369.77478 variance_cross_attn_loss: 0.13922 self_attn_loss: 2.02476 loss: -367.61081]Iterations: 100%|██████████| 30/30 [00:33<00:00,  1.12s/it, attack_loss: -369.77478 variance_cross_attn_loss: 0.13922 self_attn_loss: 2.02476 loss: -367.61081]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([518], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([671], device='cuda:0') tensor(3.7731e-17, device='cuda:0')
L1: [7670.208]	L2: [29.732243]	Linf: [0.8352941]

Accuracy on benign examples: 100.0%
gt_label: 324 pred_label: 324 pred_clean_logit 0.9673987030982971
prompt generate:  cabbage butterfly  	labels:  [[324]]
decoder:  [49406, 18407, 9738, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:00, 17.99it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:01, 12.79it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:00, 13.24it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:00, 11.99it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00, 11.85it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:00<00:00, 12.43it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:01<00:00, 12.05it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00, 12.10it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:01<00:00, 12.85it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 12.40it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:02<00:08,  2.07s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:04<00:07,  2.43s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:07<00:05,  2.71s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:11<00:03,  3.05s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:14<00:00,  3.02s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:14<00:00,  2.87s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -4.89475 variance_cross_attn_loss: 0.07018 self_attn_loss: 0.00000 loss: -4.82457]Iterations:   3%|▎         | 1/30 [00:01<00:30,  1.07s/it, attack_loss: -4.89475 variance_cross_attn_loss: 0.07018 self_attn_loss: 0.00000 loss: -4.82457]Iterations:   3%|▎         | 1/30 [00:01<00:30,  1.07s/it, attack_loss: -36.71959 variance_cross_attn_loss: 0.06298 self_attn_loss: 0.95397 loss: -35.70265]Iterations:   7%|▋         | 2/30 [00:02<00:31,  1.11s/it, attack_loss: -36.71959 variance_cross_attn_loss: 0.06298 self_attn_loss: 0.95397 loss: -35.70265]Iterations:   7%|▋         | 2/30 [00:02<00:31,  1.11s/it, attack_loss: -127.81032 variance_cross_attn_loss: 0.05149 self_attn_loss: 1.27932 loss: -126.47951]Iterations:  10%|█         | 3/30 [00:03<00:30,  1.12s/it, attack_loss: -127.81032 variance_cross_attn_loss: 0.05149 self_attn_loss: 1.27932 loss: -126.47951]Iterations:  10%|█         | 3/30 [00:03<00:30,  1.12s/it, attack_loss: -165.57524 variance_cross_attn_loss: 0.04841 self_attn_loss: 1.51353 loss: -164.01329]Iterations:  13%|█▎        | 4/30 [00:04<00:28,  1.11s/it, attack_loss: -165.57524 variance_cross_attn_loss: 0.04841 self_attn_loss: 1.51353 loss: -164.01329]Iterations:  13%|█▎        | 4/30 [00:05<00:28,  1.11s/it, attack_loss: -181.20230 variance_cross_attn_loss: 0.04660 self_attn_loss: 1.67636 loss: -179.47934]Iterations:  17%|█▋        | 5/30 [00:05<00:29,  1.18s/it, attack_loss: -181.20230 variance_cross_attn_loss: 0.04660 self_attn_loss: 1.67636 loss: -179.47934]Iterations:  17%|█▋        | 5/30 [00:06<00:29,  1.18s/it, attack_loss: -194.07388 variance_cross_attn_loss: 0.04388 self_attn_loss: 1.78682 loss: -192.24319]Iterations:  20%|██        | 6/30 [00:07<00:30,  1.25s/it, attack_loss: -194.07388 variance_cross_attn_loss: 0.04388 self_attn_loss: 1.78682 loss: -192.24319]Iterations:  20%|██        | 6/30 [00:07<00:30,  1.25s/it, attack_loss: -201.69376 variance_cross_attn_loss: 0.04013 self_attn_loss: 1.91071 loss: -199.74292]Iterations:  23%|██▎       | 7/30 [00:08<00:27,  1.21s/it, attack_loss: -201.69376 variance_cross_attn_loss: 0.04013 self_attn_loss: 1.91071 loss: -199.74292]Iterations:  23%|██▎       | 7/30 [00:08<00:27,  1.21s/it, attack_loss: -217.32239 variance_cross_attn_loss: 0.04041 self_attn_loss: 1.97641 loss: -215.30557]Iterations:  27%|██▋       | 8/30 [00:09<00:25,  1.17s/it, attack_loss: -217.32239 variance_cross_attn_loss: 0.04041 self_attn_loss: 1.97641 loss: -215.30557]Iterations:  27%|██▋       | 8/30 [00:09<00:25,  1.17s/it, attack_loss: -224.67307 variance_cross_attn_loss: 0.03997 self_attn_loss: 2.04884 loss: -222.58426]Iterations:  30%|███       | 9/30 [00:10<00:24,  1.15s/it, attack_loss: -224.67307 variance_cross_attn_loss: 0.03997 self_attn_loss: 2.04884 loss: -222.58426]Iterations:  30%|███       | 9/30 [00:11<00:24,  1.15s/it, attack_loss: -231.21539 variance_cross_attn_loss: 0.03972 self_attn_loss: 2.12076 loss: -229.05492]Iterations:  33%|███▎      | 10/30 [00:11<00:22,  1.13s/it, attack_loss: -231.21539 variance_cross_attn_loss: 0.03972 self_attn_loss: 2.12076 loss: -229.05492]Iterations:  33%|███▎      | 10/30 [00:12<00:22,  1.13s/it, attack_loss: -239.81447 variance_cross_attn_loss: 0.03971 self_attn_loss: 2.18493 loss: -237.58981]Iterations:  37%|███▋      | 11/30 [00:12<00:21,  1.12s/it, attack_loss: -239.81447 variance_cross_attn_loss: 0.03971 self_attn_loss: 2.18493 loss: -237.58981]Iterations:  37%|███▋      | 11/30 [00:13<00:21,  1.12s/it, attack_loss: -249.19385 variance_cross_attn_loss: 0.03901 self_attn_loss: 2.25988 loss: -246.89497]Iterations:  40%|████      | 12/30 [00:13<00:19,  1.11s/it, attack_loss: -249.19385 variance_cross_attn_loss: 0.03901 self_attn_loss: 2.25988 loss: -246.89497]Iterations:  40%|████      | 12/30 [00:14<00:19,  1.11s/it, attack_loss: -256.85016 variance_cross_attn_loss: 0.03805 self_attn_loss: 2.32950 loss: -254.48260]Iterations:  43%|████▎     | 13/30 [00:14<00:19,  1.12s/it, attack_loss: -256.85016 variance_cross_attn_loss: 0.03805 self_attn_loss: 2.32950 loss: -254.48260]Iterations:  43%|████▎     | 13/30 [00:15<00:19,  1.12s/it, attack_loss: -262.19202 variance_cross_attn_loss: 0.03769 self_attn_loss: 2.37040 loss: -259.78394]Iterations:  47%|████▋     | 14/30 [00:16<00:18,  1.13s/it, attack_loss: -262.19202 variance_cross_attn_loss: 0.03769 self_attn_loss: 2.37040 loss: -259.78394]Iterations:  47%|████▋     | 14/30 [00:16<00:18,  1.13s/it, attack_loss: -267.35895 variance_cross_attn_loss: 0.03780 self_attn_loss: 2.39344 loss: -264.92770]Iterations:  50%|█████     | 15/30 [00:17<00:16,  1.12s/it, attack_loss: -267.35895 variance_cross_attn_loss: 0.03780 self_attn_loss: 2.39344 loss: -264.92770]Iterations:  50%|█████     | 15/30 [00:17<00:16,  1.12s/it, attack_loss: -274.03247 variance_cross_attn_loss: 0.03815 self_attn_loss: 2.40516 loss: -271.58917]Iterations:  53%|█████▎    | 16/30 [00:18<00:15,  1.11s/it, attack_loss: -274.03247 variance_cross_attn_loss: 0.03815 self_attn_loss: 2.40516 loss: -271.58917]Iterations:  53%|█████▎    | 16/30 [00:18<00:15,  1.11s/it, attack_loss: -280.05225 variance_cross_attn_loss: 0.03857 self_attn_loss: 2.41461 loss: -277.59906]Iterations:  57%|█████▋    | 17/30 [00:19<00:14,  1.12s/it, attack_loss: -280.05225 variance_cross_attn_loss: 0.03857 self_attn_loss: 2.41461 loss: -277.59906]Iterations:  57%|█████▋    | 17/30 [00:19<00:14,  1.12s/it, attack_loss: -284.44922 variance_cross_attn_loss: 0.03896 self_attn_loss: 2.42203 loss: -281.98822]Iterations:  60%|██████    | 18/30 [00:20<00:13,  1.11s/it, attack_loss: -284.44922 variance_cross_attn_loss: 0.03896 self_attn_loss: 2.42203 loss: -281.98822]Iterations:  60%|██████    | 18/30 [00:21<00:13,  1.11s/it, attack_loss: -288.88705 variance_cross_attn_loss: 0.03921 self_attn_loss: 2.42452 loss: -286.42331]Iterations:  63%|██████▎   | 19/30 [00:21<00:12,  1.11s/it, attack_loss: -288.88705 variance_cross_attn_loss: 0.03921 self_attn_loss: 2.42452 loss: -286.42331]Iterations:  63%|██████▎   | 19/30 [00:22<00:12,  1.11s/it, attack_loss: -292.74008 variance_cross_attn_loss: 0.03933 self_attn_loss: 2.42975 loss: -290.27100]Iterations:  67%|██████▋   | 20/30 [00:22<00:11,  1.12s/it, attack_loss: -292.74008 variance_cross_attn_loss: 0.03933 self_attn_loss: 2.42975 loss: -290.27100]Iterations:  67%|██████▋   | 20/30 [00:23<00:11,  1.12s/it, attack_loss: -297.36957 variance_cross_attn_loss: 0.03990 self_attn_loss: 2.43724 loss: -294.89240]Iterations:  70%|███████   | 21/30 [00:23<00:10,  1.11s/it, attack_loss: -297.36957 variance_cross_attn_loss: 0.03990 self_attn_loss: 2.43724 loss: -294.89240]Iterations:  70%|███████   | 21/30 [00:24<00:10,  1.11s/it, attack_loss: -301.56097 variance_cross_attn_loss: 0.04042 self_attn_loss: 2.44431 loss: -299.07623]Iterations:  73%|███████▎  | 22/30 [00:24<00:09,  1.14s/it, attack_loss: -301.56097 variance_cross_attn_loss: 0.04042 self_attn_loss: 2.44431 loss: -299.07623]Iterations:  73%|███████▎  | 22/30 [00:25<00:09,  1.14s/it, attack_loss: -306.12222 variance_cross_attn_loss: 0.04073 self_attn_loss: 2.45613 loss: -303.62534]Iterations:  77%|███████▋  | 23/30 [00:26<00:08,  1.16s/it, attack_loss: -306.12222 variance_cross_attn_loss: 0.04073 self_attn_loss: 2.45613 loss: -303.62534]Iterations:  77%|███████▋  | 23/30 [00:26<00:08,  1.16s/it, attack_loss: -310.62344 variance_cross_attn_loss: 0.04107 self_attn_loss: 2.45856 loss: -308.12381]Iterations:  80%|████████  | 24/30 [00:27<00:06,  1.14s/it, attack_loss: -310.62344 variance_cross_attn_loss: 0.04107 self_attn_loss: 2.45856 loss: -308.12381]Iterations:  80%|████████  | 24/30 [00:27<00:06,  1.14s/it, attack_loss: -315.64160 variance_cross_attn_loss: 0.04149 self_attn_loss: 2.45530 loss: -313.14484]Iterations:  83%|████████▎ | 25/30 [00:28<00:05,  1.19s/it, attack_loss: -315.64160 variance_cross_attn_loss: 0.04149 self_attn_loss: 2.45530 loss: -313.14484]Iterations:  83%|████████▎ | 25/30 [00:29<00:05,  1.19s/it, attack_loss: -318.65125 variance_cross_attn_loss: 0.04110 self_attn_loss: 2.45895 loss: -316.15118]Iterations:  87%|████████▋ | 26/30 [00:29<00:05,  1.26s/it, attack_loss: -318.65125 variance_cross_attn_loss: 0.04110 self_attn_loss: 2.45895 loss: -316.15118]Iterations:  87%|████████▋ | 26/30 [00:30<00:05,  1.26s/it, attack_loss: -322.21097 variance_cross_attn_loss: 0.04023 self_attn_loss: 2.47617 loss: -319.69458]Iterations:  90%|█████████ | 27/30 [00:31<00:03,  1.21s/it, attack_loss: -322.21097 variance_cross_attn_loss: 0.04023 self_attn_loss: 2.47617 loss: -319.69458]Iterations:  90%|█████████ | 27/30 [00:31<00:03,  1.21s/it, attack_loss: -326.69052 variance_cross_attn_loss: 0.03989 self_attn_loss: 2.48071 loss: -324.16992]Iterations:  93%|█████████▎| 28/30 [00:32<00:02,  1.19s/it, attack_loss: -326.69052 variance_cross_attn_loss: 0.03989 self_attn_loss: 2.48071 loss: -324.16992]Iterations:  93%|█████████▎| 28/30 [00:32<00:02,  1.19s/it, attack_loss: -331.63345 variance_cross_attn_loss: 0.04032 self_attn_loss: 2.47089 loss: -329.12225]Iterations:  97%|█████████▋| 29/30 [00:33<00:01,  1.16s/it, attack_loss: -331.63345 variance_cross_attn_loss: 0.04032 self_attn_loss: 2.47089 loss: -329.12225]Iterations:  97%|█████████▋| 29/30 [00:33<00:01,  1.16s/it, attack_loss: -336.01324 variance_cross_attn_loss: 0.04041 self_attn_loss: 2.48312 loss: -333.48972]Iterations: 100%|██████████| 30/30 [00:34<00:00,  1.15s/it, attack_loss: -336.01324 variance_cross_attn_loss: 0.04041 self_attn_loss: 2.48312 loss: -333.48972]Iterations: 100%|██████████| 30/30 [00:34<00:00,  1.15s/it, attack_loss: -336.01324 variance_cross_attn_loss: 0.04041 self_attn_loss: 2.48312 loss: -333.48972]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([986], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([324], device='cuda:0') tensor(1.7382e-15, device='cuda:0')
L1: [6292.9565]	L2: [23.340216]	Linf: [0.62352943]

Accuracy on benign examples: 100.0%
gt_label: 759 pred_label: 759 pred_clean_logit 0.9999091625213623
prompt generate:  reflex camera  	labels:  [[759]]
decoder:  [49406, 36050, 3934, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:01, 15.45it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:01, 12.86it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:00, 14.20it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:00, 12.66it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00, 12.43it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:00<00:00, 12.23it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:01<00:00, 11.90it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00, 11.95it/s]DDIM_inverse:  95%|█████████▍| 18/19 [00:01<00:00, 11.84it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 12.31it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:01<00:07,  1.75s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:03<00:05,  1.88s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:05<00:04,  2.04s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:09<00:02,  2.51s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:12<00:00,  2.67s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:12<00:00,  2.43s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -0.00020 variance_cross_attn_loss: 0.04729 self_attn_loss: 0.00000 loss: 0.04709]Iterations:   3%|▎         | 1/30 [00:01<00:30,  1.04s/it, attack_loss: -0.00020 variance_cross_attn_loss: 0.04729 self_attn_loss: 0.00000 loss: 0.04709]Iterations:   3%|▎         | 1/30 [00:01<00:30,  1.04s/it, attack_loss: -0.00289 variance_cross_attn_loss: 0.04526 self_attn_loss: 1.14335 loss: 1.18571]Iterations:   7%|▋         | 2/30 [00:02<00:29,  1.06s/it, attack_loss: -0.00289 variance_cross_attn_loss: 0.04526 self_attn_loss: 1.14335 loss: 1.18571]Iterations:   7%|▋         | 2/30 [00:02<00:29,  1.06s/it, attack_loss: -0.00137 variance_cross_attn_loss: 0.04448 self_attn_loss: 1.27342 loss: 1.31654]Iterations:  10%|█         | 3/30 [00:03<00:29,  1.09s/it, attack_loss: -0.00137 variance_cross_attn_loss: 0.04448 self_attn_loss: 1.27342 loss: 1.31654]Iterations:  10%|█         | 3/30 [00:03<00:29,  1.09s/it, attack_loss: -0.00336 variance_cross_attn_loss: 0.04553 self_attn_loss: 1.24539 loss: 1.28756]Iterations:  13%|█▎        | 4/30 [00:04<00:28,  1.10s/it, attack_loss: -0.00336 variance_cross_attn_loss: 0.04553 self_attn_loss: 1.24539 loss: 1.28756]Iterations:  13%|█▎        | 4/30 [00:04<00:28,  1.10s/it, attack_loss: -0.00421 variance_cross_attn_loss: 0.04731 self_attn_loss: 1.16163 loss: 1.20473]Iterations:  17%|█▋        | 5/30 [00:05<00:27,  1.10s/it, attack_loss: -0.00421 variance_cross_attn_loss: 0.04731 self_attn_loss: 1.16163 loss: 1.20473]Iterations:  17%|█▋        | 5/30 [00:06<00:27,  1.10s/it, attack_loss: -0.00229 variance_cross_attn_loss: 0.04881 self_attn_loss: 1.15852 loss: 1.20504]Iterations:  20%|██        | 6/30 [00:06<00:26,  1.10s/it, attack_loss: -0.00229 variance_cross_attn_loss: 0.04881 self_attn_loss: 1.15852 loss: 1.20504]Iterations:  20%|██        | 6/30 [00:07<00:26,  1.10s/it, attack_loss: -0.00234 variance_cross_attn_loss: 0.04944 self_attn_loss: 1.18337 loss: 1.23047]Iterations:  23%|██▎       | 7/30 [00:07<00:25,  1.11s/it, attack_loss: -0.00234 variance_cross_attn_loss: 0.04944 self_attn_loss: 1.18337 loss: 1.23047]Iterations:  23%|██▎       | 7/30 [00:08<00:25,  1.11s/it, attack_loss: -0.00183 variance_cross_attn_loss: 0.05072 self_attn_loss: 1.15626 loss: 1.20515]Iterations:  27%|██▋       | 8/30 [00:08<00:24,  1.12s/it, attack_loss: -0.00183 variance_cross_attn_loss: 0.05072 self_attn_loss: 1.15626 loss: 1.20515]Iterations:  27%|██▋       | 8/30 [00:09<00:24,  1.12s/it, attack_loss: -0.00193 variance_cross_attn_loss: 0.05096 self_attn_loss: 1.13231 loss: 1.18133]Iterations:  30%|███       | 9/30 [00:09<00:23,  1.10s/it, attack_loss: -0.00193 variance_cross_attn_loss: 0.05096 self_attn_loss: 1.13231 loss: 1.18133]Iterations:  30%|███       | 9/30 [00:10<00:23,  1.10s/it, attack_loss: -0.00439 variance_cross_attn_loss: 0.05089 self_attn_loss: 1.22001 loss: 1.26651]Iterations:  33%|███▎      | 10/30 [00:11<00:22,  1.12s/it, attack_loss: -0.00439 variance_cross_attn_loss: 0.05089 self_attn_loss: 1.22001 loss: 1.26651]Iterations:  33%|███▎      | 10/30 [00:11<00:22,  1.12s/it, attack_loss: -0.00377 variance_cross_attn_loss: 0.05100 self_attn_loss: 1.05259 loss: 1.09982]Iterations:  37%|███▋      | 11/30 [00:12<00:21,  1.12s/it, attack_loss: -0.00377 variance_cross_attn_loss: 0.05100 self_attn_loss: 1.05259 loss: 1.09982]Iterations:  37%|███▋      | 11/30 [00:12<00:21,  1.12s/it, attack_loss: -0.00363 variance_cross_attn_loss: 0.04930 self_attn_loss: 1.03296 loss: 1.07863]Iterations:  40%|████      | 12/30 [00:13<00:20,  1.13s/it, attack_loss: -0.00363 variance_cross_attn_loss: 0.04930 self_attn_loss: 1.03296 loss: 1.07863]Iterations:  40%|████      | 12/30 [00:13<00:20,  1.13s/it, attack_loss: -0.00501 variance_cross_attn_loss: 0.04825 self_attn_loss: 0.98242 loss: 1.02567]Iterations:  43%|████▎     | 13/30 [00:14<00:19,  1.12s/it, attack_loss: -0.00501 variance_cross_attn_loss: 0.04825 self_attn_loss: 0.98242 loss: 1.02567]Iterations:  43%|████▎     | 13/30 [00:15<00:19,  1.12s/it, attack_loss: -0.00547 variance_cross_attn_loss: 0.04767 self_attn_loss: 0.94893 loss: 0.99113]Iterations:  47%|████▋     | 14/30 [00:15<00:17,  1.12s/it, attack_loss: -0.00547 variance_cross_attn_loss: 0.04767 self_attn_loss: 0.94893 loss: 0.99113]Iterations:  47%|████▋     | 14/30 [00:16<00:17,  1.12s/it, attack_loss: -0.00598 variance_cross_attn_loss: 0.04708 self_attn_loss: 0.90963 loss: 0.95073]Iterations:  50%|█████     | 15/30 [00:16<00:16,  1.12s/it, attack_loss: -0.00598 variance_cross_attn_loss: 0.04708 self_attn_loss: 0.90963 loss: 0.95073]Iterations:  50%|█████     | 15/30 [00:17<00:16,  1.12s/it, attack_loss: -0.00972 variance_cross_attn_loss: 0.04676 self_attn_loss: 0.86909 loss: 0.90613]Iterations:  53%|█████▎    | 16/30 [00:18<00:17,  1.22s/it, attack_loss: -0.00972 variance_cross_attn_loss: 0.04676 self_attn_loss: 0.86909 loss: 0.90613]Iterations:  53%|█████▎    | 16/30 [00:18<00:17,  1.22s/it, attack_loss: -0.01374 variance_cross_attn_loss: 0.04666 self_attn_loss: 0.87007 loss: 0.90298]Iterations:  57%|█████▋    | 17/30 [00:19<00:15,  1.21s/it, attack_loss: -0.01374 variance_cross_attn_loss: 0.04666 self_attn_loss: 0.87007 loss: 0.90298]Iterations:  57%|█████▋    | 17/30 [00:19<00:15,  1.21s/it, attack_loss: -0.02684 variance_cross_attn_loss: 0.04715 self_attn_loss: 0.85082 loss: 0.87113]Iterations:  60%|██████    | 18/30 [00:20<00:13,  1.12s/it, attack_loss: -0.02684 variance_cross_attn_loss: 0.04715 self_attn_loss: 0.85082 loss: 0.87113]Iterations:  60%|██████    | 18/30 [00:20<00:13,  1.12s/it, attack_loss: -0.05448 variance_cross_attn_loss: 0.04781 self_attn_loss: 0.98492 loss: 0.97825]Iterations:  63%|██████▎   | 19/30 [00:21<00:11,  1.05s/it, attack_loss: -0.05448 variance_cross_attn_loss: 0.04781 self_attn_loss: 0.98492 loss: 0.97825]Iterations:  63%|██████▎   | 19/30 [00:21<00:11,  1.05s/it, attack_loss: -0.47315 variance_cross_attn_loss: 0.04585 self_attn_loss: 0.84011 loss: 0.41281]Iterations:  67%|██████▋   | 20/30 [00:21<00:09,  1.00it/s, attack_loss: -0.47315 variance_cross_attn_loss: 0.04585 self_attn_loss: 0.84011 loss: 0.41281]Iterations:  67%|██████▋   | 20/30 [00:22<00:09,  1.00it/s, attack_loss: -14.38908 variance_cross_attn_loss: 0.04572 self_attn_loss: 0.86129 loss: -13.48207]Iterations:  70%|███████   | 21/30 [00:22<00:08,  1.04it/s, attack_loss: -14.38908 variance_cross_attn_loss: 0.04572 self_attn_loss: 0.86129 loss: -13.48207]Iterations:  70%|███████   | 21/30 [00:23<00:08,  1.04it/s, attack_loss: -53.52338 variance_cross_attn_loss: 0.04554 self_attn_loss: 1.07749 loss: -52.40035]Iterations:  73%|███████▎  | 22/30 [00:23<00:07,  1.06it/s, attack_loss: -53.52338 variance_cross_attn_loss: 0.04554 self_attn_loss: 1.07749 loss: -52.40035]Iterations:  73%|███████▎  | 22/30 [00:24<00:07,  1.06it/s, attack_loss: -85.23258 variance_cross_attn_loss: 0.04253 self_attn_loss: 1.25405 loss: -83.93600]Iterations:  77%|███████▋  | 23/30 [00:24<00:06,  1.02it/s, attack_loss: -85.23258 variance_cross_attn_loss: 0.04253 self_attn_loss: 1.25405 loss: -83.93600]Iterations:  77%|███████▋  | 23/30 [00:25<00:06,  1.02it/s, attack_loss: -111.78529 variance_cross_attn_loss: 0.04182 self_attn_loss: 1.33319 loss: -110.41029]Iterations:  80%|████████  | 24/30 [00:26<00:06,  1.13s/it, attack_loss: -111.78529 variance_cross_attn_loss: 0.04182 self_attn_loss: 1.33319 loss: -110.41029]Iterations:  80%|████████  | 24/30 [00:27<00:06,  1.13s/it, attack_loss: -129.32686 variance_cross_attn_loss: 0.04216 self_attn_loss: 1.49225 loss: -127.79245]Iterations:  83%|████████▎ | 25/30 [00:27<00:06,  1.22s/it, attack_loss: -129.32686 variance_cross_attn_loss: 0.04216 self_attn_loss: 1.49225 loss: -127.79245]Iterations:  83%|████████▎ | 25/30 [00:28<00:06,  1.22s/it, attack_loss: -156.37856 variance_cross_attn_loss: 0.04125 self_attn_loss: 1.60053 loss: -154.73679]Iterations:  87%|████████▋ | 26/30 [00:29<00:05,  1.29s/it, attack_loss: -156.37856 variance_cross_attn_loss: 0.04125 self_attn_loss: 1.60053 loss: -154.73679]Iterations:  87%|████████▋ | 26/30 [00:29<00:05,  1.29s/it, attack_loss: -168.49500 variance_cross_attn_loss: 0.04030 self_attn_loss: 1.63437 loss: -166.82033]Iterations:  90%|█████████ | 27/30 [00:30<00:04,  1.34s/it, attack_loss: -168.49500 variance_cross_attn_loss: 0.04030 self_attn_loss: 1.63437 loss: -166.82033]Iterations:  90%|█████████ | 27/30 [00:31<00:04,  1.34s/it, attack_loss: -187.91701 variance_cross_attn_loss: 0.04041 self_attn_loss: 1.67792 loss: -186.19868]Iterations:  93%|█████████▎| 28/30 [00:31<00:02,  1.31s/it, attack_loss: -187.91701 variance_cross_attn_loss: 0.04041 self_attn_loss: 1.67792 loss: -186.19868]Iterations:  93%|█████████▎| 28/30 [00:32<00:02,  1.31s/it, attack_loss: -193.83940 variance_cross_attn_loss: 0.04045 self_attn_loss: 1.74824 loss: -192.05070]Iterations:  97%|█████████▋| 29/30 [00:33<00:01,  1.26s/it, attack_loss: -193.83940 variance_cross_attn_loss: 0.04045 self_attn_loss: 1.74824 loss: -192.05070]Iterations:  97%|█████████▋| 29/30 [00:33<00:01,  1.26s/it, attack_loss: -214.25856 variance_cross_attn_loss: 0.04005 self_attn_loss: 1.77312 loss: -212.44540]Iterations: 100%|██████████| 30/30 [00:34<00:00,  1.22s/it, attack_loss: -214.25856 variance_cross_attn_loss: 0.04005 self_attn_loss: 1.77312 loss: -212.44540]Iterations: 100%|██████████| 30/30 [00:34<00:00,  1.14s/it, attack_loss: -214.25856 variance_cross_attn_loss: 0.04005 self_attn_loss: 1.77312 loss: -212.44540]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([783], device='cuda:0') tensor(0.9987, device='cuda:0')
after_true: tensor([759], device='cuda:0') tensor(1.3799e-10, device='cuda:0')
L1: [5332.902]	L2: [23.01285]	Linf: [0.7490196]

Accuracy on benign examples: 0.0%
gt_label: 634 pred_label: 388 pred_clean_logit 3.2354598715755856e-06
prompt generate:  lumbermill  	labels:  [[388]]
decoder:  [49406, 27421, 6637, 49407] [49406, 49407]
DDIM_inverse:   0%|          | 0/19 [00:00<?, ?it/s]DDIM_inverse:  11%|█         | 2/19 [00:00<00:01, 14.68it/s]DDIM_inverse:  21%|██        | 4/19 [00:00<00:01, 13.32it/s]DDIM_inverse:  32%|███▏      | 6/19 [00:00<00:01, 11.90it/s]DDIM_inverse:  42%|████▏     | 8/19 [00:00<00:00, 11.22it/s]DDIM_inverse:  53%|█████▎    | 10/19 [00:00<00:00, 11.40it/s]DDIM_inverse:  63%|██████▎   | 12/19 [00:01<00:00,  9.92it/s]DDIM_inverse:  74%|███████▎  | 14/19 [00:01<00:00,  9.11it/s]DDIM_inverse:  79%|███████▉  | 15/19 [00:01<00:00,  9.22it/s]DDIM_inverse:  84%|████████▍ | 16/19 [00:01<00:00,  8.99it/s]DDIM_inverse:  89%|████████▉ | 17/19 [00:01<00:00,  9.06it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00,  9.50it/s]DDIM_inverse: 100%|██████████| 19/19 [00:01<00:00, 10.07it/s]
Optimize_uncond_embed:   0%|          | 0/5 [00:00<?, ?it/s]Optimize_uncond_embed:  20%|██        | 1/5 [00:01<00:07,  1.78s/it]Optimize_uncond_embed:  40%|████      | 2/5 [00:03<00:05,  1.84s/it]Optimize_uncond_embed:  60%|██████    | 3/5 [00:06<00:04,  2.08s/it]Optimize_uncond_embed:  80%|████████  | 4/5 [00:09<00:02,  2.52s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:13<00:00,  3.08s/it]Optimize_uncond_embed: 100%|██████████| 5/5 [00:13<00:00,  2.66s/it]
Iterations:   0%|          | 0/30 [00:00<?, ?it/s]Iterations:   0%|          | 0/30 [00:00<?, ?it/s, attack_loss: -146.26607 variance_cross_attn_loss: 0.01586 self_attn_loss: 0.00000 loss: -146.25021]Iterations:   3%|▎         | 1/30 [00:01<00:47,  1.65s/it, attack_loss: -146.26607 variance_cross_attn_loss: 0.01586 self_attn_loss: 0.00000 loss: -146.25021]Iterations:   3%|▎         | 1/30 [00:02<00:47,  1.65s/it, attack_loss: -225.75133 variance_cross_attn_loss: 0.01499 self_attn_loss: 1.13485 loss: -224.60149]Iterations:   7%|▋         | 2/30 [00:03<00:48,  1.73s/it, attack_loss: -225.75133 variance_cross_attn_loss: 0.01499 self_attn_loss: 1.13485 loss: -224.60149]Iterations:   7%|▋         | 2/30 [00:04<00:48,  1.73s/it, attack_loss: -258.98718 variance_cross_attn_loss: 0.01390 self_attn_loss: 1.56007 loss: -257.41324]Iterations:  10%|█         | 3/30 [00:05<00:47,  1.76s/it, attack_loss: -258.98718 variance_cross_attn_loss: 0.01390 self_attn_loss: 1.56007 loss: -257.41324]Iterations:  10%|█         | 3/30 [00:06<00:47,  1.76s/it, attack_loss: -288.03802 variance_cross_attn_loss: 0.01381 self_attn_loss: 1.79561 loss: -286.22864]Iterations:  13%|█▎        | 4/30 [00:06<00:45,  1.75s/it, attack_loss: -288.03802 variance_cross_attn_loss: 0.01381 self_attn_loss: 1.79561 loss: -286.22864]Iterations:  13%|█▎        | 4/30 [00:07<00:45,  1.75s/it, attack_loss: -307.12421 variance_cross_attn_loss: 0.01349 self_attn_loss: 2.03769 loss: -305.07303]Iterations:  17%|█▋        | 5/30 [00:08<00:41,  1.64s/it, attack_loss: -307.12421 variance_cross_attn_loss: 0.01349 self_attn_loss: 2.03769 loss: -305.07303]Iterations:  17%|█▋        | 5/30 [00:09<00:41,  1.64s/it, attack_loss: -338.34091 variance_cross_attn_loss: 0.01346 self_attn_loss: 2.14432 loss: -336.18314]Iterations:  20%|██        | 6/30 [00:09<00:37,  1.58s/it, attack_loss: -338.34091 variance_cross_attn_loss: 0.01346 self_attn_loss: 2.14432 loss: -336.18314]Iterations:  20%|██        | 6/30 [00:10<00:37,  1.58s/it, attack_loss: -369.61728 variance_cross_attn_loss: 0.01354 self_attn_loss: 2.16634 loss: -367.43738]Iterations:  23%|██▎       | 7/30 [00:11<00:35,  1.54s/it, attack_loss: -369.61728 variance_cross_attn_loss: 0.01354 self_attn_loss: 2.16634 loss: -367.43738]Iterations:  23%|██▎       | 7/30 [00:12<00:35,  1.54s/it, attack_loss: -394.53168 variance_cross_attn_loss: 0.01352 self_attn_loss: 2.19007 loss: -392.32809]Iterations:  27%|██▋       | 8/30 [00:12<00:30,  1.39s/it, attack_loss: -394.53168 variance_cross_attn_loss: 0.01352 self_attn_loss: 2.19007 loss: -392.32809]Iterations:  27%|██▋       | 8/30 [00:12<00:30,  1.39s/it, attack_loss: -421.27591 variance_cross_attn_loss: 0.01361 self_attn_loss: 2.17834 loss: -419.08395]Iterations:  30%|███       | 9/30 [00:13<00:27,  1.29s/it, attack_loss: -421.27591 variance_cross_attn_loss: 0.01361 self_attn_loss: 2.17834 loss: -419.08395]Iterations:  30%|███       | 9/30 [00:14<00:27,  1.29s/it, attack_loss: -434.08417 variance_cross_attn_loss: 0.01367 self_attn_loss: 2.17687 loss: -431.89362]Iterations:  33%|███▎      | 10/30 [00:14<00:27,  1.35s/it, attack_loss: -434.08417 variance_cross_attn_loss: 0.01367 self_attn_loss: 2.17687 loss: -431.89362]Iterations:  33%|███▎      | 10/30 [00:16<00:27,  1.35s/it, attack_loss: -463.61597 variance_cross_attn_loss: 0.01356 self_attn_loss: 2.20988 loss: -461.39252]Iterations:  37%|███▋      | 11/30 [00:16<00:28,  1.51s/it, attack_loss: -463.61597 variance_cross_attn_loss: 0.01356 self_attn_loss: 2.20988 loss: -461.39252]Iterations:  37%|███▋      | 11/30 [00:17<00:28,  1.51s/it, attack_loss: -470.52432 variance_cross_attn_loss: 0.01348 self_attn_loss: 2.22821 loss: -468.28262]Iterations:  40%|████      | 12/30 [00:18<00:27,  1.52s/it, attack_loss: -470.52432 variance_cross_attn_loss: 0.01348 self_attn_loss: 2.22821 loss: -468.28262]Iterations:  40%|████      | 12/30 [00:19<00:27,  1.52s/it, attack_loss: -496.93082 variance_cross_attn_loss: 0.01342 self_attn_loss: 2.26205 loss: -494.65533]Iterations:  43%|████▎     | 13/30 [00:19<00:26,  1.54s/it, attack_loss: -496.93082 variance_cross_attn_loss: 0.01342 self_attn_loss: 2.26205 loss: -494.65533]Iterations:  43%|████▎     | 13/30 [00:20<00:26,  1.54s/it, attack_loss: -504.12631 variance_cross_attn_loss: 0.01343 self_attn_loss: 2.29072 loss: -501.82217]Iterations:  47%|████▋     | 14/30 [00:21<00:25,  1.60s/it, attack_loss: -504.12631 variance_cross_attn_loss: 0.01343 self_attn_loss: 2.29072 loss: -501.82217]Iterations:  47%|████▋     | 14/30 [00:22<00:25,  1.60s/it, attack_loss: -522.08221 variance_cross_attn_loss: 0.01343 self_attn_loss: 2.31250 loss: -519.75629]Iterations:  50%|█████     | 15/30 [00:23<00:24,  1.65s/it, attack_loss: -522.08221 variance_cross_attn_loss: 0.01343 self_attn_loss: 2.31250 loss: -519.75629]Iterations:  50%|█████     | 15/30 [00:24<00:24,  1.65s/it, attack_loss: -538.63934 variance_cross_attn_loss: 0.01346 self_attn_loss: 2.34332 loss: -536.28259]Iterations:  53%|█████▎    | 16/30 [00:25<00:23,  1.69s/it, attack_loss: -538.63934 variance_cross_attn_loss: 0.01346 self_attn_loss: 2.34332 loss: -536.28259]Iterations:  53%|█████▎    | 16/30 [00:26<00:23,  1.69s/it, attack_loss: -556.36206 variance_cross_attn_loss: 0.01353 self_attn_loss: 2.35228 loss: -553.99622]Iterations:  57%|█████▋    | 17/30 [00:26<00:22,  1.69s/it, attack_loss: -556.36206 variance_cross_attn_loss: 0.01353 self_attn_loss: 2.35228 loss: -553.99622]Iterations:  57%|█████▋    | 17/30 [00:27<00:22,  1.69s/it, attack_loss: -569.36615 variance_cross_attn_loss: 0.01368 self_attn_loss: 2.36183 loss: -566.99066]Iterations:  60%|██████    | 18/30 [00:28<00:20,  1.71s/it, attack_loss: -569.36615 variance_cross_attn_loss: 0.01368 self_attn_loss: 2.36183 loss: -566.99066]Iterations:  60%|██████    | 18/30 [00:29<00:20,  1.71s/it, attack_loss: -583.32867 variance_cross_attn_loss: 0.01355 self_attn_loss: 2.40521 loss: -580.90991]Iterations:  63%|██████▎   | 19/30 [00:30<00:18,  1.65s/it, attack_loss: -583.32867 variance_cross_attn_loss: 0.01355 self_attn_loss: 2.40521 loss: -580.90991]Iterations:  63%|██████▎   | 19/30 [00:31<00:18,  1.65s/it, attack_loss: -597.48389 variance_cross_attn_loss: 0.01344 self_attn_loss: 2.42591 loss: -595.04456]Iterations:  67%|██████▋   | 20/30 [00:31<00:16,  1.61s/it, attack_loss: -597.48389 variance_cross_attn_loss: 0.01344 self_attn_loss: 2.42591 loss: -595.04456]Iterations:  67%|██████▋   | 20/30 [00:32<00:16,  1.61s/it, attack_loss: -610.57593 variance_cross_attn_loss: 0.01338 self_attn_loss: 2.44189 loss: -608.12067]Iterations:  70%|███████   | 21/30 [00:33<00:13,  1.54s/it, attack_loss: -610.57593 variance_cross_attn_loss: 0.01338 self_attn_loss: 2.44189 loss: -608.12067]Iterations:  70%|███████   | 21/30 [00:33<00:13,  1.54s/it, attack_loss: -617.43054 variance_cross_attn_loss: 0.01342 self_attn_loss: 2.42313 loss: -614.99402]Iterations:  73%|███████▎  | 22/30 [00:34<00:11,  1.41s/it, attack_loss: -617.43054 variance_cross_attn_loss: 0.01342 self_attn_loss: 2.42313 loss: -614.99402]Iterations:  73%|███████▎  | 22/30 [00:34<00:11,  1.41s/it, attack_loss: -628.43469 variance_cross_attn_loss: 0.01344 self_attn_loss: 2.45072 loss: -625.97052]Iterations:  77%|███████▋  | 23/30 [00:35<00:09,  1.41s/it, attack_loss: -628.43469 variance_cross_attn_loss: 0.01344 self_attn_loss: 2.45072 loss: -625.97052]Iterations:  77%|███████▋  | 23/30 [00:36<00:09,  1.41s/it, attack_loss: -640.02563 variance_cross_attn_loss: 0.01352 self_attn_loss: 2.46925 loss: -637.54285]Iterations:  80%|████████  | 24/30 [00:37<00:08,  1.43s/it, attack_loss: -640.02563 variance_cross_attn_loss: 0.01352 self_attn_loss: 2.46925 loss: -637.54285]Iterations:  80%|████████  | 24/30 [00:37<00:08,  1.43s/it, attack_loss: -645.76691 variance_cross_attn_loss: 0.01357 self_attn_loss: 2.50214 loss: -643.25122]Iterations:  83%|████████▎ | 25/30 [00:38<00:07,  1.43s/it, attack_loss: -645.76691 variance_cross_attn_loss: 0.01357 self_attn_loss: 2.50214 loss: -643.25122]Iterations:  83%|████████▎ | 25/30 [00:39<00:07,  1.43s/it, attack_loss: -658.21155 variance_cross_attn_loss: 0.01355 self_attn_loss: 2.54147 loss: -655.65649]Iterations:  87%|████████▋ | 26/30 [00:39<00:05,  1.43s/it, attack_loss: -658.21155 variance_cross_attn_loss: 0.01355 self_attn_loss: 2.54147 loss: -655.65649]Iterations:  87%|████████▋ | 26/30 [00:40<00:05,  1.43s/it, attack_loss: -669.24933 variance_cross_attn_loss: 0.01350 self_attn_loss: 2.53101 loss: -666.70483]Iterations:  90%|█████████ | 27/30 [00:41<00:04,  1.47s/it, attack_loss: -669.24933 variance_cross_attn_loss: 0.01350 self_attn_loss: 2.53101 loss: -666.70483]Iterations:  90%|█████████ | 27/30 [00:42<00:04,  1.47s/it, attack_loss: -672.39746 variance_cross_attn_loss: 0.01348 self_attn_loss: 2.53155 loss: -669.85242]Iterations:  93%|█████████▎| 28/30 [00:43<00:03,  1.59s/it, attack_loss: -672.39746 variance_cross_attn_loss: 0.01348 self_attn_loss: 2.53155 loss: -669.85242]Iterations:  93%|█████████▎| 28/30 [00:44<00:03,  1.59s/it, attack_loss: -682.79199 variance_cross_attn_loss: 0.01352 self_attn_loss: 2.57208 loss: -680.20636]Iterations:  97%|█████████▋| 29/30 [00:45<00:01,  1.64s/it, attack_loss: -682.79199 variance_cross_attn_loss: 0.01352 self_attn_loss: 2.57208 loss: -680.20636]Iterations:  97%|█████████▋| 29/30 [00:46<00:01,  1.64s/it, attack_loss: -691.79138 variance_cross_attn_loss: 0.01353 self_attn_loss: 2.58378 loss: -689.19403]Iterations: 100%|██████████| 30/30 [00:46<00:00,  1.70s/it, attack_loss: -691.79138 variance_cross_attn_loss: 0.01353 self_attn_loss: 2.58378 loss: -689.19403]Iterations: 100%|██████████| 30/30 [00:46<00:00,  1.57s/it, attack_loss: -691.79138 variance_cross_attn_loss: 0.01353 self_attn_loss: 2.58378 loss: -689.19403]
Accuracy on adversarial examples: 0.0%
after_pred: tensor([388], device='cuda:0') tensor(1., device='cuda:0')
after_true: tensor([634], device='cuda:0') tensor(2.7286e-31, device='cuda:0')
L1: [6935.3335]	L2: [27.141977]	Linf: [0.8235294]
Clean acc: 0.0%
Adv acc: 0.0%

*********Transfer to resnet********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 27.27272727272727%

*********Transfer to vgg********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 0.0%

*********Transfer to mobile********
Accuracy on benign examples: 72.72727272727273%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to inception********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 0.0%

*********Transfer to convnext********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to vit********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 54.54545454545454%

*********Transfer to swin********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 18.181818181818183%

*********Transfer to deit-b********
Accuracy on benign examples: 81.81818181818183%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to deit-s********
Accuracy on benign examples: 90.9090909090909%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to mixer-b********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 36.36363636363637%

*********Transfer to mixer-l********
Accuracy on benign examples: 63.63636363636363%
Accuracy on adversarial examples: 9.090909090909092%
Warning: batch size is bigger than the data size. Setting batch size to data size
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:01<00:00,  1.58s/it]100%|██████████| 1/1 [00:01<00:00,  1.82s/it]
FID:  299.7743547451039

*********fid: 299.7743547451039********
